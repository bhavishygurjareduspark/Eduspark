<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Add Content Security Policy Meta Tag - Customize as needed -->
    <meta http-equiv="Content-Security-Policy"
      content="default-src 'self' https://*.firebaseio.com https://*.firebasedatabase.app https://*.googleapis.com https://*.gstatic.com https://cdnjs.cloudflare.com https://unpkg.com https://cdn.jsdelivr.net;
               script-src 'self' 'unsafe-inline' https://www.gstatic.com/firebasejs/ https://unpkg.com https://cdn.jsdelivr.net https://www.google.com/recaptcha/api.js https://*.google.com https://www.gstatic.com/recaptcha/;
               style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com https://unpkg.com;
               font-src 'self' https://fonts.gstatic.com https://cdnjs.cloudflare.com;
               img-src 'self' data: https: http://via.placeholder.com;
               connect-src 'self' wss://*.firebaseio.com https://*.googleapis.com https://*.firebaseio.com https://identitytoolkit.googleapis.com https://securetoken.googleapis.com https://firestore.googleapis.com https://firebaseinstallations.googleapis.com https://firebasestorage.googleapis.com https://firebaseappcheck.googleapis.com;
               object-src 'none';
               base-uri 'self';
               form-action 'self';
               frame-src 'self' https://www.google.com/recaptcha/ https://*.google.com;">
    <title>EduSparK - Share Knowledge</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app-check.js"></script> <!-- Firebase App Check SDK -->


    <style>
        :root{--primary-color:#ff3333;--primary-light:#ff6666;--primary-dark:#cc0000;--secondary-color:#000000;--secondary-light:#2a2a2a;--secondary-dark:#000000;--text-light:#f1f2f6;--text-dark:#dfe4ea;--text-muted:#a4b0be;--bg-light:#1e1e1e;--bg-dark:#121212;--card-bg:#212121;--card-bg-dark:#1a1a1a;--gradient:linear-gradient(135deg,#ff3333,#cc0000);--gradient-light:linear-gradient(135deg,#ff6666,#ff3333);--gradient-dark:linear-gradient(135deg,#ff0000,#990000);--shadow-sm:0 2px 5px rgba(0,0,0,0.35);--shadow-md:0 6px 12px rgba(0,0,0,0.4);--shadow-lg:0 10px 25px rgba(0,0,0,0.45);--shadow-xl:0 20px 40px rgba(0,0,0,0.5);--border-radius:12px;--border-radius-sm:8px;--border-radius-xs:6px;--transition:all 0.3s cubic-bezier(0.4,0,0.2,1);--transition-fast:all 0.15s ease-out;--header-height:70px;--nav-height:70px;--max-width:1200px;--skeleton-bg:#303030;--skeleton-highlight:#404040;--credit-color:#ffd700;--star-color:#f1c40f;--profile-header-bg:linear-gradient(135deg,rgba(30,30,30,0.9),rgba(18,18,18,0.98));--notification-unread-dot:#3498db;--notification-bg-success:rgba(39,174,96,0.15);--notification-border-success:#27ae60;--notification-bg-info:rgba(52,152,219,0.15);--notification-border-info:#3498db;--notification-bg-warning:rgba(243,156,18,0.15);--notification-border-warning:#f39c12;--notification-bg-error:rgba(231,76,60,0.15);--notification-border-error:#e74c3c}
*{margin:0;padding:0;box-sizing:border-box}
html{scroll-behavior:smooth}
body{font-family:'Poppins',sans-serif;background-color:var(--bg-dark);color:var(--text-dark);min-height:100vh;padding-top:var(--header-height);padding-bottom:var(--nav-height);line-height:1.6;overflow-x:hidden;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
.loading-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:var(--bg-dark);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999;transition:opacity 0.7s cubic-bezier(0.4,0,0.2,1),visibility 0.7s cubic-bezier(0.4,0,0.2,1);opacity:1;visibility:visible}
.loading-overlay.hidden{opacity:0;visibility:hidden;pointer-events:none}
.loading-logo-container{display:flex;align-items:center;margin-bottom:25px;animation:logoPulse 2s infinite ease-in-out}
.loading-logo-icon{font-size:3.5rem;color:var(--primary-color);margin-right:15px}
.loading-logo-text{font-size:2.2rem;font-weight:700;color:var(--primary-light);letter-spacing:1px}
.loading-dots{display:flex;justify-content:center;align-items:center;margin-bottom:30px}
.loading-dots span{width:12px;height:12px;margin:0 6px;background-color:var(--primary-color);border-radius:50%;animation:loadingBounce 1.4s infinite ease-in-out both}
.loading-dots span:nth-child(1){animation-delay:-0.32s}
.loading-dots span:nth-child(2){animation-delay:-0.16s}
.loading-message{color:var(--text-muted);font-size:1rem;font-style:italic;max-width:80%;text-align:center;animation:fadeInText 1.5s ease-out forwards;opacity:0;animation-delay:0.5s}
@keyframes logoPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
@keyframes loadingBounce{0%,80%,100%{transform:scale(0)}40%{transform:scale(1.0)}}
@keyframes fadeInText{to{opacity:1}}
.header{background-color:rgba(18,18,18,0.85);backdrop-filter:blur(15px) saturate(180%);-webkit-backdrop-filter:blur(15px) saturate(180%);color:var(--text-light);height:var(--header-height);display:flex;justify-content:space-between;align-items:center;box-shadow:var(--shadow-md);position:fixed;top:0;left:0;right:0;z-index:1000;padding:0 20px;transition:height 0.3s ease,background-color 0.3s ease,box-shadow 0.3s ease;border-bottom:1px solid rgba(255,51,51,0.1)}
.header.scrolled{height:65px;background-color:rgba(18,18,18,0.95);box-shadow:0 6px 25px rgba(0,0,0,0.25)}
.logo-container{display:flex;align-items:center;flex-shrink:0}
.logo{font-size:1.8rem;font-weight:700;color:var(--primary-color);display:flex;align-items:center;text-decoration:none;transition:transform 0.3s ease;position:relative;padding:5px 0}
.logo:hover{transform:scale(1.05)}
.logo i{margin-right:10px;font-size:1.6rem;color:var(--primary-color);transition:transform 0.3s ease}
.logo:hover i{transform:rotate(-10deg)}
.logo-text{display:inline-block;position:relative;transition:opacity 0.3s ease}
@media (max-width:420px){.logo-text{font-size:1.5rem}.logo i{margin-right:5px}}
.header-actions{display:flex;align-items:center;gap:12px;flex-shrink:0}
.header-credits{display:flex;align-items:center;gap:8px;color:var(--text-light);font-weight:600;font-size:0.9rem;cursor:pointer;padding:6px 12px;border-radius:25px;background-color:rgba(255,255,255,0.07);transition:background-color 0.3s ease,transform 0.2s ease;border:1px solid rgba(255,255,255,0.1)}
.header-credits:hover{background-color:rgba(255,255,255,0.15);transform:scale(1.05)}
.header-credits i{font-size:1.1rem;color:var(--credit-color)}
#headerCreditsAmount{min-width:20px;text-align:right}
.search-container{position:relative;width:250px;transition:all 0.3s ease;margin-left:auto;margin-right:10px}
.search-input{width:100%;padding:10px 15px 10px 40px;border:1px solid rgba(255,255,255,0.1);border-radius:30px;background-color:rgba(255,255,255,0.05);color:var(--text-light);font-family:'Poppins',sans-serif;transition:all 0.3s ease;font-size:0.9rem}
.search-input::placeholder{color:rgba(255,255,255,0.5)}
.search-input:focus{outline:none;background-color:rgba(255,255,255,0.1);box-shadow:0 0 0 2px var(--primary-light);border-color:var(--primary-light)}
.search-icon{position:absolute;left:15px;top:50%;transform:translateY(-50%);color:var(--text-light);opacity:0.6;font-size:1rem;pointer-events:none}
.search-results{position:absolute;top:calc(100% + 8px);left:0;right:0;background-color:var(--card-bg);border-radius:var(--border-radius-sm);box-shadow:var(--shadow-xl);max-height:350px;overflow-y:auto;z-index:1001;display:none;animation:fadeInDown 0.3s ease forwards;border:1px solid rgba(255,255,255,0.1)}
@keyframes fadeInDown{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}
.search-result-item{padding:12px 15px;border-bottom:1px solid rgba(255,255,255,0.05);cursor:pointer;transition:background-color 0.2s ease}
.search-result-item:hover{background-color:rgba(255,255,255,0.08)}
.search-result-item h4{font-size:0.95rem;color:var(--text-dark);margin-bottom:5px;font-weight:500}
.search-result-item p{font-size:0.8rem;color:var(--text-muted)}
.no-results{padding:20px;text-align:center;color:var(--text-muted);font-size:0.9rem}
.search-toggle-btn{background:none;border:none;color:var(--text-light);font-size:1.2rem;cursor:pointer;padding:5px;display:none}
@media (max-width:768px){.search-container{position:absolute;top:calc(var(--header-height) + 10px);left:10px;right:10px;width:auto;z-index:999;background-color:var(--bg-light);padding:10px;border-radius:var(--border-radius-sm);box-shadow:var(--shadow-lg);opacity:0;visibility:hidden;transform:translateY(-10px);transition:opacity 0.3s ease,visibility 0.3s ease,transform 0.3s ease}.search-container.active{opacity:1;visibility:visible;transform:translateY(0)}.search-toggle-btn{display:block;order:-1;margin-right:5px}.search-results{top:calc(100% + 5px);left:0;right:0;width:100%}.search-container.active ~ .header-actions .header-credits{display:none}}
@media (max-width:576px){.search-container{top:calc(var(--header-height) + 5px)}.header-actions{gap:8px}.header-credits{padding:5px 8px;font-size:0.8rem}.header-credits i{font-size:1rem}}
@media (max-width:420px){.header-credits{display:none}.header-actions .search-toggle-btn{margin-right:0}}
.user-avatar{width:40px;height:40px;border-radius:50%;object-fit:cover;border:2px solid var(--primary-color);cursor:pointer;transition:transform 0.3s ease,box-shadow 0.3s ease;display:flex;align-items:center;justify-content:center;background:var(--gradient);color:white;font-weight:600;font-size:1rem;position:relative;overflow:hidden;flex-shrink:0}
.user-avatar::after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:radial-gradient(circle,rgba(255,255,255,0.2) 0%,rgba(255,255,255,0) 70%);opacity:0;transition:opacity 0.4s ease}
.user-avatar:hover{transform:scale(1.1);box-shadow:0 0 15px rgba(255,51,51,0.5)}
.user-avatar:hover::after{opacity:1}
.popular-books-section{padding:30px 20px;background:linear-gradient(180deg,rgba(18,18,18,0.9) 0%,rgba(18,18,18,0) 100%),var(--bg-dark);margin-bottom:20px}
.section-title{font-size:1.8rem;margin-bottom:25px;color:var(--primary-light);position:relative;display:inline-block;font-weight:600;padding-bottom:10px;text-align:center;width:100%}
.section-title::after{content:'';position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:70px;height:4px;background:var(--gradient);border-radius:4px;animation:scaleIn 0.6s ease-out forwards}
@keyframes scaleIn{from{transform:translateX(-50%) scaleX(0)}to{transform:translateX(-50%) scaleX(1)}}
.popular-books-carousel{display:flex;gap:20px;overflow-x:auto;padding-bottom:20px;-ms-overflow-style:none;scrollbar-width:none}
.popular-books-carousel::-webkit-scrollbar{display:none}
.popular-book-card{flex:0 0 auto;width:160px;background-color:var(--card-bg);border-radius:var(--border-radius);overflow:hidden;box-shadow:var(--shadow-md);transition:var(--transition);border:1px solid rgba(255,255,255,0.08);position:relative;cursor:pointer}
.popular-book-card:hover{transform:translateY(-8px) scale(1.03);box-shadow:var(--shadow-lg)}
.popular-book-img-container{height:200px;overflow:hidden;position:relative;background-color:rgba(255,255,255,0.05);display:flex;align-items:center;justify-content:center}
.popular-book-img{width:auto;height:100%;object-fit:cover;transition:transform 0.5s ease}
.popular-book-card:hover .popular-book-img{transform:scale(1.1)}
.popular-book-info{padding:12px}
.popular-book-title{font-size:0.9rem;font-weight:600;color:var(--text-dark);margin-bottom:5px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.popular-book-meta{font-size:0.75rem;color:var(--text-muted);display:flex;align-items:center;gap:5px}
.popular-book-meta i{color:var(--primary-color);font-size:0.8rem}
.container{padding:20px;max-width:var(--max-width);margin:0 auto}
.page-title{font-size:2rem;margin-bottom:25px;color:var(--primary-color);position:relative;display:inline-block;font-weight:600;padding-bottom:10px}
.page-title::after{content:'';position:absolute;bottom:0;left:0;width:60px;height:4px;background:var(--gradient);border-radius:4px;transform-origin:left;animation:scaleInMain 0.6s ease-out forwards}
@keyframes scaleInMain{from{transform:scaleX(0)}to{transform:scaleX(1)}}
.category-filter-container{margin-bottom:25px;display:flex;flex-wrap:wrap;gap:10px;justify-content:center;padding:10px 0;border-bottom:1px solid rgba(255,255,255,0.1)}
.category-filter-item{padding:8px 18px;border-radius:20px;background-color:var(--card-bg);color:var(--text-muted);font-size:0.9rem;font-weight:500;cursor:pointer;transition:all 0.3s ease;border:1px solid transparent}
.category-filter-item:hover{background-color:var(--secondary-light);color:var(--text-light);transform:translateY(-2px)}
.category-filter-item.active{background:var(--gradient);color:white;font-weight:600;box-shadow:0 4px 10px rgba(255,51,51,0.3);border-color:var(--primary-dark)}
.books-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(190px,1fr));gap:25px;margin-top:20px}
#booksGridLoadingIndicator{grid-column:1 / -1;text-align:center;padding:20px;color:var(--text-muted);font-size:1rem;display:none}
#booksGridLoadingIndicator .spinner{width:24px;height:24px;border-color:var(--text-muted);border-top-color:var(--primary-color);margin-right:10px;vertical-align:middle}
.skeleton{background-color:var(--skeleton-bg);animation:pulse-bg 1.5s infinite ease-in-out;border-radius:4px}
.skeleton-img{height:220px;border-radius:var(--border-radius-sm) var(--border-radius-sm) 0 0}
.skeleton-text{height:1em;margin-bottom:10px}
.skeleton-btn{height:38px;border-radius:var(--border-radius-sm);margin-top:15px}
.skeleton-book-card{background-color:var(--card-bg);border-radius:var(--border-radius);overflow:hidden;box-shadow:var(--shadow-md);border:1px solid rgba(255,255,255,0.08);height:390px;display:flex;flex-direction:column}
.skeleton-book-card .skeleton-img{flex-shrink:0;background-color:var(--skeleton-bg);animation:pulse-bg 1.5s infinite ease-in-out}
.skeleton-book-card .skeleton-info{padding:15px;flex-grow:1;display:flex;flex-direction:column}
.skeleton-book-card .skeleton-text.title{width:85%;height:1.2em;margin-top:5px}
.skeleton-book-card .skeleton-text.author{width:60%;height:0.9em;margin-top:8px}
.skeleton-book-card .skeleton-text.meta{width:40%;height:0.8em;margin-top:15px}
.skeleton-book-card .skeleton-btn{margin-top:auto;background-color:var(--skeleton-bg);animation:pulse-bg 1.5s infinite ease-in-out}
.skeleton-popular-book{flex:0 0 auto;width:160px}
.skeleton-popular-book .skeleton-img{height:200px;border-radius:var(--border-radius-sm) var(--border-radius-sm) 0 0;background-color:var(--skeleton-bg);animation:pulse-bg 1.5s infinite ease-in-out}
.skeleton-popular-book .skeleton-info{padding:12px}
.skeleton-popular-book .skeleton-text.title{width:80%;height:1em;margin-bottom:8px}
.skeleton-popular-book .skeleton-text.meta{width:50%;height:0.8em;margin-top:8px}
.skeleton-history-item{height:80px;background-color:var(--skeleton-bg);border-radius:var(--border-radius-sm);animation:pulse-bg 1.5s infinite ease-in-out;margin-bottom:15px}
.skeleton-notification-item{display:flex;align-items:flex-start;padding:15px;background-color:var(--skeleton-bg);border-radius:var(--border-radius-sm);margin-bottom:12px;animation:pulse-bg 1.5s infinite ease-in-out}
.skeleton-notification-item .skeleton-icon{width:36px;height:36px;border-radius:50%;background-color:var(--skeleton-highlight);margin-right:15px}
.skeleton-notification-item .skeleton-content{flex:1}
.skeleton-notification-item .skeleton-text.title{width:60%;height:1.1em;margin-bottom:8px;background-color:var(--skeleton-highlight)}
.skeleton-notification-item .skeleton-text.message{width:90%;height:0.9em;margin-bottom:10px;background-color:var(--skeleton-highlight)}
.skeleton-notification-item .skeleton-text.timestamp{width:30%;height:0.7em;background-color:var(--skeleton-highlight)}
@keyframes pulse-bg{0%{background-color:var(--skeleton-bg)}50%{background-color:var(--skeleton-highlight)}100%{background-color:var(--skeleton-bg)}}
.book-card{background-color:var(--card-bg);border-radius:var(--border-radius);overflow:hidden;box-shadow:var(--shadow-md);transition:transform 0.3s ease,box-shadow 0.3s ease;position:relative;border:1px solid rgba(255,255,255,0.08);display:flex;flex-direction:column;height:100%;opacity:0;transform:translateY(20px);animation:cardFadeInUp 0.5s ease forwards}
@keyframes cardFadeInUp{to{opacity:1;transform:translateY(0)}}
.books-grid .book-card:nth-child(1),#profileBooksContainer .book-card:nth-child(1){animation-delay:0.05s}
.books-grid .book-card:nth-child(2),#profileBooksContainer .book-card:nth-child(2){animation-delay:0.1s}
.books-grid .book-card:nth-child(3),#profileBooksContainer .book-card:nth-child(3){animation-delay:0.15s}
.book-card:hover{transform:translateY(-8px) scale(1.02);box-shadow:var(--shadow-lg)}
.book-img-container{height:220px;overflow:hidden;position:relative;background-color:rgba(255,255,255,0.05);display:flex;align-items:center;justify-content:center;cursor:pointer}
.book-img{width:100%;height:100%;object-fit:cover;transition:transform 0.5s ease}
.book-card:hover .book-img{transform:scale(1.08)}
.book-info{padding:15px;flex:1;display:flex;flex-direction:column;background-color:var(--card-bg)}
.book-title{font-size:1rem;font-weight:600;margin-bottom:8px;color:var(--text-dark);display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;min-height:2.4em}
.book-author{font-size:0.85rem;color:var(--primary-light);margin-bottom:12px;font-weight:500}
.book-meta{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;font-size:0.75rem;color:var(--text-muted)}
.book-meta span{display:flex;align-items:center;gap:5px}
.book-meta i{color:var(--primary-color);font-size:0.8rem}
.book-admin-info{font-size:0.7rem;color:var(--text-muted);margin-top:auto;padding-top:10px;border-top:1px dashed rgba(255,255,255,0.15);display:flex;align-items:center;gap:5px}
.book-admin-info i{color:var(--primary-color);font-size:0.8rem}
.action-btn{background:var(--gradient);color:white;border:none;padding:10px 14px;border-radius:var(--border-radius-sm);display:flex;align-items:center;justify-content:center;width:100%;cursor:pointer;transition:var(--transition);font-weight:500;font-size:0.9rem;position:relative;overflow:hidden;box-shadow:var(--shadow-sm);margin-top:auto;gap:8px}
.action-btn::after{content:'';position:absolute;top:-50%;left:-75%;width:50%;height:200%;background:linear-gradient(to right,rgba(255,255,255,0) 0%,rgba(255,255,255,0.2) 50%,rgba(255,255,255,0) 100%);transform:skewX(-25deg);transition:left 0.7s ease;pointer-events:none}
.action-btn:hover::after{left:125%}
.action-btn i{font-size:0.9rem}
.action-btn:hover:not(:disabled){transform:translateY(-3px);box-shadow:0 8px 18px rgba(255,51,51,0.4);background:var(--gradient-light)}
.action-btn:disabled{background:var(--secondary-light)!important;opacity:0.6;cursor:not-allowed;transform:none!important;box-shadow:none!important}
.status-badge{position:absolute;top:10px;right:10px;padding:4px 9px;border-radius:var(--border-radius-xs);font-size:0.7rem;font-weight:600;text-transform:uppercase;letter-spacing:0.5px;z-index:1;box-shadow:0 2px 5px rgba(0,0,0,0.3);backdrop-filter:blur(3px)}
.status-badge.status-approved{background-color:rgba(39,174,96,0.85);color:white}
.status-badge.status-pending{background-color:rgba(243,156,18,0.85);color:white}
.status-badge.status-rejected{background-color:rgba(231,76,60,0.85);color:white}
.bottom-nav{position:fixed;bottom:0;left:0;right:0;background-color:rgba(26,26,26,0.9);backdrop-filter:blur(12px) saturate(180%);-webkit-backdrop-filter:blur(12px) saturate(180%);display:flex;justify-content:space-around;align-items:center;height:var(--nav-height);z-index:1000;box-shadow:0 -5px 25px rgba(0,0,0,0.2);border-top:1px solid rgba(255,255,255,0.1)}
.nav-item{color:var(--text-muted);font-size:1.3rem;padding:10px;border-radius:50%;width:50px;height:50px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:transform 0.3s ease,color 0.3s ease;position:relative}
.nav-item:hover{color:var(--primary-light);transform:translateY(-4px)}
.nav-item.active{color:var(--primary-color);transform:translateY(-4px)}
.nav-item.active::after{content:'';position:absolute;bottom:2px;left:50%;transform:translateX(-50%);width:6px;height:6px;background-color:var(--primary-color);border-radius:50%;box-shadow:0 0 10px var(--primary-color);animation:fadeIn 0.3s ease}
.nav-item .unread-badge{position:absolute;top:8px;right:8px;background-color:var(--notification-unread-dot);color:white;font-size:0.6rem;font-weight:bold;width:16px;height:16px;border-radius:50%;display:flex;align-items:center;justify-content:center;box-shadow:0 0 0 2px var(--bg-light)}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.add-btn{background:var(--gradient);color:white;width:60px;height:60px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.7rem;transform:translateY(-20px);box-shadow:0 8px 25px rgba(255,51,51,0.45);transition:transform 0.3s ease,box-shadow 0.3s ease,background 0.3s ease;cursor:pointer;border:none;outline:none;z-index:1001;position:relative;overflow:hidden}
.add-btn::before{content:'';position:absolute;inset:0;border-radius:50%;background:var(--gradient);opacity:0.6;z-index:-1;animation:pulse-glow 2s infinite ease-out}
.add-btn:hover{transform:translateY(-25px) scale(1.1);box-shadow:0 12px 30px rgba(255,51,51,0.6);background:var(--gradient-light)}
.add-btn:hover::before{animation-play-state:paused}
@keyframes pulse-glow{0%{transform:scale(0.95);box-shadow:0 0 0 0 rgba(255,51,51,0.7)}70%{transform:scale(1);box-shadow:0 0 0 10px rgba(255,51,51,0)}100%{transform:scale(0.95);box-shadow:0 0 0 0 rgba(255,51,51,0)}}
.profile-page{position:fixed;top:0;left:0;right:0;bottom:0;background-color:var(--bg-dark);z-index:2000;transform:translateX(100%);transition:transform 0.5s cubic-bezier(0.4,0,0.2,1);overflow-y:auto;padding:0;opacity:0;visibility:hidden}
.profile-page.active{transform:translateX(0);opacity:1;visibility:visible}
.profile-page-content{padding:20px;padding-top:var(--header-height);padding-bottom:calc(var(--nav-height) + 40px);max-width:var(--max-width);margin:0 auto}
.page-back-btn{background:rgba(0,0,0,0.4);border:none;color:var(--primary-light);font-size:1.3rem;position:absolute;left:15px;top:calc(15px + (var(--header-height) - 60px) / 2);cursor:pointer;transition:transform 0.3s ease,background-color 0.3s ease;width:40px;height:40px;display:flex;align-items:center;justify-content:center;border-radius:50%;backdrop-filter:blur(5px);z-index:5}
.page-back-btn:hover{transform:scale(1.1);background-color:rgba(255,51,51,0.3);color:white}
.profile-main-header{display:flex;flex-direction:column;align-items:center;text-align:center;background:var(--profile-header-bg);padding:40px 20px 30px;border-radius:var(--border-radius);box-shadow:var(--shadow-lg);margin-bottom:30px;position:relative}
.profile-main-header::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-image:url("data:image/svg+xml,%3Csvg width='52' height='26' viewBox='0 0 52 26' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%23ff3333' fill-opacity='0.04'%3E%3Cpath d='M10 10c0-2.21-1.79-4-4-4-3.314 0-6-2.686-6-6h2c0 2.21 1.79 4 4 4 3.314 0 6 2.686 6 6 0 2.21 1.79 4 4 4 3.314 0 6 2.686 6 6 0 2.21 1.79 4 4 4v2c-3.314 0-6-2.686-6-6 0-2.21-1.79-4-4-4-3.314 0-6-2.686-6-6zm25.464-1.95l8.486 8.486-1.414 1.414-8.486-8.486 1.414-1.414z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");opacity:0.5;z-index:0;border-radius:var(--border-radius)}
.profile-avatar-lg{width:130px;height:130px;border-radius:50%;object-fit:cover;border:5px solid var(--primary-color);margin-bottom:20px;background:var(--gradient);color:white;font-size:3.2rem;display:flex;align-items:center;justify-content:center;font-weight:700;box-shadow:0 12px 30px rgba(0,0,0,0.5);position:relative;z-index:1;transition:transform 0.4s ease,box-shadow 0.4s ease}
.profile-avatar-lg:hover{transform:scale(1.08) translateY(-5px);box-shadow:0 0 35px rgba(255,51,51,0.6)}
#profileNameLarge{font-size:2.2rem;margin-bottom:5px;color:var(--text-light);font-weight:700;text-shadow:0 3px 8px rgba(0,0,0,0.6);z-index:1}
#profileUsernameLarge{color:var(--primary-light);margin-bottom:10px;font-size:1.2rem;font-weight:500;display:inline-block;padding:5px 15px;background:rgba(0,0,0,0.4);border-radius:25px;z-index:1}
#profileEmailLarge,#profileJoinedLarge{color:var(--text-muted);margin-bottom:8px;font-size:0.95rem;display:inline-flex;align-items:center;gap:8px;background:rgba(0,0,0,0.25);padding:6px 12px;border-radius:20px;z-index:1}
#profileEmailLarge i,#profileJoinedLarge i{color:var(--primary-color)}
.profile-bio-box{margin-top:20px;color:var(--text-light);line-height:1.7;font-size:0.95rem;padding:20px 25px;background-color:rgba(255,255,255,0.05);border-radius:var(--border-radius-sm);border-left:4px solid var(--primary-color);text-align:left;position:relative;box-shadow:var(--shadow-sm);max-width:600px;width:100%;z-index:1}
.profile-bio-box::before{content:'\f10d';font-family:"Font Awesome 6 Free";font-weight:900;position:absolute;top:15px;right:20px;font-size:1.8rem;color:var(--primary-color);opacity:0.1}
.profile-dashboard{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:25px;margin-bottom:30px}
.profile-dashboard-item{background-color:var(--card-bg);padding:25px;border-radius:var(--border-radius);box-shadow:var(--shadow-md);transition:transform 0.3s ease,box-shadow 0.3s ease;border:1px solid rgba(255,255,255,0.08)}
.profile-dashboard-item:hover{transform:translateY(-5px);box-shadow:var(--shadow-lg)}
.profile-dashboard-item h3{font-size:1.3rem;color:var(--primary-light);margin-bottom:15px;display:flex;align-items:center;gap:10px;font-weight:600}
.points-amount-large{font-size:3.5rem;font-weight:700;color:var(--primary-color);margin-bottom:10px;line-height:1.1;text-shadow:0 2px 5px rgba(0,0,0,0.3)}
.profile-dashboard-item p{color:var(--text-muted);font-size:0.9rem;margin-bottom:20px}
.withdraw-btn-large{width:100%;font-size:1rem;padding:12px 20px}
.stat-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:15px}
.stat-card{background-color:rgba(255,255,255,0.05);padding:15px;border-radius:var(--border-radius-sm);text-align:center;border:1px solid rgba(255,255,255,0.1)}
.stat-value{display:block;font-size:2rem;font-weight:700;color:var(--primary-color);margin-bottom:5px}
.stat-label-card{font-size:0.8rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.5px}
.profile-tabs{display:flex;gap:10px;margin-bottom:25px;border-bottom:1px solid rgba(255,255,255,0.1);padding-bottom:10px;overflow-x:auto}
.profile-tab-btn{background:none;border:none;color:var(--text-muted);font-size:1rem;font-weight:500;padding:10px 18px;cursor:pointer;transition:color 0.3s ease,border-bottom-color 0.3s ease;border-bottom:3px solid transparent;white-space:nowrap}
.profile-tab-btn:hover{color:var(--primary-light)}
.profile-tab-btn.active{color:var(--primary-color);border-bottom-color:var(--primary-color);font-weight:600}
.profile-tab-content{display:none;animation:tabFadeIn 0.5s ease forwards}
.profile-tab-content.active{display:block}
@keyframes tabFadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.profile-section-title{font-size:1.6rem;margin-bottom:20px;color:var(--primary-light);font-weight:600;position:relative;padding-bottom:10px;text-align:center}
.profile-section-title::after{content:'';position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:70px;height:3px;background:var(--gradient);border-radius:3px}
#profileBooksContainer{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:20px;margin-top:20px;min-height:200px}
#profileBooksContainer .book-card{opacity:0;transform:translateY(20px);animation:cardFadeInUp 0.5s ease forwards}
.load-more-container{text-align:center;margin:30px 0}
.load-more-btn{background:var(--gradient);color:white;border:none;padding:12px 25px;border-radius:var(--border-radius-sm);font-size:1rem;cursor:pointer;transition:var(--transition);font-weight:600;display:inline-flex;align-items:center;justify-content:center;gap:10px;box-shadow:var(--shadow-md)}
.load-more-btn:hover:not(:disabled){transform:translateY(-3px);box-shadow:0 8px 20px rgba(255,51,51,0.5);background:var(--gradient-light)}
.load-more-btn:disabled{background:var(--secondary-light);opacity:0.6;cursor:not-allowed;transform:none!important;box-shadow:none}
#withdrawalHistoryContainer{display:flex;flex-direction:column;gap:15px;min-height:100px;flex-wrap:wrap;margin-top:20px}
.withdrawal-item{padding:15px 20px;border-radius:var(--border-radius-sm);background-color:rgba(255,255,255,0.04);display:flex;justify-content:space-between;align-items:center;transition:var(--transition);border-left:4px solid var(--primary-color);opacity:0;transform:scale(0.95);animation:itemFadeInScale 0.4s ease forwards;width:100%;word-break:break-word}
#withdrawalHistoryContainer .withdrawal-item:nth-child(1){animation-delay:0.1s}
#withdrawalHistoryContainer .withdrawal-item:nth-child(2){animation-delay:0.15s}
#withdrawalHistoryContainer .withdrawal-item:nth-child(3){animation-delay:0.2s}
@keyframes itemFadeInScale{to{opacity:1;transform:scale(1)}}
.withdrawal-item:hover{transform:translateX(5px) scale(1.01);box-shadow:var(--shadow-sm);border-left-color:var(--primary-light)}
.withdrawal-info{flex:1;margin-right:15px}
.withdrawal-amount{font-weight:600;color:var(--primary-color);margin-bottom:5px;font-size:1.05rem}
.withdrawal-method{font-size:0.85rem;color:var(--text-light);margin-bottom:5px;word-break:break-all}
.withdrawal-date{font-size:0.8rem;color:var(--text-muted)}
.withdrawal-status{padding:6px 12px;border-radius:var(--border-radius-xs);font-size:0.8rem;font-weight:600;text-transform:uppercase;flex-shrink:0;text-align:center;min-width:80px}
.withdrawal-status.status-pending{background-color:var(--status-pending-bg,#f39c12);color:white}
.withdrawal-status.status-completed{background-color:var(--status-completed-bg,#27ae60);color:white}
.withdrawal-status.status-rejected{background-color:var(--status-rejected-bg,#e74c3c);color:white}
.point-system-info-tabbed{background-color:rgba(255,255,255,0.04);border-radius:var(--border-radius);padding:25px;margin-top:20px;border:1px solid rgba(255,255,255,0.1)}
.point-item{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px dashed rgba(255,255,255,0.15)}
.point-item:last-child{border-bottom:none}
.point-action{font-weight:500;color:var(--text-light);font-size:0.9rem}
.point-value{color:var(--primary-color);font-weight:600;font-size:1rem}
.profile-actions-footer{display:flex;gap:15px;margin-top:40px;justify-content:center;padding-bottom:20px;flex-wrap:wrap;border-top:1px solid rgba(255,255,255,0.1);padding-top:30px}
.profile-action-btn{color:white;border:none;padding:12px 25px;border-radius:var(--border-radius-sm);font-size:1rem;cursor:pointer;transition:var(--transition);font-weight:600;display:inline-flex;align-items:center;justify-content:center;gap:10px;box-shadow:var(--shadow-md);position:relative;overflow:hidden;flex:1;min-width:180px;max-width:220px}
.profile-action-btn::after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(255,255,255,0.1);opacity:0;transition:opacity 0.3s ease;pointer-events:none}
.profile-action-btn:hover:not(:disabled){transform:translateY(-3px)}
.profile-action-btn:hover:not(:disabled)::after{opacity:1}
.edit-profile{background:var(--gradient)}
.edit-profile:hover:not(:disabled){background:var(--gradient-light);box-shadow:0 8px 20px rgba(255,51,51,0.5)}
.logout-btn{background:var(--secondary-light)}
.logout-btn:hover:not(:disabled){background:#333;box-shadow:0 8px 20px rgba(0,0,0,0.3)}
.notifications-page{position:fixed;top:0;left:0;right:0;bottom:0;background-color:var(--bg-dark);z-index:2000;transform:translateX(100%);transition:transform 0.5s cubic-bezier(0.4,0,0.2,1);opacity:0;visibility:hidden;display:flex;flex-direction:column}
.notifications-page.active{transform:translateX(0);opacity:1;visibility:visible}
.notifications-header{padding:0 15px;background:var(--card-bg-dark);color:white;display:flex;align-items:center;justify-content:space-between;height:var(--header-height);box-shadow:var(--shadow-md);border-bottom:1px solid rgba(255,255,255,0.1);flex-shrink:0;position:relative}
.notifications-actions{position:absolute;right:15px;top:50%;transform:translateY(-50%)}
.mark-all-read-btn{background:none;border:none;color:var(--primary-light);font-size:0.85rem;font-weight:500;cursor:pointer;padding:8px 12px;border-radius:var(--border-radius-sm);transition:background-color 0.2s ease,color 0.2s ease}
.mark-all-read-btn:hover:not(:disabled){background-color:rgba(255,255,255,0.1);color:white}
.mark-all-read-btn:disabled{opacity:0.5;cursor:not-allowed}
.mark-all-read-btn i{margin-right:6px}
.notifications-tabs{display:flex;background-color:var(--card-bg);padding:0 10px;flex-shrink:0}
.notification-tab-btn{flex:1;text-align:center;background:none;border:none;color:var(--text-muted);font-size:0.95rem;font-weight:500;padding:12px 10px;cursor:pointer;transition:color 0.3s ease,border-bottom-color 0.3s ease;border-bottom:3px solid transparent;white-space:nowrap}
.notification-tab-btn:hover{color:var(--primary-light)}
.notification-tab-btn.active{color:var(--primary-color);border-bottom-color:var(--primary-color);font-weight:600}
.notifications-content-area{flex:1;overflow-y:hidden;position:relative}
.notifications-list-container{position:absolute;top:0;left:0;width:100%;height:100%;overflow-y:auto;padding:15px;opacity:0;visibility:hidden;transition:opacity 0.3s ease,visibility 0.3s ease}
.notifications-list-container.active{opacity:1;visibility:visible}
.notification-group{margin-bottom:20px}
.notification-group-date{font-size:0.9rem;font-weight:600;color:var(--text-muted);margin-bottom:10px;padding-bottom:5px;border-bottom:1px solid rgba(255,255,255,0.1);text-transform:uppercase;letter-spacing:0.5px}
.notification-item{background-color:var(--card-bg);border-radius:var(--border-radius-sm);padding:15px;margin-bottom:12px;display:flex;align-items:flex-start;box-shadow:var(--shadow-sm);border-left:4px solid transparent;transition:background-color 0.3s ease,transform 0.2s ease;cursor:pointer;opacity:0;animation:itemFadeInScale 0.4s ease forwards}
.notification-item:hover{background-color:var(--secondary-light);transform:translateX(3px)}
.notification-item.unread{background-color:rgba(52,152,219,0.08);border-left-color:var(--notification-unread-dot)}
.notification-item.unread .notification-title{color:var(--primary-light)}
.notification-item.type-success{border-left-color:var(--notification-border-success)}
.notification-item.type-success.unread{background-color:var(--notification-bg-success)}
.notification-item.type-info{border-left-color:var(--notification-border-info)}
.notification-item.type-info.unread{background-color:var(--notification-bg-info)}
.notification-item.type-warning{border-left-color:var(--notification-border-warning)}
.notification-item.type-warning.unread{background-color:var(--notification-bg-warning)}
.notification-item.type-error{border-left-color:var(--notification-border-error)}
.notification-item.type-error.unread{background-color:var(--notification-bg-error)}
.notification-item.type-announcement{border-left-color:var(--primary-color)}
.notification-item.type-announcement .notification-icon{color:var(--primary-color)}
.notification-icon{font-size:1.4rem;width:40px;height:40px;flex-shrink:0;margin-right:15px;display:flex;align-items:center;justify-content:center;border-radius:50%;background-color:rgba(255,255,255,0.05)}
.notification-item.type-success .notification-icon{color:var(--notification-border-success)}
.notification-item.type-info .notification-icon{color:var(--notification-border-info)}
.notification-item.type-warning .notification-icon{color:var(--notification-border-warning)}
.notification-item.type-error .notification-icon{color:var(--notification-border-error)}
.notification-content{flex:1}
.notification-title{font-size:1rem;font-weight:600;color:var(--text-light);margin-bottom:5px}
.notification-message{font-size:0.9rem;color:var(--text-muted);line-height:1.5;margin-bottom:8px;word-break:break-word}
.notification-timestamp{font-size:0.75rem;color:var(--text-muted);opacity:0.8}
.modal{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,0.85);z-index:2500;align-items:center;justify-content:center;opacity:0;transition:opacity 0.3s ease;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);padding:20px 0}
.modal.active{display:flex;opacity:1}
.modal-content{background-color:var(--card-bg-dark);border-radius:var(--border-radius);width:90%;max-width:480px;padding:30px;box-shadow:var(--shadow-xl);transform:translateY(-20px) scale(0.95);transition:transform 0.35s cubic-bezier(0.175,0.885,0.32,1.275),opacity 0.3s ease;position:relative;max-height:90vh;overflow-y:auto;border:1px solid rgba(255,255,255,0.1)}
.modal.active .modal-content{transform:translateY(0) scale(1)}
.modal-content::-webkit-scrollbar{width:6px}
.modal-content::-webkit-scrollbar-thumb{background-color:var(--primary-color);border-radius:6px}
.modal-content::-webkit-scrollbar-track{background-color:rgba(255,255,255,0.05)}
.close-modal{position:absolute;top:10px;right:10px;font-size:1.8rem;color:var(--text-muted);cursor:pointer;background:none;border:none;transition:transform 0.3s ease,color 0.3s ease;width:40px;height:40px;display:flex;align-items:center;justify-content:center;border-radius:50%;line-height:1;z-index:10}
.close-modal:hover{color:var(--primary-color);transform:rotate(90deg) scale(1.1)}
.modal-title{font-size:1.6rem;margin-bottom:25px;color:var(--primary-light);text-align:center;position:relative;padding-bottom:12px;font-weight:600}
.modal-title::after{content:'';position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:60px;height:4px;background:var(--gradient);border-radius:4px}
.form-group{margin-bottom:20px;position:relative}
.form-label{display:block;margin-bottom:8px;font-weight:500;color:var(--text-dark);font-size:0.9rem}
.form-input,.form-textarea{width:100%;padding:12px 15px;border:1px solid rgba(255,255,255,0.15);border-radius:var(--border-radius-sm);font-family:'Poppins',sans-serif;background-color:var(--bg-light);color:var(--text-dark);transition:var(--transition);font-size:0.95rem}
.form-textarea{resize:vertical;min-height:80px}
.form-input:focus,.form-textarea:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 3px rgba(255,51,51,0.3)}
.submit-btn,.tutorial-btn,.profile-action-btn,.load-more-btn,.withdraw-btn,.book-overlay-btn,.download-btn,.action-btn{position:relative}
.submit-btn .spinner,.tutorial-btn .spinner,.profile-action-btn .spinner,.load-more-btn .spinner,.withdraw-btn .spinner,.withdraw-btn-large .spinner,.action-btn .spinner{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}
.submit-btn > span:not(.spinner),.tutorial-btn > span:not(.spinner),.profile-action-btn > span:not(.spinner),.load-more-btn > span:not(.spinner),.withdraw-btn > span:not(.spinner),.withdraw-btn-large > span:not(.spinner),.action-btn > span:not(.spinner){transition:opacity 0.2s ease;display:inline-flex;align-items:center;gap:8px}
.submit-btn.loading > span:not(.spinner),.tutorial-btn.loading > span:not(.spinner),.profile-action-btn.loading > span:not(.spinner),.load-more-btn.loading > span:not(.spinner),.withdraw-btn.loading > span:not(.spinner),.withdraw-btn-large.loading > span:not(.spinner),.action-btn.loading > span:not(.spinner){opacity:0}
.submit-btn,.tutorial-btn{color:white;border:none;padding:12px 18px;border-radius:var(--border-radius-sm);font-size:1rem;font-weight:500;cursor:pointer;width:100%;transition:var(--transition);margin-top:10px;display:flex;align-items:center;justify-content:center;box-shadow:var(--shadow-sm);position:relative;overflow:hidden}
.submit-btn{background:var(--gradient)}
.tutorial-btn{background:var(--secondary-light)}
.submit-btn:hover:not(:disabled){transform:translateY(-3px);box-shadow:0 8px 20px rgba(255,51,51,0.5);background:var(--gradient-light)}
.tutorial-btn:hover:not(:disabled){background:#333;transform:translateY(-2px);box-shadow:var(--shadow-md)}
.submit-btn:disabled,.tutorial-btn:disabled{background:var(--secondary-light)!important;opacity:0.6;cursor:not-allowed;transform:none!important;box-shadow:none!important}
.submit-btn::after{content:'';position:absolute;top:-50%;left:-75%;width:50%;height:200%;background:linear-gradient(to right,rgba(255,255,255,0) 0%,rgba(255,255,255,0.2) 50%,rgba(255,255,255,0) 100%);transform:skewX(-25deg);transition:left 0.7s ease;pointer-events:none}
.submit-btn:hover:not(:disabled)::after{left:125%}
.auth-switch{text-align:center;margin-top:20px;color:var(--text-muted);font-size:0.9rem}
.auth-switch a{color:var(--primary-color);font-weight:500;cursor:pointer;transition:color 0.3s ease;text-decoration:none}
.auth-switch a:hover{color:var(--primary-light);text-decoration:underline}
.withdrawal-options{display:flex;flex-direction:column;gap:12px;margin:25px 0}
.withdrawal-option{display:flex;align-items:center;padding:15px;border-radius:var(--border-radius-sm);background-color:rgba(255,255,255,0.05);cursor:pointer;transition:var(--transition);border:2px solid transparent}
.withdrawal-option:hover{background-color:rgba(255,255,255,0.1);border-color:rgba(255,255,255,0.2);transform:scale(1.02)}
.withdrawal-option.active{border:2px solid var(--primary-color);background-color:rgba(255,51,51,0.1);transform:scale(1.02)}
.withdrawal-icon{width:40px;height:40px;border-radius:50%;background:var(--gradient);color:white;display:flex;align-items:center;justify-content:center;margin-right:15px;flex-shrink:0;font-size:1.1rem;box-shadow:var(--shadow-sm)}
.withdrawal-details{flex:1}
.withdrawal-title{font-size:1rem;font-weight:600;margin-bottom:3px;color:var(--text-dark)}
.withdrawal-description{font-size:0.85rem;color:var(--text-muted)}
.amount-selection{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:12px;margin:25px 0}
.amount-option{padding:12px;text-align:center;border-radius:var(--border-radius-sm);background-color:rgba(255,255,255,0.05);cursor:pointer;transition:var(--transition);font-weight:500;border:2px solid transparent;font-size:0.9rem}
.amount-option:hover{background-color:rgba(255,255,255,0.1);border-color:rgba(255,255,255,0.2);transform:scale(1.03)}
.amount-option.active{background:var(--gradient);color:white;border-color:var(--primary-dark);transform:scale(1.03)}
.payment-details{margin-top:20px;display:none;animation:fadeIn 0.5s ease forwards}
.payment-details.active{display:block}
.discover-list{max-height:60vh;overflow-y:auto;padding-right:10px;margin:15px 0}
.discover-item{display:flex;padding:15px;border-bottom:1px solid rgba(255,255,255,0.08);transition:all 0.3s ease;align-items:center;cursor:pointer;border-radius:var(--border-radius-sm);margin-bottom:10px;background-color:rgba(255,255,255,0.03)}
.discover-item:last-child{border-bottom:none;margin-bottom:0}
.discover-item:hover{background-color:rgba(255,255,255,0.08);transform:translateX(5px) scale(1.01)}
.discover-icon{width:40px;height:40px;border-radius:50%;background:var(--gradient);color:white;display:flex;align-items:center;justify-content:center;margin-right:15px;flex-shrink:0;font-size:1.1rem;box-shadow:var(--shadow-sm)}
.discover-content{flex:1}
.discover-title{font-size:1rem;color:var(--text-dark);margin-bottom:5px;font-weight:600}
.discover-description{font-size:0.85rem;color:var(--text-muted);line-height:1.5}
.credit-options-list{display:flex;flex-direction:column;gap:15px;margin-top:20px}
#creditModalUserCredits{color:var(--credit-color);font-weight:700}
#bookDetailModal .modal-content{max-width:650px}
.book-detail-layout{display:flex;gap:25px}
.book-detail-image{flex-shrink:0;width:200px;height:280px}
.book-detail-image img{width:100%;height:100%;object-fit:cover;border-radius:var(--border-radius-sm);box-shadow:var(--shadow-md)}
.book-detail-info{flex-grow:1}
.book-detail-title{font-size:1.7rem;font-weight:700;color:var(--primary-light);margin-bottom:5px;line-height:1.3}
.book-detail-author{font-size:1rem;color:var(--text-dark);margin-bottom:8px;font-weight:500}
.book-detail-category{font-size:0.9rem;color:var(--text-muted);margin-bottom:15px;display:inline-block;background:rgba(255,255,255,0.05);padding:4px 10px;border-radius:15px}
.book-detail-meta{display:flex;gap:20px;font-size:0.9rem;color:var(--text-muted);margin-bottom:20px;align-items:center;flex-wrap:wrap}
.book-detail-meta span{display:flex;align-items:center;gap:6px}
.book-detail-meta i{color:var(--primary-color);font-size:1rem}
.book-detail-description{margin:20px 0;padding:15px;background:rgba(255,255,255,0.04);border-radius:var(--border-radius-sm);line-height:1.7;font-size:0.95rem;max-height:150px;overflow-y:auto;color:var(--text-light);border-left:3px solid var(--primary-color);word-break:break-word}
.book-detail-actions{display:flex;gap:15px;margin-top:20px;flex-wrap:wrap}
.detail-download-btn{flex-grow:1}
.feedback-separator{height:1px;background:rgba(255,255,255,0.1);margin:30px 0}
.feedback-section{margin-top:25px}
.feedback-title{font-size:1.3rem;color:var(--primary-light);margin-bottom:20px;font-weight:600;border-bottom:2px solid var(--primary-color);padding-bottom:8px;display:inline-block}
.rating-stars{margin-bottom:15px}
.rating-stars label{font-size:1rem;color:var(--text-dark);margin-right:10px}
.rating-stars .stars{display:inline-block}
.rating-stars .stars > i{font-size:1.6rem;color:var(--text-muted);cursor:pointer;transition:color 0.2s ease,transform 0.2s ease;margin:0 3px}
.rating-stars .stars:hover > i{color:var(--star-color)}
.rating-stars .stars > i:hover ~ i{color:var(--text-muted)}
.rating-stars .stars > i.selected,.rating-stars .stars > i.hovered{color:var(--star-color);transform:scale(1.1)}
#feedbackComment{margin-bottom:15px}
#submitFeedbackBtn{width:auto;padding:10px 25px}
.comments-list{margin-top:25px;max-height:250px;overflow-y:auto;padding-right:10px;display:flex;flex-direction:column;gap:15px}
.comment-item{background-color:rgba(255,255,255,0.04);padding:15px;border-radius:var(--border-radius-sm);border-left:3px solid var(--secondary-light)}
.comment-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.comment-author{font-weight:600;color:var(--text-dark);font-size:0.95rem}
.comment-rating i{color:var(--star-color);font-size:0.8rem;margin-left:2px}
.comment-body{font-size:0.9rem;color:var(--text-light);line-height:1.6;word-break:break-word}
.comment-date{font-size:0.75rem;color:var(--text-muted);margin-top:10px;text-align:right}
.no-comments{text-align:center;color:var(--text-muted);padding:20px 0}
@media (max-width:680px){.book-detail-layout{flex-direction:column;align-items:center}.book-detail-image{width:180px;height:250px;margin-bottom:15px}.book-detail-info{text-align:center}.book-detail-meta{justify-content:center}.book-detail-actions{justify-content:center}}
#toastContainer{position:fixed;top:25px;right:25px;z-index:3000;display:flex;flex-direction:column;gap:10px}
.toast{padding:15px 25px;border-radius:var(--border-radius-sm);background-color:var(--secondary-light);color:white;box-shadow:var(--shadow-xl);transform:translateX(calc(100% + 30px));transition:transform 0.5s cubic-bezier(0.68,-0.55,0.265,1.55);display:flex;align-items:center;max-width:380px;border-left:5px solid var(--primary-color)}
.toast.show{transform:translateX(0)}
.toast.success{background-color:#27ae60;border-left-color:#2ecc71}
.toast.error{background-color:#e74c3c;border-left-color:#ff4757}
.toast.warning{background-color:#f39c12;border-left-color:#f1c40f}
.toast.info{background-color:#3498db;border-left-color:#2980b9}
.toast i{margin-right:12px;font-size:1.3rem}
.toast span:not(.toast-close){flex-grow:1;word-break:break-word}
.toast-close{margin-left:15px;cursor:pointer;opacity:0.7;transition:opacity 0.2s ease;font-size:1.2rem;background:none;border:none;color:white;padding:5px}
.toast-close:hover{opacity:1}
.spinner{display:inline-block;width:18px;height:18px;border:3px solid rgba(255,255,255,0.3);border-radius:50%;border-top-color:white;animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.empty-state{text-align:center;padding:50px 20px;color:var(--text-muted);width:100%;display:none;flex-direction:column;align-items:center;justify-content:center;min-height:200px;grid-column:1 / -1}
.empty-state i{font-size:3.5rem;margin-bottom:20px;color:var(--primary-color);opacity:0.5;animation:bounce 2s infinite cubic-bezier(0.68,-0.55,0.27,1.55)}
@keyframes bounce{0%,100%{transform:translateY(0) scale(1)}50%{transform:translateY(-15px) scale(1.05)}}
.empty-state h3{margin-bottom:12px;color:var(--text-light);font-size:1.3rem;font-weight:600}
.empty-state p{font-size:0.95rem;max-width:350px;margin:0 auto;color:var(--text-muted)}
@media (max-width:992px){.container{padding:20px 15px}.books-grid,#profileBooksContainer{grid-template-columns:repeat(auto-fill,minmax(170px,1fr));gap:20px}.popular-book-card{width:150px}.popular-book-img-container{height:180px}.profile-dashboard{grid-template-columns:1fr}}
@media (max-width:768px){:root{--header-height:65px;--nav-height:65px}body{padding-top:var(--header-height);padding-bottom:var(--nav-height)}.header{padding:0 15px}.logo{font-size:1.6rem}.logo i{font-size:1.4rem}.user-avatar{width:38px;height:38px;font-size:0.9rem}.profile-avatar-lg{width:110px;height:110px;font-size:2.8rem}#profileNameLarge{font-size:2rem}.points-amount-large{font-size:3rem}.stat-value{font-size:1.8rem}.books-grid,#profileBooksContainer{grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:15px}.popular-book-card{width:140px}.popular-book-img-container{height:170px}.nav-item{width:45px;height:45px;font-size:1.2rem}.add-btn{width:55px;height:55px;font-size:1.6rem}.withdrawal-item{flex-direction:column;align-items:flex-start;gap:8px}.withdrawal-status{align-self:flex-start}.profile-action-btn{min-width:150px}.category-filter-item{padding:7px 15px;font-size:0.85rem}.notifications-tabs{padding:0 5px}.notification-tab-btn{font-size:0.9rem;padding:10px 8px}}
@media (max-width:576px){:root{--header-height:60px;--nav-height:60px}.header{padding:0 10px}.logo{font-size:1.5rem}.logo i{font-size:1.3rem;margin-right:8px}.user-avatar{width:35px;height:35px;font-size:0.8rem}.container{padding:15px 10px}.popular-books-section{padding:20px 10px}.section-title{font-size:1.5rem;margin-bottom:20px}.popular-book-card{width:130px}.popular-book-img-container{height:160px}.page-title{font-size:1.8rem}.books-grid,#profileBooksContainer{grid-template-columns:repeat(2,1fr);gap:12px}.book-card:hover{transform:translateY(-5px) scale(1.01)}.book-img-container{height:180px}.profile-page-content{padding:10px;padding-top:var(--header-height);padding-bottom:calc(var(--nav-height) + 15px)}.profile-main-header{padding:30px 15px 20px}.profile-avatar-lg{width:90px;height:90px;font-size:2.2rem}#profileNameLarge{font-size:1.6rem}#profileUsernameLarge{font-size:1rem}#profileEmailLarge,#profileJoinedLarge{font-size:0.9rem}.profile-bio-box{padding:15px;font-size:0.9rem}.points-amount-large{font-size:2.5rem}.withdraw-btn-large{font-size:0.9rem;padding:10px 15px}.stat-value{font-size:1.6rem}.profile-actions-footer{flex-direction:column;gap:12px;align-items:center}.profile-action-btn{max-width:300px;width:100%;min-width:unset}.modal-content{padding:20px;width:95%;max-height:85vh}.modal-title{font-size:1.4rem}.amount-selection{grid-template-columns:1fr 1fr}.category-filter-item{padding:6px 12px;font-size:0.8rem}.book-detail-title{font-size:1.5rem}.book-detail-author{font-size:0.9rem}.rating-stars .stars > i{font-size:1.4rem}.notifications-header{height:var(--header-height);padding:0 10px}.page-back-btn{width:35px;height:35px;font-size:1.2rem;top:calc(12.5px + (var(--header-height) - 60px) / 2)}.notification-item{padding:12px}.notification-icon{width:32px;height:32px;font-size:1.2rem;margin-right:12px}.notification-title{font-size:0.95rem}.notification-message{font-size:0.85rem}.notification-timestamp{font-size:0.7rem}.notifications-tabs{overflow-x:auto;justify-content:flex-start}.notification-tab-btn{flex:0 0 auto;padding:10px 15px}}
@media (max-width:400px){.books-grid,#profileBooksContainer{grid-template-columns:1fr}.popular-book-card{width:120px}.popular-book-img-container{height:150px}.book-img-container{height:220px}.profile-avatar-lg{width:80px;height:80px;font-size:2rem}#profileNameLarge{font-size:1.4rem}.amount-selection{grid-template-columns:1fr}.category-filter-container{gap:8px}.category-filter-item{padding:5px 10px}.book-detail-image{width:150px;height:210px}}
*{-webkit-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}
    </style>
</head>
<body data-theme="dark">

    <!-- Enhanced Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-logo-container">
            <i class="fas fa-book-reader loading-logo-icon"></i>
            <span class="loading-logo-text">EduSparK</span>
        </div>
        <div class="loading-dots">
            <span></span><span></span><span></span>
        </div>
        <p class="loading-message" id="loadingMessage">Loading EduSparK Library...</p>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="logo-container">
            <a href="#" class="logo" id="logoLink">
                <i class="fas fa-book-reader"></i>
                <span class="logo-text">EduSparK</span>
            </a>
        </div>

        <div class="search-container" id="searchContainer">
            <i class="fas fa-search search-icon"></i>
            <input type="text" class="search-input" id="searchInput" placeholder="Search books, authors...">
            <div class="search-results" id="searchResults"></div>
        </div>

        <div class="header-actions">
            <button class="search-toggle-btn" id="searchToggleBtn" aria-label="Toggle Search">
                <i class="fas fa-search"></i>
            </button>
            <div class="header-credits" id="headerCreditsContainer" style="display: none;" title="Your Credits">
                <i class="fas fa-coins"></i>
                <span id="headerCreditsAmount">0</span>
            </div>
            <div class="user-avatar" id="userAvatar">
                <span id="avatarInitials">U</span>
            </div>
        </div>
    </header>

    <!-- Popular Books Section -->
    <section class="popular-books-section" data-aos="fade-in" data-aos-delay="100">
        <h2 class="section-title"> Popular Now</h2>
        <div class="popular-books-carousel" id="popularBooksCarousel">
            <!-- Skeletons initially, then popular books -->
        </div>
    </section>

    <!-- Main Content -->
    <div class="container">
        <h1 class="page-title" data-aos="fade-right" data-aos-delay="200">Discover Books</h1>

        <!-- Category Filters -->
        <div class="category-filter-container" id="categoryFilterContainer" data-aos="fade-up" data-aos-delay="250">
            <!-- Categories will be loaded here by JS -->
        </div>

        <div class="books-grid" id="booksContainer">
            <!-- Skeletons initially, then books -->
        </div>
        <div id="booksGridLoadingIndicator">
            <span class="spinner"></span> Loading more books...
        </div>
         <div class="empty-state" id="emptyStateBooks"> <!-- Renamed for clarity -->
             <i class="fas fa-ghost"></i>
             <h3>No Books Found Yet</h3>
             <p>Looks a bit empty here. Try another category or check back later!</p>
         </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <div class="nav-item" id="notificationsBtn" data-tooltip="Notifications">
            <i class="fas fa-bell"></i>
            <span class="unread-badge" id="unreadNotificationsBadge" style="display: none;">0</span>
        </div>
        <div class="nav-item active" id="homeBtn" data-tooltip="Home">
            <i class="fas fa-home"></i>
        </div>
        <button class="add-btn" id="addBookBtn" aria-label="Add Book">
            <i class="fas fa-plus"></i>
        </button>
        <div class="nav-item" id="discoverBtn" data-tooltip="Discover">
            <i class="fas fa-compass"></i>
        </div>
        <div class="nav-item" id="profileBtn" data-tooltip="Profile">
            <i class="fas fa-user"></i>
        </div>
    </nav>

    <!-- Redesigned Full Page Profile -->
    <div class="profile-page" id="profilePage">
         <div class="profile-page-content">
            <button class="page-back-btn" id="profileBackBtn" aria-label="Go Back">
                <i class="fas fa-arrow-left"></i>
            </button>

            <div class="profile-main-header" data-aos="fade-down">
                <div class="profile-avatar-lg" id="profileAvatarLarge">
                    <span id="profileAvatarInitialsLarge">U</span>
                </div>
                <h1 id="profileNameLarge">User Loading...</h1>
                <p id="profileUsernameLarge" class="profile-username-lg">@loading</p>
                <p id="profileEmailLarge" class="profile-email-lg"><i class="fas fa-envelope"></i> loading...</p>
                <p id="profileJoinedLarge" class="profile-joined-lg"><i class="fas fa-calendar-alt"></i> Joined: -</p>
                <div class="profile-bio-box" id="profileBioLarge" data-aos="fade-up" data-aos-delay="100">
                    Loading bio...
                </div>
            </div>

            <div class="profile-dashboard" data-aos="fade-up" data-aos-delay="200">
                <div class="profile-dashboard-item points-dashboard">
                    <h3><i class="fas fa-coins"></i> Your Points</h3>
                    <div class="points-amount-large" id="userPointsLarge">0</div>
                    <p>Redeem points for exciting rewards or cash!</p>
                    <button class="withdraw-btn-large action-btn" id="withdrawBtnLarge" disabled>
                        <span class="spinner" style="display: none;"></span>
                        <span><i class="fas fa-hand-holding-usd"></i> Withdraw Points</span>
                    </button>
                </div>
                <div class="profile-dashboard-item stats-dashboard">
                    <h3><i class="fas fa-chart-line"></i> Your Activity</h3>
                    <div class="stat-grid">
                        <div class="stat-card">
                            <span class="stat-value" id="booksSharedLarge">0</span>
                            <span class="stat-label-card">Books Shared</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-value" id="booksDownloadedLarge">0</span>
                            <span class="stat-label-card">Your Downloads</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-value" id="totalBookDownloadsLarge">0</span>
                            <span class="stat-label-card">Shared Book Downloads</span>
                        </div>
                         <div class="stat-card">
                            <span class="stat-value" id="totalFeedbackLarge">0</span>
                            <span class="stat-label-card">Feedback Given</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="profile-tabs" data-aos="fade-up" data-aos-delay="300">
                <button class="profile-tab-btn active" data-tab="shared-books">My Shared Books</button>
                <button class="profile-tab-btn" data-tab="withdrawal-history">Withdrawal History</button>
                <button class="profile-tab-btn" data-tab="point-system">Point System</button>
            </div>

            <div class="profile-tab-content active" id="tab-shared-books" data-aos="fade-up" data-aos-delay="350">
                <h3 class="profile-section-title">Your Shared Books</h3>
                <div id="profileBooksContainer" class="books-grid">
                     <div class="empty-state" id="emptyProfileBooks" style="display: none;">
                         <i class="fas fa-book-medical"></i>
                         <h3>No Books Shared Yet</h3>
                         <p>Share your knowledge with the community!</p>
                     </div>
                </div>
                 <div class="load-more-container" id="loadMoreContainer">
                    <button class="load-more-btn" id="loadMoreBooksBtn" style="display: none;">
                        <span class="spinner" style="display: none;"></span>
                        <span><i class="fas fa-chevron-down"></i> Load More</span>
                    </button>
                </div>
            </div>

            <div class="profile-tab-content" id="tab-withdrawal-history">
                <h3 class="profile-section-title">Withdrawal History</h3>
                <div id="withdrawalHistoryContainer">
                    <div class="empty-state" id="emptyWithdrawalHistory" style="display: none;">
                        <i class="fas fa-history"></i>
                        <h3>No Withdrawals Yet</h3>
                        <p>Your withdrawal history will appear here.</p>
                    </div>
                 </div>
            </div>

             <div class="profile-tab-content" id="tab-point-system">
                 <h3 class="profile-section-title">Point System Guide</h3>
                 <div class="point-system-info-tabbed">
                    <div class="point-item"><span class="point-action">Share Approved Book</span><span class="point-value">+10 Points</span></div>
                    <div class="point-item"><span class="point-action">Book Downloaded (by others)</span><span class="point-value">+1 Point</span></div>
                    <div class="point-item"><span class="point-action">Min. Withdrawal (500 Points)</span><span class="point-value">50</span></div>
                    <div class="point-item"><span class="point-action">1000 Points</span><span class="point-value">100</span></div>
                    <hr style="border-color: rgba(255,255,255,0.1); margin: 10px 0;">
                    <div class="point-item"><span class="point-action">Daily Login Bonus</span><span class="point-value">+20 Credits</span></div>
                    <div class="point-item"><span class="point-action">Download a Book</span><span class="point-value">-30 Credits</span></div>
                     <div class="point-item"><span class="point-action">Complete Credit Boost</span><span class="point-value">+50 Credits</span></div> <!-- Added for clarity -->
                    <p style="font-size: 0.8rem; color: var(--text-muted); text-align: center; margin-top: 20px;">
                        <b>Points</b> are for cash withdrawal. <b>Credits</b> are for downloading books.
                    </p>
                 </div>
            </div>

            <div class="profile-actions-footer" data-aos="fade-up" data-aos-delay="400">
                <button class="profile-action-btn edit-profile" id="editProfileBtn">
                    <span class="spinner" style="display: none;"></span>
                    <span><i class="fas fa-user-edit"></i> Edit Profile</span>
                </button>
                <button class="profile-action-btn logout-btn" id="logoutBtn">
                     <span class="spinner" style="display: none;"></span>
                     <span><i class="fas fa-sign-out-alt"></i> Logout</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Full Page Notifications -->
    <div class="notifications-page" id="notificationsPage">
        <div class="notifications-header">
            <button class="page-back-btn" id="notificationsBackBtn" aria-label="Go Back">
                <i class="fas fa-arrow-left"></i>
            </button>
            <!-- <div class="notifications-title">Notifications</div> -->
            <div class="notifications-actions">
                <button class="mark-all-read-btn" id="markAllNotificationsReadBtn" disabled>
                    <i class="fas fa-check-double"></i> Mark All Read
                </button>
            </div>
        </div>
        <div class="notifications-tabs">
            <button class="notification-tab-btn active" data-tab="personal">Personal</button>
            <button class="notification-tab-btn" data-tab="announcements">Announcements</button>
        </div>
        <div class="notifications-content-area">
            <div class="notifications-list-container active" id="personalNotificationsListContainer">
                <div class="empty-state" id="emptyPersonalNotificationsState" style="display: none;">
                    <i class="fas fa-bell-slash"></i>
                    <h3>No Personal Notifications</h3>
                    <p>Important updates and alerts related to your activity will appear here.</p>
                </div>
                <!-- Personal notifications will be loaded here -->
            </div>
            <div class="notifications-list-container" id="adminAnnouncementsListContainer">
                <div class="empty-state" id="emptyAdminAnnouncementsState" style="display: none;">
                    <i class="fas fa-bullhorn"></i>
                    <h3>No Announcements Yet</h3>
                    <p>Check back later for updates from the EduSparK team.</p>
                </div>
                <!-- Admin announcements will be loaded here -->
            </div>
        </div>
    </div>


    <!-- Modals -->
    <div class="modal" id="addBookModal">
        <div class="modal-content">
            <button class="close-modal" id="closeAddBookModal" aria-label="Close">&times;</button>
            <h2 class="modal-title">Share a New Book</h2>
            <form id="addBookForm">
                <div class="form-group">
                    <label for="bookName" class="form-label">Book Title *</label>
                    <input type="text" id="bookName" class="form-input" placeholder="e.g., Introduction to Algorithms" required>
                </div>
                <div class="form-group">
                    <label for="authorName" class="form-label">Author(s) *</label>
                    <input type="text" id="authorName" class="form-input" placeholder="e.g., Thomas H. Cormen" required>
                </div>
                <div class="form-group">
                    <label for="bookCategory" class="form-label">Category *</label>
                    <input type="text" id="bookCategory" class="form-input" placeholder="e.g., Computer Science, 12th, NEET" required>
                     <small style="color: var(--text-muted); font-size: 0.75rem; margin-top: 5px; display: block;">
                         Use relevant keywords like 'JEE', '10th', 'Fiction', etc.
                     </small>
                </div>
                <div class="form-group">
                    <label for="bookImageUrl" class="form-label">Cover Image URL *</label>
                    <input type="url" id="bookImageUrl" class="form-input" placeholder="Paste direct image link" required>
                </div>
                <div class="form-group">
                    <label for="driveLink" class="form-label">Google Drive Link *</label>
                    <input type="url" id="driveLink" class="form-input" placeholder="Ensure link sharing is 'Anyone with the link'" required>
                     <small style="color: var(--text-muted); font-size: 0.75rem; margin-top: 5px; display: block;">
                         Right-click file in Drive > Share > Set 'Anyone with the link' > Copy link.
                     </small>
                </div>
                <div class="form-group">
                    <label for="bookDescription" class="form-label">Description (Optional)</label>
                    <textarea id="bookDescription" class="form-textarea" placeholder="Briefly describe the book..." rows="3"></textarea>
                </div>
                <button type="submit" class="submit-btn" id="submitBookBtn">
                    <span class="spinner" style="display: none;"></span>
                    <span>Submit for Approval</span>
                </button>
                 <button type="button" class="tutorial-btn" onclick="window.open('https://t.me/official_learnhub/140', '_blank')">
                     <span><i class="fas fa-question-circle"></i> How to Get Drive Link?</span>
                 </button>
            </form>
        </div>
    </div>

    <div class="modal" id="loginModal">
        <div class="modal-content">
            <button class="close-modal" id="closeLoginModal" aria-label="Close">&times;</button>
            <h2 class="modal-title">Welcome Back!</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label for="loginEmail" class="form-label">Email</label>
                    <input type="email" id="loginEmail" class="form-input" placeholder="your.email@example.com" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword" class="form-label">Password</label>
                    <input type="password" id="loginPassword" class="form-input" placeholder="" required>
                </div>
                <button type="submit" class="submit-btn" id="loginBtn">
                    <span class="spinner" style="display: none;"></span>
                    <span>Login</span>
                </button>
            </form>
            <div class="auth-switch">
                Don't have an account? <a id="switchToSignup">Sign up here</a>
            </div>
        </div>
    </div>

    <div class="modal" id="signupModal">
        <div class="modal-content">
            <button class="close-modal" id="closeSignupModal" aria-label="Close">&times;</button>
            <h2 class="modal-title">Join EduSparK</h2>
            <form id="signupForm">
                 <div class="form-group">
                    <label for="signupName" class="form-label">Full Name</label>
                    <input type="text" id="signupName" class="form-input" placeholder="e.g., Ada Lovelace" required>
                </div>
                <div class="form-group">
                    <label for="signupUsername" class="form-label">Username</label>
                    <input type="text" id="signupUsername" class="form-input" placeholder="Choose a unique username" required>
                     <small style="color: var(--text-muted); font-size: 0.75rem; margin-top: 5px; display: block;">
                         3-15 chars, lowercase, numbers, _, .
                     </small>
                </div>
                <div class="form-group">
                    <label for="signupEmail" class="form-label">Email</label>
                    <input type="email" id="signupEmail" class="form-input" placeholder="your.email@example.com" required>
                </div>
                <div class="form-group">
                    <label for="signupPassword" class="form-label">Password</label>
                    <input type="password" id="signupPassword" class="form-input" placeholder="Choose a strong password" required>
                </div>
                <div class="form-group">
                    <label for="signupBio" class="form-label">Bio (Optional)</label>
                    <textarea id="signupBio" class="form-textarea" placeholder="Share something about yourself..." rows="2"></textarea>
                </div>
                <button type="submit" class="submit-btn" id="signupBtn">
                    <span class="spinner" style="display: none;"></span>
                    <span>Create Account</span>
                </button>
            </form>
            <div class="auth-switch">
                Already have an account? <a id="switchToLogin">Login here</a>
            </div>
        </div>
    </div>

    <div class="modal" id="editProfileModal">
        <div class="modal-content">
            <button class="close-modal" id="closeEditProfileModal" aria-label="Close">&times;</button>
            <h2 class="modal-title">Edit Your Profile</h2>
            <form id="editProfileForm">
                <div class="form-group">
                    <label for="editProfileName" class="form-label">Full Name</label>
                    <input type="text" id="editProfileName" class="form-input" placeholder="Enter your full name" required>
                </div>
                <div class="form-group">
                    <label for="editProfileUsername" class="form-label">Username</label>
                    <input type="text" id="editProfileUsername" class="form-input" placeholder="Choose a username" required>
                     <small style="color: var(--text-muted); font-size: 0.75rem; margin-top: 5px; display: block;">
                         3-15 chars, lowercase, numbers, _, .
                     </small>
                </div>
                <div class="form-group">
                    <label for="editProfileBio" class="form-label">Bio</label>
                    <textarea id="editProfileBio" class="form-textarea" placeholder="Tell the community about yourself" rows="3"></textarea>
                </div>
                <button type="submit" class="submit-btn" id="saveProfileBtn">
                    <span class="spinner" style="display: none;"></span>
                    <span>Save Changes</span>
                </button>
            </form>
        </div>
    </div>

    <div class="modal" id="discoverModal">
        <div class="modal-content">
            <button class="close-modal" id="closeDiscoverModal" aria-label="Close">&times;</button>
            <h2 class="modal-title">Discover More</h2>
            <div class="discover-list" id="discoverList">
                <!-- Static Example Items - Replace with dynamic content if needed -->
                 <div class="discover-item" onclick="showToast('Feature coming soon!', 'info')">
                    <div class="discover-icon"><i class="fas fa-trophy"></i></div>
                    <div class="discover-content">
                        <div class="discover-title">Top Contributors</div>
                        <div class="discover-description">See who's sharing the most knowledge! (Coming Soon)</div>
                    </div>
                </div>
                 <div class="discover-item" onclick="window.open('https://t.me/official_learnhub', '_blank')">
                    <div class="discover-icon"><i class="fab fa-telegram-plane"></i></div>
                    <div class="discover-content">
                        <div class="discover-title">Join Telegram</div>
                        <div class="discover-description">Connect with the community on Telegram for updates & discussions.</div>
                    </div>
                </div>
                 <div class="discover-item" onclick="showToast('Feature coming soon!', 'info')">
                    <div class="discover-icon"><i class="fas fa-tags"></i></div>
                    <div class="discover-content">
                        <div class="discover-title">Browse by Tags</div>
                        <div class="discover-description">Find books related to specific topics or tags. (Coming Soon)</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="withdrawalModal">
        <div class="modal-content">
            <button class="close-modal" id="closeWithdrawalModal" aria-label="Close">&times;</button>
            <h2 class="modal-title">Withdraw Points</h2>
            <p style="text-align: center; color: var(--text-muted); margin-top: -15px; margin-bottom: 20px;">
                Your current balance: <strong id="withdrawalModalPoints" style="color: var(--primary-color);">0</strong> points
            </p>
            <form id="withdrawalForm">
                <div class="form-group">
                    <label class="form-label">1. Select Withdrawal Method:</label>
                    <div class="withdrawal-options">
                        <!-- Populated by JS -->
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">2. Select Amount:</label>
                    <div class="amount-selection">
                         <!-- Populated by JS -->
                    </div>
                </div>
                <div class="payment-details" id="paymentDetails">
                     <div class="form-group">
                        <label for="paymentId" class="form-label" id="paymentMethodLabel">Identifier *</label>
                        <input type="text" id="paymentId" class="form-input" placeholder="Enter details" required>
                    </div>
                     <div class="form-group" id="accountNameGroup" style="display: block;">
                        <label for="accountName" class="form-label">Account Holder Name *</label>
                        <input type="text" id="accountName" class="form-input" placeholder="Name as per account" required>
                    </div>
                    <button type="submit" class="submit-btn" id="submitWithdrawalBtn">
                         <span class="spinner" style="display: none;"></span>
                         <span>Submit Request</span>
                     </button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal" id="creditModal">
        <div class="modal-content">
            <button class="close-modal" id="closeCreditModal" aria-label="Close">&times;</button>
            <h2 class="modal-title">Earn Credits</h2>
            <p style="text-align: center; color: var(--text-muted); margin-top: -15px; margin-bottom: 25px;">
                Your current balance: <strong id="creditModalUserCredits">0</strong> <i class="fas fa-coins" style="color: var(--credit-color);"></i>
            </p>
            <div class="credit-options-list">
                
                <button class="tutorial-btn" id="conductSurveyBtn" style="margin-top:15px;">
                     <span class="spinner" style="display: none;"></span>
                     <span><i class="fas fa-poll"></i></span>
                     
                Earn Credit  
                <span><i class="fas fa-poll"></i></span></button>
                 <p style="font-size: 0.8rem; color: var(--text-muted); text-align: center; margin-top: 20px;">
                    Tip: Use credits to download books (30 <i class="fas fa-coins" style="color:var(--credit-color);font-size:0.8em;"></i> per book). Share books to earn points for withdrawal!
                    <br><br>
                    Earn Credit By Attempting Simple Maths Quiz  (Earn 50 <i class="fas fa-coins" style="color:var(--credit-color);font-size:0.8em;"></i> By attempting Quiz Each Time  )
                 </p>
            </div>
        </div>
    </div>

     <!-- Book Detail Modal -->
    <div class="modal" id="bookDetailModal">
        <div class="modal-content">
            <button class="close-modal" id="closeBookDetailModal" aria-label="Close">&times;</button>
            <div id="bookDetailContent">
                <!-- Loading state -->
                <div style="text-align:center; padding: 50px 0;">
                    <div class="spinner" style="width: 30px; height: 30px; border-width: 4px;"></div>
                    <p style="margin-top: 15px; color: var(--text-muted);">Loading details...</p>
                </div>
            </div>
        </div>
    </div>


    <div id="toastContainer"></div>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        const _0x3098b8=_0x5ab5;(function(_0x195904,_0x50ae6c){const _0x2a280d=_0x5ab5,_0xe45972=_0x195904();while(!![]){try{const _0x3f9005=-parseInt(_0x2a280d(0x2ae))/0x1*(parseInt(_0x2a280d(0x422))/0x2)+-parseInt(_0x2a280d(0x1b6))/0x3*(parseInt(_0x2a280d(0x1b7))/0x4)+-parseInt(_0x2a280d(0x2b7))/0x5+-parseInt(_0x2a280d(0x1e8))/0x6*(-parseInt(_0x2a280d(0x253))/0x7)+parseInt(_0x2a280d(0x1ae))/0x8+parseInt(_0x2a280d(0x1cc))/0x9*(-parseInt(_0x2a280d(0x1da))/0xa)+-parseInt(_0x2a280d(0x2a7))/0xb*(-parseInt(_0x2a280d(0x316))/0xc);if(_0x3f9005===_0x50ae6c)break;else _0xe45972['push'](_0xe45972['shift']());}catch(_0x502597){_0xe45972['push'](_0xe45972['shift']());}}}(_0x55e0,0x43aec));function hi(){const _0x6e6b2c=_0x5ab5;console[_0x6e6b2c(0x350)](_0x6e6b2c(0x2e8));}hi(),AOS[_0x3098b8(0x1f7)]({'duration':0x258,'easing':_0x3098b8(0x20e),'once':!![],'offset':0x32});const firebaseConfig={'apiKey':_0x3098b8(0x16b),'authDomain':_0x3098b8(0x281),'projectId':'eduspark-new','storageBucket':_0x3098b8(0x3f1),'messagingSenderId':_0x3098b8(0x41f),'appId':_0x3098b8(0x374),'measurementId':_0x3098b8(0x33b)};firebase[_0x3098b8(0x41c)](firebaseConfig);const auth=firebase[_0x3098b8(0x2bf)](),db=firebase[_0x3098b8(0x20a)](),storage=firebase['storage'](),appCheck=firebase['appCheck']();try{appCheck['activate']('',!![]),console[_0x3098b8(0x350)]('Firebase\x20App\x20Check\x20activated.');}catch(_0x41af57){console['error'](_0x3098b8(0x30b),_0x41af57);}const $=_0x3403e6=>document[_0x3098b8(0x317)](_0x3403e6),$$=_0x59a55c=>document[_0x3098b8(0x1e4)](_0x59a55c),elements={'loadingOverlay':$('#loadingOverlay'),'loadingMessage':$(_0x3098b8(0x2c6)),'body':document[_0x3098b8(0x191)],'header':$(_0x3098b8(0x3ac)),'logoLink':$(_0x3098b8(0x3de)),'userAvatar':$(_0x3098b8(0x22b)),'avatarInitials':$(_0x3098b8(0x3e8)),'searchContainer':$(_0x3098b8(0x319)),'searchInput':$(_0x3098b8(0x1db)),'searchResults':$(_0x3098b8(0x410)),'searchToggleBtn':$(_0x3098b8(0x1f5)),'addBookBtn':$('#addBookBtn'),'booksContainer':$(_0x3098b8(0x351)),'booksGridLoadingIndicator':$(_0x3098b8(0x1de)),'emptyStateBooks':$('#emptyStateBooks'),'categoryFilterContainer':$(_0x3098b8(0x3eb)),'bottomNavItems':$$(_0x3098b8(0x3a0)),'popularBooksCarousel':$('#popularBooksCarousel'),'headerCreditsContainer':$(_0x3098b8(0x362)),'headerCreditsAmount':$(_0x3098b8(0x168)),'addBookModal':$('#addBookModal'),'closeAddBookModal':$(_0x3098b8(0x405)),'addBookForm':$(_0x3098b8(0x24f)),'loginModal':$(_0x3098b8(0x165)),'signupModal':$(_0x3098b8(0x225)),'closeLoginModal':$(_0x3098b8(0x2a1)),'closeSignupModal':$(_0x3098b8(0x421)),'loginForm':$(_0x3098b8(0x182)),'signupForm':$('#signupForm'),'switchToSignup':$(_0x3098b8(0x185)),'switchToLogin':$(_0x3098b8(0x3e7)),'editProfileModal':$(_0x3098b8(0x2da)),'closeEditProfileModal':$(_0x3098b8(0x25f)),'editProfileForm':$(_0x3098b8(0x264)),'discoverModal':$('#discoverModal'),'closeDiscoverModal':$(_0x3098b8(0x39c)),'withdrawalModal':$(_0x3098b8(0x2e0)),'closeWithdrawalModal':$(_0x3098b8(0x31e)),'withdrawalForm':$(_0x3098b8(0x326)),'creditModal':$(_0x3098b8(0x3f2)),'closeCreditModal':$('#closeCreditModal'),'creditModalUserCredits':$('#creditModalUserCredits'),'claimDailyCreditBtn':$('#claimDailyCreditBtn'),'conductSurveyBtn':$(_0x3098b8(0x3c5)),'profileBtn':$(_0x3098b8(0x21c)),'profilePage':$(_0x3098b8(0x206)),'profileBackBtn':$(_0x3098b8(0x1ab)),'profileAvatarLarge':$(_0x3098b8(0x24d)),'profileAvatarInitialsLarge':$(_0x3098b8(0x3e6)),'profileNameLarge':$(_0x3098b8(0x262)),'profileUsernameLarge':$(_0x3098b8(0x200)),'profileEmailLarge':$(_0x3098b8(0x3f4)),'profileJoinedLarge':$('#profileJoinedLarge'),'profileBioLarge':$(_0x3098b8(0x3b4)),'userPointsLarge':$(_0x3098b8(0x1a7)),'withdrawBtnLarge':$(_0x3098b8(0x19e)),'booksSharedLarge':$('#booksSharedLarge'),'booksDownloadedLarge':$(_0x3098b8(0x2dc)),'totalBookDownloadsLarge':$(_0x3098b8(0x3cf)),'totalFeedbackLarge':$(_0x3098b8(0x164)),'profileTabs':$('.profile-tabs'),'profileTabBtns':$$(_0x3098b8(0x2cb)),'profileTabContents':$$(_0x3098b8(0x3c8)),'profileBooksContainer':$(_0x3098b8(0x384)),'emptyProfileBooks':$(_0x3098b8(0x1f4)),'loadMoreBooksBtn':$('#loadMoreBooksBtn'),'loadMoreContainer':$('#loadMoreContainer'),'withdrawalHistoryContainer':$(_0x3098b8(0x322)),'emptyWithdrawalHistory':$(_0x3098b8(0x31d)),'editProfileBtn':$(_0x3098b8(0x234)),'logoutBtn':$(_0x3098b8(0x388)),'withdrawalOptionsContainer':$(_0x3098b8(0x1ec)),'amountOptionsContainer':$(_0x3098b8(0x1fd)),'paymentDetails':$(_0x3098b8(0x34d)),'paymentMethodLabel':$('#paymentMethodLabel'),'paymentIdInput':$(_0x3098b8(0x190)),'accountNameInput':$(_0x3098b8(0x346)),'accountNameGroup':$('#accountNameGroup'),'submitWithdrawalBtn':$(_0x3098b8(0x1e6)),'withdrawalModalPoints':$(_0x3098b8(0x2d5)),'homeBtn':$('#homeBtn'),'discoverBtn':$(_0x3098b8(0x37f)),'notificationsBtn':$('#notificationsBtn'),'notificationsPage':$(_0x3098b8(0x2fa)),'notificationsBackBtn':$(_0x3098b8(0x328)),'personalNotificationsListContainer':$(_0x3098b8(0x222)),'adminAnnouncementsListContainer':$(_0x3098b8(0x2b0)),'notificationTabsContainer':$(_0x3098b8(0x2d0)),'notificationTabBtns':$$(_0x3098b8(0x406)),'emptyPersonalNotificationsState':$(_0x3098b8(0x1c3)),'emptyAdminAnnouncementsState':$(_0x3098b8(0x2ce)),'unreadNotificationsBadge':$(_0x3098b8(0x243)),'markAllNotificationsReadBtn':$(_0x3098b8(0x239)),'bookDetailModal':$(_0x3098b8(0x1c1)),'closeBookDetailModal':$('#closeBookDetailModal'),'bookDetailContent':$(_0x3098b8(0x3ee)),'toastContainer':$('#toastContainer')};let currentUser=null,userData=null,allBooksCache=[],displayedBooksMain=[],popularBooksData=[],currentCategory='All',lastUserBookSnapshot=null,hasMoreUserBooks=!![],selectedWithdrawalMethod=null,selectedWithdrawalAmount=null,selectedWithdrawalRs=null,isFetchingMoreUserBooks=![],currentBookDetailId=null,unreadNotificationsCount=0x0,lastVisibleBookMain=null,isLoadingBooksMain=![],hasMoreBooksMain=!![],listeners={'user':null,'withdrawals':null,'popularBooks':null,'userBooks':null,'bookApproval':null,'userNotifications':null,'adminAnnouncements':null};const BOOK_DOWNLOAD_COST=0x1e,BOOKS_PER_PAGE_MAIN=0xc,bookCategories=[_0x3098b8(0x31c),_0x3098b8(0x203),_0x3098b8(0x2d7),_0x3098b8(0x297),_0x3098b8(0x3ec),_0x3098b8(0x428),_0x3098b8(0x382),_0x3098b8(0x242),_0x3098b8(0x1df),_0x3098b8(0x387),_0x3098b8(0x37b),_0x3098b8(0x312),_0x3098b8(0x248)],loadingMessages=[_0x3098b8(0x271),_0x3098b8(0x373),_0x3098b8(0x189),_0x3098b8(0x25a),_0x3098b8(0x38c),'Preparing\x20Your\x20Journey...'];function escapeHTML(_0x1ee92d){const _0x54fca5=_0x3098b8;if(_0x1ee92d===null||_0x1ee92d===undefined)return'';return String(_0x1ee92d)[_0x54fca5(0x3fe)](/[&<>"']/g,function(_0x22fa5f){const _0x236cac=_0x54fca5;return{'&':'&amp;','<':'&lt;','>':_0x236cac(0x298),'\x22':'&quot;','\x27':_0x236cac(0x3f9)}[_0x22fa5f];});}function showToast(_0x5ecb08,_0x5f22c5=_0x3098b8(0x22c),_0x154727=0xdac){const _0x4ba9c7=_0x3098b8;if(!elements['toastContainer']){console[_0x4ba9c7(0x219)]('Toast\x20container\x20not\x20found.\x20Toast\x20not\x20shown:',_0x5ecb08);return;}const _0x2476e0='toast-'+Date[_0x4ba9c7(0x193)](),_0x126ad3=document[_0x4ba9c7(0x301)]('div');_0x126ad3[_0x4ba9c7(0x1f6)]=_0x4ba9c7(0x32f)+_0x5f22c5,_0x126ad3['id']=_0x2476e0;let _0x12abfe=_0x4ba9c7(0x3b3);if(_0x5f22c5===_0x4ba9c7(0x427))_0x12abfe=_0x4ba9c7(0x29e);else{if(_0x5f22c5===_0x4ba9c7(0x1d9))_0x12abfe=_0x4ba9c7(0x403);else{if(_0x5f22c5==='warning')_0x12abfe=_0x4ba9c7(0x1d5);}}_0x126ad3[_0x4ba9c7(0x1e1)]=_0x4ba9c7(0x2eb)+_0x12abfe+'\x22></i><span>'+escapeHTML(_0x5ecb08)+_0x4ba9c7(0x416),elements[_0x4ba9c7(0x23d)][_0x4ba9c7(0x2d8)](_0x126ad3),requestAnimationFrame(()=>_0x126ad3[_0x4ba9c7(0x425)][_0x4ba9c7(0x2fd)](_0x4ba9c7(0x3df)));const _0x1a3ac2=_0x126ad3[_0x4ba9c7(0x317)]('.toast-close');_0x1a3ac2['onclick']=()=>{const _0x46778d=_0x4ba9c7;_0x126ad3[_0x46778d(0x425)]['remove'](_0x46778d(0x3df)),setTimeout(()=>{const _0x38ac4d=_0x46778d;if(_0x126ad3[_0x38ac4d(0x34e)])_0x126ad3[_0x38ac4d(0x2a5)]();},0x1f4);},setTimeout(()=>{const _0x5b7ed0=_0x4ba9c7;document['getElementById'](_0x2476e0)&&(_0x126ad3[_0x5b7ed0(0x425)]['remove'](_0x5b7ed0(0x3df)),setTimeout(()=>{const _0x53a4c8=_0x5b7ed0;if(_0x126ad3[_0x53a4c8(0x34e)])_0x126ad3[_0x53a4c8(0x2a5)]();},0x1f4));},_0x154727);}function openModal(_0x4e9838){const _0x39fa52=_0x3098b8;if(!_0x4e9838)return;_0x4e9838['classList'][_0x39fa52(0x2fd)](_0x39fa52(0x37e)),elements[_0x39fa52(0x191)]['style'][_0x39fa52(0x19a)]=_0x39fa52(0x36b),AOS['refresh']();}function closeModal(_0x685ae){const _0x38a361=_0x3098b8;if(!_0x685ae)return;_0x685ae[_0x38a361(0x425)][_0x38a361(0x2a5)](_0x38a361(0x37e));const _0x175b4e=$$(_0x38a361(0x3ae))[_0x38a361(0x3c7)]>0x0,_0xbe3a99=$$('.profile-page.active,\x20.notifications-page.active')[_0x38a361(0x3c7)]>0x0;!_0x175b4e&&!_0xbe3a99&&(elements['body']['style']['overflow']='auto');}function getInitials(_0x4e0300){const _0x440305=_0x3098b8;if(!_0x4e0300||typeof _0x4e0300!==_0x440305(0x292))return'U';const _0x356110=_0x4e0300[_0x440305(0x161)]()[_0x440305(0x1b2)]('\x20')[_0x440305(0x2a8)](_0xe8c2ac=>_0xe8c2ac[_0x440305(0x3c7)]>0x0);if(_0x356110[_0x440305(0x3c7)]===0x0)return'U';if(_0x356110['length']===0x1)return _0x356110[0x0][_0x440305(0x250)](0x0)[_0x440305(0x3aa)]();return(_0x356110[0x0][_0x440305(0x250)](0x0)+_0x356110[_0x356110[_0x440305(0x3c7)]-0x1][_0x440305(0x250)](0x0))['toUpperCase']();}function formatDate(_0x29d816,_0xa6b1ee={'year':_0x3098b8(0x2cd),'month':'short','day':_0x3098b8(0x2cd)}){const _0x2432bb=_0x3098b8;if(!_0x29d816)return'N/A';const _0x7d3a2c=_0x29d816[_0x2432bb(0x40f)]?_0x29d816[_0x2432bb(0x40f)]():new Date(_0x29d816);try{return _0x7d3a2c[_0x2432bb(0x1cb)](undefined,_0xa6b1ee);}catch(_0x92250d){return console['warn']('Error\x20formatting\x20date:',_0x29d816,_0x92250d),_0x2432bb(0x231);}}function formatTime(_0x3e9c29){const _0xcc7b11=_0x3098b8;if(!_0x3e9c29)return'';const _0x1c392a=_0x3e9c29['toDate']?_0x3e9c29[_0xcc7b11(0x40f)]():new Date(_0x3e9c29);try{return _0x1c392a[_0xcc7b11(0x39a)](undefined,{'hour':'numeric','minute':_0xcc7b11(0x245),'hour12':!![]});}catch(_0x35adb4){return console['warn'](_0xcc7b11(0x3ce),_0x3e9c29,_0x35adb4),_0xcc7b11(0x2c8);}}function toggleSpinner(_0x4523e5,_0x383b55){const _0x4f7182=_0x3098b8;if(!_0x4523e5)return;const _0x430c3a=_0x4523e5[_0x4f7182(0x317)](_0x4f7182(0x163)),_0x42dea4=_0x4523e5['querySelector'](_0x4f7182(0x204));if(_0x383b55){_0x4523e5[_0x4f7182(0x425)]['add'](_0x4f7182(0x252)),_0x4523e5[_0x4f7182(0x31f)]=!![];if(_0x430c3a)_0x430c3a[_0x4f7182(0x41d)][_0x4f7182(0x40e)]='inline-block';if(_0x42dea4)_0x42dea4[_0x4f7182(0x41d)][_0x4f7182(0x2ab)]='0';}else{_0x4523e5[_0x4f7182(0x425)]['remove'](_0x4f7182(0x252)),_0x4523e5['disabled']=![];if(_0x430c3a)_0x430c3a[_0x4f7182(0x41d)][_0x4f7182(0x40e)]=_0x4f7182(0x1d8);if(_0x42dea4)_0x42dea4[_0x4f7182(0x41d)]['opacity']='1';}}function cleanupListeners(){const _0x2c3a4d=_0x3098b8;for(const _0x44f699 in listeners){if(listeners[_0x44f699]){try{listeners[_0x44f699]();}catch(_0x37c2ab){console[_0x2c3a4d(0x219)](_0x2c3a4d(0x180)+_0x44f699+':',_0x37c2ab);}listeners[_0x44f699]=null;}}}function formatRelativeDate(_0x41525b){const _0x2afde4=_0x3098b8;if(!_0x41525b)return'';const _0x416cd1=_0x41525b[_0x2afde4(0x40f)]?_0x41525b[_0x2afde4(0x40f)]():new Date(_0x41525b),_0x40d58b=new Date();_0x40d58b[_0x2afde4(0x23b)](0x0,0x0,0x0,0x0);const _0x4f4f4a=new Date(_0x40d58b);_0x4f4f4a[_0x2afde4(0x1a3)](_0x40d58b['getDate']()-0x1);const _0x1b6c88=new Date(_0x416cd1);_0x1b6c88['setHours'](0x0,0x0,0x0,0x0);if(_0x1b6c88[_0x2afde4(0x1f0)]()===_0x40d58b[_0x2afde4(0x1f0)]())return _0x2afde4(0x21d);if(_0x1b6c88[_0x2afde4(0x1f0)]()===_0x4f4f4a[_0x2afde4(0x1f0)]())return _0x2afde4(0x20c);return formatDate(_0x41525b,{'month':'long','day':_0x2afde4(0x2cd),'year':_0x2afde4(0x2cd)});}function hideLoadingOverlay(){const _0x1d5d88=_0x3098b8;elements[_0x1d5d88(0x221)]['classList']['add'](_0x1d5d88(0x36b));}function showRandomLoadingMessage(){const _0x1a7615=_0x3098b8,_0x16e04a=Math['floor'](Math[_0x1a7615(0x2c7)]()*loadingMessages[_0x1a7615(0x3c7)]);elements[_0x1a7615(0x192)][_0x1a7615(0x3c2)]=loadingMessages[_0x16e04a];}auth['onAuthStateChanged'](async _0x367fb5=>{const _0x1af0ec=_0x3098b8;cleanupListeners(),currentUser=_0x367fb5;if(_0x367fb5){elements['body']['classList'][_0x1af0ec(0x2fd)](_0x1af0ec(0x2bd)),elements[_0x1af0ec(0x191)][_0x1af0ec(0x425)][_0x1af0ec(0x2a5)](_0x1af0ec(0x375)),elements[_0x1af0ec(0x175)][_0x1af0ec(0x41d)][_0x1af0ec(0x40e)]=_0x1af0ec(0x1bc);const _0x5c93d7=db[_0x1af0ec(0x2be)](_0x1af0ec(0x3c4))[_0x1af0ec(0x3e3)](_0x367fb5[_0x1af0ec(0x3ba)]);listeners[_0x1af0ec(0x1ad)]=_0x5c93d7[_0x1af0ec(0x240)](async _0xc1750b=>{const _0x385739=_0x1af0ec;if(_0xc1750b[_0x385739(0x2e4)])userData={'id':_0xc1750b['id'],..._0xc1750b[_0x385739(0x306)]()},updateProfileUI(),updateAvatar(),updateHeaderCredits(),enableWithdrawalIfQualified(),setupBookApprovalListener(),setupUserNotificationsListener(),setupAdminAnnouncementsListener(),!elements[_0x385739(0x221)][_0x385739(0x425)][_0x385739(0x187)]('hidden')&&hideLoadingOverlay();else{const _0x22fab6=JSON[_0x385739(0x386)](sessionStorage[_0x385739(0x265)](_0x385739(0x1eb))||'{}');sessionStorage['removeItem'](_0x385739(0x1eb));try{console[_0x385739(0x350)](_0x385739(0x223)),await createUserDocument(_0x367fb5,_0x22fab6[_0x385739(0x28e)],_0x22fab6['username'],_0x22fab6['bio']);}catch(_0xd63397){console[_0x385739(0x1d9)]('Fatal\x20error\x20creating\x20user\x20document:',_0xd63397),showToast('Critical\x20error\x20setting\x20up\x20your\x20profile.\x20Please\x20contact\x20support.',_0x385739(0x1d9),0x2710),auth[_0x385739(0x329)]()[_0x385739(0x238)](_0x262fe6=>console['error']('Error\x20signing\x20out\x20after\x20profile\x20creation\x20failure',_0x262fe6)),!elements['loadingOverlay'][_0x385739(0x425)][_0x385739(0x187)](_0x385739(0x36b))&&hideLoadingOverlay();}}},_0x3f8681=>{const _0x300d42=_0x1af0ec;console['error'](_0x300d42(0x3fc),_0x3f8681),showToast(_0x300d42(0x1a1),_0x300d42(0x1d9)),userData=null,updateProfileUI(),updateAvatar(),updateHeaderCredits(),!elements[_0x300d42(0x221)][_0x300d42(0x425)][_0x300d42(0x187)](_0x300d42(0x36b))&&hideLoadingOverlay();});try{await _0x5c93d7[_0x1af0ec(0x1fa)]({'lastActive':firebase[_0x1af0ec(0x20a)][_0x1af0ec(0x210)][_0x1af0ec(0x2e1)]()});}catch(_0xb839f3){console[_0x1af0ec(0x219)](_0x1af0ec(0x2cc),_0xb839f3[_0x1af0ec(0x1ac)]);}initializeDataFetching();}else{userData=null,currentUser=null,elements['body'][_0x1af0ec(0x425)][_0x1af0ec(0x2a5)](_0x1af0ec(0x2bd)),elements['body'][_0x1af0ec(0x425)][_0x1af0ec(0x2fd)](_0x1af0ec(0x375)),elements['headerCreditsContainer'][_0x1af0ec(0x41d)][_0x1af0ec(0x40e)]=_0x1af0ec(0x1d8),updateProfileUI(),updateAvatar(),updateHeaderCredits(),updateUnreadBadge(0x0),showLoginPromptInsteadOfContent(),closeAllPagesAndModals(),resetNavigation(),[_0x1af0ec(0x3a7),_0x1af0ec(0x3a9),_0x1af0ec(0x3c9),_0x1af0ec(0x3d3),_0x1af0ec(0x303),_0x1af0ec(0x1c4)][_0x1af0ec(0x355)](_0x17c2f1=>{if(elements[_0x17c2f1])elements[_0x17c2f1]['innerHTML']='';});if(elements['categoryFilterContainer'])elements[_0x1af0ec(0x327)][_0x1af0ec(0x1e1)]='';allBooksCache=[],displayedBooksMain=[],popularBooksData=[],lastVisibleBookMain=null,hasMoreBooksMain=!![],isLoadingBooksMain=![],lastUserBookSnapshot=null,hasMoreUserBooks=!![],isFetchingMoreUserBooks=![],currentCategory=_0x1af0ec(0x31c),!elements['loadingOverlay']['classList'][_0x1af0ec(0x187)](_0x1af0ec(0x36b))&&hideLoadingOverlay();}});async function createUserDocument(_0x437f63,_0x1782ea,_0x4838e5,_0x301e87){const _0x12387d=_0x3098b8,_0xc38ec9=_0x1782ea||_0x437f63[_0x12387d(0x17e)]||_0x12387d(0x39e);let _0x39fdcf=_0x4838e5||_0x437f63[_0x12387d(0x33f)][_0x12387d(0x1b2)]('@')[0x0]['replace'](/[^a-z0-9_.]/gi,'')[_0x12387d(0x3cc)]()||'user'+Date[_0x12387d(0x193)]()['toString']()[_0x12387d(0x29f)](-0x5);try{const _0x5b06a5=await db['collection'](_0x12387d(0x3c4))['where'](_0x12387d(0x2f0),'==',_0x39fdcf)['get']();!_0x5b06a5[_0x12387d(0x37d)]&&(_0x39fdcf='user'+Date[_0x12387d(0x193)]()[_0x12387d(0x216)]()[_0x12387d(0x29f)](-0x5));}catch(_0x3954a8){console[_0x12387d(0x219)](_0x12387d(0x1fe),_0x3954a8);}const _0x1cfc3d=_0x301e87||_0x12387d(0x3c0),_0x48c5b2=db[_0x12387d(0x2be)](_0x12387d(0x3c4))['doc'](_0x437f63[_0x12387d(0x3ba)]),_0x4d3622={'uid':_0x437f63[_0x12387d(0x3ba)],'email':_0x437f63['email'],'name':_0xc38ec9,'username':_0x39fdcf,'bio':_0x1cfc3d,'points':0x0,'credits':0x32,'createdAt':firebase['firestore'][_0x12387d(0x210)][_0x12387d(0x2e1)](),'lastActive':firebase['firestore'][_0x12387d(0x210)][_0x12387d(0x2e1)](),'booksSharedCount':0x0,'booksDownloadedCount':0x0,'lastDailyCreditClaim':null,'totalBookDownloads':0x0,'totalFeedbackGiven':0x0,'processedBookActions':{},'lastCreditBoostClaim':null,'creditsEarnedViaBoosts':0x0};try{await _0x48c5b2[_0x12387d(0x254)](_0x4d3622),await createNotification(_0x437f63[_0x12387d(0x3ba)],_0x12387d(0x17b),_0x12387d(0x23e)+_0x4d3622[_0x12387d(0x1b4)]+_0x12387d(0x3da),_0x12387d(0x427),null,_0x12387d(0x255)),showToast(_0x12387d(0x38a),_0x12387d(0x427));}catch(_0x3aa9b){console[_0x12387d(0x1d9)](_0x12387d(0x201),_0x3aa9b),showToast('Major\x20error\x20setting\x20up\x20your\x20account.\x20Please\x20contact\x20support.',_0x12387d(0x1d9),0x2710);throw _0x3aa9b;}}function showLoginPromptInsteadOfContent(){const _0x3407c3=_0x3098b8;if(elements[_0x3407c3(0x1c4)]){elements[_0x3407c3(0x1c4)][_0x3407c3(0x1e1)]='',elements['emptyStateBooks'][_0x3407c3(0x1e1)]='<i\x20class=\x22fas\x20fa-sign-in-alt\x22></i><h3>Login\x20to\x20Discover\x20Books</h3><p>Join\x20EduSparK\x20to\x20share,\x20download,\x20and\x20engage!</p><button\x20class=\x22submit-btn\x22\x20style=\x22margin-top:20px;max-width:200px;\x22\x20id=\x22loginPromptBtnMain\x22>Login\x20/\x20Sign\x20Up</button>',elements[_0x3407c3(0x296)][_0x3407c3(0x41d)][_0x3407c3(0x40e)]=_0x3407c3(0x1bc);const _0xdb0ec9=$(_0x3407c3(0x3ed));if(_0xdb0ec9)_0xdb0ec9[_0x3407c3(0x32d)]=()=>openModal(elements[_0x3407c3(0x3cd)]);}elements[_0x3407c3(0x3a7)]&&(elements[_0x3407c3(0x3a7)]['innerHTML']='<div\x20class=\x22empty-state\x22\x20style=\x22padding:20px\x200;min-height:150px;width:100%;text-align:center;\x22><i\x20class=\x22fas\x20fa-lock\x22></i><p\x20style=\x22font-size:0.9rem;\x22>Login\x20to\x20see\x20popular\x20books.</p></div>');if(elements[_0x3407c3(0x400)])elements[_0x3407c3(0x400)]['style'][_0x3407c3(0x40e)]='flex';if(elements['emptyWithdrawalHistory'])elements[_0x3407c3(0x2c1)][_0x3407c3(0x41d)]['display']='flex';if(elements[_0x3407c3(0x365)])elements[_0x3407c3(0x365)][_0x3407c3(0x41d)][_0x3407c3(0x40e)]=_0x3407c3(0x1bc);if(elements['emptyAdminAnnouncementsState'])elements['emptyAdminAnnouncementsState'][_0x3407c3(0x41d)][_0x3407c3(0x40e)]='flex';renderCategoryFilters();}elements[_0x3098b8(0x3ea)]['addEventListener'](_0x3098b8(0x179),async _0x8b39c0=>{const _0x1309f1=_0x3098b8;_0x8b39c0[_0x1309f1(0x2a6)]();const _0x4900e5=$(_0x1309f1(0x305))['value'],_0x448c91=$(_0x1309f1(0x358))[_0x1309f1(0x40a)],_0x341621=$(_0x1309f1(0x349));toggleSpinner(_0x341621,!![]);try{await auth[_0x1309f1(0x2a0)](_0x4900e5,_0x448c91),closeModal(elements[_0x1309f1(0x3cd)]),showToast(_0x1309f1(0x39b),_0x1309f1(0x427));}catch(_0x4e1335){console[_0x1309f1(0x1d9)](_0x1309f1(0x419),_0x4e1335),showToast(_0x4e1335[_0x1309f1(0x1ac)],_0x1309f1(0x1d9));}finally{toggleSpinner(_0x341621,![]),elements['loginForm'][_0x1309f1(0x391)]();}}),elements[_0x3098b8(0x311)][_0x3098b8(0x261)](_0x3098b8(0x179),async _0x6b2761=>{const _0x5da86b=_0x3098b8;_0x6b2761[_0x5da86b(0x2a6)]();const _0x22c575=$(_0x5da86b(0x167))[_0x5da86b(0x40a)],_0x156411=$(_0x5da86b(0x30c))[_0x5da86b(0x40a)][_0x5da86b(0x161)]()[_0x5da86b(0x3cc)](),_0x1a972a=$('#signupEmail')[_0x5da86b(0x40a)],_0x286fc2=$(_0x5da86b(0x2f2))[_0x5da86b(0x40a)],_0x2d5b42=$(_0x5da86b(0x233))[_0x5da86b(0x40a)];if(!/^[a-z0-9_.]{3,15}$/[_0x5da86b(0x27c)](_0x156411)){showToast(_0x5da86b(0x318),_0x5da86b(0x1d9),0x1388);return;}if(_0x286fc2[_0x5da86b(0x3c7)]<0x6){showToast(_0x5da86b(0x1af),_0x5da86b(0x1d9));return;}const _0x415246=$('#signupBtn');toggleSpinner(_0x415246,!![]);try{const _0x86dbc2=await db['collection'](_0x5da86b(0x3c4))['where'](_0x5da86b(0x2f0),'==',_0x156411)[_0x5da86b(0x2ef)]();if(!_0x86dbc2['empty']){showToast(_0x5da86b(0x404),_0x5da86b(0x1d9)),toggleSpinner(_0x415246,![]);return;}const _0x3d53ac=await auth[_0x5da86b(0x33c)](_0x1a972a);if(_0x3d53ac['length']>0x0){showToast(_0x5da86b(0x24a),_0x5da86b(0x1d9)),toggleSpinner(_0x415246,![]);return;}sessionStorage[_0x5da86b(0x3e2)](_0x5da86b(0x1eb),JSON[_0x5da86b(0x18b)]({'name':_0x22c575,'username':_0x156411,'bio':_0x2d5b42})),await auth[_0x5da86b(0x377)](_0x1a972a,_0x286fc2);}catch(_0x126e27){console[_0x5da86b(0x1d9)]('Signup\x20error:',_0x126e27),showToast(_0x126e27['message'],_0x5da86b(0x1d9)),sessionStorage['removeItem'](_0x5da86b(0x1eb));}finally{toggleSpinner(_0x415246,![]);}}),elements[_0x3098b8(0x417)][_0x3098b8(0x261)](_0x3098b8(0x1ce),async()=>{const _0x399c63=_0x3098b8;toggleSpinner(elements['logoutBtn'],!![]);try{await auth[_0x399c63(0x329)](),showToast(_0x399c63(0x2cf),'info');}catch(_0x1a9e12){console[_0x399c63(0x1d9)](_0x399c63(0x1bd),_0x1a9e12),showToast('Error\x20logging\x20out.\x20Please\x20try\x20again.',_0x399c63(0x1d9));}finally{toggleSpinner(elements[_0x399c63(0x417)],![]);}});function updateProfileUI(){const _0x526298=_0x3098b8;userData?(elements[_0x526298(0x3bc)][_0x526298(0x3c2)]=getInitials(userData[_0x526298(0x28e)]),elements['profileNameLarge'][_0x526298(0x3c2)]=escapeHTML(userData[_0x526298(0x28e)]||'User'),elements[_0x526298(0x2e7)][_0x526298(0x3c2)]='@'+escapeHTML(userData[_0x526298(0x2f0)]||_0x526298(0x2f0)),elements['profileEmailLarge'][_0x526298(0x1e1)]=_0x526298(0x37c)+escapeHTML(userData[_0x526298(0x33f)]||_0x526298(0x368)),elements['profileJoinedLarge']['innerHTML']=_0x526298(0x23a)+(userData['createdAt']?formatDate(userData['createdAt']):'-'),elements['profileBioLarge'][_0x526298(0x3c2)]=escapeHTML(userData['bio']||_0x526298(0x3c1)),elements[_0x526298(0x176)][_0x526298(0x3c2)]=userData[_0x526298(0x19c)]||0x0,elements[_0x526298(0x30f)][_0x526298(0x3c2)]=userData['booksSharedCount']||0x0,elements['booksDownloadedLarge'][_0x526298(0x3c2)]=userData[_0x526298(0x2b8)]||0x0,elements[_0x526298(0x300)]['textContent']=userData[_0x526298(0x409)]||0x0,elements['totalFeedbackLarge']['textContent']=userData[_0x526298(0x273)]||0x0):(elements[_0x526298(0x3bc)]['textContent']='U',elements[_0x526298(0x162)][_0x526298(0x3c2)]='User\x20Loading...',elements['profileUsernameLarge'][_0x526298(0x3c2)]=_0x526298(0x27b),elements[_0x526298(0x22e)][_0x526298(0x1e1)]=_0x526298(0x1a2),elements[_0x526298(0x3a6)][_0x526298(0x1e1)]=_0x526298(0x275),elements[_0x526298(0x247)][_0x526298(0x3c2)]=_0x526298(0x260),['userPointsLarge',_0x526298(0x30f),_0x526298(0x3d4),_0x526298(0x300),'totalFeedbackLarge']['forEach'](_0x390fda=>{const _0x3cc30b=_0x526298;if(elements[_0x390fda])elements[_0x390fda][_0x3cc30b(0x3c2)]='0';}),elements[_0x526298(0x400)]&&(elements[_0x526298(0x3a9)][_0x526298(0x1e1)]='',elements['emptyProfileBooks']['style'][_0x526298(0x40e)]=_0x526298(0x1bc)),elements[_0x526298(0x2c1)]&&(elements[_0x526298(0x3c9)][_0x526298(0x1e1)]='',elements[_0x526298(0x2c1)][_0x526298(0x41d)]['display']='flex'));}function updateAvatar(){const _0xfea050=_0x3098b8;elements[_0xfea050(0x379)][_0xfea050(0x3c2)]=userData&&userData[_0xfea050(0x28e)]?getInitials(userData[_0xfea050(0x28e)]):'U';}function updateHeaderCredits(){const _0x442445=_0x3098b8;elements[_0x442445(0x331)]['textContent']=userData?userData[_0x442445(0x1b4)]||0x0:'0';}elements[_0x3098b8(0x1ff)]['addEventListener'](_0x3098b8(0x1ce),()=>{const _0xd408cc=_0x3098b8;userData&&currentUser?($('#editProfileName')[_0xd408cc(0x40a)]=userData[_0xd408cc(0x28e)]||'',$(_0xd408cc(0x25b))['value']=userData[_0xd408cc(0x2f0)]||'',$(_0xd408cc(0x295))[_0xd408cc(0x40a)]=userData['bio']||'',openModal(elements[_0xd408cc(0x36d)])):(showToast(_0xd408cc(0x263),_0xd408cc(0x272)),openModal(elements['loginModal']));});if(elements[_0x3098b8(0x393)])elements[_0x3098b8(0x393)][_0x3098b8(0x32d)]=()=>closeModal(elements['editProfileModal']);elements[_0x3098b8(0x2bb)][_0x3098b8(0x261)]('submit',async _0x593d2d=>{const _0xd6060a=_0x3098b8;_0x593d2d[_0xd6060a(0x2a6)]();if(!currentUser||!userData){showToast(_0xd6060a(0x2d1),_0xd6060a(0x1d9));return;}const _0x1e20f4=$(_0xd6060a(0x2c3))['value'],_0x160b35=$(_0xd6060a(0x25b))[_0xd6060a(0x40a)][_0xd6060a(0x161)]()[_0xd6060a(0x3cc)](),_0x1d57b8=$('#editProfileBio')[_0xd6060a(0x40a)];if(!/^[a-z0-9_.]{3,15}$/[_0xd6060a(0x27c)](_0x160b35)){showToast(_0xd6060a(0x318),_0xd6060a(0x1d9),0x1388);return;}const _0x367cc1=$(_0xd6060a(0x3e5));toggleSpinner(_0x367cc1,!![]);try{if(_0x160b35!==userData[_0xd6060a(0x2f0)]){const _0x28ccf5=await db[_0xd6060a(0x2be)]('users')[_0xd6060a(0x395)](_0xd6060a(0x2f0),'==',_0x160b35)[_0xd6060a(0x2ef)]();if(!_0x28ccf5['empty']){showToast(_0xd6060a(0x404),_0xd6060a(0x1d9)),toggleSpinner(_0x367cc1,![]);return;}}await db[_0xd6060a(0x2be)](_0xd6060a(0x3c4))[_0xd6060a(0x3e3)](currentUser['uid'])[_0xd6060a(0x1fa)]({'name':_0x1e20f4,'username':_0x160b35,'bio':_0x1d57b8}),await createNotification(currentUser[_0xd6060a(0x3ba)],_0xd6060a(0x35f),_0xd6060a(0x397),'info',null,_0xd6060a(0x29b)),showToast('Profile\x20updated\x20successfully!','success'),closeModal(elements[_0xd6060a(0x36d)]);}catch(_0x3dfafc){console[_0xd6060a(0x1d9)](_0xd6060a(0x173),_0x3dfafc),showToast('Failed\x20to\x20update\x20profile:\x20'+_0x3dfafc['message'],_0xd6060a(0x1d9));}finally{toggleSpinner(_0x367cc1,![]);}});elements['profileTabs']&&elements[_0x3098b8(0x3d6)][_0x3098b8(0x261)](_0x3098b8(0x1ce),_0x187029=>{const _0x1abb11=_0x3098b8,_0x45dcc4=_0x187029[_0x1abb11(0x30a)][_0x1abb11(0x259)](_0x1abb11(0x2cb));if(!_0x45dcc4)return;elements[_0x1abb11(0x228)][_0x1abb11(0x355)](_0x21bb07=>_0x21bb07['classList'][_0x1abb11(0x2a5)](_0x1abb11(0x37e))),_0x45dcc4['classList'][_0x1abb11(0x2fd)](_0x1abb11(0x37e));const _0x321415=_0x45dcc4[_0x1abb11(0x360)][_0x1abb11(0x18c)];elements[_0x1abb11(0x2d3)][_0x1abb11(0x355)](_0x59f88e=>{const _0x25816b=_0x1abb11;_0x59f88e[_0x25816b(0x425)][_0x25816b(0x1b8)](_0x25816b(0x37e),_0x59f88e['id']===_0x25816b(0x3dc)+_0x321415);}),AOS[_0x1abb11(0x16a)]();});function initializeDataFetching(){if(!currentUser)return;fetchBooksMain(![]),fetchPopularBooks(),renderCategoryFilters(),fetchAllBooksForSearch();}function renderSkeletonLoaders(_0x23183b,_0x29e556,_0x148513=_0x3098b8(0x224)){const _0x4823ee=_0x3098b8;if(!_0x23183b)return;_0x23183b!==elements[_0x4823ee(0x269)]&&(_0x23183b['innerHTML']='');let _0x395195='';for(let _0x504f4c=0x0;_0x504f4c<_0x29e556;_0x504f4c++){if(_0x148513===_0x4823ee(0x224))_0x395195+=_0x4823ee(0x3ca);else{if(_0x148513===_0x4823ee(0x1a9))_0x395195+=_0x4823ee(0x33a);else{if(_0x148513==='history')_0x395195+='<div\x20class=\x22skeleton-history-item\x22></div>';else _0x148513===_0x4823ee(0x2ac)&&(_0x395195+=_0x4823ee(0x28a));}}}_0x23183b!==elements['booksGridLoadingIndicator']&&(_0x23183b[_0x4823ee(0x1e1)]=_0x395195);}function createBookCardHTML(_0x591486,_0x20168b=_0x3098b8(0x341)){const _0x134316=_0x3098b8,_0x1f5f47=_0x20168b==='profile',_0x5e3734=_0x134316(0x2bc),_0x209bea=_0x591486['imageUrl']||_0x5e3734;let _0xb9a022='';if(_0x1f5f47){if(_0x591486[_0x134316(0x2ee)]===_0x134316(0x15f))_0xb9a022=_0x134316(0x369);else{if(_0x591486[_0x134316(0x2ee)]===_0x134316(0x1d0))_0xb9a022=_0x134316(0x2b6);}}return'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-card\x22\x20data-id=\x22'+_0x591486['id']+_0x134316(0x40b)+Math[_0x134316(0x2c7)]()*0.2+_0x134316(0x25d)+_0x591486['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+escapeHTML(_0x209bea)+_0x134316(0x279)+escapeHTML(_0x591486[_0x134316(0x347)])+_0x134316(0x2e5)+_0x5e3734+_0x134316(0x1cd)+_0xb9a022+_0x134316(0x3d0)+escapeHTML(_0x591486[_0x134316(0x347)])+_0x134316(0x2b4)+escapeHTML(_0x591486['authorName'])+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-user\x22></i>\x20'+escapeHTML(_0x591486[_0x134316(0x1ef)]||_0x134316(0x29c))+_0x134316(0x19b)+formatDate(_0x591486[_0x134316(0x3d5)])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x1f5f47&&(_0x591486[_0x134316(0x2ee)]===_0x134316(0x353)||_0x591486[_0x134316(0x2ee)]===_0x134316(0x1d0))?_0x134316(0x370)+(_0x591486['status']===_0x134316(0x353)?_0x134316(0x2dd)+(_0x591486[_0x134316(0x1ba)]?_0x134316(0x1d4)+escapeHTML(_0x591486['reviewedBy']):'')+'\x20on\x20'+(_0x591486[_0x134316(0x17a)]?formatDate(_0x591486[_0x134316(0x17a)]):'-'):_0x134316(0x1e0)+(_0x591486[_0x134316(0x1ba)]?_0x134316(0x1d4)+escapeHTML(_0x591486['reviewedBy']):'')+_0x134316(0x32a)+(_0x591486[_0x134316(0x2d9)]?formatDate(_0x591486[_0x134316(0x2d9)]):'-'))+_0x134316(0x321):'')+_0x134316(0x244)+(_0x1f5f47&&_0x591486[_0x134316(0x2ee)]===_0x134316(0x1d0)&&_0x591486[_0x134316(0x307)]?'<div\x20class=\x22book-admin-info\x22\x20style=\x22color:var(--primary-dark);border-color:var(--primary-dark);\x22><i\x20class=\x22fas\x20fa-times-circle\x22></i>\x20Reason:\x20'+escapeHTML(_0x591486['rejectionReason'])+_0x134316(0x321):'')+_0x134316(0x1ca)+_0x591486['id']+_0x134316(0x2b3);}function createPopularBookCardHTML(_0xcbe8bb){const _0x3fd068=_0x3098b8,_0x17283c=_0x3fd068(0x367),_0x3e2335=_0xcbe8bb['imageUrl']||_0x17283c;return _0x3fd068(0x1c7)+_0xcbe8bb['id']+'\x22\x20data-aos=\x22fade-left\x22\x20style=\x22animation-delay:\x20'+Math[_0x3fd068(0x2c7)]()*0.3+_0x3fd068(0x3ab)+escapeHTML(_0x3e2335)+_0x3fd068(0x279)+escapeHTML(_0xcbe8bb[_0x3fd068(0x347)])+_0x3fd068(0x30d)+_0x17283c+'\x27;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popular-book-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4\x20class=\x22popular-book-title\x22>'+escapeHTML(_0xcbe8bb['bookName'])+'</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22popular-book-meta\x22><i\x20class=\x22fas\x20fa-download\x22></i>\x20'+(_0xcbe8bb[_0x3fd068(0x314)]||0x0)+_0x3fd068(0x20d);}async function fetchBooksMain(_0x1c7f9b=![]){const _0x64f2be=_0x3098b8;if(!currentUser||isLoadingBooksMain)return;if(!hasMoreBooksMain&&_0x1c7f9b){if(elements[_0x64f2be(0x269)])elements['booksGridLoadingIndicator']['style'][_0x64f2be(0x40e)]=_0x64f2be(0x1d8);return;}isLoadingBooksMain=!![];if(_0x1c7f9b){if(elements[_0x64f2be(0x269)])elements['booksGridLoadingIndicator']['style']['display']='block';}else{lastVisibleBookMain=null,hasMoreBooksMain=!![],displayedBooksMain=[];if(elements[_0x64f2be(0x1c4)])elements[_0x64f2be(0x1c4)][_0x64f2be(0x1e1)]='';renderSkeletonLoaders(elements['booksContainer'],BOOKS_PER_PAGE_MAIN,_0x64f2be(0x224));if(elements[_0x64f2be(0x296)])elements[_0x64f2be(0x296)]['style']['display']=_0x64f2be(0x1d8);}let _0x2acb1f=db[_0x64f2be(0x2be)](_0x64f2be(0x398))[_0x64f2be(0x395)](_0x64f2be(0x2ee),'==',_0x64f2be(0x353));currentCategory!==_0x64f2be(0x31c)&&(_0x2acb1f=_0x2acb1f[_0x64f2be(0x395)]('category','==',currentCategory));_0x2acb1f=_0x2acb1f[_0x64f2be(0x276)](_0x64f2be(0x17a),_0x64f2be(0x3c3))[_0x64f2be(0x2a9)](BOOKS_PER_PAGE_MAIN);_0x1c7f9b&&lastVisibleBookMain&&(_0x2acb1f=_0x2acb1f[_0x64f2be(0x294)](lastVisibleBookMain));try{const _0x33f894=await _0x2acb1f[_0x64f2be(0x2ef)]();if(!_0x1c7f9b&&elements[_0x64f2be(0x1c4)])elements[_0x64f2be(0x1c4)][_0x64f2be(0x1e1)]='';const _0x5149c1=_0x33f894[_0x64f2be(0x1f1)]['map'](_0x490ba0=>({'id':_0x490ba0['id'],..._0x490ba0['data']()}));_0x5149c1[_0x64f2be(0x3c7)]>0x0&&(_0x5149c1['forEach'](_0x208733=>{const _0x31e0d0=_0x64f2be;displayedBooksMain[_0x31e0d0(0x1fc)](_0x208733);if(elements['booksContainer'])elements[_0x31e0d0(0x1c4)][_0x31e0d0(0x1e1)]+=createBookCardHTML(_0x208733);}),lastVisibleBookMain=_0x33f894[_0x64f2be(0x1f1)][_0x33f894[_0x64f2be(0x1f1)][_0x64f2be(0x3c7)]-0x1]);hasMoreBooksMain=_0x5149c1[_0x64f2be(0x3c7)]===BOOKS_PER_PAGE_MAIN;if(displayedBooksMain['length']===0x0&&!_0x1c7f9b&&elements['emptyStateBooks'])elements[_0x64f2be(0x296)][_0x64f2be(0x1e1)]=_0x64f2be(0x342)+escapeHTML(currentCategory)+_0x64f2be(0x3fb),elements['emptyStateBooks'][_0x64f2be(0x41d)][_0x64f2be(0x40e)]='flex';else elements[_0x64f2be(0x296)]&&(elements['emptyStateBooks']['style']['display']='none');AOS[_0x64f2be(0x34b)]();}catch(_0x1179e7){console[_0x64f2be(0x1d9)](_0x64f2be(0x270),_0x1179e7),showToast(_0x64f2be(0x33d),_0x64f2be(0x1d9));if(!_0x1c7f9b&&elements[_0x64f2be(0x296)]){if(elements[_0x64f2be(0x1c4)])elements[_0x64f2be(0x1c4)][_0x64f2be(0x1e1)]='';elements[_0x64f2be(0x296)][_0x64f2be(0x1e1)]=_0x64f2be(0x1f8),elements['emptyStateBooks'][_0x64f2be(0x41d)][_0x64f2be(0x40e)]=_0x64f2be(0x1bc);}}finally{isLoadingBooksMain=![];if(elements[_0x64f2be(0x269)])elements[_0x64f2be(0x269)][_0x64f2be(0x41d)][_0x64f2be(0x40e)]=_0x64f2be(0x1d8);}}async function fetchAllBooksForSearch(){const _0x11c48d=_0x3098b8;if(!currentUser){allBooksCache=[];return;}try{const _0x124c9a=await db['collection']('books')[_0x11c48d(0x395)](_0x11c48d(0x2ee),'==',_0x11c48d(0x353))[_0x11c48d(0x2ef)]();allBooksCache=_0x124c9a[_0x11c48d(0x1f1)][_0x11c48d(0x2e3)](_0x2955bc=>({'id':_0x2955bc['id'],..._0x2955bc['data']()}));}catch(_0x4709cc){console[_0x11c48d(0x1d9)](_0x11c48d(0x39f),_0x4709cc),showToast(_0x11c48d(0x2c0),'warning');}}function fetchPopularBooks(){const _0x281a1d=_0x3098b8;if(!currentUser){if(elements[_0x281a1d(0x3a7)])elements[_0x281a1d(0x3a7)][_0x281a1d(0x1e1)]=_0x281a1d(0x249);return;}if(listeners[_0x281a1d(0x28d)])listeners[_0x281a1d(0x28d)]();renderSkeletonLoaders(elements[_0x281a1d(0x3a7)],0x5,'popular'),listeners[_0x281a1d(0x28d)]=db[_0x281a1d(0x2be)](_0x281a1d(0x398))[_0x281a1d(0x395)](_0x281a1d(0x2ee),'==','approved')[_0x281a1d(0x276)](_0x281a1d(0x314),_0x281a1d(0x3c3))[_0x281a1d(0x276)](_0x281a1d(0x17a),_0x281a1d(0x3c3))[_0x281a1d(0x2a9)](0xa)[_0x281a1d(0x240)](_0x2672f1=>{const _0x16927b=_0x281a1d;popularBooksData=_0x2672f1[_0x16927b(0x1f1)]['map'](_0x1750c5=>({'id':_0x1750c5['id'],..._0x1750c5[_0x16927b(0x306)]()}));if(elements[_0x16927b(0x3a7)])elements[_0x16927b(0x3a7)][_0x16927b(0x1e1)]='';if(popularBooksData[_0x16927b(0x3c7)]===0x0){if(elements['popularBooksCarousel'])elements[_0x16927b(0x3a7)][_0x16927b(0x1e1)]=_0x16927b(0x160);}else popularBooksData[_0x16927b(0x355)](_0x2ee627=>{const _0x4e1af2=_0x16927b;if(elements[_0x4e1af2(0x3a7)])elements[_0x4e1af2(0x3a7)][_0x4e1af2(0x1e1)]+=createPopularBookCardHTML(_0x2ee627);});AOS['refreshHard']();},_0x12b30a=>{const _0x305ba6=_0x281a1d;console[_0x305ba6(0x1d9)]('Error\x20fetching\x20popular\x20books:',_0x12b30a),showToast(_0x305ba6(0x394),_0x305ba6(0x1d9));if(elements[_0x305ba6(0x3a7)])elements[_0x305ba6(0x3a7)]['innerHTML']='<div\x20class=\x22empty-state\x22\x20style=\x22padding:20px\x200;min-height:150px;width:100%;text-align:center;\x22><i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i><p\x20style=\x22font-size:0.9rem;\x22>Error\x20loading.</p></div>';});}function renderCategoryFilters(){const _0x55339c=_0x3098b8;if(!elements[_0x55339c(0x327)])return;elements[_0x55339c(0x327)][_0x55339c(0x1e1)]=bookCategories[_0x55339c(0x2e3)](_0x4ad55b=>_0x55339c(0x3b7)+(_0x4ad55b===currentCategory?_0x55339c(0x37e):'')+_0x55339c(0x363)+escapeHTML(_0x4ad55b)+_0x55339c(0x288)+escapeHTML(_0x4ad55b)+_0x55339c(0x172))['join']('');}elements[_0x3098b8(0x327)]&&elements['categoryFilterContainer']['addEventListener'](_0x3098b8(0x1ce),_0x16bf13=>{const _0x5e70b9=_0x3098b8,_0x2d9e28=_0x16bf13[_0x5e70b9(0x30a)][_0x5e70b9(0x259)](_0x5e70b9(0x290));if(_0x2d9e28&&currentUser)currentCategory=_0x2d9e28[_0x5e70b9(0x360)][_0x5e70b9(0x2f8)],$$(_0x5e70b9(0x230))[_0x5e70b9(0x355)](_0x54ad2d=>_0x54ad2d[_0x5e70b9(0x425)][_0x5e70b9(0x2a5)]('active')),_0x2d9e28['classList'][_0x5e70b9(0x2fd)](_0x5e70b9(0x37e)),fetchBooksMain(![]);else!currentUser&&(showToast(_0x5e70b9(0x2af),_0x5e70b9(0x22c)),openModal(elements[_0x5e70b9(0x3cd)]));});elements[_0x3098b8(0x385)]['addEventListener'](_0x3098b8(0x179),async _0x33f4f5=>{const _0x43fc6f=_0x3098b8;_0x33f4f5[_0x43fc6f(0x2a6)]();if(!currentUser||!userData){showToast('Login\x20to\x20share\x20books.','error'),openModal(elements['loginModal']);return;}const _0x2e00d4=$(_0x43fc6f(0x214))[_0x43fc6f(0x40a)][_0x43fc6f(0x161)](),_0x59dc05=$(_0x43fc6f(0x3d1))[_0x43fc6f(0x40a)][_0x43fc6f(0x161)](),_0x54822a=$('#bookCategory')[_0x43fc6f(0x40a)]['trim'](),_0x4bd9c3=$(_0x43fc6f(0x1c2))[_0x43fc6f(0x40a)][_0x43fc6f(0x161)](),_0x3a0392=$('#driveLink')['value'][_0x43fc6f(0x161)](),_0xc5e955=$(_0x43fc6f(0x24b))[_0x43fc6f(0x40a)]['trim']();if(!_0x2e00d4||!_0x59dc05||!_0x54822a||!_0x4bd9c3||!_0x3a0392){showToast(_0x43fc6f(0x1ed),_0x43fc6f(0x272));return;}try{new URL(_0x4bd9c3);}catch(_0x589ed6){showToast(_0x43fc6f(0x42a),_0x43fc6f(0x272));return;}try{new URL(_0x3a0392);}catch(_0xaa444e){showToast('Drive\x20link\x20must\x20be\x20a\x20valid\x20link.','warning');return;}const _0x1d001d=$('#submitBookBtn');toggleSpinner(_0x1d001d,!![]);const _0x582f01={'bookName':_0x2e00d4,'authorName':_0x59dc05,'category':_0x54822a,'imageUrl':_0x4bd9c3,'driveLink':_0x3a0392,'description':_0xc5e955,'submittedBy':currentUser['uid'],'submittedByName':userData[_0x43fc6f(0x28e)]||_0x43fc6f(0x2ea),'submittedByUsername':userData[_0x43fc6f(0x2f0)]||'anon_username','submittedAt':firebase[_0x43fc6f(0x20a)]['FieldValue'][_0x43fc6f(0x2e1)](),'status':_0x43fc6f(0x15f),'downloads':0x0,'avgRating':0x0,'ratingCount':0x0,'approvedAt':null,'reviewedAt':null,'reviewedBy':null,'rejectionReason':'','adminNotes':''};try{await db[_0x43fc6f(0x2be)]('books')[_0x43fc6f(0x2fd)](_0x582f01),await db[_0x43fc6f(0x2be)](_0x43fc6f(0x3c4))[_0x43fc6f(0x3e3)](currentUser[_0x43fc6f(0x3ba)])[_0x43fc6f(0x1fa)]({'booksSharedCount':firebase[_0x43fc6f(0x20a)][_0x43fc6f(0x210)][_0x43fc6f(0x426)](0x1)}),await createNotification(currentUser['uid'],_0x43fc6f(0x166),'Your\x20book\x20\x22'+escapeHTML(_0x2e00d4)+_0x43fc6f(0x418),_0x43fc6f(0x22c),null,'fas\x20fa-upload'),showToast(_0x43fc6f(0x1dd),'success'),elements[_0x43fc6f(0x385)][_0x43fc6f(0x391)](),closeModal(elements[_0x43fc6f(0x348)]);}catch(_0x53c586){console[_0x43fc6f(0x1d9)](_0x43fc6f(0x3e0),_0x53c586),showToast(_0x43fc6f(0x2aa)+_0x53c586[_0x43fc6f(0x1ac)],_0x43fc6f(0x1d9));}finally{toggleSpinner(_0x1d001d,![]);}});function setupBookApprovalListener(){const _0x3f35a6=_0x3098b8;if(!currentUser||listeners[_0x3f35a6(0x2de)])return;listeners['bookApproval']=db[_0x3f35a6(0x2be)]('books')['where']('submittedBy','==',currentUser[_0x3f35a6(0x3ba)])[_0x3f35a6(0x240)](async _0x434188=>{const _0x402d26=_0x3f35a6;for(const _0x332975 of _0x434188[_0x402d26(0x2ed)]()){if(_0x332975[_0x402d26(0x1e2)]===_0x402d26(0x32c)){const _0x3006c5={'id':_0x332975['doc']['id'],..._0x332975[_0x402d26(0x3e3)][_0x402d26(0x306)]()},_0x2bc8d6=db[_0x402d26(0x2be)](_0x402d26(0x3c4))['doc'](currentUser[_0x402d26(0x3ba)]);try{const _0x4a7600=await _0x2bc8d6[_0x402d26(0x2ef)]();if(!_0x4a7600[_0x402d26(0x2e4)]){console['warn']('User\x20document\x20not\x20found\x20during\x20book\x20approval\x20processing\x20for\x20UID:',currentUser[_0x402d26(0x3ba)]);continue;}const _0x553d42=_0x4a7600[_0x402d26(0x306)](),_0x4f8af6=_0x553d42['processedBookActions']||{};if(_0x3006c5[_0x402d26(0x2ee)]===_0x402d26(0x353)&&(!_0x4f8af6[_0x3006c5['id']]||!_0x4f8af6[_0x3006c5['id']]['approval']))showToast(_0x402d26(0x1d2)+escapeHTML(_0x3006c5['bookName'])+'\x22\x20has\x20been\x20approved!\x20+10\x20points.','success',0x1b58),await _0x2bc8d6[_0x402d26(0x1fa)]({'points':firebase['firestore'][_0x402d26(0x210)][_0x402d26(0x426)](0xa),[_0x402d26(0x423)+_0x3006c5['id']+'.approval']:!![]}),await createNotification(currentUser[_0x402d26(0x3ba)],_0x402d26(0x220),'Your\x20book\x20\x22'+escapeHTML(_0x3006c5[_0x402d26(0x347)])+_0x402d26(0x1f2),_0x402d26(0x427),_0x402d26(0x3d2)+_0x3006c5['id'],_0x402d26(0x232)),await createNotification(currentUser[_0x402d26(0x3ba)],_0x402d26(0x3fd),_0x402d26(0x267)+escapeHTML(_0x3006c5['bookName'])+'\x22.',_0x402d26(0x427),null,'fas\x20fa-coins');else _0x3006c5[_0x402d26(0x2ee)]===_0x402d26(0x1d0)&&(!_0x4f8af6[_0x3006c5['id']]||!_0x4f8af6[_0x3006c5['id']][_0x402d26(0x1a0)])&&(showToast(_0x402d26(0x1d2)+escapeHTML(_0x3006c5[_0x402d26(0x347)])+'\x22\x20was\x20rejected.\x20Reason:\x20'+escapeHTML(_0x3006c5[_0x402d26(0x307)]||_0x402d26(0x2fb))+'.','warning',0x1b58),await _0x2bc8d6['update']({[_0x402d26(0x423)+_0x3006c5['id']+_0x402d26(0x390)]:!![]}),await createNotification(currentUser[_0x402d26(0x3ba)],'Book\x20Submission\x20Update','Your\x20book\x20\x22'+escapeHTML(_0x3006c5[_0x402d26(0x347)])+_0x402d26(0x415)+escapeHTML(_0x3006c5[_0x402d26(0x307)]||_0x402d26(0x2fb))+'.',_0x402d26(0x272),null,_0x402d26(0x403)));}catch(_0x2fe85c){console[_0x402d26(0x1d9)](_0x402d26(0x30e),currentUser[_0x402d26(0x3ba)],_0x402d26(0x293),_0x3006c5['id'],_0x2fe85c);}}}},_0x2331bb=>{const _0x971a64=_0x3f35a6;console[_0x971a64(0x1d9)]('Error\x20in\x20book\x20approval\x20listener:',_0x2331bb);});}[elements[_0x3098b8(0x1c4)],elements[_0x3098b8(0x3a9)],elements['popularBooksCarousel']][_0x3098b8(0x355)](_0x5085e3=>{const _0x23df44=_0x3098b8;_0x5085e3&&_0x5085e3['addEventListener'](_0x23df44(0x1ce),async _0x36e0d5=>{const _0x49e8bd=_0x23df44,_0x13bcd3=_0x36e0d5['target']['closest'](_0x49e8bd(0x3bd));if(!_0x13bcd3)return;if(!currentUser||!userData){openModal(elements['loginModal']);return;}const _0x4a5f8a=_0x13bcd3[_0x49e8bd(0x360)][_0x49e8bd(0x3be)],_0x242ab5=_0x13bcd3['dataset'][_0x49e8bd(0x1b5)];if(!_0x242ab5){console[_0x49e8bd(0x219)]('Action\x20requires\x20bookId,\x20but\x20not\x20found\x20on\x20target:',_0x13bcd3);return;}_0x4a5f8a===_0x49e8bd(0x3fa)&&openBookDetailModal(_0x242ab5);});});async function handleBookDownload(_0x35a109,_0x25c39b,_0x506fea=![],_0x3043aa=null){const _0x1388f7=_0x3098b8;if(!currentUser||!userData){openModal(elements['loginModal']);return;}const _0x3d16d0=_0x3043aa||(_0x506fea?$(_0x1388f7(0x27e)+_0x35a109+'\x22]'):null);if(_0x3d16d0)toggleSpinner(_0x3d16d0,!![]);try{const _0x1887ac=await db['collection']('users')[_0x1388f7(0x3e3)](currentUser[_0x1388f7(0x3ba)])['get']();if(!_0x1887ac[_0x1388f7(0x2e4)])throw new Error(_0x1388f7(0x2d4));const _0x12b41d=_0x1887ac['data']();if(_0x12b41d[_0x1388f7(0x1b4)]<BOOK_DOWNLOAD_COST&&_0x35a109&&(await db[_0x1388f7(0x2be)](_0x1388f7(0x398))[_0x1388f7(0x3e3)](_0x35a109)[_0x1388f7(0x2ef)]())['data']()[_0x1388f7(0x16f)]!==currentUser[_0x1388f7(0x3ba)]){showToast('Need\x20'+BOOK_DOWNLOAD_COST+_0x1388f7(0x1aa)+_0x12b41d['credits']+_0x1388f7(0x2f7),_0x1388f7(0x272),0x1388),openModal(elements[_0x1388f7(0x218)]);if(_0x3d16d0)toggleSpinner(_0x3d16d0,![]);return;}const _0xfed59d=db[_0x1388f7(0x2be)]('users')[_0x1388f7(0x3e3)](currentUser['uid']),_0x144fbc=db['collection'](_0x1388f7(0x398))[_0x1388f7(0x3e3)](_0x35a109);let _0x284f9a=null,_0x3fa462=null,_0x164d87=![];await db[_0x1388f7(0x1c6)](async _0x46feef=>{const _0x5e90cb=_0x1388f7,_0x420093=await _0x46feef[_0x5e90cb(0x2ef)](_0xfed59d),_0x2420fc=await _0x46feef['get'](_0x144fbc);if(!_0x420093[_0x5e90cb(0x2e4)])throw new Error(_0x5e90cb(0x1be));if(!_0x2420fc[_0x5e90cb(0x2e4)])throw new Error(_0x5e90cb(0x37a));const _0x32c612=_0x420093[_0x5e90cb(0x306)]()[_0x5e90cb(0x1b4)]||0x0;_0x284f9a=_0x2420fc[_0x5e90cb(0x306)]()[_0x5e90cb(0x16f)],_0x3fa462=_0x2420fc['data']()[_0x5e90cb(0x347)],_0x164d87=currentUser[_0x5e90cb(0x3ba)]===_0x284f9a;if(!_0x164d87&&_0x32c612<BOOK_DOWNLOAD_COST)throw new Error(_0x5e90cb(0x21e)+BOOK_DOWNLOAD_COST+_0x5e90cb(0x376)+_0x32c612+'.\x20Please\x20refresh.');!_0x164d87&&_0x46feef['update'](_0xfed59d,{'credits':firebase[_0x5e90cb(0x20a)][_0x5e90cb(0x210)]['increment'](-BOOK_DOWNLOAD_COST),'booksDownloadedCount':firebase['firestore'][_0x5e90cb(0x210)][_0x5e90cb(0x426)](0x1)});_0x46feef['update'](_0x144fbc,{'downloads':firebase[_0x5e90cb(0x20a)][_0x5e90cb(0x210)][_0x5e90cb(0x426)](0x1)});if(_0x284f9a&&!_0x164d87){const _0x2e3f70=db['collection'](_0x5e90cb(0x3c4))['doc'](_0x284f9a);_0x46feef[_0x5e90cb(0x1fa)](_0x2e3f70,{'points':firebase[_0x5e90cb(0x20a)][_0x5e90cb(0x210)]['increment'](0x1),'totalBookDownloads':firebase[_0x5e90cb(0x20a)]['FieldValue'][_0x5e90cb(0x426)](0x1)});}}),window[_0x1388f7(0x1e9)](_0x25c39b,_0x1388f7(0x211)),!_0x164d87?showToast('-'+BOOK_DOWNLOAD_COST+_0x1388f7(0x284),_0x1388f7(0x22c),0xbb8):showToast(_0x1388f7(0x3d8),_0x1388f7(0x22c),0xbb8),!_0x164d87&&userData&&(userData[_0x1388f7(0x1b4)]=(userData[_0x1388f7(0x1b4)]||0x0)-BOOK_DOWNLOAD_COST,updateHeaderCredits()),_0x284f9a&&!_0x164d87&&_0x3fa462&&await createNotification(_0x284f9a,_0x1388f7(0x334),_0x1388f7(0x1d2)+escapeHTML(_0x3fa462)+_0x1388f7(0x26c),'info',_0x1388f7(0x3d2)+_0x35a109,'fas\x20fa-arrow-down');}catch(_0x1bb374){console[_0x1388f7(0x1d9)](_0x1388f7(0x2f4),_0x1bb374),showToast(_0x1388f7(0x235)+(_0x1bb374[_0x1388f7(0x1ac)]||_0x1388f7(0x32b)),'error');}finally{if(_0x3d16d0)toggleSpinner(_0x3d16d0,![]);}}function fetchUserBooks(_0x186386=![],_0x120b62=![]){const _0x2ecddc=_0x3098b8;if(!currentUser||isFetchingMoreUserBooks&&!_0x120b62)return;if(_0x120b62){lastUserBookSnapshot=null,hasMoreUserBooks=!![];if(elements['profileBooksContainer'])elements['profileBooksContainer'][_0x2ecddc(0x1e1)]='';if(elements[_0x2ecddc(0x400)])elements['emptyProfileBooks'][_0x2ecddc(0x41d)][_0x2ecddc(0x40e)]='none';}if(!hasMoreUserBooks&&_0x186386){if(elements[_0x2ecddc(0x227)])toggleSpinner(elements[_0x2ecddc(0x227)],![]);return;}isFetchingMoreUserBooks=!![];if(_0x186386&&elements[_0x2ecddc(0x227)])toggleSpinner(elements[_0x2ecddc(0x227)],!![]);else!_0x120b62&&elements['profileBooksContainer']&&!elements['profileBooksContainer'][_0x2ecddc(0x317)]('.book-card')&&renderSkeletonLoaders(elements['profileBooksContainer'],0x3);let _0x40e0e1=db[_0x2ecddc(0x2be)](_0x2ecddc(0x398))[_0x2ecddc(0x395)](_0x2ecddc(0x16f),'==',currentUser[_0x2ecddc(0x3ba)])['orderBy'](_0x2ecddc(0x3d5),_0x2ecddc(0x3c3))['limit'](0x6);_0x186386&&lastUserBookSnapshot&&(_0x40e0e1=_0x40e0e1['startAfter'](lastUserBookSnapshot));if(listeners[_0x2ecddc(0x186)])listeners[_0x2ecddc(0x186)]();listeners[_0x2ecddc(0x186)]=_0x40e0e1['onSnapshot'](_0x2df420=>{const _0x57401b=_0x2ecddc;if(!_0x186386&&!_0x120b62&&_0x2df420[_0x57401b(0x3b2)][_0x57401b(0x1c8)]&&!_0x2df420[_0x57401b(0x37d)])return;if(!_0x186386&&elements[_0x57401b(0x3a9)])elements[_0x57401b(0x3a9)]['innerHTML']='';if(_0x2df420[_0x57401b(0x37d)]&&(!elements[_0x57401b(0x3a9)]||elements[_0x57401b(0x3a9)][_0x57401b(0x1e1)]==='')){if(elements[_0x57401b(0x400)])elements['emptyProfileBooks'][_0x57401b(0x41d)][_0x57401b(0x40e)]=_0x57401b(0x1bc);hasMoreUserBooks=![];}else{if(elements[_0x57401b(0x400)])elements[_0x57401b(0x400)]['style'][_0x57401b(0x40e)]=_0x57401b(0x1d8);_0x2df420[_0x57401b(0x1f1)]['forEach'](_0x34e485=>{const _0xc59a5e=_0x57401b,_0x44ceda=elements[_0xc59a5e(0x3a9)]?elements[_0xc59a5e(0x3a9)]['querySelector'](_0xc59a5e(0x330)+_0x34e485['id']+'\x22]'):null;!_0x44ceda&&elements[_0xc59a5e(0x3a9)]&&(elements[_0xc59a5e(0x3a9)][_0xc59a5e(0x1e1)]+=createBookCardHTML({'id':_0x34e485['id'],..._0x34e485[_0xc59a5e(0x306)]()},_0xc59a5e(0x3d9)));}),lastUserBookSnapshot=_0x2df420[_0x57401b(0x1f1)]['length']>0x0?_0x2df420['docs'][_0x2df420[_0x57401b(0x1f1)][_0x57401b(0x3c7)]-0x1]:null,hasMoreUserBooks=_0x2df420[_0x57401b(0x1f1)][_0x57401b(0x3c7)]===0x6;}if(elements[_0x57401b(0x227)])elements[_0x57401b(0x227)][_0x57401b(0x41d)]['display']=hasMoreUserBooks?_0x57401b(0x2df):'none';if(_0x186386&&elements[_0x57401b(0x227)])toggleSpinner(elements[_0x57401b(0x227)],![]);isFetchingMoreUserBooks=![],AOS[_0x57401b(0x34b)]();},_0x96938d=>{const _0x19e571=_0x2ecddc;console[_0x19e571(0x1d9)](_0x19e571(0x3a8),_0x96938d),showToast(_0x19e571(0x1bf),_0x19e571(0x1d9));if(_0x186386&&elements[_0x19e571(0x227)])toggleSpinner(elements[_0x19e571(0x227)],![]);isFetchingMoreUserBooks=![],elements['emptyProfileBooks']&&elements[_0x19e571(0x3a9)]&&(elements[_0x19e571(0x3a9)][_0x19e571(0x1e1)]='',elements['emptyProfileBooks'][_0x19e571(0x41d)]['display']='flex');});}if(elements[_0x3098b8(0x227)])elements[_0x3098b8(0x227)][_0x3098b8(0x261)](_0x3098b8(0x1ce),()=>fetchUserBooks(!![]));function enableWithdrawalIfQualified(){const _0x3e786e=_0x3098b8,_0x85d3f5=elements[_0x3e786e(0x1fb)];_0x85d3f5&&(_0x85d3f5[_0x3e786e(0x31f)]=!(userData&&userData[_0x3e786e(0x19c)]>=0x1f4));}elements['withdrawBtnLarge']&&(elements[_0x3098b8(0x1fb)][_0x3098b8(0x32d)]=()=>{const _0xbbb194=_0x3098b8;if(userData&&userData[_0xbbb194(0x19c)]>=0x1f4){elements[_0xbbb194(0x287)][_0xbbb194(0x3c2)]=userData[_0xbbb194(0x19c)]||0x0,selectedWithdrawalMethod=null,selectedWithdrawalAmount=null,selectedWithdrawalRs=null,$$(_0xbbb194(0x2a4))[_0xbbb194(0x355)](_0x388417=>_0x388417[_0xbbb194(0x425)][_0xbbb194(0x2a5)](_0xbbb194(0x37e)));if(elements['paymentDetails'])elements[_0xbbb194(0x333)][_0xbbb194(0x425)]['remove'](_0xbbb194(0x37e));if(elements[_0xbbb194(0x371)])elements['withdrawalForm'][_0xbbb194(0x391)]();updatePaymentDetailsUI(),openModal(elements[_0xbbb194(0x3b9)]);}else showToast('You\x20need\x20at\x20least\x20500\x20points\x20to\x20withdraw.\x20Your\x20balance:\x20'+(userData?.['points']||0x0),_0xbbb194(0x272));});if(elements[_0x3098b8(0x16c)])elements[_0x3098b8(0x16c)][_0x3098b8(0x32d)]=()=>closeModal(elements[_0x3098b8(0x3b9)]);function setupWithdrawalListeners(){const _0x292bf9=_0x3098b8;elements[_0x292bf9(0x361)]&&elements[_0x292bf9(0x361)][_0x292bf9(0x261)](_0x292bf9(0x1ce),_0x2b0408=>{const _0x21ef48=_0x292bf9,_0x3d5ed3=_0x2b0408[_0x21ef48(0x30a)][_0x21ef48(0x259)](_0x21ef48(0x215));if(!_0x3d5ed3)return;$$(_0x21ef48(0x39d))[_0x21ef48(0x355)](_0x48319e=>_0x48319e[_0x21ef48(0x425)][_0x21ef48(0x2a5)](_0x21ef48(0x37e))),_0x3d5ed3['classList']['add'](_0x21ef48(0x37e)),selectedWithdrawalMethod=_0x3d5ed3[_0x21ef48(0x360)]['method'],updatePaymentDetailsUI();if(selectedWithdrawalAmount&&elements[_0x21ef48(0x333)])elements[_0x21ef48(0x333)][_0x21ef48(0x425)]['add'](_0x21ef48(0x37e));}),elements[_0x292bf9(0x345)]&&elements['amountOptionsContainer']['addEventListener']('click',_0x1fdeb4=>{const _0x236298=_0x292bf9,_0x29b4a3=_0x1fdeb4[_0x236298(0x30a)][_0x236298(0x259)](_0x236298(0x3f8));if(!_0x29b4a3)return;const _0x567204=parseInt(_0x29b4a3['dataset'][_0x236298(0x2b5)]);if(userData&&userData[_0x236298(0x19c)]>=_0x567204){$$(_0x236298(0x188))['forEach'](_0x26a05b=>_0x26a05b['classList'][_0x236298(0x2a5)](_0x236298(0x37e))),_0x29b4a3['classList'][_0x236298(0x2fd)](_0x236298(0x37e)),selectedWithdrawalAmount=_0x567204,selectedWithdrawalRs=parseInt(_0x29b4a3[_0x236298(0x360)]['rs']);if(selectedWithdrawalMethod&&elements[_0x236298(0x333)])elements[_0x236298(0x333)][_0x236298(0x425)][_0x236298(0x2fd)](_0x236298(0x37e));}else showToast(_0x236298(0x257)+_0x567204+_0x236298(0x280)+(userData?.[_0x236298(0x19c)]||0x0),'warning');});}function updatePaymentDetailsUI(){const _0x41e4a7=_0x3098b8;if(!selectedWithdrawalMethod||!elements['paymentDetails']){if(elements['paymentDetails'])elements[_0x41e4a7(0x333)]['classList'][_0x41e4a7(0x2a5)]('active');return;}const _0x1eefe1=elements[_0x41e4a7(0x23f)],_0x38b2f7=elements[_0x41e4a7(0x34c)],_0x53389a=elements[_0x41e4a7(0x197)],_0x3434c5=elements[_0x41e4a7(0x213)];if(!_0x1eefe1||!_0x38b2f7||!_0x53389a||!_0x3434c5)return;_0x38b2f7[_0x41e4a7(0x1c0)]=_0x41e4a7(0x1b1),_0x53389a[_0x41e4a7(0x41d)][_0x41e4a7(0x40e)]='none',_0x3434c5[_0x41e4a7(0x17d)]=![];if(selectedWithdrawalMethod===_0x41e4a7(0x2fe))_0x1eefe1['textContent']=_0x41e4a7(0x389),_0x38b2f7[_0x41e4a7(0x1c0)]=_0x41e4a7(0x3ff);else{if(selectedWithdrawalMethod===_0x41e4a7(0x22d))_0x1eefe1['textContent']='Email\x20for\x20Redeem\x20Code\x20*',_0x38b2f7[_0x41e4a7(0x1c0)]=_0x41e4a7(0x202);else{if(selectedWithdrawalMethod===_0x41e4a7(0x2f6))_0x1eefe1[_0x41e4a7(0x3c2)]=_0x41e4a7(0x2a3),_0x38b2f7[_0x41e4a7(0x1c0)]=_0x41e4a7(0x209),_0x53389a['style'][_0x41e4a7(0x40e)]=_0x41e4a7(0x2fc),_0x3434c5[_0x41e4a7(0x17d)]=!![];else(selectedWithdrawalMethod===_0x41e4a7(0x38f)||selectedWithdrawalMethod===_0x41e4a7(0x364))&&(_0x1eefe1[_0x41e4a7(0x3c2)]=selectedWithdrawalMethod['charAt'](0x0)[_0x41e4a7(0x3aa)]()+selectedWithdrawalMethod[_0x41e4a7(0x29f)](0x1)+_0x41e4a7(0x2d2),_0x38b2f7[_0x41e4a7(0x1c0)]=_0x41e4a7(0x26f));}}}elements['withdrawalForm']&&elements[_0x3098b8(0x371)][_0x3098b8(0x261)]('submit',async _0x4b6163=>{const _0x358de5=_0x3098b8;_0x4b6163[_0x358de5(0x2a6)]();if(!currentUser||!userData||!selectedWithdrawalMethod||!selectedWithdrawalAmount){showToast(_0x358de5(0x401),'warning');return;}if(userData[_0x358de5(0x19c)]<selectedWithdrawalAmount){showToast(_0x358de5(0x40c),_0x358de5(0x1d9));return;}const _0x5a438c=elements[_0x358de5(0x34c)]['value']['trim'](),_0x1c060e=elements[_0x358de5(0x213)][_0x358de5(0x40a)][_0x358de5(0x161)]();if(!_0x5a438c||elements['accountNameGroup']['style'][_0x358de5(0x40e)]===_0x358de5(0x2fc)&&!_0x1c060e){showToast(_0x358de5(0x36e),_0x358de5(0x272));return;}const _0x46075d=elements[_0x358de5(0x1e3)];toggleSpinner(_0x46075d,!![]);const _0xaca2d7={'userId':currentUser[_0x358de5(0x3ba)],'userName':userData[_0x358de5(0x28e)]||_0x358de5(0x3b1),'userEmail':userData[_0x358de5(0x33f)],'pointsWithdrawn':selectedWithdrawalAmount,'amountRs':selectedWithdrawalRs,'method':selectedWithdrawalMethod,'paymentIdentifier':_0x5a438c,'accountHolderName':selectedWithdrawalMethod===_0x358de5(0x2f6)&&_0x1c060e?_0x1c060e:null,'status':_0x358de5(0x15f),'requestedAt':firebase[_0x358de5(0x20a)]['FieldValue']['serverTimestamp'](),'processedAt':null,'adminNotes':''};try{const _0x5b1939=db[_0x358de5(0x2be)](_0x358de5(0x3c4))[_0x358de5(0x3e3)](currentUser[_0x358de5(0x3ba)]);await db['runTransaction'](async _0x205856=>{const _0x1e2876=_0x358de5,_0x1c79ad=await _0x205856[_0x1e2876(0x2ef)](_0x5b1939);if(!_0x1c79ad['exists'])throw new Error(_0x1e2876(0x28f));const _0x4eb51e=_0x1c79ad[_0x1e2876(0x306)]()[_0x1e2876(0x19c)]||0x0;if(_0x4eb51e<selectedWithdrawalAmount)throw new Error(_0x1e2876(0x2b9));_0x205856[_0x1e2876(0x1fa)](_0x5b1939,{'points':firebase['firestore']['FieldValue'][_0x1e2876(0x426)](-selectedWithdrawalAmount)});const _0x3cb3db=db[_0x1e2876(0x2be)]('withdrawals')[_0x1e2876(0x3e3)]();_0x205856[_0x1e2876(0x254)](_0x3cb3db,_0xaca2d7);}),await createNotification(currentUser[_0x358de5(0x3ba)],_0x358de5(0x34a),_0x358de5(0x2a2)+selectedWithdrawalAmount+_0x358de5(0x3c6)+selectedWithdrawalRs+_0x358de5(0x22a),_0x358de5(0x22c),null,_0x358de5(0x17c)),showToast(_0x358de5(0x2ca),'success'),elements[_0x358de5(0x371)][_0x358de5(0x391)](),closeModal(elements[_0x358de5(0x3b9)]);}catch(_0x3bd633){console[_0x358de5(0x1d9)]('Error\x20submitting\x20withdrawal:',_0x3bd633),showToast(_0x358de5(0x3e9)+_0x3bd633['message'],'error');}finally{toggleSpinner(_0x46075d,![]);}});function fetchWithdrawalHistory(){const _0x5b5f8b=_0x3098b8;if(!currentUser||listeners[_0x5b5f8b(0x399)])return;if(!elements[_0x5b5f8b(0x3c9)]||!elements[_0x5b5f8b(0x2c1)])return;renderSkeletonLoaders(elements['withdrawalHistoryContainer'],0x3,'history'),elements['emptyWithdrawalHistory'][_0x5b5f8b(0x41d)][_0x5b5f8b(0x40e)]='none',listeners['withdrawals']=db[_0x5b5f8b(0x2be)](_0x5b5f8b(0x399))[_0x5b5f8b(0x395)]('userId','==',currentUser[_0x5b5f8b(0x3ba)])[_0x5b5f8b(0x276)]('requestedAt','desc')[_0x5b5f8b(0x2a9)](0xa)[_0x5b5f8b(0x240)](_0x2ad11c=>{const _0x413f4d=_0x5b5f8b;elements['withdrawalHistoryContainer']['innerHTML']='',_0x2ad11c[_0x413f4d(0x37d)]?elements[_0x413f4d(0x2c1)]['style']['display']=_0x413f4d(0x1bc):(elements['emptyWithdrawalHistory']['style'][_0x413f4d(0x40e)]=_0x413f4d(0x1d8),_0x2ad11c[_0x413f4d(0x355)](_0x47db50=>{const _0x2282e1=_0x413f4d,_0x12a8a2=_0x47db50[_0x2282e1(0x306)]();elements['withdrawalHistoryContainer']['innerHTML']+=_0x2282e1(0x1a5)+Math['random']()*0.2+_0x2282e1(0x171)+_0x12a8a2[_0x2282e1(0x268)]+_0x2282e1(0x178)+_0x12a8a2[_0x2282e1(0x335)]+_0x2282e1(0x2e2)+escapeHTML(_0x12a8a2['method'][_0x2282e1(0x3aa)]())+'\x20|\x20ID:\x20'+escapeHTML(_0x12a8a2[_0x2282e1(0x36f)])+_0x2282e1(0x28b)+formatDate(_0x12a8a2[_0x2282e1(0x177)])+'\x20'+formatTime(_0x12a8a2[_0x2282e1(0x177)])+_0x2282e1(0x299)+(_0x12a8a2[_0x2282e1(0x2ee)]!=='pending'&&_0x12a8a2[_0x2282e1(0x16d)]?_0x2282e1(0x357)+formatDate(_0x12a8a2[_0x2282e1(0x16d)])+'\x20'+formatTime(_0x12a8a2[_0x2282e1(0x16d)])+_0x2282e1(0x321):'')+_0x2282e1(0x2f3)+(_0x12a8a2[_0x2282e1(0x3f5)]?_0x2282e1(0x3a4)+escapeHTML(_0x12a8a2[_0x2282e1(0x3f5)])+'</div>':'')+_0x2282e1(0x26b)+_0x12a8a2[_0x2282e1(0x2ee)][_0x2282e1(0x3cc)]()+'\x22>'+escapeHTML(_0x12a8a2['status'])+_0x2282e1(0x23c);})),AOS[_0x413f4d(0x34b)]();},_0x13c87f=>{const _0x22d968=_0x5b5f8b;console['error'](_0x22d968(0x15d),_0x13c87f),showToast(_0x22d968(0x17f),_0x22d968(0x1d9)),elements[_0x22d968(0x3c9)][_0x22d968(0x1e1)]='',elements[_0x22d968(0x2c1)][_0x22d968(0x41d)][_0x22d968(0x40e)]=_0x22d968(0x1bc);});}async function handleDailyCreditClaim(){const _0x3d8224=_0x3098b8;if(!currentUser||!userData){showToast(_0x3d8224(0x40d),_0x3d8224(0x22c)),openModal(elements[_0x3d8224(0x3cd)]);return;}const _0x1269dd=elements['claimDailyCreditBtn'];toggleSpinner(_0x1269dd,!![]);try{const _0x4bcb45=await db[_0x3d8224(0x2be)](_0x3d8224(0x3c4))['doc'](currentUser['uid'])[_0x3d8224(0x2ef)]();if(!_0x4bcb45['exists'])throw new Error(_0x3d8224(0x16e));const _0x38c486=_0x4bcb45[_0x3d8224(0x306)](),_0x22157e=new Date()[_0x3d8224(0x205)]()[_0x3d8224(0x1b2)]('T')[0x0];if(_0x38c486[_0x3d8224(0x194)]===_0x22157e){showToast(_0x3d8224(0x199),_0x3d8224(0x272)),toggleSpinner(_0x1269dd,![]);return;}const _0x58a172=0x14;await db[_0x3d8224(0x2be)]('users')['doc'](currentUser['uid'])[_0x3d8224(0x1fa)]({'credits':firebase[_0x3d8224(0x20a)][_0x3d8224(0x210)]['increment'](_0x58a172),'lastDailyCreditClaim':_0x22157e}),await createNotification(currentUser[_0x3d8224(0x3ba)],'Daily\x20Bonus\x20Claimed!',_0x3d8224(0x1c9)+_0x58a172+_0x3d8224(0x38d),_0x3d8224(0x427),null,_0x3d8224(0x378)),showToast('+'+_0x58a172+'\x20daily\x20credits\x20claimed!\x20Come\x20back\x20tomorrow.','success');}catch(_0x71ea51){console[_0x3d8224(0x1d9)](_0x3d8224(0x3db),_0x71ea51),showToast('Failed\x20to\x20claim\x20daily\x20credit.\x20'+_0x71ea51['message'],_0x3d8224(0x1d9));}finally{toggleSpinner(_0x1269dd,![]);}}if(elements[_0x3098b8(0x175)])elements['headerCreditsContainer'][_0x3098b8(0x32d)]=()=>{const _0xea6bd7=_0x3098b8;if(!currentUser){openModal(elements[_0xea6bd7(0x3cd)]);return;}if(elements['creditModalUserCredits'])elements[_0xea6bd7(0x36a)][_0xea6bd7(0x1e1)]=(userData?.['credits']||0x0)+_0xea6bd7(0x3e1);openModal(elements['creditModal']);};if(elements['closeCreditModal'])elements[_0x3098b8(0x2c2)][_0x3098b8(0x32d)]=()=>closeModal(elements[_0x3098b8(0x218)]);if(elements[_0x3098b8(0x2f1)])elements['conductSurveyBtn']['onclick']=()=>{const _0x4b3e35=_0x3098b8;if(!currentUser){openModal(elements[_0x4b3e35(0x3cd)]);return;}showToast(_0x4b3e35(0x33e),_0x4b3e35(0x22c)),window[_0x4b3e35(0x1ea)][_0x4b3e35(0x20b)]=_0x4b3e35(0x3b5),createNotification(currentUser[_0x4b3e35(0x3ba)],_0x4b3e35(0x1ee),_0x4b3e35(0x236),_0x4b3e35(0x22c),null,_0x4b3e35(0x2ff)),closeModal(elements[_0x4b3e35(0x218)]);};async function openBookDetailModal(_0x5eabc5){const _0x459170=_0x3098b8;if(!_0x5eabc5){console['warn'](_0x459170(0x352));return;}if(!currentUser){openModal(elements['loginModal']);return;}currentBookDetailId=_0x5eabc5,openModal(elements[_0x459170(0x3e4)]);if(elements[_0x459170(0x304)])elements[_0x459170(0x304)][_0x459170(0x1e1)]=_0x459170(0x3ef);try{const _0x2eeb56=await db[_0x459170(0x2be)](_0x459170(0x398))['doc'](_0x5eabc5)['get']();if(!_0x2eeb56['exists']||_0x2eeb56[_0x459170(0x306)]()[_0x459170(0x2ee)]!==_0x459170(0x353)){showToast('Book\x20details\x20not\x20found\x20or\x20not\x20available.',_0x459170(0x1d9)),closeModal(elements[_0x459170(0x3e4)]),currentBookDetailId=null;return;}const _0x327e52={'id':_0x2eeb56['id'],..._0x2eeb56[_0x459170(0x306)]()};renderBookDetailContent(_0x327e52),loadFeedbackComments(_0x5eabc5);}catch(_0x3e7890){console[_0x459170(0x1d9)]('Error\x20fetching\x20book\x20details:',_0x3e7890),showToast(_0x459170(0x3a3),'error');if(elements[_0x459170(0x304)])elements[_0x459170(0x304)]['innerHTML']=_0x459170(0x21b);}}function renderBookDetailContent(_0x52e98e){const _0x1368af=_0x3098b8;if(!elements[_0x1368af(0x304)])return;const _0x5bcfc9=_0x1368af(0x19d),_0x32b7dc=_0x52e98e['imageUrl']||_0x5bcfc9,_0x3a2611=_0x52e98e['submittedBy']===currentUser?.['uid'],_0x40ca1b=_0x3a2611?_0x1368af(0x3a5):BOOK_DOWNLOAD_COST+_0x1368af(0x29d);elements[_0x1368af(0x304)][_0x1368af(0x1e1)]=_0x1368af(0x3b0)+escapeHTML(_0x32b7dc)+_0x1368af(0x279)+escapeHTML(_0x52e98e[_0x1368af(0x347)])+_0x1368af(0x3a2)+_0x5bcfc9+_0x1368af(0x1b3)+escapeHTML(_0x52e98e[_0x1368af(0x347)])+_0x1368af(0x169)+escapeHTML(_0x52e98e[_0x1368af(0x413)])+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22book-detail-category\x22>'+escapeHTML(_0x52e98e[_0x1368af(0x2f8)]||_0x1368af(0x392))+_0x1368af(0x332)+(_0x52e98e['downloads']||0x0)+_0x1368af(0x338)+escapeHTML(_0x52e98e[_0x1368af(0x1ef)]||_0x1368af(0x29c))+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x52e98e[_0x1368af(0x3bb)]>0x0?_0x1368af(0x212)+_0x52e98e[_0x1368af(0x3bb)]['toFixed'](0x1)+'\x20('+(_0x52e98e[_0x1368af(0x366)]||0x0)+_0x1368af(0x1e7):_0x1368af(0x1c5))+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x52e98e[_0x1368af(0x35b)]?'<div\x20class=\x22book-detail-description\x22>'+escapeHTML(_0x52e98e['description'])+_0x1368af(0x321):_0x1368af(0x2ec))+_0x1368af(0x226)+escapeHTML(_0x52e98e[_0x1368af(0x3b6)])+_0x1368af(0x1cf)+_0x52e98e['id']+_0x1368af(0x1d6)+_0x40ca1b+_0x1368af(0x15e),addDetailModalListeners(_0x52e98e['id']);}function addDetailModalListeners(_0x267bfc){const _0x204bfa=_0x3098b8,_0x42f262=elements[_0x204bfa(0x304)][_0x204bfa(0x317)](_0x204bfa(0x41b));_0x42f262&&_0x42f262[_0x204bfa(0x261)](_0x204bfa(0x1ce),()=>{const _0x5c9412=_0x204bfa;if(!currentUser||!userData){openModal(elements['loginModal']);return;}handleBookDownload(_0x267bfc,_0x42f262[_0x5c9412(0x360)][_0x5c9412(0x407)],!![],_0x42f262);});const _0x9a0bb4=$('#feedbackStars'),_0x5ceb48=$('#feedbackRating');if(_0x9a0bb4&&_0x5ceb48){const _0x5dba5a=_0x9a0bb4[_0x204bfa(0x1e4)]('i');_0x5dba5a[_0x204bfa(0x355)](_0x286e6b=>{const _0x543e15=_0x204bfa;_0x286e6b[_0x543e15(0x261)](_0x543e15(0x196),()=>highlightStars(_0x5dba5a,parseInt(_0x286e6b[_0x543e15(0x360)]['value']),!![])),_0x286e6b[_0x543e15(0x261)](_0x543e15(0x181),()=>highlightStars(_0x5dba5a,parseInt(_0x5ceb48['value']),![])),_0x286e6b[_0x543e15(0x261)](_0x543e15(0x1ce),()=>{const _0x3a63a7=_0x543e15;_0x5ceb48[_0x3a63a7(0x40a)]=_0x286e6b['dataset'][_0x3a63a7(0x40a)],highlightStars(_0x5dba5a,parseInt(_0x5ceb48[_0x3a63a7(0x40a)]),![]);});});}const _0xf237a3=$(_0x204bfa(0x1a4));if(_0xf237a3)_0xf237a3[_0x204bfa(0x261)](_0x204bfa(0x179),_0x74ba67=>handleFeedbackSubmit(_0x74ba67,_0x267bfc));}function highlightStars(_0x49dc50,_0x453b65,_0x4915bd){const _0x309cb9=_0x3098b8;_0x49dc50[_0x309cb9(0x355)](_0x535196=>{const _0x31df1d=_0x309cb9,_0x1642bf=parseInt(_0x535196[_0x31df1d(0x360)][_0x31df1d(0x40a)]);_0x535196['classList'][_0x31df1d(0x2a5)]('fas',_0x31df1d(0x380),_0x31df1d(0x36c),_0x31df1d(0x207));if(_0x1642bf<=_0x453b65){_0x535196[_0x31df1d(0x425)][_0x31df1d(0x2fd)](_0x31df1d(0x35a));if(!_0x4915bd)_0x535196[_0x31df1d(0x425)]['add']('selected');if(_0x4915bd)_0x535196[_0x31df1d(0x425)][_0x31df1d(0x2fd)]('hovered');}else _0x535196[_0x31df1d(0x425)][_0x31df1d(0x2fd)](_0x31df1d(0x380));});}async function handleFeedbackSubmit(_0x1aa0cd,_0x22886b){const _0x175d5f=_0x3098b8;_0x1aa0cd[_0x175d5f(0x2a6)]();if(!currentUser||!userData||!_0x22886b){showToast(_0x175d5f(0x246),_0x175d5f(0x22c));if(!currentUser)openModal(elements[_0x175d5f(0x3cd)]);return;}const _0xe22e48=parseInt($(_0x175d5f(0x1b0))[_0x175d5f(0x40a)]),_0x222827=$(_0x175d5f(0x324))[_0x175d5f(0x40a)][_0x175d5f(0x161)]();if(_0xe22e48===0x0){showToast('Please\x20select\x20a\x20star\x20rating\x20to\x20submit\x20feedback.',_0x175d5f(0x272));return;}const _0x5e3280=$(_0x175d5f(0x320));toggleSpinner(_0x5e3280,!![]);const _0x491253={'userId':currentUser[_0x175d5f(0x3ba)],'userName':userData[_0x175d5f(0x28e)]||_0x175d5f(0x2ea),'userAvatarInitials':getInitials(userData['name']||'Anonymous'),'rating':_0xe22e48,'comment':_0x222827,'submittedAt':firebase[_0x175d5f(0x20a)]['FieldValue']['serverTimestamp']()};try{await db['collection']('books')[_0x175d5f(0x3e3)](_0x22886b)['collection'](_0x175d5f(0x323))[_0x175d5f(0x2fd)](_0x491253);const _0x122e80=db[_0x175d5f(0x2be)](_0x175d5f(0x398))[_0x175d5f(0x3e3)](_0x22886b),_0x3ff783=db['collection'](_0x175d5f(0x3c4))[_0x175d5f(0x3e3)](currentUser[_0x175d5f(0x3ba)]);await db[_0x175d5f(0x1c6)](async _0x113243=>{const _0x7e72be=_0x175d5f,_0x29870f=await _0x113243[_0x7e72be(0x2ef)](_0x122e80),_0xba636c=await _0x113243['get'](_0x3ff783);if(!_0x29870f[_0x7e72be(0x2e4)])throw new Error(_0x7e72be(0x18e));if(!_0xba636c[_0x7e72be(0x2e4)])throw new Error(_0x7e72be(0x3d7));const _0x5329ba=_0x29870f[_0x7e72be(0x306)]()[_0x7e72be(0x366)]||0x0,_0x59476e=_0x29870f['data']()['avgRating']||0x0,_0x533dbe=_0x5329ba+0x1,_0x4733c1=(_0x59476e*_0x5329ba+_0xe22e48)/_0x533dbe;_0x113243[_0x7e72be(0x1fa)](_0x122e80,{'ratingCount':_0x533dbe,'avgRating':_0x4733c1}),_0x113243['update'](_0x3ff783,{'totalFeedbackGiven':firebase[_0x7e72be(0x20a)][_0x7e72be(0x210)]['increment'](0x1)});});const _0x42f5fe=await _0x122e80['get'](),_0x4d4b4d=_0x42f5fe['exists']?_0x42f5fe[_0x175d5f(0x306)]()[_0x175d5f(0x347)]:'this\x20book';await createNotification(currentUser['uid'],'Feedback\x20Submitted',_0x175d5f(0x282)+escapeHTML(_0x4d4b4d)+_0x175d5f(0x1f9),_0x175d5f(0x427),_0x175d5f(0x3d2)+_0x22886b,_0x175d5f(0x35c)),showToast(_0x175d5f(0x1b9),_0x175d5f(0x427));if($(_0x175d5f(0x1a4)))$('#feedbackForm')[_0x175d5f(0x391)]();if($(_0x175d5f(0x1b0)))$(_0x175d5f(0x1b0))['value']=0x0;if($$(_0x175d5f(0x291))['length']>0x0)highlightStars($$(_0x175d5f(0x291)),0x0,![]);loadFeedbackComments(_0x22886b);const _0x391aa3=await db[_0x175d5f(0x2be)](_0x175d5f(0x398))[_0x175d5f(0x3e3)](_0x22886b)[_0x175d5f(0x2ef)]();if(_0x391aa3['exists']&&elements[_0x175d5f(0x304)]){const _0x577f96=_0x391aa3['data'](),_0x110513=elements['bookDetailContent']['querySelector'](_0x175d5f(0x2ba));_0x110513&&_0x110513[_0x175d5f(0x317)]('.fa-star,\x20.far.fa-star')&&(_0x110513[_0x175d5f(0x1e1)]=_0x175d5f(0x2db)+_0x577f96[_0x175d5f(0x3bb)][_0x175d5f(0x396)](0x1)+'\x20('+(_0x577f96[_0x175d5f(0x366)]||0x0)+'\x20ratings)');const _0x42f84d=elements['bookDetailContent']['querySelector'](_0x175d5f(0x35d));if(_0x42f84d)_0x42f84d[_0x175d5f(0x3c2)]=_0x577f96[_0x175d5f(0x314)]||0x0;}}catch(_0x1f68bf){console[_0x175d5f(0x1d9)](_0x175d5f(0x18f),_0x1f68bf),showToast(_0x175d5f(0x2ad)+_0x1f68bf['message'],_0x175d5f(0x1d9));}finally{toggleSpinner(_0x5e3280,![]);}}async function loadFeedbackComments(_0x2c59c0){const _0x405b7e=_0x3098b8,_0x5123b3=$(_0x405b7e(0x34f));if(!_0x5123b3)return;_0x5123b3[_0x405b7e(0x1e1)]=_0x405b7e(0x1dc);try{const _0x2f2dc5=await db[_0x405b7e(0x2be)](_0x405b7e(0x398))['doc'](_0x2c59c0)[_0x405b7e(0x2be)]('feedback')[_0x405b7e(0x276)](_0x405b7e(0x3d5),_0x405b7e(0x3c3))['limit'](0xf)[_0x405b7e(0x2ef)]();if(_0x2f2dc5[_0x405b7e(0x37d)]){_0x5123b3[_0x405b7e(0x1e1)]=_0x405b7e(0x325);return;}_0x5123b3[_0x405b7e(0x1e1)]='',_0x2f2dc5[_0x405b7e(0x355)](_0x17cef5=>{const _0x3f33af=_0x405b7e,_0x303a09=_0x17cef5[_0x3f33af(0x306)]();let _0x211dcc='';for(let _0x38bd09=0x1;_0x38bd09<=0x5;_0x38bd09++){_0x211dcc+=_0x3f33af(0x2eb)+(_0x38bd09<=_0x303a09[_0x3f33af(0x3b8)]?'fas':_0x3f33af(0x380))+'\x20fa-star\x22></i>';}_0x5123b3[_0x3f33af(0x1e1)]+=_0x3f33af(0x286)+escapeHTML(_0x303a09[_0x3f33af(0x20f)]||_0x3f33af(0x340))+_0x3f33af(0x1e5)+_0x211dcc+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x303a09[_0x3f33af(0x3f6)]?_0x3f33af(0x3f7)+escapeHTML(_0x303a09[_0x3f33af(0x3f6)])+_0x3f33af(0x183):_0x3f33af(0x2f9))+_0x3f33af(0x195)+formatDate(_0x303a09['submittedAt'])+'\x20at\x20'+formatTime(_0x303a09['submittedAt'])+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';});}catch(_0x19ce1b){console[_0x405b7e(0x1d9)]('Error\x20loading\x20comments:',_0x19ce1b),_0x5123b3[_0x405b7e(0x1e1)]=_0x405b7e(0x18d);}}async function createNotification(_0x3684b9,_0x5cdd88,_0x54cef3,_0x17c513=_0x3098b8(0x22c),_0x886911=null,_0x572a93=null){const _0x5bece0=_0x3098b8;if(!_0x3684b9){console[_0x5bece0(0x219)](_0x5bece0(0x372));return;}try{await db[_0x5bece0(0x2be)](_0x5bece0(0x3c4))[_0x5bece0(0x3e3)](_0x3684b9)[_0x5bece0(0x2be)]('notifications')[_0x5bece0(0x2fd)]({'title':_0x5cdd88,'message':_0x54cef3,'type':_0x17c513,'timestamp':firebase[_0x5bece0(0x20a)][_0x5bece0(0x210)][_0x5bece0(0x2e1)](),'read':![],'actionLink':_0x886911,'icon':_0x572a93||getDefaultIconForType(_0x17c513)});}catch(_0x11ae1e){console[_0x5bece0(0x1d9)](_0x5bece0(0x289),_0x11ae1e);}}function getDefaultIconForType(_0x440c9a){const _0x59e5a6=_0x3098b8;switch(_0x440c9a){case'success':return _0x59e5a6(0x29e);case _0x59e5a6(0x1d9):return _0x59e5a6(0x403);case'warning':return _0x59e5a6(0x1d5);case'announcement':return _0x59e5a6(0x2d6);default:return'fas\x20fa-info-circle';}}function updateUnreadBadge(_0x21e519){const _0x5e3b0b=_0x3098b8;unreadNotificationsCount=_0x21e519;elements[_0x5e3b0b(0x343)]&&(_0x21e519>0x0?(elements['unreadNotificationsBadge'][_0x5e3b0b(0x3c2)]=_0x21e519>0x9?'9+':_0x21e519,elements['unreadNotificationsBadge'][_0x5e3b0b(0x41d)]['display']=_0x5e3b0b(0x1bc)):elements[_0x5e3b0b(0x343)][_0x5e3b0b(0x41d)][_0x5e3b0b(0x40e)]='none');if(elements[_0x5e3b0b(0x2e6)]&&elements['markAllNotificationsReadBtn']){const _0x52c1bf=elements[_0x5e3b0b(0x2e6)][_0x5e3b0b(0x317)](_0x5e3b0b(0x24e));if(_0x52c1bf){const _0x2161ef=_0x52c1bf['dataset'][_0x5e3b0b(0x18c)];_0x2161ef===_0x5e3b0b(0x3ad)?elements[_0x5e3b0b(0x278)][_0x5e3b0b(0x31f)]=unreadNotificationsCount===0x0:elements[_0x5e3b0b(0x278)][_0x5e3b0b(0x31f)]=!![];}else elements[_0x5e3b0b(0x278)][_0x5e3b0b(0x31f)]=!![];}}function setupUserNotificationsListener(){const _0x35986d=_0x3098b8;if(!currentUser||listeners[_0x35986d(0x1d1)])return;if(!elements[_0x35986d(0x3d3)]||!elements[_0x35986d(0x365)])return;renderSkeletonLoaders(elements['personalNotificationsListContainer'],0x5,_0x35986d(0x2ac)),listeners[_0x35986d(0x1d1)]=db[_0x35986d(0x2be)](_0x35986d(0x3c4))[_0x35986d(0x3e3)](currentUser[_0x35986d(0x3ba)])[_0x35986d(0x2be)](_0x35986d(0x381))['orderBy'](_0x35986d(0x310),'desc')[_0x35986d(0x2a9)](0x32)['onSnapshot'](_0x3e4aec=>{const _0x192eca=_0x35986d;let _0x2e8cd9=0x0;const _0x2ee765={};_0x3e4aec[_0x192eca(0x355)](_0x360946=>{const _0x745109=_0x192eca,_0x506009={'id':_0x360946['id'],..._0x360946[_0x745109(0x306)]()};if(!_0x506009[_0x745109(0x424)])_0x2e8cd9++;const _0x4756b5=formatRelativeDate(_0x506009[_0x745109(0x310)]);if(!_0x2ee765[_0x4756b5])_0x2ee765[_0x4756b5]=[];_0x2ee765[_0x4756b5][_0x745109(0x1fc)](_0x506009);}),updateUnreadBadge(_0x2e8cd9),elements[_0x192eca(0x3d3)][_0x192eca(0x1e1)]='';if(_0x3e4aec[_0x192eca(0x37d)])elements[_0x192eca(0x365)]['style'][_0x192eca(0x40e)]=_0x192eca(0x1bc);else{elements[_0x192eca(0x365)]['style'][_0x192eca(0x40e)]=_0x192eca(0x1d8);const _0x1aea66=Object[_0x192eca(0x359)](_0x2ee765)[_0x192eca(0x1a6)]((_0x2e520d,_0x39a6e9)=>{const _0x482403=_0x192eca,_0x4e12d4=_0x2e520d===_0x482403(0x21d)?new Date():_0x2e520d===_0x482403(0x20c)?new Date(Date['now']()-0x5265c00):new Date(_0x2e520d),_0x5ea246=_0x39a6e9===_0x482403(0x21d)?new Date():_0x39a6e9===_0x482403(0x20c)?new Date(Date[_0x482403(0x193)]()-0x5265c00):new Date(_0x39a6e9);return _0x5ea246-_0x4e12d4;});_0x1aea66[_0x192eca(0x355)](_0x33cc86=>{const _0x5d4a5f=_0x192eca,_0x97234d=document[_0x5d4a5f(0x301)](_0x5d4a5f(0x229));_0x97234d[_0x5d4a5f(0x1f6)]=_0x5d4a5f(0x21a),_0x97234d[_0x5d4a5f(0x1e1)]=_0x5d4a5f(0x24c)+escapeHTML(_0x33cc86)+'</h3>',_0x2ee765[_0x33cc86][_0x5d4a5f(0x355)](_0x20fe32=>{const _0x52f116=_0x5d4a5f;_0x97234d[_0x52f116(0x1e1)]+=createNotificationItemHTML(_0x20fe32);}),elements['personalNotificationsListContainer'][_0x5d4a5f(0x2d8)](_0x97234d);});}AOS[_0x192eca(0x34b)]();},_0x88f816=>{const _0x14ae40=_0x35986d;console[_0x14ae40(0x1d9)]('Error\x20fetching\x20notifications:',_0x88f816),showToast(_0x14ae40(0x285),_0x14ae40(0x1d9)),elements['personalNotificationsListContainer'][_0x14ae40(0x1e1)]='',elements['emptyPersonalNotificationsState'][_0x14ae40(0x41d)]['display']=_0x14ae40(0x1bc);});}function setupAdminAnnouncementsListener(){const _0x46a24f=_0x3098b8;if(listeners[_0x46a24f(0x35e)])listeners['adminAnnouncements']();if(!elements[_0x46a24f(0x303)]||!elements[_0x46a24f(0x277)])return;renderSkeletonLoaders(elements[_0x46a24f(0x303)],0x3,_0x46a24f(0x2ac)),listeners[_0x46a24f(0x35e)]=db[_0x46a24f(0x2be)](_0x46a24f(0x35e))[_0x46a24f(0x276)](_0x46a24f(0x310),_0x46a24f(0x3c3))[_0x46a24f(0x2a9)](0x14)[_0x46a24f(0x240)](_0x27dc11=>{const _0x3c8e12=_0x46a24f,_0x543c7d={};_0x27dc11[_0x3c8e12(0x355)](_0x242748=>{const _0xae4af7=_0x3c8e12,_0x180ff5={'id':_0x242748['id'],..._0x242748[_0xae4af7(0x306)](),'type':'announcement'},_0x5a4a73=formatRelativeDate(_0x180ff5[_0xae4af7(0x310)]);if(!_0x543c7d[_0x5a4a73])_0x543c7d[_0x5a4a73]=[];_0x543c7d[_0x5a4a73]['push'](_0x180ff5);}),elements[_0x3c8e12(0x303)][_0x3c8e12(0x1e1)]='';if(_0x27dc11[_0x3c8e12(0x37d)])elements[_0x3c8e12(0x277)]['style']['display']=_0x3c8e12(0x1bc);else{elements[_0x3c8e12(0x277)][_0x3c8e12(0x41d)][_0x3c8e12(0x40e)]=_0x3c8e12(0x1d8);const _0x2a7476=Object[_0x3c8e12(0x359)](_0x543c7d)[_0x3c8e12(0x1a6)]((_0x62e1b0,_0x1498b9)=>{const _0x3906a3=_0x3c8e12,_0x126842=_0x62e1b0===_0x3906a3(0x21d)?new Date():_0x62e1b0===_0x3906a3(0x20c)?new Date(Date[_0x3906a3(0x193)]()-0x5265c00):new Date(_0x62e1b0),_0x2d0425=_0x1498b9===_0x3906a3(0x21d)?new Date():_0x1498b9===_0x3906a3(0x20c)?new Date(Date[_0x3906a3(0x193)]()-0x5265c00):new Date(_0x1498b9);return _0x2d0425-_0x126842;});_0x2a7476[_0x3c8e12(0x355)](_0x3caaac=>{const _0x5c4f71=_0x3c8e12,_0x178d6d=document[_0x5c4f71(0x301)](_0x5c4f71(0x229));_0x178d6d['className']=_0x5c4f71(0x21a),_0x178d6d[_0x5c4f71(0x1e1)]=_0x5c4f71(0x24c)+escapeHTML(_0x3caaac)+_0x5c4f71(0x41e),_0x543c7d[_0x3caaac][_0x5c4f71(0x355)](_0x286986=>{const _0x593efc=_0x5c4f71;_0x178d6d[_0x593efc(0x1e1)]+=createNotificationItemHTML(_0x286986);}),elements['adminAnnouncementsListContainer'][_0x5c4f71(0x2d8)](_0x178d6d);});}AOS['refreshHard']();},_0x33503e=>{const _0x353c08=_0x46a24f;console['error']('Error\x20fetching\x20admin\x20announcements:',_0x33503e),showToast(_0x353c08(0x18a),'error'),elements[_0x353c08(0x303)]['innerHTML']='',elements[_0x353c08(0x277)][_0x353c08(0x41d)][_0x353c08(0x40e)]=_0x353c08(0x1bc);});}function createNotificationItemHTML(_0x3ba1e9){const _0x4343fa=_0x3098b8;let _0x55c241='';if(_0x3ba1e9[_0x4343fa(0x217)]){if(_0x3ba1e9[_0x4343fa(0x217)][_0x4343fa(0x337)]('/#'))_0x55c241=window['location'][_0x4343fa(0x27d)]+window['location'][_0x4343fa(0x339)]+_0x3ba1e9[_0x4343fa(0x217)][_0x4343fa(0x3f3)](0x1);else _0x3ba1e9['actionLink'][_0x4343fa(0x337)](_0x4343fa(0x1f3))&&(_0x55c241=_0x3ba1e9[_0x4343fa(0x217)]);}return _0x4343fa(0x354)+(_0x3ba1e9[_0x4343fa(0x424)]?'':_0x4343fa(0x3f0))+_0x4343fa(0x3cb)+_0x3ba1e9['type']+_0x4343fa(0x32e)+_0x3ba1e9['id']+'\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20data-action-link=\x22'+escapeHTML(_0x55c241||'')+_0x4343fa(0x258)+escapeHTML(_0x3ba1e9['actionLink']&&_0x3ba1e9['actionLink'][_0x4343fa(0x337)]('/#')?_0x3ba1e9[_0x4343fa(0x217)]:'')+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22notification-icon\x22><i\x20class=\x22'+escapeHTML(_0x3ba1e9['icon']||getDefaultIconForType(_0x3ba1e9['type']))+_0x4343fa(0x27a)+escapeHTML(_0x3ba1e9[_0x4343fa(0x414)])+'</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22notification-message\x22>'+escapeHTML(_0x3ba1e9[_0x4343fa(0x1ac)])+_0x4343fa(0x402)+formatTime(_0x3ba1e9[_0x4343fa(0x310)])+_0x4343fa(0x20d);}[elements[_0x3098b8(0x3d3)],elements[_0x3098b8(0x303)]]['forEach'](_0x5d5bb5=>{const _0x257026=_0x3098b8;_0x5d5bb5&&_0x5d5bb5[_0x257026(0x261)](_0x257026(0x1ce),async _0x306cf0=>{const _0x46b06b=_0x257026,_0x57e2d4=_0x306cf0[_0x46b06b(0x30a)][_0x46b06b(0x259)](_0x46b06b(0x1d3));if(!_0x57e2d4||!_0x57e2d4[_0x46b06b(0x360)]['id'])return;if(!currentUser){openModal(elements[_0x46b06b(0x3cd)]);return;}const _0x215058=_0x57e2d4[_0x46b06b(0x360)]['id'],_0x23d9d8=_0x57e2d4[_0x46b06b(0x360)][_0x46b06b(0x217)],_0x180ff4=_0x57e2d4[_0x46b06b(0x360)][_0x46b06b(0x266)];if(_0x5d5bb5===elements[_0x46b06b(0x3d3)]&&_0x57e2d4[_0x46b06b(0x425)][_0x46b06b(0x187)](_0x46b06b(0x3f0)))try{await db[_0x46b06b(0x2be)]('users')[_0x46b06b(0x3e3)](currentUser['uid'])[_0x46b06b(0x2be)](_0x46b06b(0x381))[_0x46b06b(0x3e3)](_0x215058)[_0x46b06b(0x1fa)]({'read':!![]});}catch(_0x21f9a7){console[_0x46b06b(0x1d9)](_0x46b06b(0x25e),_0x21f9a7);}if(_0x180ff4&&_0x180ff4[_0x46b06b(0x337)](_0x46b06b(0x3d2))){const _0x2bc421=_0x180ff4['split']('/')[0x2];closePage(elements[_0x46b06b(0x29a)]),activateNavItem(elements[_0x46b06b(0x2c4)]),openBookDetailModal(_0x2bc421);}else _0x23d9d8&&_0x23d9d8[_0x46b06b(0x337)]('http')&&window[_0x46b06b(0x1e9)](_0x23d9d8,_0x46b06b(0x211));});});elements[_0x3098b8(0x278)]&&elements[_0x3098b8(0x278)][_0x3098b8(0x261)](_0x3098b8(0x1ce),async()=>{const _0x32ed31=_0x3098b8;if(!currentUser||unreadNotificationsCount===0x0)return;const _0x39cdde=elements[_0x32ed31(0x2e6)]['querySelector'](_0x32ed31(0x24e));if(!_0x39cdde||_0x39cdde[_0x32ed31(0x360)]['tab']!=='personal')return;toggleSpinner(elements[_0x32ed31(0x278)],!![]);try{const _0x10862c=db['batch'](),_0x2b4ef0=await db['collection'](_0x32ed31(0x3c4))[_0x32ed31(0x3e3)](currentUser[_0x32ed31(0x3ba)])[_0x32ed31(0x2be)](_0x32ed31(0x381))[_0x32ed31(0x395)](_0x32ed31(0x424),'==',![])['get']();_0x2b4ef0['forEach'](_0x12dc86=>{const _0x3626db=_0x32ed31;_0x10862c[_0x3626db(0x1fa)](_0x12dc86['ref'],{'read':!![]});}),await _0x10862c['commit'](),showToast(_0x32ed31(0x313),'success');}catch(_0xa3d65e){console[_0x32ed31(0x1d9)](_0x32ed31(0x1d7),_0xa3d65e),showToast(_0x32ed31(0x21f),_0x32ed31(0x1d9));}finally{toggleSpinner(elements['markAllNotificationsReadBtn'],![]);}});elements['notificationTabsContainer']&&elements['notificationTabsContainer'][_0x3098b8(0x261)]('click',_0x36f7fb=>{const _0x450731=_0x3098b8,_0x5bbd6a=_0x36f7fb[_0x450731(0x30a)][_0x450731(0x259)](_0x450731(0x406));if(!_0x5bbd6a)return;elements[_0x450731(0x274)]['forEach'](_0xa207fd=>_0xa207fd[_0x450731(0x425)][_0x450731(0x2a5)](_0x450731(0x37e))),_0x5bbd6a[_0x450731(0x425)][_0x450731(0x2fd)](_0x450731(0x37e));const _0x157143=_0x5bbd6a[_0x450731(0x360)]['tab'];if(elements[_0x450731(0x3d3)])elements[_0x450731(0x3d3)][_0x450731(0x425)][_0x450731(0x1b8)]('active',_0x157143===_0x450731(0x3ad));if(elements[_0x450731(0x303)])elements[_0x450731(0x303)][_0x450731(0x425)][_0x450731(0x1b8)](_0x450731(0x37e),_0x157143===_0x450731(0x26a));if(_0x157143===_0x450731(0x3ad)){if(elements[_0x450731(0x278)])elements[_0x450731(0x278)][_0x450731(0x31f)]=unreadNotificationsCount===0x0;}else{if(elements[_0x450731(0x278)])elements[_0x450731(0x278)]['disabled']=!![];}AOS[_0x450731(0x16a)]();});window[_0x3098b8(0x261)](_0x3098b8(0x26d),()=>{const _0x47961=_0x3098b8;if(window['scrollY']>0x32&&elements['header'])elements[_0x47961(0x315)][_0x47961(0x425)][_0x47961(0x2fd)](_0x47961(0x336));else{if(elements[_0x47961(0x315)])elements[_0x47961(0x315)][_0x47961(0x425)][_0x47961(0x2a5)](_0x47961(0x336));}elements['homeBtn']&&elements[_0x47961(0x2c4)][_0x47961(0x425)]['contains'](_0x47961(0x37e))&&window[_0x47961(0x308)]+window[_0x47961(0x256)]>=document[_0x47961(0x191)]['offsetHeight']-0x12c&&!isLoadingBooksMain&&hasMoreBooksMain&&currentUser&&fetchBooksMain(!![]);});elements[_0x3098b8(0x408)]&&elements['searchToggleBtn'][_0x3098b8(0x261)](_0x3098b8(0x1ce),_0x475b93=>{const _0x4a08c5=_0x3098b8;_0x475b93[_0x4a08c5(0x198)]();if(elements[_0x4a08c5(0x3a1)])elements[_0x4a08c5(0x3a1)][_0x4a08c5(0x425)][_0x4a08c5(0x1b8)](_0x4a08c5(0x37e));if(elements[_0x4a08c5(0x3a1)]&&elements[_0x4a08c5(0x3a1)][_0x4a08c5(0x425)]['contains']('active')&&elements['searchInput'])elements[_0x4a08c5(0x2c5)][_0x4a08c5(0x208)]();});function handleSearchInput(){const _0x1998e0=_0x3098b8;if(!elements[_0x1998e0(0x2c5)]||!elements[_0x1998e0(0x41a)])return;const _0x5676a1=elements[_0x1998e0(0x2c5)][_0x1998e0(0x40a)][_0x1998e0(0x3cc)]()[_0x1998e0(0x161)]();if(_0x5676a1[_0x1998e0(0x3c7)]<0x2){elements[_0x1998e0(0x41a)][_0x1998e0(0x41d)][_0x1998e0(0x40e)]=_0x1998e0(0x1d8);return;}const _0x599880=allBooksCache[_0x1998e0(0x2a8)](_0x2b9843=>_0x2b9843[_0x1998e0(0x347)]['toLowerCase']()['includes'](_0x5676a1)||_0x2b9843[_0x1998e0(0x413)][_0x1998e0(0x3cc)]()[_0x1998e0(0x3dd)](_0x5676a1)||_0x2b9843[_0x1998e0(0x2f8)]&&_0x2b9843[_0x1998e0(0x2f8)][_0x1998e0(0x3cc)]()[_0x1998e0(0x3dd)](_0x5676a1))[_0x1998e0(0x29f)](0x0,0xa);renderSearchResults(_0x599880,elements[_0x1998e0(0x41a)]);}let searchTimeoutGlobal;elements['searchInput']&&(elements[_0x3098b8(0x2c5)][_0x3098b8(0x261)](_0x3098b8(0x2e9),()=>{clearTimeout(searchTimeoutGlobal),searchTimeoutGlobal=setTimeout(handleSearchInput,0x12c);}),elements[_0x3098b8(0x2c5)][_0x3098b8(0x261)](_0x3098b8(0x208),handleSearchInput));function renderSearchResults(_0x3eb5be,_0x4e5b70){const _0x408cb=_0x3098b8;if(!_0x4e5b70)return;if(_0x3eb5be[_0x408cb(0x3c7)]===0x0){_0x4e5b70[_0x408cb(0x1e1)]=_0x408cb(0x241),_0x4e5b70[_0x408cb(0x41d)][_0x408cb(0x40e)]=_0x408cb(0x2fc);return;}_0x4e5b70[_0x408cb(0x1e1)]=_0x3eb5be['map'](_0x2bdc64=>_0x408cb(0x38e)+_0x2bdc64['id']+_0x408cb(0x19f)+escapeHTML(_0x2bdc64[_0x408cb(0x347)])+_0x408cb(0x3af)+escapeHTML(_0x2bdc64[_0x408cb(0x413)])+_0x408cb(0x25c)+escapeHTML(_0x2bdc64[_0x408cb(0x2f8)]||_0x408cb(0x3b1))+_0x408cb(0x420))[_0x408cb(0x170)](''),_0x4e5b70[_0x408cb(0x41d)][_0x408cb(0x40e)]=_0x408cb(0x2fc);}elements[_0x3098b8(0x41a)]&&elements[_0x3098b8(0x41a)][_0x3098b8(0x261)](_0x3098b8(0x1ce),_0x19c76e=>{const _0x10f8bd=_0x3098b8,_0x5b0e62=_0x19c76e[_0x10f8bd(0x30a)][_0x10f8bd(0x259)](_0x10f8bd(0x429));if(_0x5b0e62&&_0x5b0e62[_0x10f8bd(0x360)][_0x10f8bd(0x1b5)]){if(!currentUser){openModal(elements[_0x10f8bd(0x3cd)]);return;}openBookDetailModal(_0x5b0e62[_0x10f8bd(0x360)][_0x10f8bd(0x1b5)]),elements[_0x10f8bd(0x41a)][_0x10f8bd(0x41d)][_0x10f8bd(0x40e)]='none';if(elements[_0x10f8bd(0x2c5)])elements['searchInput'][_0x10f8bd(0x40a)]='';elements[_0x10f8bd(0x3a1)]&&elements['searchContainer'][_0x10f8bd(0x425)]['contains'](_0x10f8bd(0x37e))&&window['innerWidth']<=0x300&&elements[_0x10f8bd(0x3a1)][_0x10f8bd(0x425)]['remove'](_0x10f8bd(0x37e));}});document[_0x3098b8(0x261)]('click',_0x455f3d=>{const _0x1abb17=_0x3098b8;elements[_0x1abb17(0x3a1)]&&elements[_0x1abb17(0x3a1)][_0x1abb17(0x425)][_0x1abb17(0x187)](_0x1abb17(0x37e))&&window[_0x1abb17(0x184)]<=0x300&&!elements[_0x1abb17(0x3a1)][_0x1abb17(0x187)](_0x455f3d['target'])&&_0x455f3d[_0x1abb17(0x30a)]!==elements['searchToggleBtn']&&elements[_0x1abb17(0x3a1)][_0x1abb17(0x425)][_0x1abb17(0x2a5)]('active'),elements['searchContainer']&&!elements[_0x1abb17(0x3a1)]['contains'](_0x455f3d['target'])&&elements[_0x1abb17(0x41a)]&&(elements[_0x1abb17(0x41a)][_0x1abb17(0x41d)][_0x1abb17(0x40e)]=_0x1abb17(0x1d8));});function openPage(_0x599b3a){const _0xaad854=_0x3098b8;if(!_0x599b3a)return;_0x599b3a['classList'][_0xaad854(0x2fd)]('active'),elements[_0xaad854(0x191)][_0xaad854(0x41d)][_0xaad854(0x19a)]=_0xaad854(0x36b),AOS['refresh']();if(_0x599b3a===elements[_0xaad854(0x283)]){if(currentUser){fetchUserBooks(![],!![]),fetchWithdrawalHistory();if(elements['profileTabs']){const _0x1a6a35=elements['profileTabs'][_0xaad854(0x317)](_0xaad854(0x2cb));if(_0x1a6a35){const _0x4b3178=_0xaad854(0x3dc)+_0x1a6a35[_0xaad854(0x360)][_0xaad854(0x18c)];elements[_0xaad854(0x228)][_0xaad854(0x355)](_0x4a1c5e=>_0x4a1c5e[_0xaad854(0x425)][_0xaad854(0x2a5)](_0xaad854(0x37e))),elements[_0xaad854(0x2d3)][_0xaad854(0x355)](_0x5211bc=>_0x5211bc['classList'][_0xaad854(0x2a5)](_0xaad854(0x37e))),_0x1a6a35[_0xaad854(0x425)][_0xaad854(0x2fd)](_0xaad854(0x37e));const _0x3feeb4=$('#'+_0x4b3178);if(_0x3feeb4)_0x3feeb4[_0xaad854(0x425)]['add'](_0xaad854(0x37e));}}}else closePage(elements[_0xaad854(0x283)]),openModal(elements[_0xaad854(0x3cd)]);}else{if(_0x599b3a===elements[_0xaad854(0x29a)]){if(currentUser){if(elements[_0xaad854(0x2e6)]&&elements['personalNotificationsListContainer']&&elements[_0xaad854(0x303)]){elements[_0xaad854(0x274)][_0xaad854(0x355)](_0x4882af=>_0x4882af[_0xaad854(0x425)][_0xaad854(0x2a5)](_0xaad854(0x37e))),elements[_0xaad854(0x3d3)][_0xaad854(0x425)][_0xaad854(0x2a5)](_0xaad854(0x37e)),elements[_0xaad854(0x303)][_0xaad854(0x425)]['remove'](_0xaad854(0x37e));const _0x588817=elements[_0xaad854(0x2e6)][_0xaad854(0x317)](_0xaad854(0x383));if(_0x588817)_0x588817[_0xaad854(0x425)][_0xaad854(0x2fd)](_0xaad854(0x37e));elements[_0xaad854(0x3d3)][_0xaad854(0x425)][_0xaad854(0x2fd)]('active');if(elements[_0xaad854(0x278)])elements[_0xaad854(0x278)]['disabled']=unreadNotificationsCount===0x0;}}else closePage(elements[_0xaad854(0x29a)]),openModal(elements[_0xaad854(0x3cd)]);}}}function _0x5ab5(_0x1bb7ea,_0x2cdb85){const _0x55e09b=_0x55e0();return _0x5ab5=function(_0x5ab5e4,_0x56b3d2){_0x5ab5e4=_0x5ab5e4-0x15d;let _0x20cf36=_0x55e09b[_0x5ab5e4];return _0x20cf36;},_0x5ab5(_0x1bb7ea,_0x2cdb85);}function closePage(_0x48287f){const _0x194481=_0x3098b8;if(!_0x48287f)return;_0x48287f[_0x194481(0x425)][_0x194481(0x2a5)](_0x194481(0x37e));const _0x444b60=$$('.modal.active')[_0x194481(0x3c7)]>0x0,_0x37f519=$$(_0x194481(0x31b))[_0x194481(0x3c7)]>0x0;!_0x444b60&&!_0x37f519&&(elements[_0x194481(0x191)][_0x194481(0x41d)][_0x194481(0x19a)]='auto');}function openProfilePage(){const _0x2514c3=_0x3098b8;currentUser?(activateNavItem(elements['profileBtn']),openPage(elements['profilePage'])):openModal(elements[_0x2514c3(0x3cd)]);}function closeProfilePage(){const _0x43b728=_0x3098b8;if(elements['profilePage'])closePage(elements[_0x43b728(0x283)]);if(elements['homeBtn'])activateNavItem(elements[_0x43b728(0x2c4)]);}function openNotificationsPage(){const _0x26d134=_0x3098b8;currentUser?(activateNavItem(elements[_0x26d134(0x1bb)]),openPage(elements[_0x26d134(0x29a)])):openModal(elements[_0x26d134(0x3cd)]);}function closeNotificationsPage(){const _0x4a3d28=_0x3098b8;if(elements['notificationsPage'])closePage(elements[_0x4a3d28(0x29a)]);if(elements[_0x4a3d28(0x2c4)])activateNavItem(elements[_0x4a3d28(0x2c4)]);}function activateNavItem(_0x400668){const _0x37011d=_0x3098b8;if(!_0x400668)return;elements[_0x37011d(0x2f5)][_0x37011d(0x355)](_0x5cc010=>_0x5cc010['classList'][_0x37011d(0x2a5)](_0x37011d(0x37e))),_0x400668[_0x37011d(0x425)]['add']('active');}function resetNavigation(){const _0x3597f5=_0x3098b8;if(elements[_0x3597f5(0x2c4)])activateNavItem(elements[_0x3597f5(0x2c4)]);}function closeAllPagesAndModals(){const _0xf56c7e=_0x3098b8;if(elements[_0xf56c7e(0x283)])closePage(elements[_0xf56c7e(0x283)]);if(elements['notificationsPage'])closePage(elements['notificationsPage']);$$(_0xf56c7e(0x3ae))[_0xf56c7e(0x355)](_0x53dadd=>closeModal(_0x53dadd));const _0x1b7540=$$('.modal.active')[_0xf56c7e(0x3c7)]>0x0,_0x12c941=$$(_0xf56c7e(0x31b))['length']>0x0;!_0x1b7540&&!_0x12c941&&(elements[_0xf56c7e(0x191)][_0xf56c7e(0x41d)]['overflow']=_0xf56c7e(0x251)),currentBookDetailId=null;}if(elements[_0x3098b8(0x2c4)])elements['homeBtn'][_0x3098b8(0x32d)]=()=>{const _0x32c28e=_0x3098b8;closeAllPagesAndModals(),activateNavItem(elements[_0x32c28e(0x2c4)]),window[_0x32c28e(0x2b1)]({'top':0x0,'behavior':'smooth'});};if(elements['logoLink'])elements[_0x3098b8(0x38b)]['onclick']=_0x2509aa=>{const _0x469b82=_0x3098b8;_0x2509aa[_0x469b82(0x2a6)]();if(elements[_0x469b82(0x2c4)])elements['homeBtn'][_0x469b82(0x1ce)]();};if(elements[_0x3098b8(0x1bb)])elements[_0x3098b8(0x1bb)][_0x3098b8(0x32d)]=openNotificationsPage;function _0x55e0(){const _0x2b5aed=['2-digit','Please\x20login\x20to\x20submit\x20feedback.','profileBioLarge','Other','<div\x20class=\x22empty-state\x22\x20style=\x22padding:20px\x200;min-height:150px;width:100%;text-align:center;\x22><i\x20class=\x22fas\x20fa-lock\x22></i><p\x20style=\x22font-size:0.9rem;\x22>Login\x20to\x20see\x20popular\x20books.</p></div>','This\x20email\x20address\x20is\x20already\x20in\x20use.','#bookDescription','<h3\x20class=\x22notification-group-date\x22>','#profileAvatarLarge','.notification-tab-btn.active','#addBookForm','charAt','auto','loading','35IMizil','set','fas\x20fa-hand-sparkles','scrollY','Need\x20','\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20data-internal-route=\x22','closest','Connecting\x20to\x20the\x20Grid...','#editProfileUsername','\x20|\x20Category:\x20','s\x22\x20data-aos=\x22fade-up\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-img-container\x22\x20data-action=\x22view\x22\x20data-book-id=\x22','Error\x20marking\x20notification\x20as\x20read:','#closeEditProfileModal','Loading\x20bio...','addEventListener','#profileNameLarge','Please\x20login\x20to\x20edit\x20your\x20profile.','#editProfileForm','getItem','internalRoute','You\x20received\x20+10\x20points\x20for\x20sharing\x20\x22','pointsWithdrawn','booksGridLoadingIndicator','announcements','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-status\x20status-','\x22\x20was\x20downloaded!\x20+1\x20point.','scroll','closeAddBookModal','Enter\x20registered\x20mobile\x20number','Error\x20fetching\x20books\x20for\x20main\x20grid:','Loading\x20EduSparK\x20Library...','warning','totalFeedbackGiven','notificationTabBtns','<i\x20class=\x22fas\x20fa-calendar-alt\x22></i>\x20Joined:\x20-','orderBy','emptyAdminAnnouncementsState','markAllNotificationsReadBtn','\x22\x20alt=\x22','\x22></i></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22notification-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4\x20class=\x22notification-title\x22>','@loading','test','origin','#bookDetailModal\x20[data-action=\x22download\x22][data-book-id=\x22','userAvatar','\x20pts.\x20Your\x20balance:\x20','eduspark-new.firebaseapp.com','Your\x20feedback\x20for\x20\x22','profilePage','\x20credits.\x20Opening\x20download...','Could\x20not\x20load\x20notifications.','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-author\x22>','withdrawalModalPoints','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Error\x20creating\x20notification:','<div\x20class=\x22skeleton-notification-item\x22><div\x20class=\x22skeleton-icon\x22></div><div\x20class=\x22skeleton-content\x22><div\x20class=\x22skeleton-text\x20title\x22></div><div\x20class=\x22skeleton-text\x20message\x22></div><div\x20class=\x22skeleton-text\x20timestamp\x22></div></div></div>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-date\x22>Requested:\x20','addBookBtn','popularBooks','name','User\x20not\x20found.','.category-filter-item','#feedbackStars\x20i','string','book:','startAfter','#editProfileBio','emptyStateBooks','11th','&gt;','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','notificationsPage','fas\x20fa-user-check','Anon','\x20<i\x20class=\x22fas\x20fa-coins\x22\x20style=\x22color:var(--credit-color);font-size:0.8em;\x22></i>','fas\x20fa-check-circle','slice','signInWithEmailAndPassword','#closeLoginModal','Your\x20request\x20to\x20withdraw\x20','Account\x20Number\x20*','#withdrawalModal\x20.withdrawal-option,\x20#withdrawalModal\x20.amount-option','remove','preventDefault','121SwehfC','filter','limit','Failed\x20to\x20submit\x20book:\x20','opacity','notification','Failed\x20to\x20submit\x20feedback.\x20','106109WEsRAa','Please\x20login\x20to\x20browse\x20categories.','#adminAnnouncementsListContainer','scrollTo','discoverBtn','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22spinner\x22\x20style=\x22display:\x20none;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-eye\x22></i>\x20View\x20Details</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22book-author\x22>By\x20','amount','<span\x20class=\x22status-badge\x20status-rejected\x22>Rejected</span>','890655ooDjOw','booksDownloadedCount','Insufficient\x20points.\x20Please\x20refresh.','.book-detail-meta\x20span:nth-child(3)','editProfileForm','https://via.placeholder.com/300x220/333/888?text=No+Cover','logged-in','collection','auth','Search\x20functionality\x20might\x20be\x20limited\x20due\x20to\x20a\x20network\x20error.','emptyWithdrawalHistory','closeCreditModal','#editProfileName','homeBtn','searchInput','#loadingMessage','random','Invalid\x20Time','.modal','Withdrawal\x20request\x20submitted\x20successfully!','.profile-tab-btn','Could\x20not\x20update\x20last\x20active\x20time\x20(might\x20be\x20new\x20user):','numeric','#emptyAdminAnnouncementsState','Logged\x20out\x20successfully.','.notifications-tabs','Not\x20logged\x20in.','\x20Number\x20*','profileTabContents','User\x20data\x20not\x20found.\x20Please\x20try\x20again.','#withdrawalModalPoints','fas\x20fa-bullhorn','10th','appendChild','reviewedAt','#editProfileModal','<i\x20class=\x22fas\x20fa-star\x22\x20style=\x22color:var(--star-color);\x22></i>\x20','#booksDownloadedLarge','Approved\x20','bookApproval','inline-flex','#withdrawalModal','serverTimestamp',')</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-method\x22>Method:\x20','map','exists','\x22\x20class=\x22book-img\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.onerror=null;this.src=\x27','notificationTabsContainer','profileUsernameLarge','Hello\x20World!','input','Anonymous','<i\x20class=\x22','<p\x20class=\x22book-detail-description\x22>No\x20description\x20available\x20for\x20this\x20book.</p>','docChanges','status','get','username','conductSurveyBtn','#signupPassword','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Error\x20during\x20download\x20transaction:','bottomNavItems','bank','.\x20Earn\x20more\x20or\x20claim\x20daily\x20bonus!','category','<p\x20class=\x22comment-body\x22\x20style=\x22opacity:0.7;\x22><em>No\x20comment\x20text.</em></p>','#notificationsPage','Not\x20specified','block','add','upi','fas\x20fa-external-link-alt','totalBookDownloadsLarge','createElement','profileBackBtn','adminAnnouncementsListContainer','bookDetailContent','#loginEmail','data','rejectionReason','innerHeight','signupModal','target','Error\x20activating\x20Firebase\x20App\x20Check:','#signupUsername','\x22\x20class=\x22popular-book-img\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.onerror=null;this.src=\x27','Error\x20processing\x20book\x20approval/rejection\x20for\x20user:','booksSharedLarge','timestamp','signupForm','Non-Fiction','All\x20personal\x20notifications\x20marked\x20as\x20read.','downloads','header','795252IcgeRm','querySelector','Username:\x203-15\x20chars,\x20lowercase,\x20numbers,\x20\x27_\x27,\x20\x27.\x27','#searchContainer','switchToLogin','.profile-page.active,\x20.notifications-page.active','All','#emptyWithdrawalHistory','#closeWithdrawalModal','disabled','#submitFeedbackBtn','</div>','#withdrawalHistoryContainer','feedback','#feedbackComment','<div\x20class=\x22no-comments\x22\x20style=\x22padding:\x2020px\x200;\x22>Be\x20the\x20first\x20to\x20leave\x20feedback\x20for\x20this\x20book!</div>','#withdrawalForm','categoryFilterContainer','#notificationsBackBtn','signOut','\x20on\x20','Please\x20try\x20again.','modified','onclick','\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20data-id=\x22','toast\x20','.book-card[data-id=\x22','headerCreditsAmount','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-detail-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-download\x22></i>\x20<span\x20id=\x22detailDownloadCount\x22>','paymentDetails','Book\x20Downloaded','amountRs','scrolled','startsWith','</span>\x20Downloads</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-user\x22></i>\x20Shared\x20by\x20','pathname','<div\x20class=\x22skeleton-popular-book\x22><div\x20class=\x22skeleton-img\x22></div><div\x20class=\x22skeleton-info\x22><div\x20class=\x22skeleton-text\x20title\x22></div><div\x20class=\x22skeleton-text\x20meta\x22></div></div></div>','G-NM2SE3DE7J','fetchSignInMethodsForEmail','Could\x20not\x20load\x20books.\x20Please\x20check\x20your\x20connection.','Redirecting\x20to\x20earn\x20credits...','email','User','main','<i\x20class=\x22fas\x20fa-search-minus\x22></i><h3>No\x20Books\x20Found</h3><p>No\x20books\x20match\x20the\x20category\x20\x27','unreadNotificationsBadge','profileBtn','amountOptionsContainer','#accountName','bookName','addBookModal','#loginBtn','Withdrawal\x20Request\x20Submitted','refreshHard','paymentIdInput','#paymentDetails','parentElement','#commentsList','log','#booksContainer','openBookDetailModal\x20called\x20without\x20bookId','approved','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22notification-item\x20','forEach','closeBookDetailModal','<div\x20class=\x22withdrawal-date\x22\x20style=\x22font-style:italic;\x22>Processed:\x20','#loginPassword','keys','fas','description','fas\x20fa-comment-dots','#detailDownloadCount','adminAnnouncements','Profile\x20Updated','dataset','withdrawalOptionsContainer','#headerCreditsContainer','\x22\x20data-category=\x22','phonepe','emptyPersonalNotificationsState','ratingCount','https://via.placeholder.com/160x200/333/888?text=No+Cover','No\x20email','<span\x20class=\x22status-badge\x20status-pending\x22>Pending</span>','creditModalUserCredits','hidden','selected','editProfileModal','Please\x20fill\x20all\x20required\x20payment\x20details.','paymentIdentifier','<div\x20class=\x22book-admin-info\x22><i\x20class=\x22fas\x20fa-user-shield\x22></i>\x20','withdrawalForm','createNotification\x20called\x20without\x20userId','Unpacking\x20Knowledge...','1:564501033350:web:70c0f9873f96e9bd74fc07','logged-out',',\x20have\x20','createUserWithEmailAndPassword','fas\x20fa-gift','avatarInitials','Book\x20not\x20found\x20during\x20transaction.','Fiction','<i\x20class=\x22fas\x20fa-envelope\x22></i>\x20','empty','active','#discoverBtn','far','notifications','JEE','[data-tab=\x22personal\x22]','#profileBooksContainer','addBookForm','parse','Computer\x20Science','#logoutBtn','UPI\x20ID\x20*','Welcome\x20to\x20EduSparK!\x20Your\x20profile\x20is\x20set\x20up.','logoLink','Brewing\x20Fresh\x20Ideas...','\x20daily\x20credits.\x20Come\x20back\x20tomorrow!','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22search-result-item\x22\x20data-book-id=\x22','paytm','.rejection','reset','Uncategorized','closeEditProfileModal','Could\x20not\x20load\x20popular\x20books.','where','toFixed','Your\x20profile\x20details\x20have\x20been\x20successfully\x20changed.','books','withdrawals','toLocaleTimeString','Logged\x20in\x20successfully!','#closeDiscoverModal','#withdrawalModal\x20.withdrawal-option','Anonymous\x20User','Error\x20fetching\x20all\x20books\x20for\x20search:','.bottom-nav\x20.nav-item','searchContainer','\x22\x20onerror=\x22this.onerror=null;this.src=\x27','Failed\x20to\x20load\x20book\x20details.','<div\x20class=\x22withdrawal-date\x22\x20style=\x22color:var(--primary-light);\x22>Note:\x20','Free\x20-\x20Your\x20Book','profileJoinedLarge','popularBooksCarousel','Error\x20fetching\x20user\x20books:','profileBooksContainer','toUpperCase','s\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popular-book-img-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','.header','personal','.modal.active','</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>By\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-detail-layout\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-detail-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','N/A','metadata','fas\x20fa-info-circle','#profileBioLarge','https://linkcents.com/50-Credit-books','driveLink','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22category-filter-item\x20','rating','withdrawalModal','uid','avgRating','profileAvatarInitialsLarge','.action-btn[data-action=\x22view\x22],\x20.popular-book-card[data-action=\x22view\x22],\x20.book-img-container[data-action=\x22view\x22]','action','closeDiscoverModal','EduSparK\x20enthusiast!','No\x20bio\x20set.\x20Click\x20Edit\x20Profile\x20to\x20add\x20one!','textContent','desc','users','#conductSurveyBtn','\x20points\x20(','length','.profile-tab-content','withdrawalHistoryContainer','<div\x20class=\x22skeleton-book-card\x22><div\x20class=\x22skeleton-img\x22></div><div\x20class=\x22skeleton-info\x22><div\x20class=\x22skeleton-text\x20title\x22></div><div\x20class=\x22skeleton-text\x20author\x22></div><div\x20class=\x22skeleton-text\x20meta\x22></div><div\x20class=\x22skeleton-btn\x22></div></div></div>','\x20type-','toLowerCase','loginModal','Error\x20formatting\x20time:','#totalBookDownloadsLarge','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22book-title\x22>','#authorName','/#bookDetail/','personalNotificationsListContainer','booksDownloadedLarge','submittedAt','profileTabs','User\x20data\x20not\x20found\x20for\x20stat\x20update.','Opening\x20download...\x20(This\x20is\x20your\x20book,\x20no\x20credits\x20deducted)','profile','\x20starting\x20credits!','Error\x20claiming\x20daily\x20credit:','tab-','includes','#logoLink','show','Error\x20submitting\x20book:','\x20<i\x20class=\x22fas\x20fa-coins\x22\x20style=\x22color:\x20var(--credit-color);\x22></i>','setItem','doc','bookDetailModal','#saveProfileBtn','#profileAvatarInitialsLarge','#switchToLogin','#avatarInitials','Failed\x20to\x20submit\x20request:\x20','loginForm','#categoryFilterContainer','12th','#loginPromptBtnMain','#bookDetailContent','<div\x20style=\x22text-align:center;\x20padding:\x2050px\x200;\x22><div\x20class=\x22spinner\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20border-width:\x204px;\x22></div><p\x20style=\x22margin-top:\x2015px;\x20color:\x20var(--text-muted);\x22>Loading\x20details...</p></div>','unread','eduspark-new.firebasestorage.app','#creditModal','substring','#profileEmailLarge','adminNotes','comment','<p\x20class=\x22comment-body\x22>','.amount-option','&#39;','view','\x27.\x20Try\x20\x27All\x27\x20or\x20another\x20category.</p>','Error\x20listening\x20to\x20user\x20data:','Points\x20Awarded!','replace','yourname@okbank','emptyProfileBooks','Please\x20select\x20method\x20and\x20amount.','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22notification-timestamp\x22>','fas\x20fa-times-circle','Username\x20already\x20taken.\x20Please\x20choose\x20another.','#closeAddBookModal','.notification-tab-btn','link','searchToggleBtn','totalBookDownloads','value','\x22\x20style=\x22animation-delay:\x20','Insufficient\x20points\x20for\x20selected\x20amount.','Please\x20login\x20to\x20claim\x20credits.','display','toDate','#searchResults','<div\x20class=\x22amount-option\x22\x20data-amount=\x22500\x22\x20data-rs=\x2250\x22>500\x20pts\x20=\x2050</div><div\x20class=\x22amount-option\x22\x20data-amount=\x221000\x22\x20data-rs=\x22100\x22>1000\x20pts\x20=\x20100</div><div\x20class=\x22amount-option\x22\x20data-amount=\x222000\x22\x20data-rs=\x22200\x22>2000\x20pts\x20=\x20200</div><div\x20class=\x22amount-option\x22\x20data-amount=\x225000\x22\x20data-rs=\x22500\x22>5000\x20pts\x20=\x20500</div>','discoverModal','authorName','title','\x22\x20was\x20rejected.\x20Reason:\x20','</span><button\x20class=\x22toast-close\x22\x20aria-label=\x22Close\x20toast\x22>&times;</button>','logoutBtn','\x22\x20has\x20been\x20submitted\x20for\x20approval.','Login\x20error:','searchResults','.detail-download-btn','initializeApp','style','</h3>','564501033350','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','#closeSignupModal','10XTMzhX','processedBookActions.','read','classList','increment','success','NEET','.search-result-item','Image\x20URL\x20must\x20be\x20a\x20valid\x20link.','Error\x20fetching\x20withdrawal\x20history:',')</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22feedback-separator\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22feedback-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22feedback-title\x22>Rate\x20this\x20Book</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<form\x20id=\x22feedbackForm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rating-stars\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Your\x20Rating:</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stars\x22\x20id=\x22feedbackStars\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22far\x20fa-star\x22\x20data-value=\x221\x22\x20title=\x22Terrible\x22></i><i\x20class=\x22far\x20fa-star\x22\x20data-value=\x222\x22\x20title=\x22Poor\x22></i><i\x20class=\x22far\x20fa-star\x22\x20data-value=\x223\x22\x20title=\x22Average\x22></i><i\x20class=\x22far\x20fa-star\x22\x20data-value=\x224\x22\x20title=\x22Good\x22></i><i\x20class=\x22far\x20fa-star\x22\x20data-value=\x225\x22\x20title=\x22Excellent\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22hidden\x22\x20id=\x22feedbackRating\x22\x20value=\x220\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22feedbackComment\x22\x20class=\x22form-label\x22>Your\x20Feedback\x20(Optional):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22feedbackComment\x22\x20class=\x22form-textarea\x22\x20placeholder=\x22Share\x20your\x20thoughts...\x22\x20rows=\x223\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20class=\x22submit-btn\x22\x20id=\x22submitFeedbackBtn\x22><span\x20class=\x22spinner\x22\x20style=\x22display:\x20none;\x22></span><span>Submit\x20Feedback</span></button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22feedback-title\x22\x20style=\x22margin-top:\x2030px;\x22>Comments</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comments-list\x22\x20id=\x22commentsList\x22><div\x20class=\x22no-comments\x22>Loading\x20comments...</div></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','pending','<div\x20class=\x22empty-state\x22\x20style=\x22padding:20px\x200;min-height:150px;width:100%;text-align:center;\x22><i\x20class=\x22fas\x20fa-sad-tear\x22></i><p\x20style=\x22font-size:0.9rem;\x22>No\x20popular\x20books\x20yet.</p></div>','trim','profileNameLarge','.spinner','#totalFeedbackLarge','#loginModal','Book\x20Submitted','#signupName','#headerCreditsAmount','</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22book-detail-author\x22>By\x20','refresh','AIzaSyBNi6BHTKNd62VAY7q1oHQmxjZ3r0MUA9U','closeWithdrawalModal','processedAt','User\x20data\x20not\x20found.','submittedBy','join','s\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-amount\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Error\x20updating\x20profile:','closeSignupModal','headerCreditsContainer','userPointsLarge','requestedAt','\x20pts\x20(','submit','approvedAt','Welcome\x20to\x20EduSparK!','fas\x20fa-hourglass-half','required','displayName','Could\x20not\x20load\x20withdrawal\x20history.','Error\x20cleaning\x20listener\x20','mouseout','#loginForm','</p>','innerWidth','#switchToSignup','userBooks','contains','#withdrawalModal\x20.amount-option','Igniting\x20Minds...','Could\x20not\x20load\x20admin\x20announcements.','stringify','tab','<div\x20class=\x22no-comments\x22\x20style=\x22padding:\x2020px\x200;\x22>Could\x20not\x20load\x20comments\x20at\x20this\x20time.</div>','Book\x20not\x20found\x20for\x20rating\x20update.','Error\x20submitting\x20feedback:','#paymentId','body','loadingMessage','now','lastDailyCreditClaim','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22comment-date\x22>','mouseover','accountNameGroup','stopPropagation','You\x27ve\x20already\x20claimed\x20your\x20daily\x20bonus\x20today!','overflow','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-calendar-alt\x22></i>\x20','points','https://via.placeholder.com/200x280/333/888?text=No+Cover','#withdrawBtnLarge','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4>','rejection','Could\x20not\x20load\x20your\x20profile\x20data.\x20Please\x20refresh.','<i\x20class=\x22fas\x20fa-envelope\x22></i>\x20loading...','setDate','#feedbackForm','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-item\x22\x20data-aos=\x22fade-up\x22\x20style=\x22animation-delay:\x20','sort','#userPointsLarge','notificationsBackBtn','popular','\x20credits.\x20You\x20have\x20','#profileBackBtn','message','user','2445736jWDuFn','Password\x20must\x20be\x20at\x20least\x206\x20characters.','#feedbackRating','Enter\x20details','split','\x27;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-detail-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h2\x20class=\x22book-detail-title\x22>','credits','bookId','1045428VVqpxL','4MCyoaL','toggle','Thank\x20you!\x20Your\x20feedback\x20has\x20been\x20submitted.','reviewedBy','notificationsBtn','flex','Logout\x20error:','User\x20not\x20found\x20during\x20transaction.','Could\x20not\x20load\x20your\x20shared\x20books.','placeholder','#bookDetailModal','#bookImageUrl','#emptyPersonalNotificationsState','booksContainer','<span><i\x20class=\x22far\x20fa-star\x22\x20style=\x22color:var(--star-color);\x22></i>\x20No\x20ratings\x20yet</span>','runTransaction','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popular-book-card\x22\x20data-action=\x22view\x22\x20data-book-id=\x22','hasPendingWrites','You\x20received\x20+','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22action-btn\x20view-btn\x22\x20data-action=\x22view\x22\x20data-book-id=\x22','toLocaleDateString','9BTVvNJ','\x27;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','click','\x22\x20data-book-id=\x22','rejected','userNotifications','Your\x20book\x20\x22','.notification-item','by\x20','fas\x20fa-exclamation-triangle','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22spinner\x22\x20style=\x22display:none;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-download\x22></i>\x20Download\x20(','Error\x20marking\x20all\x20notifications\x20as\x20read:','none','error','573830dttTwL','#searchInput','<div\x20class=\x22no-comments\x22\x20style=\x22padding:\x2020px\x200;\x22>Loading\x20comments...</div>','Book\x20submitted\x20for\x20approval!\x20You\x27ll\x20be\x20notified.','#booksGridLoadingIndicator','Coding','Rejected\x20','innerHTML','type','submitWithdrawalBtn','querySelectorAll','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-rating\x22>','#submitWithdrawalBtn','\x20ratings)</span>','428478ZgfuFO','open','location','tempSignupData','#withdrawalModal\x20.withdrawal-options','Please\x20fill\x20all\x20required\x20fields.','Attempted\x20Credit\x20Boost','submittedByName','getTime','docs','\x22\x20is\x20now\x20live.','http','#emptyProfileBooks','#searchToggleBtn','className','init','<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i><h3>Error\x20Loading\x20Books</h3><p>Please\x20refresh\x20or\x20try\x20again\x20later.</p>','\x22\x20has\x20been\x20recorded.','update','withdrawBtnLarge','push','#withdrawalModal\x20.amount-selection','Error\x20re-checking\x20username\x20during\x20doc\x20creation:','editProfileBtn','#profileUsernameLarge','Critical\x20error\x20creating\x20user\x20document\x20in\x20Firestore:\x20','your.email@example.com','9th',':scope\x20>\x20span:not(.spinner)','toISOString','#profilePage','hovered','focus','Enter\x20Account\x20Number','firestore','href','Yesterday','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','ease-out-cubic','userName','FieldValue','_blank','<span><i\x20class=\x22fas\x20fa-star\x22\x20style=\x22color:var(--star-color);\x22></i>\x20','accountNameInput','#bookName','.withdrawal-option','toString','actionLink','creditModal','warn','notification-group','<p\x20style=\x22color:\x20var(--text-muted);\x20text-align:\x20center;\x20padding:\x2030px;\x22>Could\x20not\x20load\x20details.\x20Please\x20try\x20again.</p>','#profileBtn','Today','Insufficient\x20credits.\x20Need\x20','Failed\x20to\x20mark\x20all\x20as\x20read.','Book\x20Approved!','loadingOverlay','#personalNotificationsListContainer','User\x20document\x20doesn\x27t\x20exist,\x20creating\x20one...','book','#signupModal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-detail-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22action-btn\x20detail-download-btn\x22\x20data-action=\x22download\x22\x20data-link=\x22','loadMoreBooksBtn','profileTabBtns','div',')\x20is\x20pending.','#userAvatar','info','redeem','profileEmailLarge','closeLoginModal','#categoryFilterContainer\x20.category-filter-item','Invalid\x20Date','fas\x20fa-book-reader','#signupBio','#editProfileBtn','Download\x20failed:\x20','You\x20clicked\x20the\x20link\x20to\x20earn\x20credits.\x20Checking\x20eligibility...','switchToSignup','catch','#markAllNotificationsReadBtn','<i\x20class=\x22fas\x20fa-calendar-alt\x22></i>\x20Joined:\x20','setHours','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','toastContainer','Your\x20profile\x20is\x20set\x20up.\x20You\x27ve\x20received\x20','paymentMethodLabel','onSnapshot','<div\x20class=\x22no-results\x22>No\x20books\x20found.</div>','UPSC','#unreadNotificationsBadge','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'];_0x55e0=function(){return _0x2b5aed;};return _0x55e0();}if(elements[_0x3098b8(0x1a8)])elements[_0x3098b8(0x1a8)]['onclick']=closeNotificationsPage;if(elements[_0x3098b8(0x344)])elements[_0x3098b8(0x344)][_0x3098b8(0x32d)]=openProfilePage;if(elements[_0x3098b8(0x27f)])elements[_0x3098b8(0x27f)][_0x3098b8(0x32d)]=openProfilePage;if(elements['profileBackBtn'])elements[_0x3098b8(0x302)][_0x3098b8(0x32d)]=closeProfilePage;if(elements[_0x3098b8(0x28c)])elements[_0x3098b8(0x28c)]['onclick']=()=>{const _0x501851=_0x3098b8;if(currentUser)openModal(elements[_0x501851(0x348)]);else openModal(elements[_0x501851(0x3cd)]);};if(elements[_0x3098b8(0x26e)])elements[_0x3098b8(0x26e)][_0x3098b8(0x32d)]=()=>closeModal(elements[_0x3098b8(0x348)]);if(elements['discoverBtn'])elements[_0x3098b8(0x2b2)]['onclick']=()=>{const _0x3d76ad=_0x3098b8;if(currentUser)openModal(elements['discoverModal']);else openModal(elements[_0x3d76ad(0x3cd)]);};if(elements[_0x3098b8(0x3bf)])elements[_0x3098b8(0x3bf)][_0x3098b8(0x32d)]=()=>closeModal(elements[_0x3098b8(0x412)]);if(elements[_0x3098b8(0x237)])elements['switchToSignup'][_0x3098b8(0x32d)]=()=>{const _0x3933b5=_0x3098b8;closeModal(elements[_0x3933b5(0x3cd)]),openModal(elements[_0x3933b5(0x309)]);};if(elements[_0x3098b8(0x31a)])elements[_0x3098b8(0x31a)][_0x3098b8(0x32d)]=()=>{const _0x24c122=_0x3098b8;closeModal(elements[_0x24c122(0x309)]),openModal(elements['loginModal']);};if(elements[_0x3098b8(0x22f)])elements[_0x3098b8(0x22f)][_0x3098b8(0x32d)]=()=>closeModal(elements[_0x3098b8(0x3cd)]);if(elements[_0x3098b8(0x174)])elements[_0x3098b8(0x174)][_0x3098b8(0x32d)]=()=>closeModal(elements[_0x3098b8(0x309)]);if(elements['closeBookDetailModal'])elements[_0x3098b8(0x356)][_0x3098b8(0x32d)]=()=>{const _0x2b48c0=_0x3098b8;closeModal(elements[_0x2b48c0(0x3e4)]),currentBookDetailId=null;};$$(_0x3098b8(0x2c9))[_0x3098b8(0x355)](_0x53edfc=>{const _0x346a7f=_0x3098b8;_0x53edfc[_0x346a7f(0x261)](_0x346a7f(0x1ce),_0x5b3672=>{const _0x4513d4=_0x346a7f;if(_0x5b3672[_0x4513d4(0x30a)]===_0x53edfc)closeModal(_0x53edfc);});}),document[_0x3098b8(0x261)]('DOMContentLoaded',()=>{const _0x11e5cb=_0x3098b8;if(elements[_0x11e5cb(0x221)])elements[_0x11e5cb(0x221)][_0x11e5cb(0x425)][_0x11e5cb(0x2a5)](_0x11e5cb(0x36b));showRandomLoadingMessage(),renderSkeletonLoaders(elements['booksContainer'],BOOKS_PER_PAGE_MAIN,_0x11e5cb(0x224)),renderSkeletonLoaders(elements['popularBooksCarousel'],0x5,_0x11e5cb(0x1a9)),renderCategoryFilters(),resetNavigation(),setupWithdrawalListeners();const _0x23127e='<div\x20class=\x22withdrawal-option\x22\x20data-method=\x22upi\x22><div\x20class=\x22withdrawal-icon\x22><i\x20class=\x22fas\x20fa-mobile-alt\x22></i></div><div\x20class=\x22withdrawal-details\x22><div\x20class=\x22withdrawal-title\x22>UPI</div><div\x20class=\x22withdrawal-description\x22>Fast\x20transfer\x20via\x20UPI\x20ID</div></div></div><div\x20class=\x22withdrawal-option\x22\x20data-method=\x22redeem\x22><div\x20class=\x22withdrawal-icon\x22><i\x20class=\x22fab\x20fa-google-play\x22></i></div><div\x20class=\x22withdrawal-details\x22><div\x20class=\x22withdrawal-title\x22>Redeem\x20Code</div><div\x20class=\x22withdrawal-description\x22>Google\x20Play\x20Gift\x20Card</div></div></div><div\x20class=\x22withdrawal-option\x22\x20data-method=\x22bank\x22><div\x20class=\x22withdrawal-icon\x22><i\x20class=\x22fas\x20fa-university\x22></i></div><div\x20class=\x22withdrawal-details\x22><div\x20class=\x22withdrawal-title\x22>Bank\x20Account</div><div\x20class=\x22withdrawal-description\x22>Direct\x20bank\x20transfer\x20(slower)</div></div></div><div\x20class=\x22withdrawal-option\x22\x20data-method=\x22paytm\x22><div\x20class=\x22withdrawal-icon\x22><i\x20class=\x22fas\x20fa-wallet\x22></i></div><div\x20class=\x22withdrawal-details\x22><div\x20class=\x22withdrawal-title\x22>Paytm\x20Wallet</div><div\x20class=\x22withdrawal-description\x22>Transfer\x20to\x20Paytm</div></div></div><div\x20class=\x22withdrawal-option\x22\x20data-method=\x22phonepe\x22><div\x20class=\x22withdrawal-icon\x22><i\x20class=\x22fas\x20fa-rupee-sign\x22></i></div><div\x20class=\x22withdrawal-details\x22><div\x20class=\x22withdrawal-title\x22>PhonePe</div><div\x20class=\x22withdrawal-description\x22>Transfer\x20to\x20PhonePe</div></div></div>';if(elements[_0x11e5cb(0x361)])elements[_0x11e5cb(0x361)][_0x11e5cb(0x1e1)]=_0x23127e;const _0x384d24=_0x11e5cb(0x411);if(elements[_0x11e5cb(0x345)])elements['amountOptionsContainer']['innerHTML']=_0x384d24;});
            </script>
</body>
</html>
