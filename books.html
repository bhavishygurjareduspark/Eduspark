<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Add Content Security Policy Meta Tag - Customize as needed -->
    <meta http-equiv="Content-Security-Policy"
      content="default-src 'self' https://*.firebaseio.com https://*.firebasedatabase.app https://*.googleapis.com https://*.gstatic.com https://cdnjs.cloudflare.com https://unpkg.com https://cdn.jsdelivr.net;
               script-src 'self' 'unsafe-inline' https://www.gstatic.com/firebasejs/ https://unpkg.com https://cdn.jsdelivr.net https://www.google.com/recaptcha/api.js https://*.google.com https://www.gstatic.com/recaptcha/;
               style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com https://unpkg.com;
               font-src 'self' https://fonts.gstatic.com https://cdnjs.cloudflare.com;
               img-src 'self' data: https: http://via.placeholder.com;
               connect-src 'self' wss://*.firebaseio.com https://*.googleapis.com https://*.firebaseio.com https://identitytoolkit.googleapis.com https://securetoken.googleapis.com https://firestore.googleapis.com https://firebaseinstallations.googleapis.com https://firebasestorage.googleapis.com https://firebaseappcheck.googleapis.com;
               object-src 'none';
               base-uri 'self';
               form-action 'self';
               frame-src 'self' https://www.google.com/recaptcha/ https://*.google.com;">
    <title>EduSparK - Share Knowledge</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app-check.js"></script> <!-- Firebase App Check SDK -->


    <style>
        :root {
            --primary-color: #ff3333;
            --primary-light: #ff6666;
            --primary-dark: #cc0000; /* Darker primary */
            --secondary-color: #000000;
            --secondary-light: #2a2a2a; /* Lighter secondary */
            --secondary-dark: #000000;
            --text-light: #f1f2f6;
            --text-dark: #dfe4ea;
            --text-muted: #a4b0be;
            --bg-light: #1e1e1e; /* Slightly lighter dark bg */
            --bg-dark: #121212; /* Very dark bg */
            --card-bg: #212121; /* Darker card bg */
            --card-bg-dark: #1a1a1a; /* Darker modal bg */
            --gradient: linear-gradient(135deg, #ff3333, #cc0000);
            --gradient-light: linear-gradient(135deg, #ff6666, #ff3333);
            --gradient-dark: linear-gradient(135deg, #ff0000, #990000);
            --shadow-sm: 0 2px 5px rgba(0, 0, 0, 0.35);
            --shadow-md: 0 6px 12px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.45);
            --shadow-xl: 0 20px 40px rgba(0, 0, 0, 0.5);
            --border-radius: 12px;
            --border-radius-sm: 8px;
            --border-radius-xs: 6px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-fast: all 0.15s ease-out;
            --header-height: 70px;
            --nav-height: 70px;
            --max-width: 1200px;
            --skeleton-bg: #303030;
            --skeleton-highlight: #404040;
            --credit-color: #ffd700; /* Gold color for credits */
            --star-color: #f1c40f; /* Yellow for stars */
            --profile-header-bg: linear-gradient(135deg, rgba(30, 30, 30, 0.9), rgba(18, 18, 18, 0.98));
            --notification-unread-dot: #3498db;
            --notification-bg-success: rgba(39, 174, 96, 0.15);
            --notification-border-success: #27ae60;
            --notification-bg-info: rgba(52, 152, 219, 0.15);
            --notification-border-info: #3498db;
            --notification-bg-warning: rgba(243, 156, 18, 0.15);
            --notification-border-warning: #f39c12;
            --notification-bg-error: rgba(231, 76, 60, 0.15);
            --notification-border-error: #e74c3c;
            --status-pending-bg: #f39c12;
            --status-rejected-bg: #e74c3c;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
             scroll-behavior: smooth;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-dark);
            min-height: 100vh;
            padding-top: var(--header-height);
            padding-bottom: var(--nav-height);
            line-height: 1.6;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Enhanced Loading Overlay */
        .loading-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: var(--bg-dark);
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            z-index: 9999;
            transition: opacity 0.7s cubic-bezier(0.4, 0, 0.2, 1), visibility 0.7s cubic-bezier(0.4, 0, 0.2, 1);
            opacity: 1; visibility: visible;
        }
        .loading-overlay.hidden { opacity: 0; visibility: hidden; pointer-events: none; }

        .loading-logo-container { display: flex; align-items: center; margin-bottom: 25px; animation: logoPulse 2s infinite ease-in-out; }
        .loading-logo-icon { font-size: 3.5rem; color: var(--primary-color); margin-right: 15px; }
        .loading-logo-text { font-size: 2.2rem; font-weight: 700; color: var(--primary-light); letter-spacing: 1px; }

        .loading-dots { display: flex; justify-content: center; align-items: center; margin-bottom: 30px; }
        .loading-dots span {
            width: 12px; height: 12px; margin: 0 6px;
            background-color: var(--primary-color);
            border-radius: 50%;
            animation: loadingBounce 1.4s infinite ease-in-out both;
        }
        .loading-dots span:nth-child(1) { animation-delay: -0.32s; }
        .loading-dots span:nth-child(2) { animation-delay: -0.16s; }

        .loading-message { color: var(--text-muted); font-size: 1rem; font-style: italic; max-width: 80%; text-align: center; animation: fadeInText 1.5s ease-out forwards; opacity: 0; animation-delay: 0.5s;}


        @keyframes logoPulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        @keyframes loadingBounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1.0); } }
        @keyframes fadeInText { to { opacity: 1; } }


        /* Enhanced Header with Glass Morphism */
        .header {
            background-color: rgba(18, 18, 18, 0.85);
            backdrop-filter: blur(15px) saturate(180%);
            -webkit-backdrop-filter: blur(15px) saturate(180%);
            color: var(--text-light);
            height: var(--header-height);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow-md);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            padding: 0 20px;
            transition: height 0.3s ease, background-color 0.3s ease, box-shadow 0.3s ease;
            border-bottom: 1px solid rgba(255, 51, 51, 0.1);
        }

        .header.scrolled {
            height: 65px;
            background-color: rgba(18, 18, 18, 0.95);
            box-shadow: 0 6px 25px rgba(0, 0, 0, 0.25);
        }

        .logo-container { display: flex; align-items: center; flex-shrink: 0; }
        .logo { font-size: 1.8rem; font-weight: 700; color: var(--primary-color); display: flex; align-items: center; text-decoration: none; transition: transform 0.3s ease; position: relative; padding: 5px 0; }
        .logo:hover { transform: scale(1.05); }
        .logo i { margin-right: 10px; font-size: 1.6rem; color: var(--primary-color); transition: transform 0.3s ease; }
        .logo:hover i { transform: rotate(-10deg); }
        .logo-text { display: inline-block; position: relative; transition: opacity 0.3s ease; }

        @media (max-width: 420px) { .logo-text { font-size: 1.5rem; } .logo i { margin-right: 5px; } }

        .header-actions { display: flex; align-items: center; gap: 12px; flex-shrink: 0; }

        /* --- Header Credits --- */
        .header-credits { display: flex; align-items: center; gap: 8px; color: var(--text-light); font-weight: 600; font-size: 0.9rem; cursor: pointer; padding: 6px 12px; border-radius: 25px; background-color: rgba(255, 255, 255, 0.07); transition: background-color 0.3s ease, transform 0.2s ease; border: 1px solid rgba(255, 255, 255, 0.1); }
        .header-credits:hover { background-color: rgba(255, 255, 255, 0.15); transform: scale(1.05); }
        .header-credits i { font-size: 1.1rem; color: var(--credit-color); }
        #headerCreditsAmount { min-width: 20px; text-align: right; }


        /* --- Single Search Bar --- */
        .search-container { position: relative; width: 250px; transition: all 0.3s ease; margin-left: auto; margin-right: 10px; }
        .search-input { width: 100%; padding: 10px 15px 10px 40px; border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 30px; background-color: rgba(255, 255, 255, 0.05); color: var(--text-light); font-family: 'Poppins', sans-serif; transition: all 0.3s ease; font-size: 0.9rem; }
        .search-input::placeholder { color: rgba(255, 255, 255, 0.5); }
        .search-input:focus { outline: none; background-color: rgba(255, 255, 255, 0.1); box-shadow: 0 0 0 2px var(--primary-light); border-color: var(--primary-light); }
        .search-icon { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: var(--text-light); opacity: 0.6; font-size: 1rem; pointer-events: none; }
        .search-results { position: absolute; top: calc(100% + 8px); left: 0; right: 0; background-color: var(--card-bg); border-radius: var(--border-radius-sm); box-shadow: var(--shadow-xl); max-height: 350px; overflow-y: auto; z-index: 1001; display: none; animation: fadeInDown 0.3s ease forwards; border: 1px solid rgba(255, 255, 255, 0.1); }
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .search-result-item { padding: 12px 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.05); cursor: pointer; transition: background-color 0.2s ease; }
        .search-result-item:hover { background-color: rgba(255, 255, 255, 0.08); }
        .search-result-item h4 { font-size: 0.95rem; color: var(--text-dark); margin-bottom: 5px; font-weight: 500; }
        .search-result-item p { font-size: 0.8rem; color: var(--text-muted); }
        .no-results { padding: 20px; text-align: center; color: var(--text-muted); font-size: 0.9rem; }

        /* Mobile Search Handling */
        .search-toggle-btn { background: none; border: none; color: var(--text-light); font-size: 1.2rem; cursor: pointer; padding: 5px; display: none; }
        @media (max-width: 768px) {
            .search-container { position: absolute; top: calc(var(--header-height) + 10px); left: 10px; right: 10px; width: auto; z-index: 999; background-color: var(--bg-light); padding: 10px; border-radius: var(--border-radius-sm); box-shadow: var(--shadow-lg); opacity: 0; visibility: hidden; transform: translateY(-10px); transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease; }
            .search-container.active { opacity: 1; visibility: visible; transform: translateY(0); }
            .search-toggle-btn { display: block; order: -1; margin-right: 5px; }
            .search-results { top: calc(100% + 5px); left: 0; right: 0; width: 100%; }
            .search-container.active ~ .header-actions .header-credits { display: none; }
        }
        @media (max-width: 576px) { .search-container { top: calc(var(--header-height) + 5px); } .header-actions { gap: 8px; } .header-credits { padding: 5px 8px; font-size: 0.8rem; } .header-credits i { font-size: 1rem; } }
        @media (max-width: 420px) { .header-credits { display: none; } .header-actions .search-toggle-btn { margin-right: 0;} }


        .user-avatar { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; border: 2px solid var(--primary-color); cursor: pointer; transition: transform 0.3s ease, box-shadow 0.3s ease; display: flex; align-items: center; justify-content: center; background: var(--gradient); color: white; font-weight: 600; font-size: 1rem; position: relative; overflow: hidden; flex-shrink: 0; }
        .user-avatar::after { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 70%); opacity: 0; transition: opacity 0.4s ease; }
        .user-avatar:hover { transform: scale(1.1); box-shadow: 0 0 15px rgba(255, 51, 51, 0.5); }
        .user-avatar:hover::after { opacity: 1; }


        /* --- Popular Books Section --- */
        .popular-books-section { padding: 30px 20px; background: linear-gradient(180deg, rgba(18, 18, 18, 0.9) 0%, rgba(18, 18, 18, 0) 100%), var(--bg-dark); margin-bottom: 20px; }
        .section-title { font-size: 1.8rem; margin-bottom: 25px; color: var(--primary-light); position: relative; display: inline-block; font-weight: 600; padding-bottom: 10px; text-align: center; width: 100%; }
        .section-title::after { content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 70px; height: 4px; background: var(--gradient); border-radius: 4px; animation: scaleIn 0.6s ease-out forwards; }
        @keyframes scaleIn { from { transform: translateX(-50%) scaleX(0); } to { transform: translateX(-50%) scaleX(1); } }
        .popular-books-carousel { display: flex; gap: 20px; overflow-x: auto; padding-bottom: 20px; -ms-overflow-style: none; scrollbar-width: none; }
        .popular-books-carousel::-webkit-scrollbar { display: none; }
        .popular-book-card { flex: 0 0 auto; width: 160px; background-color: var(--card-bg); border-radius: var(--border-radius); overflow: hidden; box-shadow: var(--shadow-md); transition: var(--transition); border: 1px solid rgba(255, 255, 255, 0.08); position: relative; cursor: pointer; }
        .popular-book-card:hover { transform: translateY(-8px) scale(1.03); box-shadow: var(--shadow-lg); }
        .popular-book-img-container { height: 200px; overflow: hidden; position: relative; background-color: rgba(255, 255, 255, 0.05); display: flex; align-items: center; justify-content: center; }
        .popular-book-img { width: auto; height: 100%; object-fit: cover; transition: transform 0.5s ease; }
        .popular-book-card:hover .popular-book-img { transform: scale(1.1); }
        .popular-book-info { padding: 12px; }
        .popular-book-title { font-size: 0.9rem; font-weight: 600; color: var(--text-dark); margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .popular-book-meta { font-size: 0.75rem; color: var(--text-muted); display: flex; align-items: center; gap: 5px; }
        .popular-book-meta i { color: var(--primary-color); font-size: 0.8rem; }


        /* --- Main Content & Book Grid --- */
        .container { padding: 20px; max-width: var(--max-width); margin: 0 auto; }
        .page-title { font-size: 2rem; margin-bottom: 25px; color: var(--primary-color); position: relative; display: inline-block; font-weight: 600; padding-bottom: 10px; }
        .page-title::after { content: ''; position: absolute; bottom: 0; left: 0; width: 60px; height: 4px; background: var(--gradient); border-radius: 4px; transform-origin: left; animation: scaleInMain 0.6s ease-out forwards; }
        @keyframes scaleInMain { from { transform: scaleX(0); } to { transform: scaleX(1); } }

        /* Category Filters */
        .category-filter-container {
            margin-bottom: 25px; display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;
            padding: 10px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        .category-filter-item {
            padding: 8px 18px; border-radius: 20px; background-color: var(--card-bg);
            color: var(--text-muted); font-size: 0.9rem; font-weight: 500; cursor: pointer;
            transition: all 0.3s ease; border: 1px solid transparent;
        }
        .category-filter-item:hover { background-color: var(--secondary-light); color: var(--text-light); transform: translateY(-2px); }
        .category-filter-item.active {
            background: var(--gradient); color: white; font-weight: 600;
            box-shadow: 0 4px 10px rgba(255, 51, 51, 0.3); border-color: var(--primary-dark);
        }

        .books-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(190px, 1fr)); gap: 25px; margin-top: 20px; }
        #booksGridLoadingIndicator {
            grid-column: 1 / -1; /* Span all columns */
            text-align: center;
            padding: 20px;
            color: var(--text-muted);
            font-size: 1rem;
            display: none; /* Initially hidden */
        }
        #booksGridLoadingIndicator .spinner {
            width: 24px; height: 24px;
            border-color: var(--text-muted);
            border-top-color: var(--primary-color);
            margin-right: 10px;
            vertical-align: middle;
        }


        /* Skeleton Loader Base Styles */
        .skeleton { background-color: var(--skeleton-bg); animation: pulse-bg 1.5s infinite ease-in-out; border-radius: 4px; }
        .skeleton-img { height: 220px; border-radius: var(--border-radius-sm) var(--border-radius-sm) 0 0; }
        .skeleton-text { height: 1em; margin-bottom: 10px; }
        .skeleton-btn { height: 38px; border-radius: var(--border-radius-sm); margin-top: 15px; }
        /* Skeleton Loader for Books */
        .skeleton-book-card { background-color: var(--card-bg); border-radius: var(--border-radius); overflow: hidden; box-shadow: var(--shadow-md); border: 1px solid rgba(255, 255, 255, 0.08); height: 390px; display: flex; flex-direction: column; }
        .skeleton-book-card .skeleton-img { flex-shrink: 0; background-color: var(--skeleton-bg); animation: pulse-bg 1.5s infinite ease-in-out; }
        .skeleton-book-card .skeleton-info { padding: 15px; flex-grow: 1; display: flex; flex-direction: column; }
        .skeleton-book-card .skeleton-text.title { width: 85%; height: 1.2em; margin-top: 5px; }
        .skeleton-book-card .skeleton-text.author { width: 60%; height: 0.9em; margin-top: 8px; }
        .skeleton-book-card .skeleton-text.meta { width: 40%; height: 0.8em; margin-top: 15px; }
        .skeleton-book-card .skeleton-btn { margin-top: auto; background-color: var(--skeleton-bg); animation: pulse-bg 1.5s infinite ease-in-out; }
        /* Skeleton Loader for Popular Books */
        .skeleton-popular-book { flex: 0 0 auto; width: 160px; }
        .skeleton-popular-book .skeleton-img { height: 200px; border-radius: var(--border-radius-sm) var(--border-radius-sm) 0 0; background-color: var(--skeleton-bg); animation: pulse-bg 1.5s infinite ease-in-out; }
        .skeleton-popular-book .skeleton-info { padding: 12px; }
        .skeleton-popular-book .skeleton-text.title { width: 80%; height: 1em; margin-bottom: 8px; }
        .skeleton-popular-book .skeleton-text.meta { width: 50%; height: 0.8em; margin-top: 8px; }
        /* Skeleton Loader for Withdrawal History */
        .skeleton-history-item { height: 80px; background-color: var(--skeleton-bg); border-radius: var(--border-radius-sm); animation: pulse-bg 1.5s infinite ease-in-out; margin-bottom: 15px; }
        /* Skeleton for Notification Items */
        .skeleton-notification-item {
            display: flex; align-items: flex-start; padding: 15px;
            background-color: var(--skeleton-bg); border-radius: var(--border-radius-sm);
            margin-bottom: 12px; animation: pulse-bg 1.5s infinite ease-in-out;
        }
        .skeleton-notification-item .skeleton-icon { width: 36px; height: 36px; border-radius: 50%; background-color: var(--skeleton-highlight); margin-right: 15px; }
        .skeleton-notification-item .skeleton-content { flex: 1; }
        .skeleton-notification-item .skeleton-text.title { width: 60%; height: 1.1em; margin-bottom: 8px; background-color: var(--skeleton-highlight); }
        .skeleton-notification-item .skeleton-text.message { width: 90%; height: 0.9em; margin-bottom: 10px; background-color: var(--skeleton-highlight); }
        .skeleton-notification-item .skeleton-text.timestamp { width: 30%; height: 0.7em; background-color: var(--skeleton-highlight); }

        @keyframes pulse-bg { 0% { background-color: var(--skeleton-bg); } 50% { background-color: var(--skeleton-highlight); } 100% { background-color: var(--skeleton-bg); } }


        .book-card { background-color: var(--card-bg); border-radius: var(--border-radius); overflow: hidden; box-shadow: var(--shadow-md); transition: transform 0.3s ease, box-shadow 0.3s ease; position: relative; border: 1px solid rgba(255, 255, 255, 0.08); display: flex; flex-direction: column; height: 100%; opacity: 0; transform: translateY(20px); animation: cardFadeInUp 0.5s ease forwards; }
        @keyframes cardFadeInUp { to { opacity: 1; transform: translateY(0); } }
        .books-grid .book-card:nth-child(1), #profileBooksContainer .book-card:nth-child(1) { animation-delay: 0.05s; }
        .books-grid .book-card:nth-child(2), #profileBooksContainer .book-card:nth-child(2) { animation-delay: 0.1s; }
        .books-grid .book-card:nth-child(3), #profileBooksContainer .book-card:nth-child(3) { animation-delay: 0.15s; }
        .book-card:hover { transform: translateY(-8px) scale(1.02); box-shadow: var(--shadow-lg); }

        .book-img-container { height: 220px; overflow: hidden; position: relative; background-color: rgba(255, 255, 255, 0.05); display: flex; align-items: center; justify-content: center; cursor: pointer; }
        .book-img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s ease; }
        .book-card:hover .book-img { transform: scale(1.08); }

        .book-info { padding: 15px; flex: 1; display: flex; flex-direction: column; background-color: var(--card-bg); }
        .book-title { font-size: 1rem; font-weight: 600; margin-bottom: 8px; color: var(--text-dark); display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; min-height: 2.4em; }
        .book-author { font-size: 0.85rem; color: var(--primary-light); margin-bottom: 12px; font-weight: 500; }
        .book-meta { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; font-size: 0.75rem; color: var(--text-muted); }
        .book-meta span { display: flex; align-items: center; gap: 5px; }
        .book-meta i { color: var(--primary-color); font-size: 0.8rem; }
        .book-admin-info { font-size: 0.7rem; color: var(--text-muted); margin-top: auto; padding-top: 10px; border-top: 1px dashed rgba(255, 255, 255, 0.15); display: flex; align-items: center; gap: 5px; }
        .book-admin-info i { color: var(--primary-color); font-size: 0.8rem; }

        .action-btn { /* Generalized button style */
            background: var(--gradient); color: white; border: none; padding: 10px 14px; border-radius: var(--border-radius-sm); display: flex; align-items: center; justify-content: center; width: 100%; cursor: pointer; transition: var(--transition); font-weight: 500; font-size: 0.9rem; position: relative; overflow: hidden; box-shadow: var(--shadow-sm); margin-top: auto; gap: 8px;
        }
        .action-btn::after { /* Shimmer effect */
            content: ''; position: absolute; top: -50%; left: -75%; width: 50%; height: 200%; background: linear-gradient(to right, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 0.2) 50%, rgba(255, 255, 255, 0) 100%); transform: skewX(-25deg); transition: left 0.7s ease; pointer-events: none;
        }
        .action-btn:hover::after { left: 125%; }
        .action-btn i { font-size: 0.9rem; }
        .action-btn:hover:not(:disabled) { transform: translateY(-3px); box-shadow: 0 8px 18px rgba(255, 51, 51, 0.4); background: var(--gradient-light); }
        .action-btn:disabled { background: var(--secondary-light) !important; opacity: 0.6; cursor: not-allowed; transform: none !important; box-shadow: none !important; }


        /* Status Badges */
        .status-badge { position: absolute; top: 10px; right: 10px; padding: 4px 9px; border-radius: var(--border-radius-xs); font-size: 0.7rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; z-index: 1; box-shadow: 0 2px 5px rgba(0,0,0,0.3); backdrop-filter: blur(3px); }
        .status-badge.status-approved { background-color: rgba(39, 174, 96, 0.85); color: white; } /* Added .status-badge */
        .status-badge.status-pending { background-color: rgba(243, 156, 18, 0.85); color: white; } /* Added .status-badge */
        .status-badge.status-rejected { background-color: rgba(231, 76, 60, 0.85); color: white; } /* Added .status-badge */


        /* --- Bottom Navigation --- */
        .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; background-color: rgba(26, 26, 26, 0.9); backdrop-filter: blur(12px) saturate(180%); -webkit-backdrop-filter: blur(12px) saturate(180%); display: flex; justify-content: space-around; align-items: center; height: var(--nav-height); z-index: 1000; box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.2); border-top: 1px solid rgba(255, 255, 255, 0.1); }
        .nav-item { color: var(--text-muted); font-size: 1.3rem; padding: 10px; border-radius: 50%; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: transform 0.3s ease, color 0.3s ease; position: relative; }
        .nav-item:hover { color: var(--primary-light); transform: translateY(-4px); }
        .nav-item.active { color: var(--primary-color); transform: translateY(-4px); }
        .nav-item.active::after { content: ''; position: absolute; bottom: 2px; left: 50%; transform: translateX(-50%); width: 6px; height: 6px; background-color: var(--primary-color); border-radius: 50%; box-shadow: 0 0 10px var(--primary-color); animation: fadeIn 0.3s ease; }
        .nav-item .unread-badge {
            position: absolute; top: 8px; right: 8px;
            background-color: var(--notification-unread-dot);
            color: white; font-size: 0.6rem; font-weight: bold;
            width: 16px; height: 16px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 0 0 2px var(--bg-light); /* To make it stand out from nav item */
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .add-btn { background: var(--gradient); color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.7rem; transform: translateY(-20px); box-shadow: 0 8px 25px rgba(255, 51, 51, 0.45); transition: transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease; cursor: pointer; border: none; outline: none; z-index: 1001; position: relative; overflow: hidden; }
        .add-btn::before { content: ''; position: absolute; inset: 0; border-radius: 50%; background: var(--gradient); opacity: 0.6; z-index: -1; animation: pulse-glow 2s infinite ease-out; }
        .add-btn:hover { transform: translateY(-25px) scale(1.1); box-shadow: 0 12px 30px rgba(255, 51, 51, 0.6); background: var(--gradient-light); }
        .add-btn:hover::before { animation-play-state: paused; }
        @keyframes pulse-glow { 0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(255, 51, 51, 0.7); } 70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(255, 51, 51, 0); } 100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(255, 51, 51, 0); } }


        /* --- Redesigned Profile Page --- */
        .profile-page { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--bg-dark); z-index: 2000; transform: translateX(100%); transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1); overflow-y: auto; padding: 0; opacity: 0; visibility: hidden; }
        .profile-page.active { transform: translateX(0); opacity: 1; visibility: visible; }
        .profile-page-content { padding: 20px; padding-top: var(--header-height); padding-bottom: calc(var(--nav-height) + 40px); max-width: var(--max-width); margin: 0 auto;}

        .page-back-btn { /* Generalized for profile and notifications */
            background: rgba(0, 0, 0, 0.4); border: none; color: var(--primary-light); font-size: 1.3rem;
            position: absolute; left: 15px; top: calc(15px + (var(--header-height) - 60px) / 2); /* Adjusted top for consistency */
            cursor: pointer; transition: transform 0.3s ease, background-color 0.3s ease;
            width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;
            border-radius: 50%; backdrop-filter: blur(5px); z-index: 5;
        }
        .page-back-btn:hover { transform: scale(1.1); background-color: rgba(255, 51, 51, 0.3); color: white; }


        .profile-main-header {
            display: flex; flex-direction: column; align-items: center; text-align: center;
            background: var(--profile-header-bg);
            padding: 40px 20px 30px; border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg); margin-bottom: 30px; position: relative;
        }
        .profile-main-header::before { /* Subtle pattern overlay */
            content: ''; position: absolute; top:0; left:0; right:0; bottom:0;
            background-image: url("data:image/svg+xml,%3Csvg width='52' height='26' viewBox='0 0 52 26' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%23ff3333' fill-opacity='0.04'%3E%3Cpath d='M10 10c0-2.21-1.79-4-4-4-3.314 0-6-2.686-6-6h2c0 2.21 1.79 4 4 4 3.314 0 6 2.686 6 6 0 2.21 1.79 4 4 4 3.314 0 6 2.686 6 6 0 2.21 1.79 4 4 4v2c-3.314 0-6-2.686-6-6 0-2.21-1.79-4-4-4-3.314 0-6-2.686-6-6zm25.464-1.95l8.486 8.486-1.414 1.414-8.486-8.486 1.414-1.414z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            opacity: 0.5; z-index: 0; border-radius: var(--border-radius);
        }
        .profile-avatar-lg {
            width: 130px; height: 130px; border-radius: 50%; object-fit: cover;
            border: 5px solid var(--primary-color); margin-bottom: 20px;
            background: var(--gradient); color: white; font-size: 3.2rem;
            display: flex; align-items: center; justify-content: center; font-weight: 700;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.5);
            position: relative; z-index: 1; transition: transform 0.4s ease, box-shadow 0.4s ease;
        }
        .profile-avatar-lg:hover { transform: scale(1.08) translateY(-5px); box-shadow: 0 0 35px rgba(255, 51, 51, 0.6); }
        #profileNameLarge { font-size: 2.2rem; margin-bottom: 5px; color: var(--text-light); font-weight: 700; text-shadow: 0 3px 8px rgba(0,0,0,0.6); z-index: 1;}
        #profileUsernameLarge { color: var(--primary-light); margin-bottom: 10px; font-size: 1.2rem; font-weight: 500; display: inline-block; padding: 5px 15px; background: rgba(0,0,0,0.4); border-radius: 25px; z-index: 1;}
        #profileEmailLarge, #profileJoinedLarge { color: var(--text-muted); margin-bottom: 8px; font-size: 0.95rem; display: inline-flex; align-items: center; gap: 8px; background: rgba(0,0,0,0.25); padding: 6px 12px; border-radius: 20px; z-index: 1;}
        #profileEmailLarge i, #profileJoinedLarge i { color: var(--primary-color); }
        .profile-bio-box {
            margin-top: 20px; color: var(--text-light); line-height: 1.7; font-size: 0.95rem;
            padding: 20px 25px; background-color: rgba(255, 255, 255, 0.05);
            border-radius: var(--border-radius-sm); border-left: 4px solid var(--primary-color);
            text-align: left; position: relative; box-shadow: var(--shadow-sm); max-width: 600px; width:100%;
            z-index: 1;
        }
        .profile-bio-box::before { content: '\f10d'; font-family: "Font Awesome 6 Free"; font-weight: 900; position: absolute; top: 15px; right: 20px; font-size: 1.8rem; color: var(--primary-color); opacity: 0.1; }

        .profile-dashboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; margin-bottom: 30px; }
        .profile-dashboard-item { background-color: var(--card-bg); padding: 25px; border-radius: var(--border-radius); box-shadow: var(--shadow-md); transition: transform 0.3s ease, box-shadow 0.3s ease; border: 1px solid rgba(255,255,255,0.08);}
        .profile-dashboard-item:hover { transform: translateY(-5px); box-shadow: var(--shadow-lg); }
        .profile-dashboard-item h3 { font-size: 1.3rem; color: var(--primary-light); margin-bottom: 15px; display: flex; align-items: center; gap: 10px; font-weight: 600; }
        .points-amount-large { font-size: 3.5rem; font-weight: 700; color: var(--primary-color); margin-bottom: 10px; line-height: 1.1; text-shadow: 0 2px 5px rgba(0,0,0,0.3); }
        .profile-dashboard-item p { color: var(--text-muted); font-size: 0.9rem; margin-bottom: 20px; }
        .withdraw-btn-large { width: 100%; font-size: 1rem; padding: 12px 20px; } /* Relies on .action-btn */

        .stat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 15px; }
        .stat-card { background-color: rgba(255,255,255,0.05); padding: 15px; border-radius: var(--border-radius-sm); text-align: center; border: 1px solid rgba(255,255,255,0.1); }
        .stat-value { display: block; font-size: 2rem; font-weight: 700; color: var(--primary-color); margin-bottom: 5px; }
        .stat-label-card { font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; }

        .profile-tabs { display: flex; gap: 10px; margin-bottom: 25px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px; overflow-x: auto; }
        .profile-tab-btn { background: none; border: none; color: var(--text-muted); font-size: 1rem; font-weight: 500; padding: 10px 18px; cursor: pointer; transition: color 0.3s ease, border-bottom-color 0.3s ease; border-bottom: 3px solid transparent; white-space: nowrap; }
        .profile-tab-btn:hover { color: var(--primary-light); }
        .profile-tab-btn.active { color: var(--primary-color); border-bottom-color: var(--primary-color); font-weight: 600; }

        .profile-tab-content { display: none; animation: tabFadeIn 0.5s ease forwards; }
        .profile-tab-content.active { display: block; }
        @keyframes tabFadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .profile-section-title { font-size: 1.6rem; margin-bottom: 20px; color: var(--primary-light); font-weight: 600; position: relative; padding-bottom: 10px; text-align: center; }
        .profile-section-title::after { content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 70px; height: 3px; background: var(--gradient); border-radius: 3px; }

        #profileBooksContainer { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 20px; margin-top: 20px; min-height: 200px; }
        #profileBooksContainer .book-card { opacity: 0; transform: translateY(20px); animation: cardFadeInUp 0.5s ease forwards; }

        .load-more-container { text-align: center; margin: 30px 0; }
        .load-more-btn { background: var(--gradient); color: white; border: none; padding: 12px 25px; border-radius: var(--border-radius-sm); font-size: 1rem; cursor: pointer; transition: var(--transition); font-weight: 600; display: inline-flex; align-items: center; justify-content: center; gap: 10px; box-shadow: var(--shadow-md); }
        .load-more-btn:hover:not(:disabled) { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(255, 51, 51, 0.5); background: var(--gradient-light); }
        .load-more-btn:disabled { background: var(--secondary-light); opacity: 0.6; cursor: not-allowed; transform: none !important; box-shadow: none; }

        #withdrawalHistoryContainer { display: flex; flex-direction: column; gap: 15px; min-height: 100px; flex-wrap: wrap; margin-top: 20px; }
        .withdrawal-item { padding: 15px 20px; border-radius: var(--border-radius-sm); background-color: rgba(255, 255, 255, 0.04); display: flex; justify-content: space-between; align-items: center; transition: var(--transition); border-left: 4px solid var(--primary-color); opacity: 0; transform: scale(0.95); animation: itemFadeInScale 0.4s ease forwards; width: 100%; word-break: break-word; }
        #withdrawalHistoryContainer .withdrawal-item:nth-child(1) { animation-delay: 0.1s; }
        #withdrawalHistoryContainer .withdrawal-item:nth-child(2) { animation-delay: 0.15s; }
        #withdrawalHistoryContainer .withdrawal-item:nth-child(3) { animation-delay: 0.2s; }
        @keyframes itemFadeInScale { to { opacity: 1; transform: scale(1); } }
        .withdrawal-item:hover { transform: translateX(5px) scale(1.01); box-shadow: var(--shadow-sm); border-left-color: var(--primary-light); }
        .withdrawal-info { flex: 1; margin-right: 15px; }
        .withdrawal-amount { font-weight: 600; color: var(--primary-color); margin-bottom: 5px; font-size: 1.05rem; }
        .withdrawal-method { font-size: 0.85rem; color: var(--text-light); margin-bottom: 5px; word-break: break-all; }
        .withdrawal-date { font-size: 0.8rem; color: var(--text-muted); }
        .withdrawal-status { padding: 6px 12px; border-radius: var(--border-radius-xs); font-size: 0.8rem; font-weight: 600; text-transform: uppercase; flex-shrink: 0; text-align: center; min-width: 80px; }
        /* Using CSS variables for withdrawal statuses for consistency */
        .withdrawal-status.status-pending { background-color: var(--status-pending-bg, #f39c12); color: white; }
        .withdrawal-status.status-completed { background-color: var(--status-completed-bg, #27ae60); color: white; }
        .withdrawal-status.status-rejected { background-color: var(--status-rejected-bg, #e74c3c); color: white; }


        .point-system-info-tabbed { background-color: rgba(255, 255, 255, 0.04); border-radius: var(--border-radius); padding: 25px; margin-top:20px; border: 1px solid rgba(255, 255, 255, 0.1); }
        .point-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px dashed rgba(255, 255, 255, 0.15); }
        .point-item:last-child { border-bottom: none; }
        .point-action { font-weight: 500; color: var(--text-light); font-size: 0.9rem; }
        .point-value { color: var(--primary-color); font-weight: 600; font-size: 1rem; }

        .profile-actions-footer { display: flex; gap: 15px; margin-top: 40px; justify-content: center; padding-bottom: 20px; flex-wrap: wrap; border-top: 1px solid rgba(255,255,255,0.1); padding-top:30px;}
        .profile-action-btn { color: white; border: none; padding: 12px 25px; border-radius: var(--border-radius-sm); font-size: 1rem; cursor: pointer; transition: var(--transition); font-weight: 600; display: inline-flex; align-items: center; justify-content: center; gap: 10px; box-shadow: var(--shadow-md); position: relative; overflow: hidden; flex: 1; min-width: 180px; max-width: 220px; }
        .profile-action-btn::after { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255, 255, 255, 0.1); opacity: 0; transition: opacity 0.3s ease; pointer-events: none; }
        .profile-action-btn:hover:not(:disabled) { transform: translateY(-3px); } /* :not(:disabled) added */
        .profile-action-btn:hover:not(:disabled)::after { opacity: 1; } /* :not(:disabled) added */
        .edit-profile { background: var(--gradient); }
        .edit-profile:hover:not(:disabled) { background: var(--gradient-light); box-shadow: 0 8px 20px rgba(255, 51, 51, 0.5); } /* :not(:disabled) added */
        .logout-btn { background: var(--secondary-light); }
        .logout-btn:hover:not(:disabled) { background: #333; box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3); } /* :not(:disabled) added */
        /* End of Profile Redesign */


        /* --- Full Page Notifications --- */
        .notifications-page {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background-color: var(--bg-dark);
            z-index: 2000;
            transform: translateX(100%);
            transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            opacity: 0; visibility: hidden;
            display: flex; flex-direction: column;
        }
        .notifications-page.active {
            transform: translateX(0);
            opacity: 1; visibility: visible;
        }
        .notifications-header {
            padding: 0 15px;
            background: var(--card-bg-dark);
            color: white;
            display: flex; align-items: center; justify-content: space-between;
            height: var(--header-height);
            box-shadow: var(--shadow-md);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            flex-shrink: 0; position: relative;
        }
        /* .notifications-title removed as per previous notes, handled by tabs or implied */
        .notifications-actions {
            position: absolute; right: 15px; top: 50%; transform: translateY(-50%);
        }
        .mark-all-read-btn {
            background: none; border: none; color: var(--primary-light);
            font-size: 0.85rem; font-weight: 500; cursor: pointer;
            padding: 8px 12px; border-radius: var(--border-radius-sm);
            transition: background-color 0.2s ease, color 0.2s ease;
        }
        .mark-all-read-btn:hover:not(:disabled) { background-color: rgba(255,255,255,0.1); color: white; }
        .mark-all-read-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .mark-all-read-btn i { margin-right: 6px; }

        .notifications-tabs {
            display: flex;
            background-color: var(--card-bg);
            padding: 0 10px;
            flex-shrink: 0;
        }
        .notification-tab-btn {
            flex: 1; text-align: center;
            background: none; border: none;
            color: var(--text-muted);
            font-size: 0.95rem; font-weight: 500;
            padding: 12px 10px;
            cursor: pointer;
            transition: color 0.3s ease, border-bottom-color 0.3s ease;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
        }
        .notification-tab-btn:hover { color: var(--primary-light); }
        .notification-tab-btn.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            font-weight: 600;
        }
        .notifications-content-area {
            flex: 1; overflow-y: hidden; /* Parent handles scroll if needed, individual lists scroll */
            position: relative;
        }
        .notifications-list-container {
            position: absolute; top: 0; left:0; width: 100%; height: 100%;
            overflow-y: auto; padding: 15px;
            opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .notifications-list-container.active {
            opacity: 1; visibility: visible;
        }


        .notification-group { margin-bottom: 20px; }
        .notification-group-date {
            font-size: 0.9rem; font-weight: 600; color: var(--text-muted);
            margin-bottom: 10px; padding-bottom: 5px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            text-transform: uppercase; letter-spacing: 0.5px;
        }
        .notification-item {
            background-color: var(--card-bg);
            border-radius: var(--border-radius-sm);
            padding: 15px; margin-bottom: 12px;
            display: flex; align-items: flex-start;
            box-shadow: var(--shadow-sm);
            border-left: 4px solid transparent;
            transition: background-color 0.3s ease, transform 0.2s ease;
            cursor: pointer;
            opacity: 0; animation: itemFadeInScale 0.4s ease forwards;
        }
        .notification-item:hover {
            background-color: var(--secondary-light);
            transform: translateX(3px);
        }
        .notification-item.unread {
             background-color: rgba(52, 152, 219, 0.08); /* Subtle blue for unread */
             border-left-color: var(--notification-unread-dot);
        }
        .notification-item.unread .notification-title { color: var(--primary-light); }

        .notification-item.type-success { border-left-color: var(--notification-border-success); }
        .notification-item.type-success.unread { background-color: var(--notification-bg-success); }
        .notification-item.type-info { border-left-color: var(--notification-border-info); }
        .notification-item.type-info.unread { background-color: var(--notification-bg-info); }
        .notification-item.type-warning { border-left-color: var(--notification-border-warning); }
        .notification-item.type-warning.unread { background-color: var(--notification-bg-warning); }
        .notification-item.type-error { border-left-color: var(--notification-border-error); }
        .notification-item.type-error.unread { background-color: var(--notification-bg-error); }
        /* Admin Announcement specific style if needed */
        .notification-item.type-announcement { border-left-color: var(--primary-color); /* Or a distinct color */ }
        .notification-item.type-announcement .notification-icon { color: var(--primary-color); }


        .notification-icon {
            font-size: 1.4rem; width: 40px; height: 40px;
            flex-shrink: 0; margin-right: 15px;
            display: flex; align-items: center; justify-content: center;
            border-radius: 50%; background-color: rgba(255,255,255,0.05);
        }
        .notification-item.type-success .notification-icon { color: var(--notification-border-success); }
        .notification-item.type-info .notification-icon { color: var(--notification-border-info); }
        .notification-item.type-warning .notification-icon { color: var(--notification-border-warning); }
        .notification-item.type-error .notification-icon { color: var(--notification-border-error); }

        .notification-content { flex: 1; }
        .notification-title {
            font-size: 1rem; font-weight: 600; color: var(--text-light);
            margin-bottom: 5px;
        }
        .notification-message {
            font-size: 0.9rem; color: var(--text-muted);
            line-height: 1.5; margin-bottom: 8px;
            word-break: break-word; /* Added for long messages */
        }
        .notification-timestamp {
            font-size: 0.75rem; color: var(--text-muted); opacity: 0.8;
        }
        /* End of Full Page Notifications */


        /* --- Modals --- */
        .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.85); z-index: 2500; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.3s ease; backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); padding: 20px 0; /* Padding for scroll */ }
        .modal.active { display: flex; opacity: 1; }
        .modal-content { background-color: var(--card-bg-dark); border-radius: var(--border-radius); width: 90%; max-width: 480px; padding: 30px; box-shadow: var(--shadow-xl); transform: translateY(-20px) scale(0.95); transition: transform 0.35s cubic-bezier(0.175, 0.885, 0.32, 1.275), opacity 0.3s ease; position: relative; max-height: 90vh; overflow-y: auto; border: 1px solid rgba(255, 255, 255, 0.1); }
        .modal.active .modal-content { transform: translateY(0) scale(1); }
        .modal-content::-webkit-scrollbar { width: 6px; }
        .modal-content::-webkit-scrollbar-thumb { background-color: var(--primary-color); border-radius: 6px; }
        .modal-content::-webkit-scrollbar-track { background-color: rgba(255,255,255,0.05); }

        .close-modal { position: absolute; top: 10px; right: 10px; font-size: 1.8rem; color: var(--text-muted); cursor: pointer; background: none; border: none; transition: transform 0.3s ease, color 0.3s ease; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; border-radius: 50%; line-height: 1; z-index: 10; }
        .close-modal:hover { color: var(--primary-color); transform: rotate(90deg) scale(1.1); }

        .modal-title { font-size: 1.6rem; margin-bottom: 25px; color: var(--primary-light); text-align: center; position: relative; padding-bottom: 12px; font-weight: 600; }
        .modal-title::after { content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 60px; height: 4px; background: var(--gradient); border-radius: 4px; }
        .form-group { margin-bottom: 20px; position: relative; }
        .form-label { display: block; margin-bottom: 8px; font-weight: 500; color: var(--text-dark); font-size: 0.9rem; }
        .form-input, .form-textarea { width: 100%; padding: 12px 15px; border: 1px solid rgba(255, 255, 255, 0.15); border-radius: var(--border-radius-sm); font-family: 'Poppins', sans-serif; background-color: var(--bg-light); color: var(--text-dark); transition: var(--transition); font-size: 0.95rem; }
        .form-textarea { resize: vertical; min-height: 80px; }
        .form-input:focus, .form-textarea:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(255, 51, 51, 0.3); }

        .submit-btn, .tutorial-btn, .profile-action-btn, .load-more-btn, .withdraw-btn, .book-overlay-btn, .download-btn, .action-btn { position: relative; }
        .submit-btn .spinner, .tutorial-btn .spinner, .profile-action-btn .spinner, .load-more-btn .spinner, .withdraw-btn .spinner, .withdraw-btn-large .spinner, .action-btn .spinner {
            position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%);
        }
        .submit-btn > span:not(.spinner), .tutorial-btn > span:not(.spinner), .profile-action-btn > span:not(.spinner), .load-more-btn > span:not(.spinner), .withdraw-btn > span:not(.spinner), .withdraw-btn-large > span:not(.spinner), .action-btn > span:not(.spinner) {
            transition: opacity 0.2s ease;
            display: inline-flex; /* To allow gap with icon */
            align-items: center;
            gap: 8px; /* Consistent gap */
        }
        .submit-btn.loading > span:not(.spinner), .tutorial-btn.loading > span:not(.spinner), .profile-action-btn.loading > span:not(.spinner), .load-more-btn.loading > span:not(.spinner), .withdraw-btn.loading > span:not(.spinner), .withdraw-btn-large.loading > span:not(.spinner), .action-btn.loading > span:not(.spinner) {
            opacity: 0;
        }


        .submit-btn, .tutorial-btn { color: white; border: none; padding: 12px 18px; border-radius: var(--border-radius-sm); font-size: 1rem; font-weight: 500; cursor: pointer; width: 100%; transition: var(--transition); margin-top: 10px; display: flex; align-items: center; justify-content: center; /* gap: 8px; already handled by child span */ box-shadow: var(--shadow-sm); position: relative; overflow: hidden; }
        .submit-btn { background: var(--gradient); }
        .tutorial-btn { background: var(--secondary-light); }
        .submit-btn:hover:not(:disabled) { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(255, 51, 51, 0.5); background: var(--gradient-light); }
        .tutorial-btn:hover:not(:disabled) { background: #333; transform: translateY(-2px); box-shadow: var(--shadow-md); }
        .submit-btn:disabled, .tutorial-btn:disabled { background: var(--secondary-light) !important; opacity: 0.6; cursor: not-allowed; transform: none !important; box-shadow: none !important; }

        .submit-btn::after { content: ''; position: absolute; top: -50%; left: -75%; width: 50%; height: 200%; background: linear-gradient(to right, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 0.2) 50%, rgba(255, 255, 255, 0) 100%); transform: skewX(-25deg); transition: left 0.7s ease; pointer-events: none; }
        .submit-btn:hover:not(:disabled)::after { left: 125%; }

        .auth-switch { text-align: center; margin-top: 20px; color: var(--text-muted); font-size: 0.9rem; }
        .auth-switch a { color: var(--primary-color); font-weight: 500; cursor: pointer; transition: color 0.3s ease; text-decoration: none; }
        .auth-switch a:hover { color: var(--primary-light); text-decoration: underline; }

        /* Withdrawal Modal Specifics */
        .withdrawal-options { display: flex; flex-direction: column; gap: 12px; margin: 25px 0; }
        .withdrawal-option { display: flex; align-items: center; padding: 15px; border-radius: var(--border-radius-sm); background-color: rgba(255, 255, 255, 0.05); cursor: pointer; transition: var(--transition); border: 2px solid transparent; }
        .withdrawal-option:hover { background-color: rgba(255, 255, 255, 0.1); border-color: rgba(255, 255, 255, 0.2); transform: scale(1.02); }
        .withdrawal-option.active { border: 2px solid var(--primary-color); background-color: rgba(255, 51, 51, 0.1); transform: scale(1.02); }
        .withdrawal-icon { width: 40px; height: 40px; border-radius: 50%; background: var(--gradient); color: white; display: flex; align-items: center; justify-content: center; margin-right: 15px; flex-shrink: 0; font-size: 1.1rem; box-shadow: var(--shadow-sm); }
        .withdrawal-details { flex: 1; }
        .withdrawal-title { font-size: 1rem; font-weight: 600; margin-bottom: 3px; color: var(--text-dark); }
        .withdrawal-description { font-size: 0.85rem; color: var(--text-muted); }

        .amount-selection { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px; margin: 25px 0; }
        .amount-option { padding: 12px; text-align: center; border-radius: var(--border-radius-sm); background-color: rgba(255, 255, 255, 0.05); cursor: pointer; transition: var(--transition); font-weight: 500; border: 2px solid transparent; font-size: 0.9rem; }
        .amount-option:hover { background-color: rgba(255, 255, 255, 0.1); border-color: rgba(255, 255, 255, 0.2); transform: scale(1.03); }
        .amount-option.active { background: var(--gradient); color: white; border-color: var(--primary-dark); transform: scale(1.03); }

        .payment-details { margin-top: 20px; display: none; animation: fadeIn 0.5s ease forwards; }
        .payment-details.active { display: block; }


        /* Discover Modal Specifics */
        .discover-list { max-height: 60vh; overflow-y: auto; padding-right: 10px; margin: 15px 0; }
        .discover-item { display: flex; padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.08); transition: all 0.3s ease; align-items: center; cursor: pointer; border-radius: var(--border-radius-sm); margin-bottom: 10px; background-color: rgba(255, 255, 255, 0.03); }
        .discover-item:last-child { border-bottom: none; margin-bottom: 0; }
        .discover-item:hover { background-color: rgba(255, 255, 255, 0.08); transform: translateX(5px) scale(1.01); }
        .discover-icon { width: 40px; height: 40px; border-radius: 50%; background: var(--gradient); color: white; display: flex; align-items: center; justify-content: center; margin-right: 15px; flex-shrink: 0; font-size: 1.1rem; box-shadow: var(--shadow-sm); }
        .discover-content { flex: 1; }
        .discover-title { font-size: 1rem; color: var(--text-dark); margin-bottom: 5px; font-weight: 600; }
        .discover-description { font-size: 0.85rem; color: var(--text-muted); line-height: 1.5; }

        /* Credit Modal Specifics */
        .credit-options-list { display: flex; flex-direction: column; gap: 15px; margin-top: 20px; }
        #creditModalUserCredits { color: var(--credit-color); font-weight: 700; }


        /* --- Book Detail Modal --- */
        #bookDetailModal .modal-content { max-width: 650px; }
        .book-detail-layout { display: flex; gap: 25px; }
        .book-detail-image { flex-shrink: 0; width: 200px; height: 280px; }
        .book-detail-image img { width: 100%; height: 100%; object-fit: cover; border-radius: var(--border-radius-sm); box-shadow: var(--shadow-md); }
        .book-detail-info { flex-grow: 1; }
        .book-detail-title { font-size: 1.7rem; font-weight: 700; color: var(--primary-light); margin-bottom: 5px; line-height: 1.3; }
        .book-detail-author { font-size: 1rem; color: var(--text-dark); margin-bottom: 8px; font-weight: 500; }
        .book-detail-category { font-size: 0.9rem; color: var(--text-muted); margin-bottom: 15px; display: inline-block; background: rgba(255,255,255,0.05); padding: 4px 10px; border-radius: 15px; }
        .book-detail-meta { display: flex; gap: 20px; font-size: 0.9rem; color: var(--text-muted); margin-bottom: 20px; align-items: center; flex-wrap: wrap; }
        .book-detail-meta span { display: flex; align-items: center; gap: 6px; }
        .book-detail-meta i { color: var(--primary-color); font-size: 1rem; }
        .book-detail-description { margin: 20px 0; padding: 15px; background: rgba(255,255,255,0.04); border-radius: var(--border-radius-sm); line-height: 1.7; font-size: 0.95rem; max-height: 150px; overflow-y: auto; color: var(--text-light); border-left: 3px solid var(--primary-color); word-break: break-word; } /* Added word-break */
        .book-detail-actions { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; }
        .detail-download-btn { flex-grow: 1; } /* Relies on .action-btn */
        .feedback-separator { height: 1px; background: rgba(255,255,255,0.1); margin: 30px 0; }

        .feedback-section { margin-top: 25px; }
        .feedback-title { font-size: 1.3rem; color: var(--primary-light); margin-bottom: 20px; font-weight: 600; border-bottom: 2px solid var(--primary-color); padding-bottom: 8px; display: inline-block; }
        .rating-stars { margin-bottom: 15px; }
        .rating-stars label { font-size: 1rem; color: var(--text-dark); margin-right: 10px; }
        .rating-stars .stars { display: inline-block; }
        .rating-stars .stars > i { font-size: 1.6rem; color: var(--text-muted); cursor: pointer; transition: color 0.2s ease, transform 0.2s ease; margin: 0 3px; }
        .rating-stars .stars:hover > i { color: var(--star-color); }
        .rating-stars .stars > i:hover ~ i { color: var(--text-muted); }
        .rating-stars .stars > i.selected,
        .rating-stars .stars > i.hovered { color: var(--star-color); transform: scale(1.1); }

        #feedbackComment { margin-bottom: 15px; }
        #submitFeedbackBtn { width: auto; padding: 10px 25px; } /* Relies on .submit-btn */

        .comments-list { margin-top: 25px; max-height: 250px; overflow-y: auto; padding-right: 10px; display: flex; flex-direction: column; gap: 15px; }
        .comment-item { background-color: rgba(255, 255, 255, 0.04); padding: 15px; border-radius: var(--border-radius-sm); border-left: 3px solid var(--secondary-light); }
        .comment-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .comment-author { font-weight: 600; color: var(--text-dark); font-size: 0.95rem; }
        .comment-rating i { color: var(--star-color); font-size: 0.8rem; margin-left: 2px; }
        .comment-body { font-size: 0.9rem; color: var(--text-light); line-height: 1.6; word-break: break-word; }
        .comment-date { font-size: 0.75rem; color: var(--text-muted); margin-top: 10px; text-align: right; }
        .no-comments { text-align: center; color: var(--text-muted); padding: 20px 0; }

        @media (max-width: 680px) {
            .book-detail-layout { flex-direction: column; align-items: center; }
            .book-detail-image { width: 180px; height: 250px; margin-bottom: 15px; }
            .book-detail-info { text-align: center; }
            .book-detail-meta { justify-content: center; }
            .book-detail-actions { justify-content: center; }
        }


        /* Toast Notifications */
        #toastContainer { position: fixed; top: 25px; right: 25px; z-index: 3000; display: flex; flex-direction: column; gap: 10px; }
        .toast { /* position, top, right moved to #toastContainer */ padding: 15px 25px; border-radius: var(--border-radius-sm); background-color: var(--secondary-light); color: white; box-shadow: var(--shadow-xl); transform: translateX(calc(100% + 30px)); transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55); display: flex; align-items: center; max-width: 380px; border-left: 5px solid var(--primary-color); }
        .toast.show { transform: translateX(0); }
        .toast.success { background-color: #27ae60; border-left-color: #2ecc71; }
        .toast.error { background-color: #e74c3c; border-left-color: #ff4757; }
        .toast.warning { background-color: #f39c12; border-left-color: #f1c40f; }
        .toast.info { background-color: #3498db; border-left-color: #2980b9; }
        .toast i { margin-right: 12px; font-size: 1.3rem; }
        .toast span:not(.toast-close) { flex-grow: 1; word-break: break-word; }
        .toast-close { margin-left: 15px; cursor: pointer; opacity: 0.7; transition: opacity 0.2s ease; font-size: 1.2rem; background: none; border: none; color: white; padding: 5px; }
        .toast-close:hover { opacity: 1; }

        /* Loading Spinner */
        .spinner { display: inline-block; width: 18px; height: 18px; border: 3px solid rgba(255, 255, 255, 0.3); border-radius: 50%; border-top-color: white; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* Empty State */
        .empty-state { text-align: center; padding: 50px 20px; color: var(--text-muted); width: 100%; display: none; flex-direction: column; align-items: center; justify-content: center; min-height: 200px; grid-column: 1 / -1; /* Ensure it spans grid if parent is grid */ }
        .empty-state i { font-size: 3.5rem; margin-bottom: 20px; color: var(--primary-color); opacity: 0.5; animation: bounce 2s infinite cubic-bezier(0.68, -0.55, 0.27, 1.55); }
        @keyframes bounce { 0%, 100% { transform: translateY(0) scale(1); } 50% { transform: translateY(-15px) scale(1.05); } }
        .empty-state h3 { margin-bottom: 12px; color: var(--text-light); font-size: 1.3rem; font-weight: 600; }
        .empty-state p { font-size: 0.95rem; max-width: 350px; margin: 0 auto; color: var(--text-muted); }


        /* Responsive Styles */
        @media (max-width: 992px) {
            .container { padding: 20px 15px; }
            .books-grid, #profileBooksContainer { grid-template-columns: repeat(auto-fill, minmax(170px, 1fr)); gap: 20px; }
            .popular-book-card { width: 150px; }
            .popular-book-img-container { height: 180px; }
            .profile-dashboard { grid-template-columns: 1fr; } /* Stack dashboard items */
        }

        @media (max-width: 768px) {
            :root { --header-height: 65px; --nav-height: 65px; }
            body { padding-top: var(--header-height); padding-bottom: var(--nav-height); }
            .header { padding: 0 15px; }
            .logo { font-size: 1.6rem; } .logo i { font-size: 1.4rem; }
            .user-avatar { width: 38px; height: 38px; font-size: 0.9rem;}
            .profile-avatar-lg { width: 110px; height: 110px; font-size: 2.8rem; }
            #profileNameLarge { font-size: 2rem; }
            .points-amount-large { font-size: 3rem; }
            .stat-value { font-size: 1.8rem; }
            .books-grid, #profileBooksContainer { grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 15px; }
            .popular-book-card { width: 140px; }
            .popular-book-img-container { height: 170px; }
            .nav-item { width: 45px; height: 45px; font-size: 1.2rem; }
            .add-btn { width: 55px; height: 55px; font-size: 1.6rem; }
            .withdrawal-item { flex-direction: column; align-items: flex-start; gap: 8px; }
            .withdrawal-status { align-self: flex-start; }
            .profile-action-btn { min-width: 150px; }
            .category-filter-item { padding: 7px 15px; font-size: 0.85rem;}
            /* .notifications-title removed as per previous notes, handled by tabs or implied */
            .notifications-tabs { padding: 0 5px;}
            .notification-tab-btn { font-size: 0.9rem; padding: 10px 8px;}
        }

        @media (max-width: 576px) {
            :root { --header-height: 60px; --nav-height: 60px; }
            .header { padding: 0 10px; }
            .logo { font-size: 1.5rem; } .logo i { font-size: 1.3rem; margin-right: 8px;}
            .user-avatar { width: 35px; height: 35px; font-size: 0.8rem;}
            .container { padding: 15px 10px; }
            .popular-books-section { padding: 20px 10px; }
            .section-title { font-size: 1.5rem; margin-bottom: 20px; }
            .popular-book-card { width: 130px; }
            .popular-book-img-container { height: 160px; }
            .page-title { font-size: 1.8rem; }
            .books-grid, #profileBooksContainer { grid-template-columns: repeat(2, 1fr); gap: 12px; }
            .book-card:hover { transform: translateY(-5px) scale(1.01); }
            .book-img-container { height: 180px; }
            .profile-page-content { padding: 10px; padding-top: var(--header-height); padding-bottom: calc(var(--nav-height) + 15px); }
            .profile-main-header { padding: 30px 15px 20px; }
            .profile-avatar-lg { width: 90px; height: 90px; font-size: 2.2rem; }
            #profileNameLarge { font-size: 1.6rem; }
            #profileUsernameLarge { font-size: 1rem; }
            #profileEmailLarge, #profileJoinedLarge { font-size: 0.9rem; }
            .profile-bio-box { padding: 15px; font-size: 0.9rem; }
            .points-amount-large { font-size: 2.5rem; }
            .withdraw-btn-large { font-size: 0.9rem; padding: 10px 15px; }
            .stat-value { font-size: 1.6rem; }
            .profile-actions-footer { flex-direction: column; gap: 12px; align-items: center; }
            .profile-action-btn { max-width: 300px; width: 100%; min-width: unset; }
            .modal-content { padding: 20px; width: 95%; max-height: 85vh; }
            .modal-title { font-size: 1.4rem; }
            .amount-selection { grid-template-columns: 1fr 1fr; }
            .category-filter-item { padding: 6px 12px; font-size: 0.8rem; }
            .book-detail-title { font-size: 1.5rem; }
            .book-detail-author { font-size: 0.9rem; }
            .rating-stars .stars > i { font-size: 1.4rem; }
            .notifications-header { height: var(--header-height); padding: 0 10px;}
            /* .notifications-title { font-size: 1rem; } */
            .page-back-btn { width: 35px; height: 35px; font-size: 1.2rem; top: calc(12.5px + (var(--header-height) - 60px) / 2); } /* For profile and notifications */
            .notification-item { padding: 12px; }
            .notification-icon { width: 32px; height: 32px; font-size: 1.2rem; margin-right: 12px; }
            .notification-title { font-size: 0.95rem; }
            .notification-message { font-size: 0.85rem; }
            .notification-timestamp { font-size: 0.7rem; }
            .notifications-tabs {overflow-x: auto; justify-content: flex-start;}
            .notification-tab-btn { flex: 0 0 auto; padding: 10px 15px;} /* Ensure tabs are scrollable if they overflow */
        }

        @media (max-width: 400px) {
            .books-grid, #profileBooksContainer { grid-template-columns: 1fr; }
            .popular-book-card { width: 120px; }
            .popular-book-img-container { height: 150px; }
            .book-img-container { height: 220px; }
            .profile-avatar-lg { width: 80px; height: 80px; font-size: 2rem; }
            #profileNameLarge { font-size: 1.4rem; }
            .amount-selection { grid-template-columns: 1fr; }
            .category-filter-container { gap: 8px; }
            .category-filter-item { padding: 5px 10px; }
            .book-detail-image { width: 150px; height: 210px; }
        }
        * {
          -webkit-user-select: none; /* Safari and Chrome */
          user-select: none;         /* Standard */
          -webkit-tap-highlight-color: transparent; /* Removes tap highlight */
        }

    </style>
</head>
<body data-theme="dark">

    <!-- Enhanced Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-logo-container">
            <i class="fas fa-book-reader loading-logo-icon"></i>
            <span class="loading-logo-text">EduSparK</span>
        </div>
        <div class="loading-dots">
            <span></span><span></span><span></span>
        </div>
        <p class="loading-message" id="loadingMessage">Loading EduSparK Library...</p>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="logo-container">
            <a href="#" class="logo" id="logoLink">
                <i class="fas fa-book-reader"></i>
                <span class="logo-text">EduSparK</span>
            </a>
        </div>

        <div class="search-container" id="searchContainer">
            <i class="fas fa-search search-icon"></i>
            <input type="text" class="search-input" id="searchInput" placeholder="Search books, authors...">
            <div class="search-results" id="searchResults"></div>
        </div>

        <div class="header-actions">
            <button class="search-toggle-btn" id="searchToggleBtn" aria-label="Toggle Search">
                <i class="fas fa-search"></i>
            </button>
            <div class="header-credits" id="headerCreditsContainer" style="display: none;" title="Your Credits">
                <i class="fas fa-coins"></i>
                <span id="headerCreditsAmount">0</span>
            </div>
            <div class="user-avatar" id="userAvatar">
                <span id="avatarInitials">U</span>
            </div>
        </div>
    </header>

    <!-- Popular Books Section -->
    <section class="popular-books-section" data-aos="fade-in" data-aos-delay="100">
        <h2 class="section-title">🔥 Popular Now</h2>
        <div class="popular-books-carousel" id="popularBooksCarousel">
            <!-- Skeletons initially, then popular books -->
        </div>
    </section>

    <!-- Main Content -->
    <div class="container">
        <h1 class="page-title" data-aos="fade-right" data-aos-delay="200">Discover Books</h1>

        <!-- Category Filters -->
        <div class="category-filter-container" id="categoryFilterContainer" data-aos="fade-up" data-aos-delay="250">
            <!-- Categories will be loaded here by JS -->
        </div>

        <div class="books-grid" id="booksContainer">
            <!-- Skeletons initially, then books -->
        </div>
        <div id="booksGridLoadingIndicator">
            <span class="spinner"></span> Loading more books...
        </div>
         <div class="empty-state" id="emptyStateBooks"> <!-- Renamed for clarity -->
             <i class="fas fa-ghost"></i>
             <h3>No Books Found Yet</h3>
             <p>Looks a bit empty here. Try another category or check back later!</p>
         </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <div class="nav-item" id="notificationsBtn" data-tooltip="Notifications">
            <i class="fas fa-bell"></i>
            <span class="unread-badge" id="unreadNotificationsBadge" style="display: none;">0</span>
        </div>
        <div class="nav-item active" id="homeBtn" data-tooltip="Home">
            <i class="fas fa-home"></i>
        </div>
        <button class="add-btn" id="addBookBtn" aria-label="Add Book">
            <i class="fas fa-plus"></i>
        </button>
        <div class="nav-item" id="discoverBtn" data-tooltip="Discover">
            <i class="fas fa-compass"></i>
        </div>
        <div class="nav-item" id="profileBtn" data-tooltip="Profile">
            <i class="fas fa-user"></i>
        </div>
    </nav>

    <!-- Redesigned Full Page Profile -->
    <div class="profile-page" id="profilePage">
         <div class="profile-page-content">
            <button class="page-back-btn" id="profileBackBtn" aria-label="Go Back">
                <i class="fas fa-arrow-left"></i>
            </button>

            <div class="profile-main-header" data-aos="fade-down">
                <div class="profile-avatar-lg" id="profileAvatarLarge">
                    <span id="profileAvatarInitialsLarge">U</span>
                </div>
                <h1 id="profileNameLarge">User Loading...</h1>
                <p id="profileUsernameLarge" class="profile-username-lg">@loading</p>
                <p id="profileEmailLarge" class="profile-email-lg"><i class="fas fa-envelope"></i> loading...</p>
                <p id="profileJoinedLarge" class="profile-joined-lg"><i class="fas fa-calendar-alt"></i> Joined: -</p>
                <div class="profile-bio-box" id="profileBioLarge" data-aos="fade-up" data-aos-delay="100">
                    Loading bio...
                </div>
            </div>

            <div class="profile-dashboard" data-aos="fade-up" data-aos-delay="200">
                <div class="profile-dashboard-item points-dashboard">
                    <h3><i class="fas fa-coins"></i> Your Points</h3>
                    <div class="points-amount-large" id="userPointsLarge">0</div>
                    <p>Redeem points for exciting rewards or cash!</p>
                    <button class="withdraw-btn-large action-btn" id="withdrawBtnLarge" disabled>
                        <span class="spinner" style="display: none;"></span>
                        <span><i class="fas fa-hand-holding-usd"></i> Withdraw Points</span>
                    </button>
                </div>
                <div class="profile-dashboard-item stats-dashboard">
                    <h3><i class="fas fa-chart-line"></i> Your Activity</h3>
                    <div class="stat-grid">
                        <div class="stat-card">
                            <span class="stat-value" id="booksSharedLarge">0</span>
                            <span class="stat-label-card">Books Shared</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-value" id="booksDownloadedLarge">0</span>
                            <span class="stat-label-card">Your Downloads</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-value" id="totalBookDownloadsLarge">0</span>
                            <span class="stat-label-card">Shared Book Downloads</span>
                        </div>
                         <div class="stat-card">
                            <span class="stat-value" id="totalFeedbackLarge">0</span>
                            <span class="stat-label-card">Feedback Given</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="profile-tabs" data-aos="fade-up" data-aos-delay="300">
                <button class="profile-tab-btn active" data-tab="shared-books">My Shared Books</button>
                <button class="profile-tab-btn" data-tab="withdrawal-history">Withdrawal History</button>
                <button class="profile-tab-btn" data-tab="point-system">Point System</button>
            </div>

            <div class="profile-tab-content active" id="tab-shared-books" data-aos="fade-up" data-aos-delay="350">
                <h3 class="profile-section-title">Your Shared Books</h3>
                <div id="profileBooksContainer" class="books-grid">
                     <div class="empty-state" id="emptyProfileBooks" style="display: none;">
                         <i class="fas fa-book-medical"></i>
                         <h3>No Books Shared Yet</h3>
                         <p>Share your knowledge with the community!</p>
                     </div>
                </div>
                 <div class="load-more-container" id="loadMoreContainer">
                    <button class="load-more-btn" id="loadMoreBooksBtn" style="display: none;">
                        <span class="spinner" style="display: none;"></span>
                        <span><i class="fas fa-chevron-down"></i> Load More</span>
                    </button>
                </div>
            </div>

            <div class="profile-tab-content" id="tab-withdrawal-history">
                <h3 class="profile-section-title">Withdrawal History</h3>
                <div id="withdrawalHistoryContainer">
                    <div class="empty-state" id="emptyWithdrawalHistory" style="display: none;">
                        <i class="fas fa-history"></i>
                        <h3>No Withdrawals Yet</h3>
                        <p>Your withdrawal history will appear here.</p>
                    </div>
                 </div>
            </div>

             <div class="profile-tab-content" id="tab-point-system">
                 <h3 class="profile-section-title">Point System Guide</h3>
                 <div class="point-system-info-tabbed">
                    <div class="point-item"><span class="point-action">Share Approved Book</span><span class="point-value">+10 Points</span></div>
                    <div class="point-item"><span class="point-action">Book Downloaded (by others)</span><span class="point-value">+1 Point</span></div>
                    <div class="point-item"><span class="point-action">Min. Withdrawal (500 Points)</span><span class="point-value">₹50</span></div>
                    <div class="point-item"><span class="point-action">1000 Points</span><span class="point-value">₹100</span></div>
                    <hr style="border-color: rgba(255,255,255,0.1); margin: 10px 0;">
                    <div class="point-item"><span class="point-action">Daily Login Bonus</span><span class="point-value">+20 Credits</span></div>
                    <div class="point-item"><span class="point-action">Download a Book</span><span class="point-value">-30 Credits</span></div>
                     <div class="point-item"><span class="point-action">Complete Credit Boost</span><span class="point-value">+50 Credits</span></div> <!-- Added for clarity -->
                    <p style="font-size: 0.8rem; color: var(--text-muted); text-align: center; margin-top: 20px;">
                        <b>Points</b> are for cash withdrawal. <b>Credits</b> are for downloading books.
                    </p>
                 </div>
            </div>

            <div class="profile-actions-footer" data-aos="fade-up" data-aos-delay="400">
                <button class="profile-action-btn edit-profile" id="editProfileBtn">
                    <span class="spinner" style="display: none;"></span>
                    <span><i class="fas fa-user-edit"></i> Edit Profile</span>
                </button>
                <button class="profile-action-btn logout-btn" id="logoutBtn">
                     <span class="spinner" style="display: none;"></span>
                     <span><i class="fas fa-sign-out-alt"></i> Logout</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Full Page Notifications -->
    <div class="notifications-page" id="notificationsPage">
        <div class="notifications-header">
            <button class="page-back-btn" id="notificationsBackBtn" aria-label="Go Back">
                <i class="fas fa-arrow-left"></i>
            </button>
            <!-- <div class="notifications-title">Notifications</div> -->
            <div class="notifications-actions">
                <button class="mark-all-read-btn" id="markAllNotificationsReadBtn" disabled>
                    <i class="fas fa-check-double"></i> Mark All Read
                </button>
            </div>
        </div>
        <div class="notifications-tabs">
            <button class="notification-tab-btn active" data-tab="personal">Personal</button>
            <button class="notification-tab-btn" data-tab="announcements">Announcements</button>
        </div>
        <div class="notifications-content-area">
            <div class="notifications-list-container active" id="personalNotificationsListContainer">
                <div class="empty-state" id="emptyPersonalNotificationsState" style="display: none;">
                    <i class="fas fa-bell-slash"></i>
                    <h3>No Personal Notifications</h3>
                    <p>Important updates and alerts related to your activity will appear here.</p>
                </div>
                <!-- Personal notifications will be loaded here -->
            </div>
            <div class="notifications-list-container" id="adminAnnouncementsListContainer">
                <div class="empty-state" id="emptyAdminAnnouncementsState" style="display: none;">
                    <i class="fas fa-bullhorn"></i>
                    <h3>No Announcements Yet</h3>
                    <p>Check back later for updates from the EduSparK team.</p>
                </div>
                <!-- Admin announcements will be loaded here -->
            </div>
        </div>
    </div>


    <!-- Modals -->
    <div class="modal" id="addBookModal">
        <div class="modal-content">
            <button class="close-modal" id="closeAddBookModal" aria-label="Close">&times;</button>
            <h2 class="modal-title">Share a New Book</h2>
            <form id="addBookForm">
                <div class="form-group">
                    <label for="bookName" class="form-label">Book Title *</label>
                    <input type="text" id="bookName" class="form-input" placeholder="e.g., Introduction to Algorithms" required>
                </div>
                <div class="form-group">
                    <label for="authorName" class="form-label">Author(s) *</label>
                    <input type="text" id="authorName" class="form-input" placeholder="e.g., Thomas H. Cormen" required>
                </div>
                <div class="form-group">
                    <label for="bookCategory" class="form-label">Category *</label>
                    <input type="text" id="bookCategory" class="form-input" placeholder="e.g., Computer Science, 12th, NEET" required>
                     <small style="color: var(--text-muted); font-size: 0.75rem; margin-top: 5px; display: block;">
                         Use relevant keywords like 'JEE', '10th', 'Fiction', etc.
                     </small>
                </div>
                <div class="form-group">
                    <label for="bookImageUrl" class="form-label">Cover Image URL *</label>
                    <input type="url" id="bookImageUrl" class="form-input" placeholder="Paste direct image link" required>
                </div>
                <div class="form-group">
                    <label for="driveLink" class="form-label">Google Drive Link *</label>
                    <input type="url" id="driveLink" class="form-input" placeholder="Ensure link sharing is 'Anyone with the link'" required>
                     <small style="color: var(--text-muted); font-size: 0.75rem; margin-top: 5px; display: block;">
                         Right-click file in Drive > Share > Set 'Anyone with the link' > Copy link.
                     </small>
                </div>
                <div class="form-group">
                    <label for="bookDescription" class="form-label">Description (Optional)</label>
                    <textarea id="bookDescription" class="form-textarea" placeholder="Briefly describe the book..." rows="3"></textarea>
                </div>
                <button type="submit" class="submit-btn" id="submitBookBtn">
                    <span class="spinner" style="display: none;"></span>
                    <span>Submit for Approval</span>
                </button>
                 <button type="button" class="tutorial-btn" onclick="window.open('https://t.me/official_learnhub/140', '_blank')">
                     <span><i class="fas fa-question-circle"></i> How to Get Drive Link?</span>
                 </button>
            </form>
        </div>
    </div>

    <div class="modal" id="loginModal">
        <div class="modal-content">
            <button class="close-modal" id="closeLoginModal" aria-label="Close">&times;</button>
            <h2 class="modal-title">Welcome Back!</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label for="loginEmail" class="form-label">Email</label>
                    <input type="email" id="loginEmail" class="form-input" placeholder="your.email@example.com" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword" class="form-label">Password</label>
                    <input type="password" id="loginPassword" class="form-input" placeholder="••••••••" required>
                </div>
                <button type="submit" class="submit-btn" id="loginBtn">
                    <span class="spinner" style="display: none;"></span>
                    <span>Login</span>
                </button>
            </form>
            <div class="auth-switch">
                Don't have an account? <a id="switchToSignup">Sign up here</a>
            </div>
        </div>
    </div>

    <div class="modal" id="signupModal">
        <div class="modal-content">
            <button class="close-modal" id="closeSignupModal" aria-label="Close">&times;</button>
            <h2 class="modal-title">Join EduSparK</h2>
            <form id="signupForm">
                 <div class="form-group">
                    <label for="signupName" class="form-label">Full Name</label>
                    <input type="text" id="signupName" class="form-input" placeholder="e.g., Ada Lovelace" required>
                </div>
                <div class="form-group">
                    <label for="signupUsername" class="form-label">Username</label>
                    <input type="text" id="signupUsername" class="form-input" placeholder="Choose a unique username" required>
                     <small style="color: var(--text-muted); font-size: 0.75rem; margin-top: 5px; display: block;">
                         3-15 chars, lowercase, numbers, _, .
                     </small>
                </div>
                <div class="form-group">
                    <label for="signupEmail" class="form-label">Email</label>
                    <input type="email" id="signupEmail" class="form-input" placeholder="your.email@example.com" required>
                </div>
                <div class="form-group">
                    <label for="signupPassword" class="form-label">Password</label>
                    <input type="password" id="signupPassword" class="form-input" placeholder="Choose a strong password" required>
                </div>
                <div class="form-group">
                    <label for="signupBio" class="form-label">Bio (Optional)</label>
                    <textarea id="signupBio" class="form-textarea" placeholder="Share something about yourself..." rows="2"></textarea>
                </div>
                <button type="submit" class="submit-btn" id="signupBtn">
                    <span class="spinner" style="display: none;"></span>
                    <span>Create Account</span>
                </button>
            </form>
            <div class="auth-switch">
                Already have an account? <a id="switchToLogin">Login here</a>
            </div>
        </div>
    </div>

    <div class="modal" id="editProfileModal">
        <div class="modal-content">
            <button class="close-modal" id="closeEditProfileModal" aria-label="Close">&times;</button>
            <h2 class="modal-title">Edit Your Profile</h2>
            <form id="editProfileForm">
                <div class="form-group">
                    <label for="editProfileName" class="form-label">Full Name</label>
                    <input type="text" id="editProfileName" class="form-input" placeholder="Enter your full name" required>
                </div>
                <div class="form-group">
                    <label for="editProfileUsername" class="form-label">Username</label>
                    <input type="text" id="editProfileUsername" class="form-input" placeholder="Choose a username" required>
                     <small style="color: var(--text-muted); font-size: 0.75rem; margin-top: 5px; display: block;">
                         3-15 chars, lowercase, numbers, _, .
                     </small>
                </div>
                <div class="form-group">
                    <label for="editProfileBio" class="form-label">Bio</label>
                    <textarea id="editProfileBio" class="form-textarea" placeholder="Tell the community about yourself" rows="3"></textarea>
                </div>
                <button type="submit" class="submit-btn" id="saveProfileBtn">
                    <span class="spinner" style="display: none;"></span>
                    <span>Save Changes</span>
                </button>
            </form>
        </div>
    </div>

    <div class="modal" id="discoverModal">
        <div class="modal-content">
            <button class="close-modal" id="closeDiscoverModal" aria-label="Close">&times;</button>
            <h2 class="modal-title">Discover More</h2>
            <div class="discover-list" id="discoverList">
                <!-- Static Example Items - Replace with dynamic content if needed -->
                 <div class="discover-item" onclick="showToast('Feature coming soon!', 'info')">
                    <div class="discover-icon"><i class="fas fa-trophy"></i></div>
                    <div class="discover-content">
                        <div class="discover-title">Top Contributors</div>
                        <div class="discover-description">See who's sharing the most knowledge! (Coming Soon)</div>
                    </div>
                </div>
                 <div class="discover-item" onclick="window.open('https://t.me/official_learnhub', '_blank')">
                    <div class="discover-icon"><i class="fab fa-telegram-plane"></i></div>
                    <div class="discover-content">
                        <div class="discover-title">Join Telegram</div>
                        <div class="discover-description">Connect with the community on Telegram for updates & discussions.</div>
                    </div>
                </div>
                 <div class="discover-item" onclick="showToast('Feature coming soon!', 'info')">
                    <div class="discover-icon"><i class="fas fa-tags"></i></div>
                    <div class="discover-content">
                        <div class="discover-title">Browse by Tags</div>
                        <div class="discover-description">Find books related to specific topics or tags. (Coming Soon)</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="withdrawalModal">
        <div class="modal-content">
            <button class="close-modal" id="closeWithdrawalModal" aria-label="Close">&times;</button>
            <h2 class="modal-title">Withdraw Points</h2>
            <p style="text-align: center; color: var(--text-muted); margin-top: -15px; margin-bottom: 20px;">
                Your current balance: <strong id="withdrawalModalPoints" style="color: var(--primary-color);">0</strong> points
            </p>
            <form id="withdrawalForm">
                <div class="form-group">
                    <label class="form-label">1. Select Withdrawal Method:</label>
                    <div class="withdrawal-options">
                        <!-- Populated by JS -->
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">2. Select Amount:</label>
                    <div class="amount-selection">
                         <!-- Populated by JS -->
                    </div>
                </div>
                <div class="payment-details" id="paymentDetails">
                     <div class="form-group">
                        <label for="paymentId" class="form-label" id="paymentMethodLabel">Identifier *</label>
                        <input type="text" id="paymentId" class="form-input" placeholder="Enter details" required>
                    </div>
                     <div class="form-group" id="accountNameGroup" style="display: block;">
                        <label for="accountName" class="form-label">Account Holder Name *</label>
                        <input type="text" id="accountName" class="form-input" placeholder="Name as per account" required>
                    </div>
                    <button type="submit" class="submit-btn" id="submitWithdrawalBtn">
                         <span class="spinner" style="display: none;"></span>
                         <span>Submit Request</span>
                     </button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal" id="creditModal">
        <div class="modal-content">
            <button class="close-modal" id="closeCreditModal" aria-label="Close">&times;</button>
            <h2 class="modal-title">Earn Credits</h2>
            <p style="text-align: center; color: var(--text-muted); margin-top: -15px; margin-bottom: 25px;">
                Your current balance: <strong id="creditModalUserCredits">0</strong> <i class="fas fa-coins" style="color: var(--credit-color);"></i>
            </p>
            <div class="credit-options-list">
                
                <button class="tutorial-btn" id="conductSurveyBtn" style="margin-top:15px;">
                     <span class="spinner" style="display: none;"></span>
                     <span><i class="fas fa-poll"></i></span>
                    ‎ 
                Earn Credit ‎ 
                <span><i class="fas fa-poll"></i></span></button>
                 <p style="font-size: 0.8rem; color: var(--text-muted); text-align: center; margin-top: 20px;">
                    Tip: Use credits to download books (30 <i class="fas fa-coins" style="color:var(--credit-color);font-size:0.8em;"></i> per book). Share books to earn points for withdrawal!
                    <br><br>
                    Earn Credit By Attempting Simple Maths Quiz 🌸 (Earn 50‎ <i class="fas fa-coins" style="color:var(--credit-color);font-size:0.8em;"></i>‎ By attempting Quiz Each Time ⚡ )
                 </p>
            </div>
        </div>
    </div>

     <!-- Book Detail Modal -->
    <div class="modal" id="bookDetailModal">
        <div class="modal-content">
            <button class="close-modal" id="closeBookDetailModal" aria-label="Close">&times;</button>
            <div id="bookDetailContent">
                <!-- Loading state -->
                <div style="text-align:center; padding: 50px 0;">
                    <div class="spinner" style="width: 30px; height: 30px; border-width: 4px;"></div>
                    <p style="margin-top: 15px; color: var(--text-muted);">Loading details...</p>
                </div>
            </div>
        </div>
    </div>


    <div id="toastContainer"></div>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        const _0x4cce9e=_0x481a;(function(_0x259a89,_0x410d72){const _0x32a524=_0x481a,_0x312f3a=_0x259a89();while(!![]){try{const _0x375dca=-parseInt(_0x32a524(0x313))/0x1*(parseInt(_0x32a524(0x234))/0x2)+-parseInt(_0x32a524(0x1c6))/0x3*(-parseInt(_0x32a524(0x2e1))/0x4)+parseInt(_0x32a524(0x175))/0x5*(-parseInt(_0x32a524(0x15e))/0x6)+-parseInt(_0x32a524(0x18b))/0x7*(-parseInt(_0x32a524(0x16c))/0x8)+-parseInt(_0x32a524(0x8f))/0x9*(parseInt(_0x32a524(0x210))/0xa)+-parseInt(_0x32a524(0x314))/0xb+parseInt(_0x32a524(0x117))/0xc;if(_0x375dca===_0x410d72)break;else _0x312f3a['push'](_0x312f3a['shift']());}catch(_0xa02e03){_0x312f3a['push'](_0x312f3a['shift']());}}}(_0x5087,0x60413));function hi(){console['log']('Hello\x20World!');}hi(),AOS[_0x4cce9e(0x30d)]({'duration':0x258,'easing':_0x4cce9e(0x263),'once':!![],'offset':0x32});const firebaseConfig={'apiKey':'AIzaSyBNi6BHTKNd62VAY7q1oHQmxjZ3r0MUA9U','authDomain':_0x4cce9e(0x7d),'projectId':_0x4cce9e(0x13c),'storageBucket':_0x4cce9e(0x2b2),'messagingSenderId':'564501033350','appId':_0x4cce9e(0xdd),'measurementId':_0x4cce9e(0x22b)};firebase[_0x4cce9e(0x1ee)](firebaseConfig);const auth=firebase[_0x4cce9e(0x2fe)](),db=firebase[_0x4cce9e(0x1aa)](),storage=firebase[_0x4cce9e(0x279)](),appCheck=firebase[_0x4cce9e(0x29f)]();try{appCheck[_0x4cce9e(0x1c9)]('hh',!![]),console[_0x4cce9e(0x33b)](_0x4cce9e(0x2c1));}catch(_0x5557ce){console[_0x4cce9e(0x181)](_0x4cce9e(0x11c),_0x5557ce);}const $=_0x1b4792=>document[_0x4cce9e(0x2d5)](_0x1b4792),$$=_0x4c6eee=>document[_0x4cce9e(0x224)](_0x4c6eee),elements={'loadingOverlay':$(_0x4cce9e(0x228)),'loadingMessage':$(_0x4cce9e(0x2dd)),'body':document['body'],'header':$('.header'),'logoLink':$('#logoLink'),'userAvatar':$(_0x4cce9e(0x130)),'avatarInitials':$(_0x4cce9e(0x297)),'searchContainer':$('#searchContainer'),'searchInput':$(_0x4cce9e(0x22e)),'searchResults':$(_0x4cce9e(0x174)),'searchToggleBtn':$(_0x4cce9e(0xc3)),'addBookBtn':$(_0x4cce9e(0x304)),'booksContainer':$(_0x4cce9e(0x28c)),'booksGridLoadingIndicator':$(_0x4cce9e(0x260)),'emptyStateBooks':$(_0x4cce9e(0x31d)),'categoryFilterContainer':$(_0x4cce9e(0x1f0)),'bottomNavItems':$$(_0x4cce9e(0x305)),'popularBooksCarousel':$(_0x4cce9e(0x2eb)),'headerCreditsContainer':$('#headerCreditsContainer'),'headerCreditsAmount':$(_0x4cce9e(0x2b0)),'addBookModal':$(_0x4cce9e(0x183)),'closeAddBookModal':$(_0x4cce9e(0x249)),'addBookForm':$('#addBookForm'),'loginModal':$(_0x4cce9e(0x32d)),'signupModal':$(_0x4cce9e(0x31f)),'closeLoginModal':$(_0x4cce9e(0xdc)),'closeSignupModal':$(_0x4cce9e(0x15a)),'loginForm':$(_0x4cce9e(0x124)),'signupForm':$(_0x4cce9e(0x140)),'switchToSignup':$('#switchToSignup'),'switchToLogin':$(_0x4cce9e(0x20a)),'editProfileModal':$(_0x4cce9e(0x23d)),'closeEditProfileModal':$('#closeEditProfileModal'),'editProfileForm':$(_0x4cce9e(0x8a)),'discoverModal':$('#discoverModal'),'closeDiscoverModal':$('#closeDiscoverModal'),'withdrawalModal':$(_0x4cce9e(0x2b7)),'closeWithdrawalModal':$('#closeWithdrawalModal'),'withdrawalForm':$('#withdrawalForm'),'creditModal':$(_0x4cce9e(0xf5)),'closeCreditModal':$(_0x4cce9e(0x345)),'creditModalUserCredits':$(_0x4cce9e(0x15d)),'claimDailyCreditBtn':$(_0x4cce9e(0x109)),'conductSurveyBtn':$('#conductSurveyBtn'),'profileBtn':$(_0x4cce9e(0x2e3)),'profilePage':$(_0x4cce9e(0x220)),'profileBackBtn':$('#profileBackBtn'),'profileAvatarLarge':$(_0x4cce9e(0x1d8)),'profileAvatarInitialsLarge':$('#profileAvatarInitialsLarge'),'profileNameLarge':$(_0x4cce9e(0x2be)),'profileUsernameLarge':$(_0x4cce9e(0x167)),'profileEmailLarge':$('#profileEmailLarge'),'profileJoinedLarge':$('#profileJoinedLarge'),'profileBioLarge':$(_0x4cce9e(0x10f)),'userPointsLarge':$(_0x4cce9e(0x259)),'withdrawBtnLarge':$(_0x4cce9e(0x29d)),'booksSharedLarge':$(_0x4cce9e(0x13a)),'booksDownloadedLarge':$(_0x4cce9e(0x1d1)),'totalBookDownloadsLarge':$('#totalBookDownloadsLarge'),'totalFeedbackLarge':$('#totalFeedbackLarge'),'profileTabs':$('.profile-tabs'),'profileTabBtns':$$(_0x4cce9e(0xca)),'profileTabContents':$$(_0x4cce9e(0x1d5)),'profileBooksContainer':$(_0x4cce9e(0x1bd)),'emptyProfileBooks':$('#emptyProfileBooks'),'loadMoreBooksBtn':$(_0x4cce9e(0x202)),'loadMoreContainer':$(_0x4cce9e(0x1ca)),'withdrawalHistoryContainer':$(_0x4cce9e(0x78)),'emptyWithdrawalHistory':$('#emptyWithdrawalHistory'),'editProfileBtn':$(_0x4cce9e(0x2f8)),'logoutBtn':$(_0x4cce9e(0x194)),'withdrawalOptionsContainer':$(_0x4cce9e(0x321)),'amountOptionsContainer':$(_0x4cce9e(0x171)),'paymentDetails':$(_0x4cce9e(0x186)),'paymentMethodLabel':$(_0x4cce9e(0x337)),'paymentIdInput':$(_0x4cce9e(0x258)),'accountNameInput':$(_0x4cce9e(0x2c6)),'accountNameGroup':$('#accountNameGroup'),'submitWithdrawalBtn':$(_0x4cce9e(0x2c2)),'withdrawalModalPoints':$(_0x4cce9e(0x2b1)),'homeBtn':$('#homeBtn'),'discoverBtn':$(_0x4cce9e(0x230)),'notificationsBtn':$(_0x4cce9e(0xc4)),'notificationsPage':$(_0x4cce9e(0xe6)),'notificationsBackBtn':$(_0x4cce9e(0x2a5)),'personalNotificationsListContainer':$('#personalNotificationsListContainer'),'adminAnnouncementsListContainer':$('#adminAnnouncementsListContainer'),'notificationTabsContainer':$(_0x4cce9e(0x33a)),'notificationTabBtns':$$('.notification-tab-btn'),'emptyPersonalNotificationsState':$(_0x4cce9e(0x2e0)),'emptyAdminAnnouncementsState':$(_0x4cce9e(0x79)),'unreadNotificationsBadge':$(_0x4cce9e(0x24e)),'markAllNotificationsReadBtn':$(_0x4cce9e(0x22c)),'bookDetailModal':$(_0x4cce9e(0x25f)),'closeBookDetailModal':$(_0x4cce9e(0x129)),'bookDetailContent':$(_0x4cce9e(0x1a5)),'toastContainer':$(_0x4cce9e(0x116))};let currentUser=null,userData=null,allBooksCache=[],displayedBooksMain=[],popularBooksData=[],currentCategory=_0x4cce9e(0x2fd),lastUserBookSnapshot=null,hasMoreUserBooks=!![],selectedWithdrawalMethod=null,selectedWithdrawalAmount=null,selectedWithdrawalRs=null,isFetchingMoreUserBooks=![],currentBookDetailId=null,unreadNotificationsCount=0x0,lastVisibleBookMain=null,isLoadingBooksMain=![],hasMoreBooksMain=!![],listeners={'user':null,'withdrawals':null,'popularBooks':null,'userBooks':null,'bookApproval':null,'userNotifications':null,'adminAnnouncements':null,'allBooksSearch':null};const BOOK_DOWNLOAD_COST=0x1e,BOOKS_PER_PAGE_MAIN=0xc,bookCategories=[_0x4cce9e(0x2fd),_0x4cce9e(0x111),_0x4cce9e(0x1d4),_0x4cce9e(0x177),_0x4cce9e(0x2cf),'NEET',_0x4cce9e(0x11a),_0x4cce9e(0x27a),_0x4cce9e(0x1e8),_0x4cce9e(0xf3),_0x4cce9e(0x123),'Non-Fiction',_0x4cce9e(0xe3)],loadingMessages=[_0x4cce9e(0x342),_0x4cce9e(0x120),'Igniting\x20Minds...',_0x4cce9e(0x106),_0x4cce9e(0x251),'Preparing\x20Your\x20Journey...'];function escapeHTML(_0x395327){const _0x3daf0a=_0x4cce9e;if(_0x395327===null||_0x395327===undefined)return'';return String(_0x395327)[_0x3daf0a(0x2ed)](/[&<>"']/g,function(_0x1e36b9){const _0x2f61ac=_0x3daf0a;return{'&':_0x2f61ac(0x2ad),'<':_0x2f61ac(0x93),'>':_0x2f61ac(0x21f),'\x22':_0x2f61ac(0xc7),'\x27':_0x2f61ac(0xfc)}[_0x1e36b9];});}function showToast(_0x999857,_0x48dbbc=_0x4cce9e(0x21e),_0x97155c=0xdac){const _0x40e70c=_0x4cce9e;if(!elements['toastContainer']){console['warn']('Toast\x20container\x20not\x20found.\x20Toast\x20not\x20shown:',_0x999857);return;}const _0x4cc365=_0x40e70c(0x275)+Date[_0x40e70c(0xa4)](),_0x498577=document[_0x40e70c(0x136)](_0x40e70c(0x298));_0x498577[_0x40e70c(0x312)]='toast\x20'+_0x48dbbc,_0x498577['id']=_0x4cc365;let _0x3d58d9=_0x40e70c(0xd5);if(_0x48dbbc===_0x40e70c(0x1e1))_0x3d58d9='fas\x20fa-check-circle';else{if(_0x48dbbc===_0x40e70c(0x181))_0x3d58d9='fas\x20fa-times-circle';else{if(_0x48dbbc===_0x40e70c(0x2f3))_0x3d58d9='fas\x20fa-exclamation-triangle';}}_0x498577[_0x40e70c(0x17e)]=_0x40e70c(0x6f)+_0x3d58d9+_0x40e70c(0x160)+escapeHTML(_0x999857)+_0x40e70c(0x30f),elements[_0x40e70c(0xa9)][_0x40e70c(0x274)](_0x498577),requestAnimationFrame(()=>_0x498577['classList']['add']('show'));const _0x5c0d2b=_0x498577['querySelector'](_0x40e70c(0x1f1));_0x5c0d2b[_0x40e70c(0x1a2)]=()=>{const _0x5cdaaf=_0x40e70c;_0x498577[_0x5cdaaf(0x1b2)][_0x5cdaaf(0x318)](_0x5cdaaf(0x2f0)),setTimeout(()=>{const _0x2a1616=_0x5cdaaf;if(_0x498577['parentElement'])_0x498577[_0x2a1616(0x318)]();},0x1f4);},setTimeout(()=>{const _0x2f5c89=_0x40e70c;document[_0x2f5c89(0x2f5)](_0x4cc365)&&(_0x498577['classList'][_0x2f5c89(0x318)]('show'),setTimeout(()=>{const _0x1d4d7e=_0x2f5c89;if(_0x498577[_0x1d4d7e(0x122)])_0x498577['remove']();},0x1f4));},_0x97155c);}function openModal(_0x2d14be){const _0x23ea47=_0x4cce9e;if(!_0x2d14be)return;_0x2d14be['classList']['add'](_0x23ea47(0x24a)),elements[_0x23ea47(0x323)][_0x23ea47(0x285)][_0x23ea47(0x184)]='hidden',AOS[_0x23ea47(0x233)]();}function closeModal(_0x35bb7a){const _0x310352=_0x4cce9e;if(!_0x35bb7a)return;_0x35bb7a[_0x310352(0x1b2)][_0x310352(0x318)](_0x310352(0x24a));const _0x55ec75=$$('.modal.active')[_0x310352(0x151)]>0x0,_0x3f838e=$$(_0x310352(0x28d))[_0x310352(0x151)]>0x0;!_0x55ec75&&!_0x3f838e&&(elements[_0x310352(0x323)][_0x310352(0x285)]['overflow']='auto');}function getInitials(_0x5051e9){const _0x8e1061=_0x4cce9e;if(!_0x5051e9||typeof _0x5051e9!=='string')return'U';const _0xeecd17=_0x5051e9[_0x8e1061(0x113)]()[_0x8e1061(0x2b3)]('\x20')[_0x8e1061(0x1eb)](_0x238f36=>_0x238f36[_0x8e1061(0x151)]>0x0);if(_0xeecd17[_0x8e1061(0x151)]===0x0)return'U';if(_0xeecd17['length']===0x1)return _0xeecd17[0x0][_0x8e1061(0x2ca)](0x0)[_0x8e1061(0x34c)]();return(_0xeecd17[0x0][_0x8e1061(0x2ca)](0x0)+_0xeecd17[_0xeecd17['length']-0x1]['charAt'](0x0))[_0x8e1061(0x34c)]();}function formatDate(_0x391ed0,_0x56521c={'year':_0x4cce9e(0x26e),'month':_0x4cce9e(0x1c0),'day':_0x4cce9e(0x26e)}){const _0x38f577=_0x4cce9e;if(!_0x391ed0)return _0x38f577(0xb3);const _0x5ecc3=_0x391ed0['toDate']?_0x391ed0[_0x38f577(0x2bd)]():new Date(_0x391ed0);try{return _0x5ecc3[_0x38f577(0x87)](undefined,_0x56521c);}catch(_0x1a1348){return console[_0x38f577(0xc6)](_0x38f577(0x2a3),_0x391ed0,_0x1a1348),_0x38f577(0x338);}}function formatTime(_0x178a05){const _0x1896d9=_0x4cce9e;if(!_0x178a05)return'';const _0x40e841=_0x178a05[_0x1896d9(0x2bd)]?_0x178a05['toDate']():new Date(_0x178a05);try{return _0x40e841[_0x1896d9(0x188)](undefined,{'hour':_0x1896d9(0x26e),'minute':'2-digit','hour12':!![]});}catch(_0xeb8baf){return console[_0x1896d9(0xc6)](_0x1896d9(0x179),_0x178a05,_0xeb8baf),_0x1896d9(0x163);}}function toggleSpinner(_0x45f1e7,_0x22d7cf){const _0x1cae7b=_0x4cce9e;if(!_0x45f1e7)return;const _0x43c996=_0x45f1e7[_0x1cae7b(0x2d5)](_0x1cae7b(0x2ce)),_0x6a9453=_0x45f1e7['querySelector'](_0x1cae7b(0x30c));if(_0x22d7cf){_0x45f1e7[_0x1cae7b(0x1b2)]['add'](_0x1cae7b(0x32c)),_0x45f1e7['disabled']=!![];if(_0x43c996)_0x43c996[_0x1cae7b(0x285)][_0x1cae7b(0x103)]=_0x1cae7b(0x1a1);if(_0x6a9453)_0x6a9453[_0x1cae7b(0x285)]['opacity']='0';}else{_0x45f1e7[_0x1cae7b(0x1b2)]['remove'](_0x1cae7b(0x32c)),_0x45f1e7[_0x1cae7b(0x2ac)]=![];if(_0x43c996)_0x43c996[_0x1cae7b(0x285)][_0x1cae7b(0x103)]=_0x1cae7b(0x2f4);if(_0x6a9453)_0x6a9453[_0x1cae7b(0x285)][_0x1cae7b(0xa2)]='1';}}function cleanupListeners(){const _0xe87d6b=_0x4cce9e;for(const _0x5bc1ff in listeners){if(listeners[_0x5bc1ff]){try{listeners[_0x5bc1ff]();}catch(_0x235a4c){console['warn'](_0xe87d6b(0x322)+_0x5bc1ff+':',_0x235a4c);}listeners[_0x5bc1ff]=null;}}}function formatRelativeDate(_0x182316){const _0x3e430e=_0x4cce9e;if(!_0x182316)return'';const _0x17d806=_0x182316[_0x3e430e(0x2bd)]?_0x182316[_0x3e430e(0x2bd)]():new Date(_0x182316),_0x21055d=new Date();_0x21055d['setHours'](0x0,0x0,0x0,0x0);const _0x525d1f=new Date(_0x21055d);_0x525d1f[_0x3e430e(0x2cd)](_0x21055d[_0x3e430e(0x1c2)]()-0x1);const _0x2967e5=new Date(_0x17d806);_0x2967e5[_0x3e430e(0xd6)](0x0,0x0,0x0,0x0);if(_0x2967e5['getTime']()===_0x21055d['getTime']())return _0x3e430e(0x282);if(_0x2967e5['getTime']()===_0x525d1f[_0x3e430e(0x20d)]())return _0x3e430e(0x1b7);return formatDate(_0x182316,{'month':'long','day':_0x3e430e(0x26e),'year':_0x3e430e(0x26e)});}function hideLoadingOverlay(){const _0xf52ef5=_0x4cce9e;elements[_0xf52ef5(0x1e6)][_0xf52ef5(0x1b2)]['add']('hidden');}function showRandomLoadingMessage(){const _0x3a9b9d=_0x4cce9e,_0x179b82=Math[_0x3a9b9d(0x12c)](Math['random']()*loadingMessages[_0x3a9b9d(0x151)]);elements[_0x3a9b9d(0xf8)][_0x3a9b9d(0x221)]=loadingMessages[_0x179b82];}auth[_0x4cce9e(0x28f)](async _0x15bd48=>{const _0x4f70f3=_0x4cce9e;cleanupListeners(),currentUser=_0x15bd48;if(_0x15bd48){elements[_0x4f70f3(0x323)][_0x4f70f3(0x1b2)][_0x4f70f3(0x239)]('logged-in'),elements[_0x4f70f3(0x323)][_0x4f70f3(0x1b2)][_0x4f70f3(0x318)](_0x4f70f3(0x31b)),elements[_0x4f70f3(0x18d)][_0x4f70f3(0x285)][_0x4f70f3(0x103)]=_0x4f70f3(0x2da);const _0x323737=db[_0x4f70f3(0x1d9)]('users')[_0x4f70f3(0x1a0)](_0x15bd48[_0x4f70f3(0x1d6)]);listeners[_0x4f70f3(0x1df)]=_0x323737[_0x4f70f3(0x17b)](async _0x4c4dbc=>{const _0x26c843=_0x4f70f3;if(_0x4c4dbc[_0x26c843(0x10a)])userData={'id':_0x4c4dbc['id'],..._0x4c4dbc[_0x26c843(0x9a)]()},updateProfileUI(),updateAvatar(),updateHeaderCredits(),enableWithdrawalIfQualified(),setupBookApprovalListener(),setupUserNotificationsListener(),setupAdminAnnouncementsListener(),!elements[_0x26c843(0x1e6)][_0x26c843(0x1b2)][_0x26c843(0xac)](_0x26c843(0x107))&&hideLoadingOverlay();else{const _0x260339=JSON[_0x26c843(0x243)](sessionStorage[_0x26c843(0x2b6)](_0x26c843(0x2ae))||'{}');sessionStorage[_0x26c843(0x114)](_0x26c843(0x2ae));try{console['log'](_0x26c843(0x205)),await createUserDocument(_0x15bd48,_0x260339[_0x26c843(0x2a4)],_0x260339['username'],_0x260339['bio']);}catch(_0x4e30dd){console[_0x26c843(0x181)]('Fatal\x20error\x20creating\x20user\x20document:',_0x4e30dd),showToast(_0x26c843(0x320),_0x26c843(0x181),0x2710),auth[_0x26c843(0x238)]()[_0x26c843(0xe7)](_0x13fbbb=>console[_0x26c843(0x181)](_0x26c843(0x2f9),_0x13fbbb)),!elements[_0x26c843(0x1e6)][_0x26c843(0x1b2)][_0x26c843(0xac)](_0x26c843(0x107))&&hideLoadingOverlay();}}},_0x4c5ed0=>{const _0x39661b=_0x4f70f3;console['error']('Error\x20listening\x20to\x20user\x20data:',_0x4c5ed0),showToast(_0x39661b(0xc5),_0x39661b(0x181)),userData=null,updateProfileUI(),updateAvatar(),updateHeaderCredits(),!elements[_0x39661b(0x1e6)][_0x39661b(0x1b2)][_0x39661b(0xac)]('hidden')&&hideLoadingOverlay();});try{await _0x323737[_0x4f70f3(0x24f)]({'lastActive':firebase['firestore']['FieldValue'][_0x4f70f3(0x254)]()});}catch(_0x3937e9){console[_0x4f70f3(0xc6)]('Could\x20not\x20update\x20last\x20active\x20time\x20(might\x20be\x20new\x20user):',_0x3937e9[_0x4f70f3(0x30a)]);}initializeDataFetching();}else{userData=null,currentUser=null,elements[_0x4f70f3(0x323)][_0x4f70f3(0x1b2)][_0x4f70f3(0x318)](_0x4f70f3(0x127)),elements[_0x4f70f3(0x323)][_0x4f70f3(0x1b2)][_0x4f70f3(0x239)](_0x4f70f3(0x31b)),elements[_0x4f70f3(0x18d)][_0x4f70f3(0x285)][_0x4f70f3(0x103)]=_0x4f70f3(0x2f4),updateProfileUI(),updateAvatar(),updateHeaderCredits(),updateUnreadBadge(0x0),showLoginPromptInsteadOfContent(),closeAllPagesAndModals(),resetNavigation(),['popularBooksCarousel','profileBooksContainer',_0x4f70f3(0x20b),_0x4f70f3(0x1f6),_0x4f70f3(0x24c),_0x4f70f3(0x1ff)][_0x4f70f3(0x144)](_0x11be11=>{const _0x2bd9b1=_0x4f70f3;if(elements[_0x11be11])elements[_0x11be11][_0x2bd9b1(0x17e)]='';});if(elements[_0x4f70f3(0x147)])elements['categoryFilterContainer'][_0x4f70f3(0x17e)]='';allBooksCache=[],displayedBooksMain=[],popularBooksData=[],lastVisibleBookMain=null,hasMoreBooksMain=!![],isLoadingBooksMain=![],lastUserBookSnapshot=null,hasMoreUserBooks=!![],isFetchingMoreUserBooks=![],currentCategory=_0x4f70f3(0x2fd);if(listeners[_0x4f70f3(0x173)])listeners[_0x4f70f3(0x173)]();listeners['allBooksSearch']=null,!elements[_0x4f70f3(0x1e6)][_0x4f70f3(0x1b2)][_0x4f70f3(0xac)]('hidden')&&hideLoadingOverlay();}});async function createUserDocument(_0x5b28a9,_0x4aa6c3,_0x140ff6,_0x163f8a){const _0x31569e=_0x4cce9e,_0x590526=_0x4aa6c3||_0x5b28a9[_0x31569e(0x2bc)]||_0x31569e(0x1ac);let _0x262770=_0x140ff6||_0x5b28a9[_0x31569e(0x7e)][_0x31569e(0x2b3)]('@')[0x0][_0x31569e(0x2ed)](/[^a-z0-9_.]/gi,'')[_0x31569e(0xb5)]()||_0x31569e(0x1df)+Date[_0x31569e(0xa4)]()[_0x31569e(0x99)]()['slice'](-0x5);try{const _0x407552=await db[_0x31569e(0x1d9)](_0x31569e(0x281))[_0x31569e(0x347)]('username','==',_0x262770)[_0x31569e(0x169)]();!_0x407552[_0x31569e(0x34d)]&&(_0x262770=_0x31569e(0x1df)+Date[_0x31569e(0xa4)]()[_0x31569e(0x99)]()[_0x31569e(0x340)](-0x5));}catch(_0x2b4fff){console['warn'](_0x31569e(0x200),_0x2b4fff);}const _0x4e42b0=_0x163f8a||_0x31569e(0x293),_0x28e67e=db[_0x31569e(0x1d9)](_0x31569e(0x281))[_0x31569e(0x1a0)](_0x5b28a9[_0x31569e(0x1d6)]),_0x597923={'uid':_0x5b28a9['uid'],'email':_0x5b28a9[_0x31569e(0x7e)],'name':_0x590526,'username':_0x262770,'bio':_0x4e42b0,'points':0x0,'credits':0x32,'createdAt':firebase['firestore'][_0x31569e(0xff)][_0x31569e(0x254)](),'lastActive':firebase[_0x31569e(0x1aa)][_0x31569e(0xff)][_0x31569e(0x254)](),'booksSharedCount':0x0,'booksDownloadedCount':0x0,'lastDailyCreditClaim':null,'totalBookDownloads':0x0,'totalFeedbackGiven':0x0,'processedBookActions':{},'lastCreditBoostClaim':null,'creditsEarnedViaBoosts':0x0};try{await _0x28e67e[_0x31569e(0x13b)](_0x597923),await createNotification(_0x5b28a9[_0x31569e(0x1d6)],'Welcome\x20to\x20EduSparK!',_0x31569e(0x341)+_0x597923[_0x31569e(0x316)]+_0x31569e(0x14b),_0x31569e(0x1e1),null,_0x31569e(0x19d)),showToast(_0x31569e(0x9c),_0x31569e(0x1e1));}catch(_0xdde855){console[_0x31569e(0x181)](_0x31569e(0x2e4),_0xdde855),showToast('Major\x20error\x20setting\x20up\x20your\x20account.\x20Please\x20contact\x20support.',_0x31569e(0x181),0x2710);throw _0xdde855;}}function showLoginPromptInsteadOfContent(){const _0x3466c1=_0x4cce9e;if(elements[_0x3466c1(0x1ff)]){elements[_0x3466c1(0x1ff)][_0x3466c1(0x17e)]='',elements['emptyStateBooks'][_0x3466c1(0x17e)]='<i\x20class=\x22fas\x20fa-sign-in-alt\x22></i><h3>Login\x20to\x20Discover\x20Books</h3><p>Join\x20EduSparK\x20to\x20share,\x20download,\x20and\x20engage!</p><button\x20class=\x22submit-btn\x22\x20style=\x22margin-top:20px;max-width:200px;\x22\x20id=\x22loginPromptBtnMain\x22>Login\x20/\x20Sign\x20Up</button>',elements[_0x3466c1(0x100)][_0x3466c1(0x285)]['display']='flex';const _0x5278f8=$(_0x3466c1(0xe5));if(_0x5278f8)_0x5278f8['onclick']=()=>openModal(elements['loginModal']);}elements[_0x3466c1(0x2e9)]&&(elements[_0x3466c1(0x2e9)][_0x3466c1(0x17e)]=_0x3466c1(0x1ab));if(elements['emptyProfileBooks'])elements[_0x3466c1(0x33f)][_0x3466c1(0x285)][_0x3466c1(0x103)]='flex';if(elements['emptyWithdrawalHistory'])elements[_0x3466c1(0x1f8)][_0x3466c1(0x285)][_0x3466c1(0x103)]=_0x3466c1(0x2da);if(elements[_0x3466c1(0x10d)])elements[_0x3466c1(0x10d)][_0x3466c1(0x285)][_0x3466c1(0x103)]=_0x3466c1(0x2da);if(elements[_0x3466c1(0xf2)])elements['emptyAdminAnnouncementsState'][_0x3466c1(0x285)][_0x3466c1(0x103)]='flex';renderCategoryFilters();}elements['loginForm'][_0x4cce9e(0x16a)](_0x4cce9e(0x264),async _0x4938ee=>{const _0x4e0bad=_0x4cce9e;_0x4938ee['preventDefault']();const _0x4fbf7e=$(_0x4e0bad(0x2cc))[_0x4e0bad(0x104)],_0x221378=$(_0x4e0bad(0xd1))[_0x4e0bad(0x104)],_0xf8ca23=$(_0x4e0bad(0xe2));toggleSpinner(_0xf8ca23,!![]);try{await auth[_0x4e0bad(0x143)](_0x4fbf7e,_0x221378),closeModal(elements[_0x4e0bad(0x70)]),showToast(_0x4e0bad(0x2f1),_0x4e0bad(0x1e1));}catch(_0x50ac8d){console[_0x4e0bad(0x181)](_0x4e0bad(0x150),_0x50ac8d),showToast(_0x50ac8d[_0x4e0bad(0x30a)],_0x4e0bad(0x181));}finally{toggleSpinner(_0xf8ca23,![]),elements[_0x4e0bad(0xce)]['reset']();}}),elements[_0x4cce9e(0x19c)][_0x4cce9e(0x16a)](_0x4cce9e(0x264),async _0x274a51=>{const _0x52a032=_0x4cce9e;_0x274a51[_0x52a032(0x27d)]();const _0x394627=$(_0x52a032(0x218))[_0x52a032(0x104)],_0x1ac196=$(_0x52a032(0x158))[_0x52a032(0x104)][_0x52a032(0x113)]()[_0x52a032(0xb5)](),_0xf5b3d7=$(_0x52a032(0x115))[_0x52a032(0x104)],_0x28f438=$('#signupPassword')[_0x52a032(0x104)],_0xa11327=$('#signupBio')['value'];if(!/^[a-z0-9_.]{3,15}$/[_0x52a032(0x336)](_0x1ac196)){showToast(_0x52a032(0xa5),_0x52a032(0x181),0x1388);return;}if(_0x28f438['length']<0x6){showToast(_0x52a032(0x190),_0x52a032(0x181));return;}const _0x11afd1=$(_0x52a032(0x126));toggleSpinner(_0x11afd1,!![]);try{const _0x256d51=await db['collection'](_0x52a032(0x281))[_0x52a032(0x347)](_0x52a032(0x1a3),'==',_0x1ac196)[_0x52a032(0x169)]();if(!_0x256d51[_0x52a032(0x34d)]){showToast(_0x52a032(0x2d8),_0x52a032(0x181)),toggleSpinner(_0x11afd1,![]);return;}const _0x2dc931=await auth[_0x52a032(0x317)](_0xf5b3d7);if(_0x2dc931['length']>0x0){showToast(_0x52a032(0x17f),_0x52a032(0x181)),toggleSpinner(_0x11afd1,![]);return;}sessionStorage[_0x52a032(0x26c)](_0x52a032(0x2ae),JSON[_0x52a032(0xc1)]({'name':_0x394627,'username':_0x1ac196,'bio':_0xa11327})),await auth[_0x52a032(0x231)](_0xf5b3d7,_0x28f438);}catch(_0x1df09a){console[_0x52a032(0x181)](_0x52a032(0x16e),_0x1df09a),showToast(_0x1df09a[_0x52a032(0x30a)],_0x52a032(0x181)),sessionStorage[_0x52a032(0x114)](_0x52a032(0x2ae));}finally{toggleSpinner(_0x11afd1,![]);}}),elements[_0x4cce9e(0x2ea)][_0x4cce9e(0x16a)](_0x4cce9e(0x328),async()=>{const _0xb3c8ed=_0x4cce9e;toggleSpinner(elements[_0xb3c8ed(0x2ea)],!![]);try{await auth[_0xb3c8ed(0x238)](),showToast(_0xb3c8ed(0xba),'info');}catch(_0x29c3db){console[_0xb3c8ed(0x181)](_0xb3c8ed(0x176),_0x29c3db),showToast('Error\x20logging\x20out.\x20Please\x20try\x20again.',_0xb3c8ed(0x181));}finally{toggleSpinner(elements['logoutBtn'],![]);}});function updateProfileUI(){const _0x718879=_0x4cce9e;userData?(elements[_0x718879(0x1ba)]['textContent']=getInitials(userData[_0x718879(0x2a4)]),elements['profileNameLarge'][_0x718879(0x221)]=escapeHTML(userData['name']||_0x718879(0x148)),elements[_0x718879(0x287)][_0x718879(0x221)]='@'+escapeHTML(userData[_0x718879(0x1a3)]||'username'),elements[_0x718879(0x137)][_0x718879(0x17e)]=_0x718879(0x2de)+escapeHTML(userData[_0x718879(0x7e)]||_0x718879(0xaa)),elements[_0x718879(0x226)][_0x718879(0x17e)]=_0x718879(0x131)+(userData[_0x718879(0x133)]?formatDate(userData[_0x718879(0x133)]):'-'),elements[_0x718879(0x1c3)][_0x718879(0x221)]=escapeHTML(userData[_0x718879(0x18c)]||'No\x20bio\x20set.\x20Click\x20Edit\x20Profile\x20to\x20add\x20one!'),elements['userPointsLarge']['textContent']=userData[_0x718879(0x26b)]||0x0,elements[_0x718879(0x2fa)][_0x718879(0x221)]=userData[_0x718879(0x2d6)]||0x0,elements[_0x718879(0xe9)]['textContent']=userData[_0x718879(0x1b9)]||0x0,elements['totalBookDownloadsLarge'][_0x718879(0x221)]=userData[_0x718879(0x180)]||0x0,elements[_0x718879(0x211)][_0x718879(0x221)]=userData[_0x718879(0x2e2)]||0x0):(elements[_0x718879(0x1ba)][_0x718879(0x221)]='U',elements[_0x718879(0x145)]['textContent']=_0x718879(0x135),elements[_0x718879(0x287)][_0x718879(0x221)]=_0x718879(0x33d),elements[_0x718879(0x137)][_0x718879(0x17e)]=_0x718879(0x248),elements[_0x718879(0x226)][_0x718879(0x17e)]=_0x718879(0x2a7),elements['profileBioLarge'][_0x718879(0x221)]=_0x718879(0x201),[_0x718879(0x139),_0x718879(0x2fa),'booksDownloadedLarge',_0x718879(0x209),_0x718879(0x211)][_0x718879(0x144)](_0x46921e=>{if(elements[_0x46921e])elements[_0x46921e]['textContent']='0';}),elements[_0x718879(0x33f)]&&(elements[_0x718879(0x25e)][_0x718879(0x17e)]='',elements[_0x718879(0x33f)]['style'][_0x718879(0x103)]=_0x718879(0x2da)),elements[_0x718879(0x1f8)]&&(elements[_0x718879(0x20b)]['innerHTML']='',elements[_0x718879(0x1f8)]['style'][_0x718879(0x103)]=_0x718879(0x2da)));}function updateAvatar(){const _0x4dc005=_0x4cce9e;elements[_0x4dc005(0x294)][_0x4dc005(0x221)]=userData&&userData[_0x4dc005(0x2a4)]?getInitials(userData['name']):'U';}function updateHeaderCredits(){const _0x49962d=_0x4cce9e;elements[_0x49962d(0x32b)]['textContent']=userData?userData[_0x49962d(0x316)]||0x0:'0';}elements[_0x4cce9e(0x19b)][_0x4cce9e(0x16a)](_0x4cce9e(0x328),()=>{const _0x10c55b=_0x4cce9e;userData&&currentUser?($(_0x10c55b(0x7b))[_0x10c55b(0x104)]=userData[_0x10c55b(0x2a4)]||'',$('#editProfileUsername')[_0x10c55b(0x104)]=userData['username']||'',$(_0x10c55b(0x227))['value']=userData[_0x10c55b(0x18c)]||'',openModal(elements[_0x10c55b(0x1be)])):(showToast(_0x10c55b(0x170),'warning'),openModal(elements['loginModal']));});if(elements[_0x4cce9e(0x1a8)])elements[_0x4cce9e(0x1a8)]['onclick']=()=>closeModal(elements[_0x4cce9e(0x1be)]);elements['editProfileForm']['addEventListener']('submit',async _0x19a407=>{const _0x37d1bf=_0x4cce9e;_0x19a407['preventDefault']();if(!currentUser||!userData){showToast(_0x37d1bf(0x253),'error');return;}const _0x5071a7=$(_0x37d1bf(0x7b))[_0x37d1bf(0x104)],_0x30490e=$(_0x37d1bf(0x247))[_0x37d1bf(0x104)][_0x37d1bf(0x113)]()['toLowerCase'](),_0x1b3a70=$(_0x37d1bf(0x227))[_0x37d1bf(0x104)];if(!/^[a-z0-9_.]{3,15}$/[_0x37d1bf(0x336)](_0x30490e)){showToast(_0x37d1bf(0xa5),_0x37d1bf(0x181),0x1388);return;}const _0x4f7f35=$(_0x37d1bf(0xd0));toggleSpinner(_0x4f7f35,!![]);try{if(_0x30490e!==userData[_0x37d1bf(0x1a3)]){const _0x441da8=await db[_0x37d1bf(0x1d9)](_0x37d1bf(0x281))[_0x37d1bf(0x347)](_0x37d1bf(0x1a3),'==',_0x30490e)[_0x37d1bf(0x169)]();if(!_0x441da8[_0x37d1bf(0x34d)]){showToast(_0x37d1bf(0x2d8),_0x37d1bf(0x181)),toggleSpinner(_0x4f7f35,![]);return;}}await db['collection'](_0x37d1bf(0x281))['doc'](currentUser[_0x37d1bf(0x1d6)])[_0x37d1bf(0x24f)]({'name':_0x5071a7,'username':_0x30490e,'bio':_0x1b3a70}),await createNotification(currentUser[_0x37d1bf(0x1d6)],_0x37d1bf(0x242),'Your\x20profile\x20details\x20have\x20been\x20successfully\x20changed.',_0x37d1bf(0x21e),null,_0x37d1bf(0x161)),showToast(_0x37d1bf(0xb9),_0x37d1bf(0x1e1)),closeModal(elements[_0x37d1bf(0x1be)]);}catch(_0x4c3d14){console['error'](_0x37d1bf(0xe8),_0x4c3d14),showToast(_0x37d1bf(0x77)+_0x4c3d14[_0x37d1bf(0x30a)],_0x37d1bf(0x181));}finally{toggleSpinner(_0x4f7f35,![]);}});elements[_0x4cce9e(0x172)]&&elements[_0x4cce9e(0x172)][_0x4cce9e(0x16a)](_0x4cce9e(0x328),_0xd446e8=>{const _0x1fc316=_0x4cce9e,_0x4517bc=_0xd446e8['target']['closest'](_0x1fc316(0xca));if(!_0x4517bc)return;elements['profileTabBtns']['forEach'](_0x475423=>_0x475423[_0x1fc316(0x1b2)]['remove'](_0x1fc316(0x24a))),_0x4517bc['classList'][_0x1fc316(0x239)](_0x1fc316(0x24a));const _0x1ec307=_0x4517bc['dataset'][_0x1fc316(0x80)];elements[_0x1fc316(0x1e0)][_0x1fc316(0x144)](_0x55d4eb=>{const _0x2d4185=_0x1fc316;_0x55d4eb[_0x2d4185(0x1b2)][_0x2d4185(0x12a)](_0x2d4185(0x24a),_0x55d4eb['id']===_0x2d4185(0x1cf)+_0x1ec307);}),AOS[_0x1fc316(0x233)]();});function initializeDataFetching(){if(!currentUser)return;fetchBooksMain(![]),fetchPopularBooks(),renderCategoryFilters(),setupAllBooksListenerForSearch();}function renderSkeletonLoaders(_0x689797,_0x1a76b9,_0x47d88b=_0x4cce9e(0x2c3)){const _0x36a055=_0x4cce9e;if(!_0x689797)return;_0x689797!==elements['booksGridLoadingIndicator']&&(_0x689797[_0x36a055(0x17e)]='');let _0x51190a='';for(let _0x249e18=0x0;_0x249e18<_0x1a76b9;_0x249e18++){if(_0x47d88b===_0x36a055(0x2c3))_0x51190a+='<div\x20class=\x22skeleton-book-card\x22><div\x20class=\x22skeleton-img\x22></div><div\x20class=\x22skeleton-info\x22><div\x20class=\x22skeleton-text\x20title\x22></div><div\x20class=\x22skeleton-text\x20author\x22></div><div\x20class=\x22skeleton-text\x20meta\x22></div><div\x20class=\x22skeleton-btn\x22></div></div></div>';else{if(_0x47d88b==='popular')_0x51190a+=_0x36a055(0x2ba);else{if(_0x47d88b===_0x36a055(0x1d0))_0x51190a+=_0x36a055(0x2d1);else _0x47d88b==='notification'&&(_0x51190a+='<div\x20class=\x22skeleton-notification-item\x22><div\x20class=\x22skeleton-icon\x22></div><div\x20class=\x22skeleton-content\x22><div\x20class=\x22skeleton-text\x20title\x22></div><div\x20class=\x22skeleton-text\x20message\x22></div><div\x20class=\x22skeleton-text\x20timestamp\x22></div></div></div>');}}}_0x689797!==elements[_0x36a055(0x2c0)]&&(_0x689797[_0x36a055(0x17e)]=_0x51190a);}function createBookCardHTML(_0x5ce089,_0x21d155='main'){const _0x774183=_0x4cce9e,_0x41af9c=_0x21d155==='profile',_0xd1d8e0=_0x774183(0x1dd),_0x5b8396=_0x5ce089[_0x774183(0x155)]||_0xd1d8e0;let _0x52180c='';if(_0x41af9c){if(_0x5ce089['status']===_0x774183(0xf6))_0x52180c=_0x774183(0x7f);else{if(_0x5ce089['status']===_0x774183(0x343))_0x52180c=_0x774183(0xa3);}}const _0x299115=escapeHTML(_0x5ce089['reviewedByName']||_0x5ce089['reviewedBy']||_0x774183(0x292));return _0x774183(0x245)+_0x5ce089['id']+'\x22\x20style=\x22animation-delay:\x20'+Math[_0x774183(0x299)]()*0.2+_0x774183(0x8e)+_0x5ce089['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+escapeHTML(_0x5b8396)+_0x774183(0x11e)+escapeHTML(_0x5ce089[_0x774183(0x86)])+'\x22\x20class=\x22book-img\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.onerror=null;this.src=\x27'+_0xd1d8e0+_0x774183(0x2ec)+_0x52180c+_0x774183(0x19a)+escapeHTML(_0x5ce089['bookName'])+_0x774183(0x165)+escapeHTML(_0x5ce089[_0x774183(0x2ab)])+_0x774183(0x8d)+escapeHTML(_0x5ce089[_0x774183(0x207)]||_0x774183(0x1c5))+_0x774183(0x280)+formatDate(_0x5ce089[_0x774183(0xf9)])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x41af9c&&_0x5ce089[_0x774183(0x15f)]!==_0x774183(0x25d)?'<div\x20class=\x22book-admin-info\x22\x20style=\x22font-style:\x20italic;\x20color:\x20'+(_0x5ce089[_0x774183(0x15f)]===_0x774183(0xf6)?_0x774183(0x187):_0x774183(0x1de))+_0x774183(0x1ef)+(_0x5ce089[_0x774183(0x15f)]===_0x774183(0xf6)?_0x774183(0x149):_0x774183(0x17a))+_0x774183(0x1e7)+_0x5ce089[_0x774183(0x15f)]['toUpperCase']()+(_0x5ce089[_0x774183(0x15f)]==='rejected'&&_0x5ce089['rejectionReason']?_0x774183(0x1a7)+escapeHTML(_0x5ce089[_0x774183(0x1ec)]):'')+_0x774183(0x33c):'')+_0x774183(0xaf)+(_0x41af9c&&_0x5ce089[_0x774183(0x15f)]===_0x774183(0x25d)&&(_0x5ce089[_0x774183(0x24b)]||_0x5ce089[_0x774183(0x303)])?_0x774183(0x295)+_0x299115+_0x774183(0x290)+(_0x5ce089[_0x774183(0x18a)]?formatDate(_0x5ce089[_0x774183(0x18a)]):'-')+_0x774183(0x33c):'')+_0x774183(0x16d)+_0x5ce089['id']+_0x774183(0x32a);}function createPopularBookCardHTML(_0x241b6b){const _0x4609b9=_0x4cce9e,_0x5b1443=_0x4609b9(0x85),_0x5b64f8=_0x241b6b[_0x4609b9(0x155)]||_0x5b1443;return _0x4609b9(0x2c7)+_0x241b6b['id']+_0x4609b9(0x14a)+Math[_0x4609b9(0x299)]()*0.3+_0x4609b9(0x16f)+escapeHTML(_0x5b64f8)+_0x4609b9(0x11e)+escapeHTML(_0x241b6b[_0x4609b9(0x86)])+_0x4609b9(0x2fb)+_0x5b1443+_0x4609b9(0x1bb)+escapeHTML(_0x241b6b[_0x4609b9(0x86)])+'</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22popular-book-meta\x22><i\x20class=\x22fas\x20fa-download\x22></i>\x20'+(_0x241b6b['downloads']||0x0)+_0x4609b9(0x23b);}async function fetchBooksMain(_0x3805bf=![]){const _0x2e3019=_0x4cce9e;if(!currentUser||isLoadingBooksMain)return;if(!hasMoreBooksMain&&_0x3805bf){if(elements[_0x2e3019(0x2c0)])elements[_0x2e3019(0x2c0)][_0x2e3019(0x285)]['display']=_0x2e3019(0x2f4);return;}isLoadingBooksMain=!![];if(_0x3805bf){if(elements[_0x2e3019(0x2c0)])elements['booksGridLoadingIndicator'][_0x2e3019(0x285)][_0x2e3019(0x103)]=_0x2e3019(0x8b);}else{lastVisibleBookMain=null,hasMoreBooksMain=!![],displayedBooksMain=[];if(elements[_0x2e3019(0x1ff)])elements[_0x2e3019(0x1ff)][_0x2e3019(0x17e)]='';renderSkeletonLoaders(elements[_0x2e3019(0x1ff)],BOOKS_PER_PAGE_MAIN,_0x2e3019(0x2c3));if(elements[_0x2e3019(0x100)])elements[_0x2e3019(0x100)]['style'][_0x2e3019(0x103)]=_0x2e3019(0x2f4);}let _0x545b4f=db['collection'](_0x2e3019(0x270))[_0x2e3019(0x347)](_0x2e3019(0x15f),'==',_0x2e3019(0x25d));currentCategory!==_0x2e3019(0x2fd)&&(_0x545b4f=_0x545b4f[_0x2e3019(0x347)]('category','==',currentCategory));_0x545b4f=_0x545b4f['orderBy'](_0x2e3019(0x18a),_0x2e3019(0x1cb))[_0x2e3019(0xad)](BOOKS_PER_PAGE_MAIN);_0x3805bf&&lastVisibleBookMain&&(_0x545b4f=_0x545b4f[_0x2e3019(0x344)](lastVisibleBookMain));try{const _0x1b3dde=await _0x545b4f[_0x2e3019(0x169)]();if(!_0x3805bf&&elements[_0x2e3019(0x1ff)])elements[_0x2e3019(0x1ff)][_0x2e3019(0x17e)]='';const _0x236ab7=_0x1b3dde[_0x2e3019(0xbe)][_0x2e3019(0x84)](_0x368f21=>({'id':_0x368f21['id'],..._0x368f21[_0x2e3019(0x9a)]()}));_0x236ab7[_0x2e3019(0x151)]>0x0&&(_0x236ab7[_0x2e3019(0x144)](_0x1d62b6=>{const _0x373979=_0x2e3019;displayedBooksMain[_0x373979(0x2d2)](_0x1d62b6);if(elements[_0x373979(0x1ff)])elements[_0x373979(0x1ff)][_0x373979(0x17e)]+=createBookCardHTML(_0x1d62b6);}),lastVisibleBookMain=_0x1b3dde[_0x2e3019(0xbe)][_0x1b3dde[_0x2e3019(0xbe)][_0x2e3019(0x151)]-0x1]);hasMoreBooksMain=_0x236ab7[_0x2e3019(0x151)]===BOOKS_PER_PAGE_MAIN;if(displayedBooksMain[_0x2e3019(0x151)]===0x0&&!_0x3805bf&&elements[_0x2e3019(0x100)])elements[_0x2e3019(0x100)][_0x2e3019(0x17e)]=_0x2e3019(0x18f)+escapeHTML(currentCategory)+_0x2e3019(0x250),elements['emptyStateBooks'][_0x2e3019(0x285)][_0x2e3019(0x103)]=_0x2e3019(0x2da);else elements['emptyStateBooks']&&(elements[_0x2e3019(0x100)][_0x2e3019(0x285)][_0x2e3019(0x103)]=_0x2e3019(0x2f4));AOS[_0x2e3019(0x34b)]();}catch(_0x2ead61){console['error'](_0x2e3019(0x206),_0x2ead61),showToast(_0x2e3019(0x1c7),'error');if(!_0x3805bf&&elements[_0x2e3019(0x100)]){if(elements[_0x2e3019(0x1ff)])elements[_0x2e3019(0x1ff)][_0x2e3019(0x17e)]='';elements[_0x2e3019(0x100)]['innerHTML']=_0x2e3019(0x1cc),elements[_0x2e3019(0x100)][_0x2e3019(0x285)]['display']='flex';}}finally{isLoadingBooksMain=![];if(elements[_0x2e3019(0x2c0)])elements['booksGridLoadingIndicator'][_0x2e3019(0x285)]['display']='none';}}function setupAllBooksListenerForSearch(){const _0x39eb8b=_0x4cce9e;if(!currentUser){allBooksCache=[];if(listeners[_0x39eb8b(0x173)])listeners['allBooksSearch']();listeners['allBooksSearch']=null;return;}if(listeners[_0x39eb8b(0x173)])return;listeners[_0x39eb8b(0x173)]=db['collection'](_0x39eb8b(0x270))[_0x39eb8b(0x347)]('status','==',_0x39eb8b(0x25d))[_0x39eb8b(0x17b)](_0x4e320b=>{const _0xb19554=_0x39eb8b;allBooksCache=_0x4e320b[_0xb19554(0xbe)][_0xb19554(0x84)](_0x5afa38=>({'id':_0x5afa38['id'],..._0x5afa38[_0xb19554(0x9a)]()})),console[_0xb19554(0x33b)](_0xb19554(0x1b1),allBooksCache['length']);},_0x3f88f5=>{const _0x564b30=_0x39eb8b;console[_0x564b30(0x181)](_0x564b30(0x334),_0x3f88f5),showToast(_0x564b30(0x2e5),_0x564b30(0x2f3));});}function fetchPopularBooks(){const _0xdd7cfb=_0x4cce9e;if(!currentUser){if(elements[_0xdd7cfb(0x2e9)])elements[_0xdd7cfb(0x2e9)][_0xdd7cfb(0x17e)]=_0xdd7cfb(0x1ab);return;}if(listeners[_0xdd7cfb(0x13e)])listeners['popularBooks']();renderSkeletonLoaders(elements['popularBooksCarousel'],0x5,'popular'),listeners['popularBooks']=db[_0xdd7cfb(0x1d9)](_0xdd7cfb(0x270))['where'](_0xdd7cfb(0x15f),'==',_0xdd7cfb(0x25d))[_0xdd7cfb(0x11b)](_0xdd7cfb(0x308),_0xdd7cfb(0x1cb))[_0xdd7cfb(0x11b)](_0xdd7cfb(0x18a),_0xdd7cfb(0x1cb))[_0xdd7cfb(0xad)](0xa)[_0xdd7cfb(0x17b)](_0x4d42f1=>{const _0x1f4602=_0xdd7cfb;popularBooksData=_0x4d42f1[_0x1f4602(0xbe)][_0x1f4602(0x84)](_0xec79c4=>({'id':_0xec79c4['id'],..._0xec79c4[_0x1f4602(0x9a)]()}));if(elements['popularBooksCarousel'])elements[_0x1f4602(0x2e9)][_0x1f4602(0x17e)]='';if(popularBooksData['length']===0x0){if(elements['popularBooksCarousel'])elements[_0x1f4602(0x2e9)]['innerHTML']=_0x1f4602(0x2fc);}else popularBooksData['forEach'](_0x5dff13=>{const _0x235e53=_0x1f4602;if(elements[_0x235e53(0x2e9)])elements[_0x235e53(0x2e9)][_0x235e53(0x17e)]+=createPopularBookCardHTML(_0x5dff13);});AOS[_0x1f4602(0x34b)]();},_0x3ad029=>{const _0x275cde=_0xdd7cfb;console[_0x275cde(0x181)](_0x275cde(0x10e),_0x3ad029),showToast(_0x275cde(0xf0),_0x275cde(0x181));if(elements[_0x275cde(0x2e9)])elements['popularBooksCarousel'][_0x275cde(0x17e)]='<div\x20class=\x22empty-state\x22\x20style=\x22padding:20px\x200;min-height:150px;width:100%;text-align:center;\x22><i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i><p\x20style=\x22font-size:0.9rem;\x22>Error\x20loading.</p></div>';});}function renderCategoryFilters(){const _0x2e46f1=_0x4cce9e;if(!elements['categoryFilterContainer'])return;elements[_0x2e46f1(0x147)][_0x2e46f1(0x17e)]=bookCategories[_0x2e46f1(0x84)](_0xa7ef4d=>_0x2e46f1(0x31c)+(_0xa7ef4d===currentCategory?'active':'')+_0x2e46f1(0x89)+escapeHTML(_0xa7ef4d)+_0x2e46f1(0x30b)+escapeHTML(_0xa7ef4d)+_0x2e46f1(0x348))[_0x2e46f1(0x23e)]('');}elements[_0x4cce9e(0x147)]&&elements[_0x4cce9e(0x147)]['addEventListener'](_0x4cce9e(0x328),_0x1b12ff=>{const _0x2c9fa2=_0x4cce9e,_0x3b707b=_0x1b12ff[_0x2c9fa2(0x9b)][_0x2c9fa2(0x2b4)]('.category-filter-item');if(_0x3b707b&&currentUser)currentCategory=_0x3b707b['dataset']['category'],$$('#categoryFilterContainer\x20.category-filter-item')[_0x2c9fa2(0x144)](_0x589237=>_0x589237[_0x2c9fa2(0x1b2)][_0x2c9fa2(0x318)](_0x2c9fa2(0x24a))),_0x3b707b[_0x2c9fa2(0x1b2)][_0x2c9fa2(0x239)]('active'),fetchBooksMain(![]);else!currentUser&&(showToast(_0x2c9fa2(0x1c8),_0x2c9fa2(0x21e)),openModal(elements['loginModal']));});function _0x5087(){const _0x49abf0=['conductSurveyBtn','points','setItem','Redirecting\x20to\x20earn\x20credits...','numeric','Thank\x20you!\x20Your\x20feedback\x20has\x20been\x20submitted.','books','withdrawals','feedback','fas\x20fa-gift','appendChild','toast-','.book-card','switchToLogin','docChanges','storage','UPSC','this\x20book','modified','preventDefault','auto','closeAddBookModal','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-calendar-alt\x22></i>\x20','users','Today','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22notification-icon\x22><i\x20class=\x22','bookDetailContent','style','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','profileUsernameLarge','#bookImageUrl','\x20<i\x20class=\x22fas\x20fa-coins\x22\x20style=\x22color:\x20var(--credit-color);\x22></i>','You\x20received\x20+','DOMContentLoaded','#booksContainer','.profile-page.active,\x20.notifications-page.active','submittedBy','onAuthStateChanged','\x20on\x20','submitWithdrawalBtn','Admin','EduSparK\x20enthusiast!','avatarInitials','<div\x20class=\x22book-admin-info\x22><i\x20class=\x22fas\x20fa-user-shield\x22></i>\x20Approved\x20by\x20','#submitBookBtn','#avatarInitials','div','random','processedBookActions',')</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','hovered','#withdrawBtnLarge','Error\x20fetching\x20notifications:','appCheck','withdrawalModal','Book\x20details\x20not\x20found.','[data-tab=\x22personal\x22]','Error\x20formatting\x20date:','name','#notificationsBackBtn','</h2>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22book-detail-author\x22>By\x20','<i\x20class=\x22fas\x20fa-calendar-alt\x22></i>\x20Joined:\x20-','User\x20data\x20not\x20found.\x20Please\x20try\x20again.','fas\x20fa-coins','Login\x20to\x20share\x20books.','authorName','disabled','&amp;','tempSignupData','redeem','#headerCreditsAmount','#withdrawalModalPoints','eduspark-new.firebasestorage.app','split','closest','accountNameGroup','getItem','#withdrawalModal','\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20data-action-link=\x22','<div\x20class=\x22no-comments\x22\x20style=\x22padding:\x2020px\x200;\x22>Loading\x20comments...</div>','<div\x20class=\x22skeleton-popular-book\x22><div\x20class=\x22skeleton-img\x22></div><div\x20class=\x22skeleton-info\x22><div\x20class=\x22skeleton-text\x20title\x22></div><div\x20class=\x22skeleton-text\x20meta\x22></div></div></div>','_blank','displayName','toDate','#profileNameLarge','Error\x20processing\x20book\x20approval/rejection\x20for\x20user:','booksGridLoadingIndicator','Firebase\x20App\x20Check\x20activated.','#submitWithdrawalBtn','book','\x22\x20has\x20been\x20submitted\x20for\x20approval.','User\x20data\x20not\x20found\x20for\x20stat\x20update.','#accountName','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popular-book-card\x22\x20data-action=\x22view\x22\x20data-book-id=\x22','Please\x20login\x20to\x20submit\x20feedback.','adminNotes','charAt','notificationsBtn','#loginEmail','setDate','.spinner','12th','openBookDetailModal\x20called\x20without\x20bookId','<div\x20class=\x22skeleton-history-item\x22></div>','push','Could\x20not\x20load\x20your\x20shared\x20books.','fas','querySelector','booksSharedCount','.notification-tab-btn.active','Username\x20already\x20taken.\x20Please\x20choose\x20another.','.modal','flex','Failed\x20to\x20load\x20book\x20details.','Daily\x20Bonus\x20Claimed!','#loadingMessage','<i\x20class=\x22fas\x20fa-envelope\x22></i>\x20','\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20data-id=\x22','#emptyPersonalNotificationsState','15956PXwHax','totalFeedbackGiven','#profileBtn','Critical\x20error\x20creating\x20user\x20document\x20in\x20Firestore:\x20','Search\x20functionality\x20might\x20be\x20limited\x20due\x20to\x20a\x20network\x20error.','ratingCount','</strong>','.amount-option','popularBooksCarousel','logoutBtn','#popularBooksCarousel','\x27;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','replace','lastDailyCreditClaim','read','show','Logged\x20in\x20successfully!','pointsWithdrawn','warning','none','getElementById','type','title','#editProfileBtn','Error\x20signing\x20out\x20after\x20profile\x20creation\x20failure','booksSharedLarge','\x22\x20class=\x22popular-book-img\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.onerror=null;this.src=\x27','<div\x20class=\x22empty-state\x22\x20style=\x22padding:20px\x200;min-height:150px;width:100%;text-align:center;\x22><i\x20class=\x22fas\x20fa-sad-tear\x22></i><p\x20style=\x22font-size:0.9rem;\x22>No\x20popular\x20books\x20yet.</p></div>','All','auth','addBookBtn','\x20pts\x20(₹','notificationTabBtns','\x20|\x20Category:\x20','reviewedBy','#addBookBtn','.bottom-nav\x20.nav-item','\x20fa-star\x22></i>','.\x20Please\x20refresh.','downloads','profile','message','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',':scope\x20>\x20span:not(.spinner)','init','Anonymous','</span><button\x20class=\x22toast-close\x22\x20aria-label=\x22Close\x20toast\x22>&times;</button>','fas\x20fa-times-circle','addBookForm','className','23WDQfoN','460427MjfbHg','increment','credits','fetchSignInMethodsForEmail','remove','notification-group','#authorName','logged-out','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22category-filter-item\x20','#emptyStateBooks','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-detail-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','#signupModal','Critical\x20error\x20setting\x20up\x20your\x20profile.\x20Please\x20contact\x20support.','#withdrawalModal\x20.withdrawal-options','Error\x20cleaning\x20listener\x20','body','<div\x20class=\x22no-comments\x22\x20style=\x22padding:\x2020px\x200;\x22>Be\x20the\x20first\x20to\x20leave\x20feedback\x20for\x20this\x20book!</div>','Opening\x20download...\x20(This\x20is\x20your\x20book,\x20no\x20credits\x20deducted)','Could\x20not\x20load\x20admin\x20announcements.','header','click','category','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22spinner\x22\x20style=\x22display:\x20none;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-eye\x22></i>\x20View\x20Details</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','headerCreditsAmount','loading','#loginModal','logoLink','scrollTo','creditModalUserCredits','Your\x20book\x20\x22','You\x20clicked\x20the\x20link\x20to\x20earn\x20credits.\x20Checking\x20eligibility...','#feedbackRating','Error\x20listening\x20to\x20all\x20books\x20for\x20search:','Please\x20select\x20a\x20star\x20rating\x20to\x20submit\x20feedback.','test','#paymentMethodLabel','Invalid\x20Date','includes','.notifications-tabs','log','</div>','@loading','<p\x20style=\x22text-align:center;\x20padding:10px;\x20background-color:\x20var(--card-bg-dark);\x20border-radius:\x20var(--border-radius-sm);\x20margin-bottom:15px;\x20color:\x20','emptyProfileBooks','slice','Your\x20profile\x20is\x20set\x20up.\x20You\x27ve\x20received\x20','Loading\x20EduSparK\x20Library...','rejected','startAfter','#closeCreditModal','withdrawBtnLarge','where','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','commit','\x20ratings)','refreshHard','toUpperCase','empty','announcement','<i\x20class=\x22','loginModal','#commentsList','Failed\x20to\x20submit\x20book:\x20','inline-flex','batch','innerWidth','<p\x20class=\x22comment-body\x22>','Failed\x20to\x20update\x20profile:\x20','#withdrawalHistoryContainer','#emptyAdminAnnouncementsState','fas\x20fa-exclamation-triangle','#editProfileName','book:','eduspark-new.firebaseapp.com','email','<span\x20class=\x22status-badge\x20status-pending\x22>Pending</span>','tab','\x22\x20onerror=\x22this.onerror=null;this.src=\x27','userAvatar','notificationsBackBtn','map','https://via.placeholder.com/160x200/333/888?text=No+Cover','bookName','toLocaleDateString','Book\x20Submission\x20Update','\x22\x20data-category=\x22','#editProfileForm','block','\x20type-','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-user\x22></i>\x20','s\x22\x20data-aos=\x22fade-up\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-img-container\x22\x20data-action=\x22view\x22\x20data-book-id=\x22','2156373jozJzF','your.email@example.com','addBookModal','Download\x20failed:\x20','&lt;','actionLink','<div\x20class=\x22feedback-separator\x22></div><p\x20style=\x22text-align:center;\x20color:var(--text-muted);\x20margin-top:20px;\x22>Feedback\x20section\x20will\x20be\x20available\x20once\x20approved.</p>','adminAnnouncements','method','pathname','toString','data','target','Welcome\x20to\x20EduSparK!\x20Your\x20profile\x20is\x20set\x20up.','timestamp','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-detail-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-download\x22></i>\x20<span\x20id=\x22detailDownloadCount\x22>','rejection','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','paymentIdInput','opacity','<span\x20class=\x22status-badge\x20status-rejected\x22>Rejected</span>','now','Username:\x203-15\x20chars,\x20lowercase,\x20numbers,\x20\x27_\x27,\x20\x27.\x27','\x22\x20was\x20rejected.\x20Reason:\x20','Failed\x20to\x20mark\x20all\x20as\x20read.','Please\x20login\x20to\x20claim\x20credits.','toastContainer','No\x20email','<div\x20class=\x22book-detail-description\x22>','contains','limit',')\x20is\x20pending.','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',',\x20have\x20','amountOptionsContainer','N/A','<div\x20class=\x22amount-option\x22\x20data-amount=\x22500\x22\x20data-rs=\x2250\x22>500\x20pts\x20=\x20₹50</div><div\x20class=\x22amount-option\x22\x20data-amount=\x221000\x22\x20data-rs=\x22100\x22>1000\x20pts\x20=\x20₹100</div><div\x20class=\x22amount-option\x22\x20data-amount=\x222000\x22\x20data-rs=\x22200\x22>2000\x20pts\x20=\x20₹200</div><div\x20class=\x22amount-option\x22\x20data-amount=\x225000\x22\x20data-rs=\x22500\x22>5000\x20pts\x20=\x20₹500</div>','toLowerCase','hasPendingWrites','href','.search-result-item','Profile\x20updated\x20successfully!','Logged\x20out\x20successfully.','s\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-amount\x22>','reset','\x20daily\x20credits.\x20Come\x20back\x20tomorrow!','docs','<div\x20class=\x22no-results\x22>No\x20books\x20found.</div>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-item\x22\x20data-aos=\x22fade-up\x22\x20style=\x22animation-delay:\x20','stringify','\x22\x20has\x20been\x20approved!\x20+10\x20points.','#searchToggleBtn','#notificationsBtn','Could\x20not\x20load\x20your\x20profile\x20data.\x20Please\x20refresh.','warn','&quot;','Insufficient\x20points\x20for\x20selected\x20amount.','\x22\x20was\x20downloaded!\x20+1\x20point.','.profile-tab-btn','bank','Email\x20for\x20Redeem\x20Code\x20*','Please\x20fill\x20all\x20required\x20fields.','loginForm','\x22></i></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22notification-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4\x20class=\x22notification-title\x22>','#saveProfileBtn','#loginPassword','You\x20received\x20+10\x20points\x20for\x20sharing\x20\x22','.modal.active','avgRating','fas\x20fa-info-circle','setHours','#feedbackStars','userBooks','Error\x20loading\x20comments:','Error\x20submitting\x20book:','</h3>','#closeLoginModal','1:564501033350:web:70c0f9873f96e9bd74fc07','profileBtn','processedBookActions.','</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22notification-message\x22>','.book-detail-meta\x20span:nth-child(3)','#loginBtn','Other','Drive\x20link\x20must\x20be\x20a\x20valid\x20link.','#loginPromptBtnMain','#notificationsPage','catch','Error\x20updating\x20profile:','booksDownloadedLarge','Image\x20URL\x20must\x20be\x20a\x20valid\x20link.','anon_username','<i\x20class=\x22fas\x20fa-star\x22\x20style=\x22color:var(--star-color);\x22></i>\x20','searchInput','notifications','Your\x20feedback\x20for\x20\x22','Could\x20not\x20load\x20popular\x20books.','You\x27ve\x20already\x20claimed\x20your\x20daily\x20bonus\x20today!','emptyAdminAnnouncementsState','Computer\x20Science','profileBackBtn','#creditModal','pending','userNotifications','loadingMessage','submittedAt','withdrawalOptionsContainer','#driveLink','&#39;','Not\x20specified','unreadNotificationsBadge','FieldValue','emptyStateBooks','announcements','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4>','display','value','closeWithdrawalModal','Connecting\x20to\x20the\x20Grid...','hidden','paytm','#claimDailyCreditBtn','exists','origin','createNotification\x20called\x20without\x20userId','emptyPersonalNotificationsState','Error\x20fetching\x20popular\x20books:','#profileBioLarge','bookDetailModal','9th','selected','trim','removeItem','#signupEmail','#toastContainer','10915536mzjLXC','Please\x20try\x20again.','Points\x20Awarded!','JEE','orderBy','Error\x20activating\x20Firebase\x20App\x20Check:','requestedAt','\x22\x20alt=\x22','scrolled','Unpacking\x20Knowledge...','closeLoginModal','parentElement','Fiction','#loginForm','User\x20document\x20not\x20found\x20during\x20book\x20approval\x20processing\x20for\x20UID:','#signupBtn','logged-in','All\x20personal\x20notifications\x20marked\x20as\x20read.','#closeBookDetailModal','toggle','Enter\x20details','floor','Feedback\x20Submitted','description',';\x22>This\x20book\x20is\x20currently:\x20<strong>','#userAvatar','<i\x20class=\x22fas\x20fa-calendar-alt\x22></i>\x20Joined:\x20','signupModal','createdAt','Book\x20Downloaded','User\x20Loading...','createElement','profileEmailLarge','\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20data-internal-route=\x22','userPointsLarge','#booksSharedLarge','set','eduspark-new','Failed\x20to\x20submit\x20feedback.\x20','popularBooks','.book-card[data-id=\x22','#signupForm','<div\x20class=\x22withdrawal-option\x22\x20data-method=\x22upi\x22><div\x20class=\x22withdrawal-icon\x22><i\x20class=\x22fas\x20fa-mobile-alt\x22></i></div><div\x20class=\x22withdrawal-details\x22><div\x20class=\x22withdrawal-title\x22>UPI</div><div\x20class=\x22withdrawal-description\x22>Fast\x20transfer\x20via\x20UPI\x20ID</div></div></div><div\x20class=\x22withdrawal-option\x22\x20data-method=\x22redeem\x22><div\x20class=\x22withdrawal-icon\x22><i\x20class=\x22fab\x20fa-google-play\x22></i></div><div\x20class=\x22withdrawal-details\x22><div\x20class=\x22withdrawal-title\x22>Redeem\x20Code</div><div\x20class=\x22withdrawal-description\x22>Google\x20Play\x20Gift\x20Card</div></div></div><div\x20class=\x22withdrawal-option\x22\x20data-method=\x22bank\x22><div\x20class=\x22withdrawal-icon\x22><i\x20class=\x22fas\x20fa-university\x22></i></div><div\x20class=\x22withdrawal-details\x22><div\x20class=\x22withdrawal-title\x22>Bank\x20Account</div><div\x20class=\x22withdrawal-description\x22>Direct\x20bank\x20transfer\x20(slower)</div></div></div><div\x20class=\x22withdrawal-option\x22\x20data-method=\x22paytm\x22><div\x20class=\x22withdrawal-icon\x22><i\x20class=\x22fas\x20fa-wallet\x22></i></div><div\x20class=\x22withdrawal-details\x22><div\x20class=\x22withdrawal-title\x22>Paytm\x20Wallet</div><div\x20class=\x22withdrawal-description\x22>Transfer\x20to\x20Paytm</div></div></div><div\x20class=\x22withdrawal-option\x22\x20data-method=\x22phonepe\x22><div\x20class=\x22withdrawal-icon\x22><i\x20class=\x22fas\x20fa-rupee-sign\x22></i></div><div\x20class=\x22withdrawal-details\x22><div\x20class=\x22withdrawal-title\x22>PhonePe</div><div\x20class=\x22withdrawal-description\x22>Transfer\x20to\x20PhonePe</div></div></div>','Failed\x20to\x20submit\x20request:\x20','signInWithEmailAndPassword','forEach','profileNameLarge','searchContainer','categoryFilterContainer','User','fa-hourglass-half','\x22\x20data-aos=\x22fade-left\x22\x20style=\x22animation-delay:\x20','\x20starting\x20credits!','#feedbackComment','Attempted\x20Credit\x20Boost','\x20daily\x20credits\x20claimed!\x20Come\x20back\x20tomorrow.','unread','Login\x20error:','length','#withdrawalModal\x20.amount-option','view','far','imageUrl','bookApproval','#feedbackForm','#signupUsername','<h3\x20class=\x22notification-group-date\x22>','#closeSignupModal','startsWith','</span>\x20Downloads</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-user\x22></i>\x20Shared\x20by\x20','#creditModalUserCredits','60cwzEyL','status','\x22></i><span>','fas\x20fa-user-check','Book\x20Approved!','Invalid\x20Time','comment','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22book-author\x22>By\x20','You\x20need\x20at\x20least\x20500\x20points\x20to\x20withdraw.\x20Your\x20balance:\x20','#profileUsernameLarge','\x20Number\x20*','get','addEventListener','<p\x20class=\x22comment-body\x22\x20style=\x22opacity:0.7;\x22><em>No\x20comment\x20text.</em></p>','48gOakAo','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22action-btn\x20view-btn\x22\x20data-action=\x22view\x22\x20data-book-id=\x22','Signup\x20error:','s\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popular-book-img-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','Please\x20login\x20to\x20edit\x20your\x20profile.','#withdrawalModal\x20.amount-selection','profileTabs','allBooksSearch','#searchResults','374270pMhJOx','Logout\x20error:','11th','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','Error\x20formatting\x20time:','fa-times-circle','onSnapshot','scroll','Enter\x20Account\x20Number','innerHTML','This\x20email\x20address\x20is\x20already\x20in\x20use.','totalBookDownloads','error','metadata','#addBookModal','overflow','withdrawalModalPoints','#paymentDetails','var(--status-pending-bg,\x20#f39c12)','toLocaleTimeString','#bookCategory','approvedAt','612031JqOUrF','bio','headerCreditsContainer','Error\x20fetching\x20withdrawal\x20history:','<i\x20class=\x22fas\x20fa-search-minus\x22></i><h3>No\x20Books\x20Found</h3><p>No\x20books\x20match\x20the\x20category\x20\x27','Password\x20must\x20be\x20at\x20least\x206\x20characters.','bookId','Error\x20in\x20book\x20approval\x20listener:','</p>','#logoutBtn','Could\x20not\x20load\x20notifications.','Account\x20Number\x20*','Action\x20requires\x20bookId,\x20but\x20not\x20found\x20on\x20target:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-author\x22>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-rating\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22book-title\x22>','editProfileBtn','signupForm','fas\x20fa-hand-sparkles','notificationsPage','upi','doc','inline-block','onclick','username','rating','#bookDetailContent','\x20at\x20','<br>Reason:\x20','closeEditProfileModal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-detail-layout\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-detail-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','firestore','<div\x20class=\x22empty-state\x22\x20style=\x22padding:20px\x200;min-height:150px;width:100%;text-align:center;\x22><i\x20class=\x22fas\x20fa-lock\x22></i><p\x20style=\x22font-size:0.9rem;\x22>Login\x20to\x20see\x20popular\x20books.</p></div>','Anonymous\x20User','Error\x20marking\x20all\x20notifications\x20as\x20read:','internalRoute','Uncategorized','Book\x20submitted\x20for\x20approval!\x20You\x27ll\x20be\x20notified.','Search\x20cache\x20updated\x20with\x20approved\x20books:','classList','open','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22notification-timestamp\x22>','closeSignupModal','</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>By\x20','Yesterday','closeDiscoverModal','booksDownloadedCount','profileAvatarInitialsLarge','\x27;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22popular-book-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4\x20class=\x22popular-book-title\x22>','focus','#profileBooksContainer','editProfileModal','profilePage','short','.notification-item','getDate','profileBioLarge','#withdrawalModal\x20.withdrawal-option,\x20#withdrawalModal\x20.amount-option','Anon','51kKMxdl','Could\x20not\x20load\x20books.\x20Please\x20check\x20your\x20connection.','Please\x20login\x20to\x20browse\x20categories.','activate','#loadMoreContainer','desc','<i\x20class=\x22fas\x20fa-exclamation-triangle\x22></i><h3>Error\x20Loading\x20Books</h3><p>Please\x20refresh\x20or\x20try\x20again\x20later.</p>','#detailDownloadCount','Need\x20','tab-','history','#booksDownloadedLarge','withdrawalForm','<span><i\x20class=\x22fas\x20fa-star\x22\x20style=\x22color:var(--star-color);\x22></i>\x20','10th','.profile-tab-content','uid','.action-btn[data-action=\x22view\x22],\x20.popular-book-card[data-action=\x22view\x22],\x20.book-img-container[data-action=\x22view\x22]','#profileAvatarLarge','collection','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22book-detail-category\x22>','accountNameInput','processedAt','https://via.placeholder.com/300x220/333/888?text=No+Cover','var(--status-rejected-bg,\x20#e74c3c)','user','profileTabContents','success','runTransaction','Book\x20not\x20found\x20during\x20transaction.','Enter\x20registered\x20mobile\x20number','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','loadingOverlay','\x22></i>\x20Status:\x20','Coding','fas\x20fa-comment-dots','fas\x20fa-hourglass-half','filter','rejectionReason','#bookName','initializeApp',';\x22><i\x20class=\x22fas\x20','#categoryFilterContainer','.toast-close','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','dataset','loadMoreBooksBtn','Book\x20not\x20found\x20for\x20rating\x20update.','personalNotificationsListContainer','switchToSignup','emptyWithdrawalHistory','required','#bookDetailModal\x20[data-action=\x22download\x22][data-book-id=\x22','\x20credits.\x20Opening\x20download...','placeholder','Book\x20Submitted','Insufficient\x20points.\x20Please\x20refresh.','booksContainer','Error\x20re-checking\x20username\x20during\x20doc\x20creation:','Loading\x20bio...','#loadMoreBooksBtn','claimDailyCreditBtn','<span><i\x20class=\x22far\x20fa-star\x22\x20style=\x22color:var(--star-color);\x22></i>\x20No\x20ratings\x20yet</span>','User\x20document\x20doesn\x27t\x20exist,\x20creating\x20one...','Error\x20fetching\x20books\x20for\x20main\x20grid:','submittedByName','action','totalBookDownloadsLarge','#switchToLogin','withdrawalHistoryContainer','homeBtn','getTime','paymentDetails','sentAt','10TFglZK','totalFeedbackLarge','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22notification-item\x20','popular','#feedbackStars\x20i','/#bookDetail/','http','<div\x20class=\x22withdrawal-date\x22\x20style=\x22color:var(--primary-light);\x22>Note:\x20','#signupName','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','<p\x20class=\x22book-detail-description\x22>No\x20description\x20available\x20for\x20this\x20book.</p>','mouseout','#withdrawalModal\x20.withdrawal-option','link','info','&gt;','#profilePage','textContent','<div\x20style=\x22text-align:center;\x20padding:\x2050px\x200;\x22><div\x20class=\x22spinner\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20border-width:\x204px;\x22></div><p\x20style=\x22margin-top:\x2015px;\x20color:\x20var(--text-muted);\x22>Loading\x20details...</p></div>','\x22\x20data-book-id=\x22','querySelectorAll','User\x20data\x20not\x20found.','profileJoinedLarge','#editProfileBio','#loadingOverlay','searchToggleBtn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22action-btn\x20detail-download-btn\x22\x20data-action=\x22download\x22\x20data-link=\x22','G-NM2SE3DE7J','#markAllNotificationsReadBtn','searchResults','#searchInput','substring','#discoverBtn','createUserWithEmailAndPassword','\x22\x20has\x20been\x20recorded.','refresh','6764OTCxCY','innerHeight','notificationTabsContainer','<p\x20style=\x22font-style:italic;\x20color:var(--text-muted);\x22>Download\x20will\x20be\x20available\x20once\x20approved.</p>','signOut','add','bottomNavItems','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','scrollY','#editProfileModal','join','personal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22search-result-item\x22\x20data-book-id=\x22','icon','Profile\x20Updated','parse','\x20points\x20(₹','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-card\x22\x20data-id=\x22','Failed\x20to\x20claim\x20daily\x20credit.\x20','#editProfileUsername','<i\x20class=\x22fas\x20fa-envelope\x22></i>\x20loading...','#closeAddBookModal','active','reviewedByName','adminAnnouncementsListContainer','<div\x20class=\x22withdrawal-date\x22\x20style=\x22font-style:italic;\x22>Processed:\x20','#unreadNotificationsBadge','update','\x27.\x20Try\x20\x27All\x27\x20or\x20another\x20category.</p>','Brewing\x20Fresh\x20Ideas...','sort','Not\x20logged\x20in.','serverTimestamp','User\x20not\x20found\x20during\x20transaction.','location','approval','#paymentId','#userPointsLarge','fas\x20fa-external-link-alt','markAllNotificationsReadBtn','toFixed','approved','profileBooksContainer','#bookDetailModal','#booksGridLoadingIndicator','phonepe','#bookDescription','ease-out-cubic','submit','.fa-star,\x20.far.fa-star','creditModal','closeBookDetailModal','.withdrawal-option','keys'];_0x5087=function(){return _0x49abf0;};return _0x5087();}elements[_0x4cce9e(0x311)][_0x4cce9e(0x16a)]('submit',async _0x27e2e7=>{const _0x20bfd6=_0x4cce9e;_0x27e2e7[_0x20bfd6(0x27d)]();if(!currentUser||!userData){showToast(_0x20bfd6(0x2aa),_0x20bfd6(0x181)),openModal(elements[_0x20bfd6(0x70)]);return;}const _0x573cfe=$(_0x20bfd6(0x1ed))[_0x20bfd6(0x104)]['trim'](),_0x5810e9=$(_0x20bfd6(0x31a))[_0x20bfd6(0x104)]['trim'](),_0x4c06d5=$(_0x20bfd6(0x189))[_0x20bfd6(0x104)]['trim'](),_0xad3db8=$(_0x20bfd6(0x288))[_0x20bfd6(0x104)][_0x20bfd6(0x113)](),_0x41e751=$(_0x20bfd6(0xfb))[_0x20bfd6(0x104)][_0x20bfd6(0x113)](),_0x2c61b9=$(_0x20bfd6(0x262))['value'][_0x20bfd6(0x113)]();if(!_0x573cfe||!_0x5810e9||!_0x4c06d5||!_0xad3db8||!_0x41e751){showToast(_0x20bfd6(0xcd),_0x20bfd6(0x2f3));return;}try{new URL(_0xad3db8);}catch(_0x49755b){showToast(_0x20bfd6(0xea),'warning');return;}try{new URL(_0x41e751);}catch(_0x3352d2){showToast(_0x20bfd6(0xe4),_0x20bfd6(0x2f3));return;}const _0x5f04ec=$(_0x20bfd6(0x296));toggleSpinner(_0x5f04ec,!![]);const _0x3dd071={'bookName':_0x573cfe,'authorName':_0x5810e9,'category':_0x4c06d5,'imageUrl':_0xad3db8,'driveLink':_0x41e751,'description':_0x2c61b9,'submittedBy':currentUser[_0x20bfd6(0x1d6)],'submittedByName':userData['name']||_0x20bfd6(0x30e),'submittedByUsername':userData[_0x20bfd6(0x1a3)]||_0x20bfd6(0xeb),'submittedAt':firebase[_0x20bfd6(0x1aa)][_0x20bfd6(0xff)][_0x20bfd6(0x254)](),'status':'pending','downloads':0x0,'avgRating':0x0,'ratingCount':0x0,'approvedAt':null,'reviewedAt':null,'reviewedBy':null,'reviewedByName':null,'rejectionReason':'','adminNotes':''};try{await db[_0x20bfd6(0x1d9)](_0x20bfd6(0x270))[_0x20bfd6(0x239)](_0x3dd071),await db[_0x20bfd6(0x1d9)]('users')['doc'](currentUser[_0x20bfd6(0x1d6)])[_0x20bfd6(0x24f)]({'booksSharedCount':firebase[_0x20bfd6(0x1aa)][_0x20bfd6(0xff)][_0x20bfd6(0x315)](0x1)}),await createNotification(currentUser['uid'],_0x20bfd6(0x1fd),'Your\x20book\x20\x22'+escapeHTML(_0x573cfe)+_0x20bfd6(0x2c4),_0x20bfd6(0x21e),null,'fas\x20fa-upload'),showToast(_0x20bfd6(0x1b0),_0x20bfd6(0x1e1)),elements[_0x20bfd6(0x311)][_0x20bfd6(0xbc)](),closeModal(elements[_0x20bfd6(0x91)]);}catch(_0x5ea957){console[_0x20bfd6(0x181)](_0x20bfd6(0xda),_0x5ea957),showToast(_0x20bfd6(0x72)+_0x5ea957[_0x20bfd6(0x30a)],'error');}finally{toggleSpinner(_0x5f04ec,![]);}});function setupBookApprovalListener(){const _0x41163a=_0x4cce9e;if(!currentUser||listeners[_0x41163a(0x156)])return;listeners[_0x41163a(0x156)]=db['collection'](_0x41163a(0x270))[_0x41163a(0x347)](_0x41163a(0x28e),'==',currentUser[_0x41163a(0x1d6)])[_0x41163a(0x17b)](async _0x31a81a=>{const _0x1479f7=_0x41163a;for(const _0xa22d8 of _0x31a81a[_0x1479f7(0x278)]()){if(_0xa22d8[_0x1479f7(0x2f6)]===_0x1479f7(0x27c)){const _0x11c530={'id':_0xa22d8['doc']['id'],..._0xa22d8[_0x1479f7(0x1a0)][_0x1479f7(0x9a)]()},_0x46eeb5=db[_0x1479f7(0x1d9)]('users')[_0x1479f7(0x1a0)](currentUser[_0x1479f7(0x1d6)]);try{const _0x4b94ff=await _0x46eeb5[_0x1479f7(0x169)]();if(!_0x4b94ff[_0x1479f7(0x10a)]){console[_0x1479f7(0xc6)](_0x1479f7(0x125),currentUser[_0x1479f7(0x1d6)]);continue;}const _0x233b34=_0x4b94ff[_0x1479f7(0x9a)](),_0x39ed53=_0x233b34[_0x1479f7(0x29a)]||{};if(_0x11c530[_0x1479f7(0x15f)]===_0x1479f7(0x25d)&&(!_0x39ed53[_0x11c530['id']]||!_0x39ed53[_0x11c530['id']][_0x1479f7(0x257)]))showToast(_0x1479f7(0x331)+escapeHTML(_0x11c530[_0x1479f7(0x86)])+_0x1479f7(0xc2),_0x1479f7(0x1e1),0x1b58),await _0x46eeb5[_0x1479f7(0x24f)]({'points':firebase[_0x1479f7(0x1aa)][_0x1479f7(0xff)][_0x1479f7(0x315)](0xa),[_0x1479f7(0xdf)+_0x11c530['id']+'.approval']:!![]}),await createNotification(currentUser[_0x1479f7(0x1d6)],_0x1479f7(0x162),_0x1479f7(0x331)+escapeHTML(_0x11c530[_0x1479f7(0x86)])+'\x22\x20is\x20now\x20live.',_0x1479f7(0x1e1),_0x1479f7(0x215)+_0x11c530['id'],'fas\x20fa-book-reader'),await createNotification(currentUser[_0x1479f7(0x1d6)],_0x1479f7(0x119),_0x1479f7(0xd2)+escapeHTML(_0x11c530[_0x1479f7(0x86)])+'\x22.','success',null,_0x1479f7(0x2a9));else _0x11c530[_0x1479f7(0x15f)]===_0x1479f7(0x343)&&(!_0x39ed53[_0x11c530['id']]||!_0x39ed53[_0x11c530['id']][_0x1479f7(0x9f)])&&(showToast(_0x1479f7(0x331)+escapeHTML(_0x11c530[_0x1479f7(0x86)])+_0x1479f7(0xa6)+escapeHTML(_0x11c530[_0x1479f7(0x1ec)]||'Not\x20specified')+'.',_0x1479f7(0x2f3),0x1b58),await _0x46eeb5['update']({[_0x1479f7(0xdf)+_0x11c530['id']+'.rejection']:!![]}),await createNotification(currentUser[_0x1479f7(0x1d6)],_0x1479f7(0x88),'Your\x20book\x20\x22'+escapeHTML(_0x11c530[_0x1479f7(0x86)])+_0x1479f7(0xa6)+escapeHTML(_0x11c530[_0x1479f7(0x1ec)]||_0x1479f7(0xfd))+'.',_0x1479f7(0x2f3),null,_0x1479f7(0x310)));}catch(_0x2c94e7){console[_0x1479f7(0x181)](_0x1479f7(0x2bf),currentUser[_0x1479f7(0x1d6)],_0x1479f7(0x7c),_0x11c530['id'],_0x2c94e7);}}}},_0x100d30=>{const _0x574f9e=_0x41163a;console[_0x574f9e(0x181)](_0x574f9e(0x192),_0x100d30);});}[elements[_0x4cce9e(0x1ff)],elements[_0x4cce9e(0x25e)],elements[_0x4cce9e(0x2e9)]][_0x4cce9e(0x144)](_0x26c13f=>{const _0x126e59=_0x4cce9e;_0x26c13f&&_0x26c13f[_0x126e59(0x16a)](_0x126e59(0x328),async _0x154452=>{const _0x2fd7b3=_0x126e59,_0x292eb4=_0x154452['target'][_0x2fd7b3(0x2b4)](_0x2fd7b3(0x1d7));if(!_0x292eb4)return;if(!currentUser||!userData){openModal(elements[_0x2fd7b3(0x70)]);return;}const _0x358c1e=_0x292eb4['dataset'][_0x2fd7b3(0x208)],_0x4e4685=_0x292eb4[_0x2fd7b3(0x1f3)][_0x2fd7b3(0x191)];if(!_0x4e4685){console[_0x2fd7b3(0xc6)](_0x2fd7b3(0x197),_0x292eb4);return;}_0x358c1e===_0x2fd7b3(0x153)&&openBookDetailModal(_0x4e4685);});});async function handleBookDownload(_0x307852,_0x1bf7b1,_0x3595de=![],_0x42c9d5=null){const _0x9f626b=_0x4cce9e;if(!currentUser||!userData){openModal(elements[_0x9f626b(0x70)]);return;}const _0x1cad7a=_0x42c9d5||(_0x3595de?$(_0x9f626b(0x1fa)+_0x307852+'\x22]'):null);if(_0x1cad7a)toggleSpinner(_0x1cad7a,!![]);try{const _0x420423=await db[_0x9f626b(0x1d9)](_0x9f626b(0x281))[_0x9f626b(0x1a0)](currentUser[_0x9f626b(0x1d6)])[_0x9f626b(0x169)]();if(!_0x420423[_0x9f626b(0x10a)])throw new Error(_0x9f626b(0x2a8));const _0x1f48cc=_0x420423[_0x9f626b(0x9a)]();if(_0x1f48cc[_0x9f626b(0x316)]<BOOK_DOWNLOAD_COST&&_0x307852&&(await db['collection'](_0x9f626b(0x270))[_0x9f626b(0x1a0)](_0x307852)[_0x9f626b(0x169)]())[_0x9f626b(0x9a)]()[_0x9f626b(0x28e)]!==currentUser[_0x9f626b(0x1d6)]){showToast(_0x9f626b(0x1ce)+BOOK_DOWNLOAD_COST+'\x20credits.\x20You\x20have\x20'+_0x1f48cc[_0x9f626b(0x316)]+'.\x20Earn\x20more\x20or\x20claim\x20daily\x20bonus!',_0x9f626b(0x2f3),0x1388),openModal(elements[_0x9f626b(0x266)]);if(_0x1cad7a)toggleSpinner(_0x1cad7a,![]);return;}const _0x39fbd7=db[_0x9f626b(0x1d9)]('users')['doc'](currentUser[_0x9f626b(0x1d6)]),_0x3604fd=db[_0x9f626b(0x1d9)](_0x9f626b(0x270))[_0x9f626b(0x1a0)](_0x307852);let _0x4926ef=null,_0x239ca3=null,_0x1608bc=![];await db[_0x9f626b(0x1e2)](async _0x158bf7=>{const _0x28ca36=_0x9f626b,_0x5405ed=await _0x158bf7[_0x28ca36(0x169)](_0x39fbd7),_0x2a0e09=await _0x158bf7[_0x28ca36(0x169)](_0x3604fd);if(!_0x5405ed['exists'])throw new Error(_0x28ca36(0x255));if(!_0x2a0e09[_0x28ca36(0x10a)])throw new Error(_0x28ca36(0x1e3));const _0x27b3f1=_0x5405ed[_0x28ca36(0x9a)]()['credits']||0x0;_0x4926ef=_0x2a0e09['data']()[_0x28ca36(0x28e)],_0x239ca3=_0x2a0e09[_0x28ca36(0x9a)]()['bookName'],_0x1608bc=currentUser['uid']===_0x4926ef;if(!_0x1608bc&&_0x27b3f1<BOOK_DOWNLOAD_COST)throw new Error('Insufficient\x20credits.\x20Need\x20'+BOOK_DOWNLOAD_COST+_0x28ca36(0xb1)+_0x27b3f1+_0x28ca36(0x307));!_0x1608bc&&_0x158bf7[_0x28ca36(0x24f)](_0x39fbd7,{'credits':firebase['firestore'][_0x28ca36(0xff)]['increment'](-BOOK_DOWNLOAD_COST),'booksDownloadedCount':firebase[_0x28ca36(0x1aa)][_0x28ca36(0xff)]['increment'](0x1)});_0x158bf7['update'](_0x3604fd,{'downloads':firebase['firestore'][_0x28ca36(0xff)]['increment'](0x1)});if(_0x4926ef&&!_0x1608bc){const _0x5bf848=db[_0x28ca36(0x1d9)]('users')[_0x28ca36(0x1a0)](_0x4926ef);_0x158bf7[_0x28ca36(0x24f)](_0x5bf848,{'points':firebase['firestore'][_0x28ca36(0xff)][_0x28ca36(0x315)](0x1),'totalBookDownloads':firebase[_0x28ca36(0x1aa)]['FieldValue'][_0x28ca36(0x315)](0x1)});}}),window['open'](_0x1bf7b1,'_blank'),!_0x1608bc?showToast('-'+BOOK_DOWNLOAD_COST+_0x9f626b(0x1fb),_0x9f626b(0x21e),0xbb8):showToast(_0x9f626b(0x325),'info',0xbb8),!_0x1608bc&&userData&&(userData['credits']=(userData[_0x9f626b(0x316)]||0x0)-BOOK_DOWNLOAD_COST,updateHeaderCredits()),_0x4926ef&&!_0x1608bc&&_0x239ca3&&await createNotification(_0x4926ef,_0x9f626b(0x134),_0x9f626b(0x331)+escapeHTML(_0x239ca3)+_0x9f626b(0xc9),_0x9f626b(0x21e),_0x9f626b(0x215)+_0x307852,'fas\x20fa-arrow-down');}catch(_0x434054){console[_0x9f626b(0x181)]('Error\x20during\x20download\x20transaction:',_0x434054),showToast(_0x9f626b(0x92)+(_0x434054[_0x9f626b(0x30a)]||_0x9f626b(0x118)),_0x9f626b(0x181));}finally{if(_0x1cad7a)toggleSpinner(_0x1cad7a,![]);}}function fetchUserBooks(_0x143698=![],_0x4d9d37=![]){const _0x55140d=_0x4cce9e;if(!currentUser||isFetchingMoreUserBooks&&!_0x4d9d37)return;if(_0x4d9d37){lastUserBookSnapshot=null,hasMoreUserBooks=!![];if(elements[_0x55140d(0x25e)])elements['profileBooksContainer'][_0x55140d(0x17e)]='';if(elements[_0x55140d(0x33f)])elements[_0x55140d(0x33f)][_0x55140d(0x285)][_0x55140d(0x103)]=_0x55140d(0x2f4);}if(!hasMoreUserBooks&&_0x143698){if(elements['loadMoreBooksBtn'])toggleSpinner(elements['loadMoreBooksBtn'],![]);return;}isFetchingMoreUserBooks=!![];if(_0x143698&&elements[_0x55140d(0x1f4)])toggleSpinner(elements[_0x55140d(0x1f4)],!![]);else!_0x4d9d37&&elements['profileBooksContainer']&&!elements[_0x55140d(0x25e)][_0x55140d(0x2d5)](_0x55140d(0x276))&&renderSkeletonLoaders(elements[_0x55140d(0x25e)],0x3);let _0x25a5e6=db[_0x55140d(0x1d9)](_0x55140d(0x270))['where'](_0x55140d(0x28e),'==',currentUser['uid'])[_0x55140d(0x11b)]('submittedAt',_0x55140d(0x1cb))[_0x55140d(0xad)](0x6);_0x143698&&lastUserBookSnapshot&&(_0x25a5e6=_0x25a5e6['startAfter'](lastUserBookSnapshot));if(listeners[_0x55140d(0xd8)])listeners[_0x55140d(0xd8)]();listeners['userBooks']=_0x25a5e6[_0x55140d(0x17b)](_0x12a1ba=>{const _0x621c9b=_0x55140d;if(!_0x143698&&!_0x4d9d37&&_0x12a1ba[_0x621c9b(0x182)][_0x621c9b(0xb6)]&&!_0x12a1ba[_0x621c9b(0x34d)])return;if(!_0x143698&&elements['profileBooksContainer'])elements[_0x621c9b(0x25e)][_0x621c9b(0x17e)]='';if(_0x12a1ba['empty']&&(!elements[_0x621c9b(0x25e)]||elements[_0x621c9b(0x25e)][_0x621c9b(0x17e)]==='')){if(elements[_0x621c9b(0x33f)])elements[_0x621c9b(0x33f)][_0x621c9b(0x285)][_0x621c9b(0x103)]='flex';hasMoreUserBooks=![];}else{if(elements[_0x621c9b(0x33f)])elements['emptyProfileBooks'][_0x621c9b(0x285)][_0x621c9b(0x103)]=_0x621c9b(0x2f4);_0x12a1ba[_0x621c9b(0xbe)][_0x621c9b(0x144)](_0x24f301=>{const _0x351ec0=_0x621c9b,_0x1b8a8f=elements[_0x351ec0(0x25e)]?elements[_0x351ec0(0x25e)]['querySelector'](_0x351ec0(0x13f)+_0x24f301['id']+'\x22]'):null;!_0x1b8a8f&&elements[_0x351ec0(0x25e)]&&(elements[_0x351ec0(0x25e)][_0x351ec0(0x17e)]+=createBookCardHTML({'id':_0x24f301['id'],..._0x24f301[_0x351ec0(0x9a)]()},_0x351ec0(0x309)));}),lastUserBookSnapshot=_0x12a1ba[_0x621c9b(0xbe)][_0x621c9b(0x151)]>0x0?_0x12a1ba[_0x621c9b(0xbe)][_0x12a1ba[_0x621c9b(0xbe)][_0x621c9b(0x151)]-0x1]:null,hasMoreUserBooks=_0x12a1ba[_0x621c9b(0xbe)]['length']===0x6;}if(elements['loadMoreBooksBtn'])elements['loadMoreBooksBtn']['style']['display']=hasMoreUserBooks?_0x621c9b(0x73):'none';if(_0x143698&&elements[_0x621c9b(0x1f4)])toggleSpinner(elements['loadMoreBooksBtn'],![]);isFetchingMoreUserBooks=![],AOS['refreshHard']();},_0x27b1c5=>{const _0x588596=_0x55140d;console[_0x588596(0x181)]('Error\x20fetching\x20user\x20books:',_0x27b1c5),showToast(_0x588596(0x2d3),'error');if(_0x143698&&elements[_0x588596(0x1f4)])toggleSpinner(elements[_0x588596(0x1f4)],![]);isFetchingMoreUserBooks=![],elements['emptyProfileBooks']&&elements[_0x588596(0x25e)]&&(elements[_0x588596(0x25e)][_0x588596(0x17e)]='',elements[_0x588596(0x33f)][_0x588596(0x285)][_0x588596(0x103)]=_0x588596(0x2da));});}if(elements['loadMoreBooksBtn'])elements[_0x4cce9e(0x1f4)][_0x4cce9e(0x16a)](_0x4cce9e(0x328),()=>fetchUserBooks(!![]));function enableWithdrawalIfQualified(){const _0x3915f0=_0x4cce9e,_0x1418d0=elements['withdrawBtnLarge'];_0x1418d0&&(_0x1418d0[_0x3915f0(0x2ac)]=!(userData&&userData['points']>=0x1f4));}elements[_0x4cce9e(0x346)]&&(elements['withdrawBtnLarge'][_0x4cce9e(0x1a2)]=()=>{const _0x48c578=_0x4cce9e;if(userData&&userData[_0x48c578(0x26b)]>=0x1f4){elements[_0x48c578(0x185)]['textContent']=userData[_0x48c578(0x26b)]||0x0,selectedWithdrawalMethod=null,selectedWithdrawalAmount=null,selectedWithdrawalRs=null,$$(_0x48c578(0x1c4))[_0x48c578(0x144)](_0xd22317=>_0xd22317['classList'][_0x48c578(0x318)](_0x48c578(0x24a)));if(elements[_0x48c578(0x20e)])elements[_0x48c578(0x20e)][_0x48c578(0x1b2)][_0x48c578(0x318)](_0x48c578(0x24a));if(elements[_0x48c578(0x1d2)])elements[_0x48c578(0x1d2)][_0x48c578(0xbc)]();updatePaymentDetailsUI(),openModal(elements[_0x48c578(0x2a0)]);}else showToast(_0x48c578(0x166)+(userData?.[_0x48c578(0x26b)]||0x0),_0x48c578(0x2f3));});if(elements[_0x4cce9e(0x105)])elements[_0x4cce9e(0x105)]['onclick']=()=>closeModal(elements[_0x4cce9e(0x2a0)]);function _0x481a(_0x243ad4,_0xc57c7){const _0x508793=_0x5087();return _0x481a=function(_0x481a36,_0x5dde1e){_0x481a36=_0x481a36-0x6f;let _0x1fd12e=_0x508793[_0x481a36];return _0x1fd12e;},_0x481a(_0x243ad4,_0xc57c7);}function setupWithdrawalListeners(){const _0x5dfdc4=_0x4cce9e;elements[_0x5dfdc4(0xfa)]&&elements[_0x5dfdc4(0xfa)][_0x5dfdc4(0x16a)]('click',_0xb403a3=>{const _0x5d0900=_0x5dfdc4,_0x4cf38a=_0xb403a3[_0x5d0900(0x9b)]['closest'](_0x5d0900(0x268));if(!_0x4cf38a)return;$$(_0x5d0900(0x21c))[_0x5d0900(0x144)](_0x2597f6=>_0x2597f6[_0x5d0900(0x1b2)][_0x5d0900(0x318)](_0x5d0900(0x24a))),_0x4cf38a[_0x5d0900(0x1b2)][_0x5d0900(0x239)](_0x5d0900(0x24a)),selectedWithdrawalMethod=_0x4cf38a[_0x5d0900(0x1f3)][_0x5d0900(0x97)],updatePaymentDetailsUI();if(selectedWithdrawalAmount&&elements['paymentDetails'])elements[_0x5d0900(0x20e)][_0x5d0900(0x1b2)][_0x5d0900(0x239)]('active');}),elements[_0x5dfdc4(0xb2)]&&elements[_0x5dfdc4(0xb2)][_0x5dfdc4(0x16a)](_0x5dfdc4(0x328),_0x139013=>{const _0x3ac186=_0x5dfdc4,_0x434457=_0x139013[_0x3ac186(0x9b)][_0x3ac186(0x2b4)](_0x3ac186(0x2e8));if(!_0x434457)return;const _0x2964b7=parseInt(_0x434457[_0x3ac186(0x1f3)]['amount']);if(userData&&userData['points']>=_0x2964b7){$$(_0x3ac186(0x152))[_0x3ac186(0x144)](_0x87fd2a=>_0x87fd2a['classList']['remove']('active')),_0x434457[_0x3ac186(0x1b2)][_0x3ac186(0x239)](_0x3ac186(0x24a)),selectedWithdrawalAmount=_0x2964b7,selectedWithdrawalRs=parseInt(_0x434457[_0x3ac186(0x1f3)]['rs']);if(selectedWithdrawalMethod&&elements['paymentDetails'])elements[_0x3ac186(0x20e)][_0x3ac186(0x1b2)][_0x3ac186(0x239)](_0x3ac186(0x24a));}else showToast(_0x3ac186(0x1ce)+_0x2964b7+'\x20pts.\x20Your\x20balance:\x20'+(userData?.['points']||0x0),_0x3ac186(0x2f3));});}function updatePaymentDetailsUI(){const _0x212844=_0x4cce9e;if(!selectedWithdrawalMethod||!elements['paymentDetails']){if(elements[_0x212844(0x20e)])elements['paymentDetails']['classList'][_0x212844(0x318)](_0x212844(0x24a));return;}const _0x5b8cf7=elements['paymentMethodLabel'],_0x363dad=elements[_0x212844(0xa1)],_0x33c4fe=elements[_0x212844(0x2b5)],_0x944564=elements[_0x212844(0x1db)];if(!_0x5b8cf7||!_0x363dad||!_0x33c4fe||!_0x944564)return;_0x363dad[_0x212844(0x1fc)]=_0x212844(0x12b),_0x33c4fe[_0x212844(0x285)][_0x212844(0x103)]='none',_0x944564[_0x212844(0x1f9)]=![];if(selectedWithdrawalMethod===_0x212844(0x19f))_0x5b8cf7[_0x212844(0x221)]='UPI\x20ID\x20*',_0x363dad[_0x212844(0x1fc)]='yourname@okbank';else{if(selectedWithdrawalMethod===_0x212844(0x2af))_0x5b8cf7[_0x212844(0x221)]=_0x212844(0xcc),_0x363dad[_0x212844(0x1fc)]=_0x212844(0x90);else{if(selectedWithdrawalMethod===_0x212844(0xcb))_0x5b8cf7['textContent']=_0x212844(0x196),_0x363dad[_0x212844(0x1fc)]=_0x212844(0x17d),_0x33c4fe[_0x212844(0x285)][_0x212844(0x103)]='block',_0x944564[_0x212844(0x1f9)]=!![];else(selectedWithdrawalMethod===_0x212844(0x108)||selectedWithdrawalMethod===_0x212844(0x261))&&(_0x5b8cf7[_0x212844(0x221)]=selectedWithdrawalMethod[_0x212844(0x2ca)](0x0)['toUpperCase']()+selectedWithdrawalMethod[_0x212844(0x340)](0x1)+_0x212844(0x168),_0x363dad[_0x212844(0x1fc)]=_0x212844(0x1e4));}}}elements[_0x4cce9e(0x1d2)]&&elements[_0x4cce9e(0x1d2)][_0x4cce9e(0x16a)](_0x4cce9e(0x264),async _0x287cd2=>{const _0x79eb0f=_0x4cce9e;_0x287cd2[_0x79eb0f(0x27d)]();if(!currentUser||!userData||!selectedWithdrawalMethod||!selectedWithdrawalAmount){showToast('Please\x20select\x20method\x20and\x20amount.',_0x79eb0f(0x2f3));return;}if(userData[_0x79eb0f(0x26b)]<selectedWithdrawalAmount){showToast(_0x79eb0f(0xc8),_0x79eb0f(0x181));return;}const _0x3f8a30=elements[_0x79eb0f(0xa1)][_0x79eb0f(0x104)][_0x79eb0f(0x113)](),_0x4fe6e9=elements[_0x79eb0f(0x1db)][_0x79eb0f(0x104)][_0x79eb0f(0x113)]();if(!_0x3f8a30||elements['accountNameGroup'][_0x79eb0f(0x285)]['display']===_0x79eb0f(0x8b)&&!_0x4fe6e9){showToast('Please\x20fill\x20all\x20required\x20payment\x20details.',_0x79eb0f(0x2f3));return;}const _0x89e96c=elements[_0x79eb0f(0x291)];toggleSpinner(_0x89e96c,!![]);const _0x16e1bf={'userId':currentUser[_0x79eb0f(0x1d6)],'userName':userData[_0x79eb0f(0x2a4)]||_0x79eb0f(0xb3),'userEmail':userData['email'],'pointsWithdrawn':selectedWithdrawalAmount,'amountRs':selectedWithdrawalRs,'method':selectedWithdrawalMethod,'paymentIdentifier':_0x3f8a30,'accountHolderName':selectedWithdrawalMethod===_0x79eb0f(0xcb)&&_0x4fe6e9?_0x4fe6e9:null,'status':_0x79eb0f(0xf6),'requestedAt':firebase[_0x79eb0f(0x1aa)][_0x79eb0f(0xff)][_0x79eb0f(0x254)](),'processedAt':null,'adminNotes':''};try{const _0x5596b4=db[_0x79eb0f(0x1d9)](_0x79eb0f(0x281))[_0x79eb0f(0x1a0)](currentUser[_0x79eb0f(0x1d6)]);await db[_0x79eb0f(0x1e2)](async _0x22352a=>{const _0x2dc2c4=_0x79eb0f,_0x29d07a=await _0x22352a[_0x2dc2c4(0x169)](_0x5596b4);if(!_0x29d07a[_0x2dc2c4(0x10a)])throw new Error('User\x20not\x20found.');const _0x3e0e41=_0x29d07a[_0x2dc2c4(0x9a)]()[_0x2dc2c4(0x26b)]||0x0;if(_0x3e0e41<selectedWithdrawalAmount)throw new Error(_0x2dc2c4(0x1fe));_0x22352a[_0x2dc2c4(0x24f)](_0x5596b4,{'points':firebase[_0x2dc2c4(0x1aa)][_0x2dc2c4(0xff)][_0x2dc2c4(0x315)](-selectedWithdrawalAmount)});const _0x208cf7=db[_0x2dc2c4(0x1d9)]('withdrawals')[_0x2dc2c4(0x1a0)]();_0x22352a[_0x2dc2c4(0x13b)](_0x208cf7,_0x16e1bf);}),await createNotification(currentUser['uid'],'Withdrawal\x20Request\x20Submitted','Your\x20request\x20to\x20withdraw\x20'+selectedWithdrawalAmount+_0x79eb0f(0x244)+selectedWithdrawalRs+_0x79eb0f(0xae),'info',null,_0x79eb0f(0x1ea)),showToast('Withdrawal\x20request\x20submitted\x20successfully!','success'),elements['withdrawalForm'][_0x79eb0f(0xbc)](),closeModal(elements[_0x79eb0f(0x2a0)]);}catch(_0x498f63){console[_0x79eb0f(0x181)]('Error\x20submitting\x20withdrawal:',_0x498f63),showToast(_0x79eb0f(0x142)+_0x498f63['message'],'error');}finally{toggleSpinner(_0x89e96c,![]);}});function fetchWithdrawalHistory(){const _0xb09c86=_0x4cce9e;if(!currentUser||listeners['withdrawals'])return;if(!elements[_0xb09c86(0x20b)]||!elements['emptyWithdrawalHistory'])return;renderSkeletonLoaders(elements['withdrawalHistoryContainer'],0x3,_0xb09c86(0x1d0)),elements[_0xb09c86(0x1f8)][_0xb09c86(0x285)][_0xb09c86(0x103)]=_0xb09c86(0x2f4),listeners[_0xb09c86(0x271)]=db[_0xb09c86(0x1d9)](_0xb09c86(0x271))['where']('userId','==',currentUser[_0xb09c86(0x1d6)])[_0xb09c86(0x11b)](_0xb09c86(0x11d),_0xb09c86(0x1cb))[_0xb09c86(0xad)](0xa)[_0xb09c86(0x17b)](_0x154981=>{const _0x33b6e9=_0xb09c86;elements[_0x33b6e9(0x20b)][_0x33b6e9(0x17e)]='',_0x154981[_0x33b6e9(0x34d)]?elements['emptyWithdrawalHistory']['style'][_0x33b6e9(0x103)]=_0x33b6e9(0x2da):(elements['emptyWithdrawalHistory'][_0x33b6e9(0x285)][_0x33b6e9(0x103)]=_0x33b6e9(0x2f4),_0x154981[_0x33b6e9(0x144)](_0x473af7=>{const _0x16fe87=_0x33b6e9,_0x4e50df=_0x473af7[_0x16fe87(0x9a)]();elements[_0x16fe87(0x20b)]['innerHTML']+=_0x16fe87(0xc0)+Math[_0x16fe87(0x299)]()*0.2+_0x16fe87(0xbb)+_0x4e50df[_0x16fe87(0x2f2)]+_0x16fe87(0x300)+_0x4e50df['amountRs']+')</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-method\x22>Method:\x20'+escapeHTML(_0x4e50df[_0x16fe87(0x97)][_0x16fe87(0x34c)]())+'\x20|\x20ID:\x20'+escapeHTML(_0x4e50df['paymentIdentifier'])+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-date\x22>Requested:\x20'+formatDate(_0x4e50df['requestedAt'])+'\x20'+formatTime(_0x4e50df[_0x16fe87(0x11d)])+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x4e50df[_0x16fe87(0x15f)]!=='pending'&&_0x4e50df['processedAt']?_0x16fe87(0x24d)+formatDate(_0x4e50df[_0x16fe87(0x1dc)])+'\x20'+formatTime(_0x4e50df['processedAt'])+_0x16fe87(0x33c):'')+_0x16fe87(0xb0)+(_0x4e50df['adminNotes']?_0x16fe87(0x217)+escapeHTML(_0x4e50df[_0x16fe87(0x2c9)])+_0x16fe87(0x33c):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-status\x20status-'+_0x4e50df[_0x16fe87(0x15f)][_0x16fe87(0xb5)]()+'\x22>'+escapeHTML(_0x4e50df[_0x16fe87(0x15f)])+_0x16fe87(0x178);})),AOS[_0x33b6e9(0x34b)]();},_0x5cac39=>{const _0x4c7f8c=_0xb09c86;console[_0x4c7f8c(0x181)](_0x4c7f8c(0x18e),_0x5cac39),showToast('Could\x20not\x20load\x20withdrawal\x20history.',_0x4c7f8c(0x181)),elements[_0x4c7f8c(0x20b)][_0x4c7f8c(0x17e)]='',elements['emptyWithdrawalHistory'][_0x4c7f8c(0x285)][_0x4c7f8c(0x103)]='flex';});}async function handleDailyCreditClaim(){const _0x37a626=_0x4cce9e;if(!currentUser||!userData){showToast(_0x37a626(0xa8),_0x37a626(0x21e)),openModal(elements[_0x37a626(0x70)]);return;}const _0x1250a3=elements[_0x37a626(0x203)];toggleSpinner(_0x1250a3,!![]);try{const _0x23294f=await db[_0x37a626(0x1d9)](_0x37a626(0x281))[_0x37a626(0x1a0)](currentUser[_0x37a626(0x1d6)])[_0x37a626(0x169)]();if(!_0x23294f[_0x37a626(0x10a)])throw new Error(_0x37a626(0x225));const _0xb2da9a=_0x23294f[_0x37a626(0x9a)](),_0x59aca1=new Date()['toISOString']()[_0x37a626(0x2b3)]('T')[0x0];if(_0xb2da9a[_0x37a626(0x2ee)]===_0x59aca1){showToast(_0x37a626(0xf1),'warning'),toggleSpinner(_0x1250a3,![]);return;}const _0xa80af4=0x14;await db[_0x37a626(0x1d9)](_0x37a626(0x281))['doc'](currentUser['uid'])[_0x37a626(0x24f)]({'credits':firebase[_0x37a626(0x1aa)]['FieldValue']['increment'](_0xa80af4),'lastDailyCreditClaim':_0x59aca1}),await createNotification(currentUser[_0x37a626(0x1d6)],_0x37a626(0x2dc),_0x37a626(0x28a)+_0xa80af4+_0x37a626(0xbd),_0x37a626(0x1e1),null,_0x37a626(0x273)),showToast('+'+_0xa80af4+_0x37a626(0x14e),'success');}catch(_0x195516){console['error']('Error\x20claiming\x20daily\x20credit:',_0x195516),showToast(_0x37a626(0x246)+_0x195516[_0x37a626(0x30a)],'error');}finally{toggleSpinner(_0x1250a3,![]);}}if(elements['headerCreditsContainer'])elements[_0x4cce9e(0x18d)][_0x4cce9e(0x1a2)]=()=>{const _0x41ffc4=_0x4cce9e;if(!currentUser){openModal(elements[_0x41ffc4(0x70)]);return;}if(elements[_0x41ffc4(0x330)])elements['creditModalUserCredits'][_0x41ffc4(0x17e)]=(userData?.[_0x41ffc4(0x316)]||0x0)+_0x41ffc4(0x289);openModal(elements[_0x41ffc4(0x266)]);};if(elements['closeCreditModal'])elements['closeCreditModal'][_0x4cce9e(0x1a2)]=()=>closeModal(elements[_0x4cce9e(0x266)]);if(elements[_0x4cce9e(0x26a)])elements[_0x4cce9e(0x26a)][_0x4cce9e(0x1a2)]=()=>{const _0x214439=_0x4cce9e;if(!currentUser){openModal(elements[_0x214439(0x70)]);return;}showToast(_0x214439(0x26d),_0x214439(0x21e)),window['location'][_0x214439(0xb7)]='https://linkcents.com/50-Credit-books',createNotification(currentUser[_0x214439(0x1d6)],_0x214439(0x14d),_0x214439(0x332),_0x214439(0x21e),null,_0x214439(0x25a)),closeModal(elements[_0x214439(0x266)]);};async function openBookDetailModal(_0x3ec226){const _0x30d382=_0x4cce9e;if(!_0x3ec226){console[_0x30d382(0xc6)](_0x30d382(0x2d0));return;}if(!currentUser){openModal(elements[_0x30d382(0x70)]);return;}currentBookDetailId=_0x3ec226,openModal(elements[_0x30d382(0x110)]);if(elements['bookDetailContent'])elements[_0x30d382(0x284)][_0x30d382(0x17e)]=_0x30d382(0x222);try{const _0x4d142e=await db[_0x30d382(0x1d9)]('books')[_0x30d382(0x1a0)](_0x3ec226)[_0x30d382(0x169)]();if(!_0x4d142e[_0x30d382(0x10a)]){showToast(_0x30d382(0x2a1),_0x30d382(0x181)),closeModal(elements[_0x30d382(0x110)]),currentBookDetailId=null;return;}const _0x67eee3={'id':_0x4d142e['id'],..._0x4d142e['data']()},_0x5a0269=_0x67eee3[_0x30d382(0x28e)]===currentUser?.['uid'];if(_0x67eee3[_0x30d382(0x15f)]!==_0x30d382(0x25d)&&!_0x5a0269){showToast('This\x20book\x20is\x20not\x20yet\x20approved\x20or\x20available.',_0x30d382(0x181)),closeModal(elements['bookDetailModal']),currentBookDetailId=null;return;}renderBookDetailContent(_0x67eee3),_0x67eee3[_0x30d382(0x15f)]==='approved'&&loadFeedbackComments(_0x3ec226);}catch(_0x43c6b4){console[_0x30d382(0x181)]('Error\x20fetching\x20book\x20details:',_0x43c6b4),showToast(_0x30d382(0x2db),'error');if(elements[_0x30d382(0x284)])elements[_0x30d382(0x284)][_0x30d382(0x17e)]='<p\x20style=\x22color:\x20var(--text-muted);\x20text-align:\x20center;\x20padding:\x2030px;\x22>Could\x20not\x20load\x20details.\x20Please\x20try\x20again.</p>';}}function renderBookDetailContent(_0x1a774c){const _0x1c9f27=_0x4cce9e;if(!elements[_0x1c9f27(0x284)])return;const _0x3e6552='https://via.placeholder.com/200x280/333/888?text=No+Cover',_0x156eb7=_0x1a774c[_0x1c9f27(0x155)]||_0x3e6552,_0x488144=_0x1a774c[_0x1c9f27(0x28e)]===currentUser?.['uid'],_0x4aad14=_0x1a774c[_0x1c9f27(0x15f)]===_0x1c9f27(0x25d);let _0x5008c3='';_0x488144&&!_0x4aad14&&(_0x5008c3=_0x1c9f27(0x33e)+(_0x1a774c['status']===_0x1c9f27(0xf6)?_0x1c9f27(0x187):_0x1c9f27(0x1de))+_0x1c9f27(0x12f)+_0x1a774c[_0x1c9f27(0x15f)][_0x1c9f27(0x34c)]()+_0x1c9f27(0x2e7)+(_0x1a774c[_0x1c9f27(0x15f)]===_0x1c9f27(0x343)&&_0x1a774c[_0x1c9f27(0x1ec)]?_0x1c9f27(0x1a7)+escapeHTML(_0x1a774c[_0x1c9f27(0x1ec)]):'')+_0x1c9f27(0x193));const _0x5969dd=_0x4aad14?_0x488144?'Free\x20-\x20Your\x20Book':BOOK_DOWNLOAD_COST+'\x20<i\x20class=\x22fas\x20fa-coins\x22\x20style=\x22color:var(--credit-color);font-size:0.8em;\x22></i>':'Unavailable';elements['bookDetailContent'][_0x1c9f27(0x17e)]=_0x1c9f27(0x1a9)+escapeHTML(_0x156eb7)+_0x1c9f27(0x11e)+escapeHTML(_0x1a774c[_0x1c9f27(0x86)])+_0x1c9f27(0x81)+_0x3e6552+'\x27;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-detail-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5008c3+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h2\x20class=\x22book-detail-title\x22>'+escapeHTML(_0x1a774c[_0x1c9f27(0x86)])+_0x1c9f27(0x2a6)+escapeHTML(_0x1a774c['authorName'])+_0x1c9f27(0x1da)+escapeHTML(_0x1a774c[_0x1c9f27(0x329)]||_0x1c9f27(0x1af))+_0x1c9f27(0x9e)+(_0x1a774c[_0x1c9f27(0x308)]||0x0)+_0x1c9f27(0x15c)+escapeHTML(_0x1a774c[_0x1c9f27(0x207)]||_0x1c9f27(0x1c5))+_0x1c9f27(0xa0)+(_0x1a774c['avgRating']>0x0&&_0x4aad14?_0x1c9f27(0x1d3)+_0x1a774c[_0x1c9f27(0xd4)][_0x1c9f27(0x25c)](0x1)+'\x20('+(_0x1a774c['ratingCount']||0x0)+'\x20ratings)</span>':_0x4aad14?_0x1c9f27(0x204):'')+_0x1c9f27(0x1f2)+(_0x1a774c[_0x1c9f27(0x12e)]?_0x1c9f27(0xab)+escapeHTML(_0x1a774c[_0x1c9f27(0x12e)])+_0x1c9f27(0x33c):_0x1c9f27(0x21a))+_0x1c9f27(0x31e)+(_0x4aad14?_0x1c9f27(0x22a)+escapeHTML(_0x1a774c['driveLink'])+_0x1c9f27(0x223)+_0x1a774c['id']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22spinner\x22\x20style=\x22display:none;\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-download\x22></i>\x20Download\x20('+_0x5969dd+_0x1c9f27(0x29b):_0x488144?_0x1c9f27(0x237):'')+_0x1c9f27(0x286)+(_0x4aad14?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22feedback-separator\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22feedback-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22feedback-title\x22>Rate\x20this\x20Book</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<form\x20id=\x22feedbackForm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22rating-stars\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>Your\x20Rating:</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22stars\x22\x20id=\x22feedbackStars\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22far\x20fa-star\x22\x20data-value=\x221\x22\x20title=\x22Terrible\x22></i><i\x20class=\x22far\x20fa-star\x22\x20data-value=\x222\x22\x20title=\x22Poor\x22></i><i\x20class=\x22far\x20fa-star\x22\x20data-value=\x223\x22\x20title=\x22Average\x22></i><i\x20class=\x22far\x20fa-star\x22\x20data-value=\x224\x22\x20title=\x22Good\x22></i><i\x20class=\x22far\x20fa-star\x22\x20data-value=\x225\x22\x20title=\x22Excellent\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22hidden\x22\x20id=\x22feedbackRating\x22\x20value=\x220\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22feedbackComment\x22\x20class=\x22form-label\x22>Your\x20Feedback\x20(Optional):</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22feedbackComment\x22\x20class=\x22form-textarea\x22\x20placeholder=\x22Share\x20your\x20thoughts...\x22\x20rows=\x223\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22submit\x22\x20class=\x22submit-btn\x22\x20id=\x22submitFeedbackBtn\x22><span\x20class=\x22spinner\x22\x20style=\x22display:\x20none;\x22></span><span>Submit\x20Feedback</span></button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</form>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22feedback-title\x22\x20style=\x22margin-top:\x2030px;\x22>Comments</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comments-list\x22\x20id=\x22commentsList\x22><div\x20class=\x22no-comments\x22>Loading\x20comments...</div></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':_0x488144?_0x1c9f27(0x95):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4aad14&&addDetailModalListeners(_0x1a774c['id']);}function addDetailModalListeners(_0x525442){const _0x4e9b9e=_0x4cce9e,_0x328698=elements[_0x4e9b9e(0x284)][_0x4e9b9e(0x2d5)]('.detail-download-btn');_0x328698&&_0x328698[_0x4e9b9e(0x16a)](_0x4e9b9e(0x328),()=>{const _0x36d390=_0x4e9b9e;if(!currentUser||!userData){openModal(elements[_0x36d390(0x70)]);return;}handleBookDownload(_0x525442,_0x328698[_0x36d390(0x1f3)][_0x36d390(0x21d)],!![],_0x328698);});const _0x54addc=$(_0x4e9b9e(0xd7)),_0x2c98db=$(_0x4e9b9e(0x333));if(_0x54addc&&_0x2c98db){const _0x459a99=_0x54addc[_0x4e9b9e(0x224)]('i');_0x459a99[_0x4e9b9e(0x144)](_0x20fdec=>{const _0x5168be=_0x4e9b9e;_0x20fdec[_0x5168be(0x16a)]('mouseover',()=>highlightStars(_0x459a99,parseInt(_0x20fdec[_0x5168be(0x1f3)][_0x5168be(0x104)]),!![])),_0x20fdec[_0x5168be(0x16a)](_0x5168be(0x21b),()=>highlightStars(_0x459a99,parseInt(_0x2c98db['value']),![])),_0x20fdec[_0x5168be(0x16a)]('click',()=>{const _0x5cbef2=_0x5168be;_0x2c98db[_0x5cbef2(0x104)]=_0x20fdec['dataset'][_0x5cbef2(0x104)],highlightStars(_0x459a99,parseInt(_0x2c98db[_0x5cbef2(0x104)]),![]);});});}const _0x28ab50=$(_0x4e9b9e(0x157));if(_0x28ab50)_0x28ab50[_0x4e9b9e(0x16a)](_0x4e9b9e(0x264),_0xb15a6f=>handleFeedbackSubmit(_0xb15a6f,_0x525442));}function highlightStars(_0x244cdd,_0x21529a,_0x23d97b){const _0x21786f=_0x4cce9e;_0x244cdd[_0x21786f(0x144)](_0x5e038c=>{const _0xc450ab=_0x21786f,_0x3c288f=parseInt(_0x5e038c['dataset']['value']);_0x5e038c[_0xc450ab(0x1b2)][_0xc450ab(0x318)](_0xc450ab(0x2d4),_0xc450ab(0x154),_0xc450ab(0x112),'hovered');if(_0x3c288f<=_0x21529a){_0x5e038c[_0xc450ab(0x1b2)][_0xc450ab(0x239)](_0xc450ab(0x2d4));if(!_0x23d97b)_0x5e038c[_0xc450ab(0x1b2)][_0xc450ab(0x239)]('selected');if(_0x23d97b)_0x5e038c['classList']['add'](_0xc450ab(0x29c));}else _0x5e038c['classList'][_0xc450ab(0x239)](_0xc450ab(0x154));});}async function handleFeedbackSubmit(_0x4d968d,_0x2c43ad){const _0x22e645=_0x4cce9e;_0x4d968d[_0x22e645(0x27d)]();if(!currentUser||!userData||!_0x2c43ad){showToast(_0x22e645(0x2c8),_0x22e645(0x21e));if(!currentUser)openModal(elements[_0x22e645(0x70)]);return;}const _0x4879bf=parseInt($('#feedbackRating')[_0x22e645(0x104)]),_0x6c4fc=$(_0x22e645(0x14c))['value'][_0x22e645(0x113)]();if(_0x4879bf===0x0){showToast(_0x22e645(0x335),_0x22e645(0x2f3));return;}const _0x2ad83d=$('#submitFeedbackBtn');toggleSpinner(_0x2ad83d,!![]);const _0x20de4d={'userId':currentUser[_0x22e645(0x1d6)],'userName':userData[_0x22e645(0x2a4)]||_0x22e645(0x30e),'userAvatarInitials':getInitials(userData[_0x22e645(0x2a4)]||_0x22e645(0x30e)),'rating':_0x4879bf,'comment':_0x6c4fc,'submittedAt':firebase[_0x22e645(0x1aa)][_0x22e645(0xff)][_0x22e645(0x254)]()};try{await db[_0x22e645(0x1d9)](_0x22e645(0x270))['doc'](_0x2c43ad)[_0x22e645(0x1d9)](_0x22e645(0x272))[_0x22e645(0x239)](_0x20de4d);const _0x430e59=db[_0x22e645(0x1d9)]('books')[_0x22e645(0x1a0)](_0x2c43ad),_0x966e97=db[_0x22e645(0x1d9)](_0x22e645(0x281))[_0x22e645(0x1a0)](currentUser[_0x22e645(0x1d6)]);await db[_0x22e645(0x1e2)](async _0x2725f2=>{const _0x5523e9=_0x22e645,_0x5a145a=await _0x2725f2[_0x5523e9(0x169)](_0x430e59),_0x5f5455=await _0x2725f2[_0x5523e9(0x169)](_0x966e97);if(!_0x5a145a[_0x5523e9(0x10a)])throw new Error(_0x5523e9(0x1f5));if(!_0x5f5455['exists'])throw new Error(_0x5523e9(0x2c5));const _0x33d92d=_0x5a145a['data']()[_0x5523e9(0x2e6)]||0x0,_0x37bd9a=_0x5a145a[_0x5523e9(0x9a)]()[_0x5523e9(0xd4)]||0x0,_0x38c385=_0x33d92d+0x1,_0x5928d9=(_0x37bd9a*_0x33d92d+_0x4879bf)/_0x38c385;_0x2725f2[_0x5523e9(0x24f)](_0x430e59,{'ratingCount':_0x38c385,'avgRating':_0x5928d9}),_0x2725f2[_0x5523e9(0x24f)](_0x966e97,{'totalFeedbackGiven':firebase[_0x5523e9(0x1aa)][_0x5523e9(0xff)]['increment'](0x1)});});const _0x2e5425=await _0x430e59[_0x22e645(0x169)](),_0x33e46c=_0x2e5425[_0x22e645(0x10a)]?_0x2e5425[_0x22e645(0x9a)]()[_0x22e645(0x86)]:_0x22e645(0x27b);await createNotification(currentUser['uid'],_0x22e645(0x12d),_0x22e645(0xef)+escapeHTML(_0x33e46c)+_0x22e645(0x232),_0x22e645(0x1e1),_0x22e645(0x215)+_0x2c43ad,_0x22e645(0x1e9)),showToast(_0x22e645(0x26f),'success');if($('#feedbackForm'))$(_0x22e645(0x157))[_0x22e645(0xbc)]();if($('#feedbackRating'))$(_0x22e645(0x333))[_0x22e645(0x104)]=0x0;if($$(_0x22e645(0x214))['length']>0x0)highlightStars($$(_0x22e645(0x214)),0x0,![]);loadFeedbackComments(_0x2c43ad);const _0xfb14cb=await db['collection'](_0x22e645(0x270))[_0x22e645(0x1a0)](_0x2c43ad)[_0x22e645(0x169)]();if(_0xfb14cb[_0x22e645(0x10a)]&&elements[_0x22e645(0x284)]){const _0x4fca5b=_0xfb14cb[_0x22e645(0x9a)](),_0x3f96e2=elements[_0x22e645(0x284)]['querySelector'](_0x22e645(0xe1));_0x3f96e2&&_0x3f96e2[_0x22e645(0x2d5)](_0x22e645(0x265))&&(_0x3f96e2[_0x22e645(0x17e)]=_0x22e645(0xec)+_0x4fca5b[_0x22e645(0xd4)][_0x22e645(0x25c)](0x1)+'\x20('+(_0x4fca5b[_0x22e645(0x2e6)]||0x0)+_0x22e645(0x34a));const _0x3f4f80=elements['bookDetailContent'][_0x22e645(0x2d5)](_0x22e645(0x1cd));if(_0x3f4f80)_0x3f4f80[_0x22e645(0x221)]=_0x4fca5b[_0x22e645(0x308)]||0x0;}}catch(_0x3c7f47){console[_0x22e645(0x181)]('Error\x20submitting\x20feedback:',_0x3c7f47),showToast(_0x22e645(0x13d)+_0x3c7f47[_0x22e645(0x30a)],'error');}finally{toggleSpinner(_0x2ad83d,![]);}}async function loadFeedbackComments(_0x5a28d4){const _0x3c0d68=_0x4cce9e,_0x1cf4b1=$(_0x3c0d68(0x71));if(!_0x1cf4b1)return;_0x1cf4b1[_0x3c0d68(0x17e)]=_0x3c0d68(0x2b9);try{const _0x4086a1=await db[_0x3c0d68(0x1d9)](_0x3c0d68(0x270))[_0x3c0d68(0x1a0)](_0x5a28d4)[_0x3c0d68(0x1d9)](_0x3c0d68(0x272))[_0x3c0d68(0x11b)](_0x3c0d68(0xf9),_0x3c0d68(0x1cb))[_0x3c0d68(0xad)](0xf)['get']();if(_0x4086a1[_0x3c0d68(0x34d)]){_0x1cf4b1[_0x3c0d68(0x17e)]=_0x3c0d68(0x324);return;}_0x1cf4b1[_0x3c0d68(0x17e)]='',_0x4086a1[_0x3c0d68(0x144)](_0x4a4844=>{const _0x109816=_0x3c0d68,_0x4d86cb=_0x4a4844[_0x109816(0x9a)]();let _0x1f18af='';for(let _0x4a049b=0x1;_0x4a049b<=0x5;_0x4a049b++){_0x1f18af+=_0x109816(0x6f)+(_0x4a049b<=_0x4d86cb[_0x109816(0x1a4)]?'fas':_0x109816(0x154))+_0x109816(0x306);}_0x1cf4b1['innerHTML']+=_0x109816(0x198)+escapeHTML(_0x4d86cb['userName']||_0x109816(0x148))+_0x109816(0x199)+_0x1f18af+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x4d86cb[_0x109816(0x164)]?_0x109816(0x76)+escapeHTML(_0x4d86cb[_0x109816(0x164)])+_0x109816(0x193):_0x109816(0x16b))+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22comment-date\x22>'+formatDate(_0x4d86cb[_0x109816(0xf9)])+_0x109816(0x1a6)+formatTime(_0x4d86cb[_0x109816(0xf9)])+_0x109816(0x1e5);});}catch(_0x214252){console['error'](_0x3c0d68(0xd9),_0x214252),_0x1cf4b1['innerHTML']='<div\x20class=\x22no-comments\x22\x20style=\x22padding:\x2020px\x200;\x22>Could\x20not\x20load\x20comments\x20at\x20this\x20time.</div>';}}async function createNotification(_0x52b0c6,_0x4fb513,_0x23d976,_0x114c52=_0x4cce9e(0x21e),_0x33c8d8=null,_0x1c0c78=null){const _0xecd58e=_0x4cce9e;if(!_0x52b0c6){console[_0xecd58e(0xc6)](_0xecd58e(0x10c));return;}try{await db[_0xecd58e(0x1d9)](_0xecd58e(0x281))[_0xecd58e(0x1a0)](_0x52b0c6)['collection'](_0xecd58e(0xee))[_0xecd58e(0x239)]({'title':_0x4fb513,'message':_0x23d976,'type':_0x114c52,'timestamp':firebase[_0xecd58e(0x1aa)]['FieldValue'][_0xecd58e(0x254)](),'read':![],'actionLink':_0x33c8d8,'icon':_0x1c0c78||getDefaultIconForType(_0x114c52)});}catch(_0x376268){console[_0xecd58e(0x181)]('Error\x20creating\x20notification:',_0x376268);}}function getDefaultIconForType(_0x59d534){const _0x1302e3=_0x4cce9e;switch(_0x59d534){case'success':return'fas\x20fa-check-circle';case _0x1302e3(0x181):return _0x1302e3(0x310);case _0x1302e3(0x2f3):return _0x1302e3(0x7a);case _0x1302e3(0x34e):return'fas\x20fa-bullhorn';default:return _0x1302e3(0xd5);}}function updateUnreadBadge(_0x21c02a){const _0x4d96a8=_0x4cce9e;unreadNotificationsCount=_0x21c02a;elements[_0x4d96a8(0xfe)]&&(_0x21c02a>0x0?(elements['unreadNotificationsBadge'][_0x4d96a8(0x221)]=_0x21c02a>0x9?'9+':_0x21c02a,elements[_0x4d96a8(0xfe)]['style'][_0x4d96a8(0x103)]='flex'):elements['unreadNotificationsBadge']['style'][_0x4d96a8(0x103)]=_0x4d96a8(0x2f4));if(elements[_0x4d96a8(0x236)]&&elements[_0x4d96a8(0x25b)]){const _0x232879=elements[_0x4d96a8(0x236)][_0x4d96a8(0x2d5)](_0x4d96a8(0x2d7));if(_0x232879){const _0x1db964=_0x232879[_0x4d96a8(0x1f3)][_0x4d96a8(0x80)];_0x1db964===_0x4d96a8(0x23f)?elements['markAllNotificationsReadBtn'][_0x4d96a8(0x2ac)]=unreadNotificationsCount===0x0:elements[_0x4d96a8(0x25b)][_0x4d96a8(0x2ac)]=!![];}else elements[_0x4d96a8(0x25b)][_0x4d96a8(0x2ac)]=!![];}}function setupUserNotificationsListener(){const _0x197174=_0x4cce9e;if(!currentUser||listeners['userNotifications'])return;if(!elements[_0x197174(0x1f6)]||!elements[_0x197174(0x10d)])return;renderSkeletonLoaders(elements[_0x197174(0x1f6)],0x5,'notification'),listeners[_0x197174(0xf7)]=db[_0x197174(0x1d9)]('users')[_0x197174(0x1a0)](currentUser['uid'])[_0x197174(0x1d9)](_0x197174(0xee))[_0x197174(0x11b)]('timestamp',_0x197174(0x1cb))[_0x197174(0xad)](0x32)['onSnapshot'](_0x13a434=>{const _0x1a0d15=_0x197174;let _0x3d9e63=0x0;const _0x54456f={};_0x13a434[_0x1a0d15(0x144)](_0x1613f1=>{const _0x47126c=_0x1a0d15,_0xe0c40a={'id':_0x1613f1['id'],..._0x1613f1[_0x47126c(0x9a)]()};if(!_0xe0c40a[_0x47126c(0x2ef)])_0x3d9e63++;const _0x57a365=formatRelativeDate(_0xe0c40a[_0x47126c(0x9d)]);if(!_0x54456f[_0x57a365])_0x54456f[_0x57a365]=[];_0x54456f[_0x57a365][_0x47126c(0x2d2)](_0xe0c40a);}),updateUnreadBadge(_0x3d9e63),elements[_0x1a0d15(0x1f6)][_0x1a0d15(0x17e)]='';if(_0x13a434['empty'])elements[_0x1a0d15(0x10d)][_0x1a0d15(0x285)][_0x1a0d15(0x103)]=_0x1a0d15(0x2da);else{elements[_0x1a0d15(0x10d)]['style'][_0x1a0d15(0x103)]='none';const _0x550dce=Object[_0x1a0d15(0x269)](_0x54456f)[_0x1a0d15(0x252)]((_0x37c19e,_0x2ff5f8)=>{const _0x43ed4e=_0x1a0d15,_0x15cec9=_0x37c19e===_0x43ed4e(0x282)?new Date():_0x37c19e===_0x43ed4e(0x1b7)?new Date(Date[_0x43ed4e(0xa4)]()-0x5265c00):new Date(_0x37c19e),_0x3bdb73=_0x2ff5f8===_0x43ed4e(0x282)?new Date():_0x2ff5f8===_0x43ed4e(0x1b7)?new Date(Date[_0x43ed4e(0xa4)]()-0x5265c00):new Date(_0x2ff5f8);return _0x3bdb73-_0x15cec9;});_0x550dce[_0x1a0d15(0x144)](_0x5dcee1=>{const _0x4bab5f=_0x1a0d15,_0x2dccc3=document[_0x4bab5f(0x136)]('div');_0x2dccc3[_0x4bab5f(0x312)]=_0x4bab5f(0x319),_0x2dccc3[_0x4bab5f(0x17e)]=_0x4bab5f(0x159)+escapeHTML(_0x5dcee1)+_0x4bab5f(0xdb),_0x54456f[_0x5dcee1]['forEach'](_0x1ba575=>{const _0x51e65a=_0x4bab5f;_0x2dccc3[_0x51e65a(0x17e)]+=createNotificationItemHTML(_0x1ba575);}),elements['personalNotificationsListContainer'][_0x4bab5f(0x274)](_0x2dccc3);});}AOS[_0x1a0d15(0x34b)]();},_0x5cdc2b=>{const _0x58980e=_0x197174;console[_0x58980e(0x181)](_0x58980e(0x29e),_0x5cdc2b),showToast(_0x58980e(0x195),_0x58980e(0x181)),elements['personalNotificationsListContainer'][_0x58980e(0x17e)]='',elements['emptyPersonalNotificationsState']['style'][_0x58980e(0x103)]=_0x58980e(0x2da);});}function setupAdminAnnouncementsListener(){const _0x46d8ad=_0x4cce9e;if(listeners['adminAnnouncements'])listeners[_0x46d8ad(0x96)]();if(!elements['adminAnnouncementsListContainer']||!elements[_0x46d8ad(0xf2)])return;renderSkeletonLoaders(elements[_0x46d8ad(0x24c)],0x3,'notification'),listeners[_0x46d8ad(0x96)]=db[_0x46d8ad(0x1d9)]('broadcast_notifications')[_0x46d8ad(0x11b)](_0x46d8ad(0x20f),_0x46d8ad(0x1cb))['limit'](0x14)[_0x46d8ad(0x17b)](_0x4c572b=>{const _0x289577=_0x46d8ad,_0x258ce1={};_0x4c572b[_0x289577(0x144)](_0x10aa9f=>{const _0x2c7421=_0x289577,_0xb58240={'id':_0x10aa9f['id'],..._0x10aa9f[_0x2c7421(0x9a)](),'type':_0x10aa9f[_0x2c7421(0x9a)]()[_0x2c7421(0x2f6)]||_0x2c7421(0x34e)},_0x434e85=formatRelativeDate(_0xb58240['sentAt']);if(!_0x258ce1[_0x434e85])_0x258ce1[_0x434e85]=[];_0x258ce1[_0x434e85][_0x2c7421(0x2d2)](_0xb58240);}),elements['adminAnnouncementsListContainer'][_0x289577(0x17e)]='';if(_0x4c572b[_0x289577(0x34d)])elements[_0x289577(0xf2)][_0x289577(0x285)][_0x289577(0x103)]='flex';else{elements['emptyAdminAnnouncementsState'][_0x289577(0x285)][_0x289577(0x103)]=_0x289577(0x2f4);const _0x30c21c=Object[_0x289577(0x269)](_0x258ce1)[_0x289577(0x252)]((_0x49783d,_0x1aea2c)=>{const _0xaf3fa3=_0x289577,_0x28786c=_0x49783d===_0xaf3fa3(0x282)?new Date():_0x49783d===_0xaf3fa3(0x1b7)?new Date(Date[_0xaf3fa3(0xa4)]()-0x5265c00):new Date(_0x49783d),_0x4e337c=_0x1aea2c===_0xaf3fa3(0x282)?new Date():_0x1aea2c==='Yesterday'?new Date(Date[_0xaf3fa3(0xa4)]()-0x5265c00):new Date(_0x1aea2c);return _0x4e337c-_0x28786c;});_0x30c21c[_0x289577(0x144)](_0x3d1f5f=>{const _0x5e9758=_0x289577,_0x3c4235=document[_0x5e9758(0x136)](_0x5e9758(0x298));_0x3c4235[_0x5e9758(0x312)]='notification-group',_0x3c4235[_0x5e9758(0x17e)]=_0x5e9758(0x159)+escapeHTML(_0x3d1f5f)+_0x5e9758(0xdb),_0x258ce1[_0x3d1f5f][_0x5e9758(0x144)](_0x19b05c=>{const _0x3eda07=_0x5e9758;_0x3c4235[_0x3eda07(0x17e)]+=createNotificationItemHTML(_0x19b05c);}),elements[_0x5e9758(0x24c)][_0x5e9758(0x274)](_0x3c4235);});}AOS[_0x289577(0x34b)]();},_0x2ece3a=>{const _0x2117c4=_0x46d8ad;console[_0x2117c4(0x181)]('Error\x20fetching\x20admin\x20announcements:',_0x2ece3a),showToast(_0x2117c4(0x326),_0x2117c4(0x181)),elements[_0x2117c4(0x24c)][_0x2117c4(0x17e)]='',elements['emptyAdminAnnouncementsState'][_0x2117c4(0x285)]['display']=_0x2117c4(0x2da);});}function createNotificationItemHTML(_0x1e673f){const _0x37e03a=_0x4cce9e;let _0x208dd3='';if(_0x1e673f['actionLink']){if(_0x1e673f[_0x37e03a(0x94)][_0x37e03a(0x15b)]('/#'))_0x208dd3=window[_0x37e03a(0x256)][_0x37e03a(0x10b)]+window[_0x37e03a(0x256)][_0x37e03a(0x98)]+_0x1e673f[_0x37e03a(0x94)][_0x37e03a(0x22f)](0x1);else _0x1e673f[_0x37e03a(0x94)][_0x37e03a(0x15b)]('http')&&(_0x208dd3=_0x1e673f[_0x37e03a(0x94)]);}const _0x55c26e=_0x1e673f[_0x37e03a(0x20f)]||_0x1e673f[_0x37e03a(0x9d)],_0x2f07dd=_0x1e673f[_0x37e03a(0x241)]||getDefaultIconForType(_0x1e673f[_0x37e03a(0x2f6)]||_0x37e03a(0x34e));return _0x37e03a(0x212)+(_0x1e673f[_0x37e03a(0x2ef)]?'':'unread')+_0x37e03a(0x8c)+_0x1e673f[_0x37e03a(0x2f6)]+_0x37e03a(0x2df)+_0x1e673f['id']+_0x37e03a(0x2b8)+escapeHTML(_0x208dd3||'')+_0x37e03a(0x138)+escapeHTML(_0x1e673f[_0x37e03a(0x94)]&&_0x1e673f[_0x37e03a(0x94)][_0x37e03a(0x15b)]('/#')?_0x1e673f['actionLink']:'')+_0x37e03a(0x283)+escapeHTML(_0x2f07dd)+_0x37e03a(0xcf)+escapeHTML(_0x1e673f[_0x37e03a(0x2f7)])+_0x37e03a(0xe0)+escapeHTML(_0x1e673f[_0x37e03a(0x30a)])+_0x37e03a(0x1b4)+formatTime(_0x55c26e)+_0x37e03a(0x23b);}[elements[_0x4cce9e(0x1f6)],elements[_0x4cce9e(0x24c)]][_0x4cce9e(0x144)](_0x4230b5=>{const _0x4a63a4=_0x4cce9e;_0x4230b5&&_0x4230b5[_0x4a63a4(0x16a)](_0x4a63a4(0x328),async _0x443a0d=>{const _0x580a1e=_0x4a63a4,_0x42c2d8=_0x443a0d[_0x580a1e(0x9b)][_0x580a1e(0x2b4)](_0x580a1e(0x1c1));if(!_0x42c2d8||!_0x42c2d8[_0x580a1e(0x1f3)]['id'])return;if(!currentUser){openModal(elements[_0x580a1e(0x70)]);return;}const _0x2bed14=_0x42c2d8[_0x580a1e(0x1f3)]['id'],_0x1f876d=_0x42c2d8[_0x580a1e(0x1f3)][_0x580a1e(0x94)],_0x1a05af=_0x42c2d8[_0x580a1e(0x1f3)][_0x580a1e(0x1ae)];if(_0x4230b5===elements['personalNotificationsListContainer']&&_0x42c2d8['classList'][_0x580a1e(0xac)](_0x580a1e(0x14f)))try{await db[_0x580a1e(0x1d9)](_0x580a1e(0x281))[_0x580a1e(0x1a0)](currentUser[_0x580a1e(0x1d6)])[_0x580a1e(0x1d9)](_0x580a1e(0xee))[_0x580a1e(0x1a0)](_0x2bed14)['update']({'read':!![]});}catch(_0x587d20){console[_0x580a1e(0x181)]('Error\x20marking\x20notification\x20as\x20read:',_0x587d20);}if(_0x1a05af&&_0x1a05af['startsWith']('/#bookDetail/')){const _0x5a1883=_0x1a05af[_0x580a1e(0x2b3)]('/')[0x2];closePage(elements['notificationsPage']),activateNavItem(elements['homeBtn']),openBookDetailModal(_0x5a1883);}else _0x1f876d&&_0x1f876d[_0x580a1e(0x15b)](_0x580a1e(0x216))&&window[_0x580a1e(0x1b3)](_0x1f876d,_0x580a1e(0x2bb));});});elements[_0x4cce9e(0x25b)]&&elements[_0x4cce9e(0x25b)][_0x4cce9e(0x16a)](_0x4cce9e(0x328),async()=>{const _0x451bd1=_0x4cce9e;if(!currentUser||unreadNotificationsCount===0x0)return;const _0x4f3e9d=elements[_0x451bd1(0x236)]['querySelector'](_0x451bd1(0x2d7));if(!_0x4f3e9d||_0x4f3e9d[_0x451bd1(0x1f3)][_0x451bd1(0x80)]!==_0x451bd1(0x23f))return;toggleSpinner(elements[_0x451bd1(0x25b)],!![]);try{const _0xd37869=db[_0x451bd1(0x74)](),_0x31e3ef=await db[_0x451bd1(0x1d9)](_0x451bd1(0x281))[_0x451bd1(0x1a0)](currentUser[_0x451bd1(0x1d6)])[_0x451bd1(0x1d9)](_0x451bd1(0xee))[_0x451bd1(0x347)](_0x451bd1(0x2ef),'==',![])[_0x451bd1(0x169)]();_0x31e3ef[_0x451bd1(0x144)](_0x50f458=>{const _0x9e9887=_0x451bd1;_0xd37869[_0x9e9887(0x24f)](_0x50f458['ref'],{'read':!![]});}),await _0xd37869[_0x451bd1(0x349)](),showToast(_0x451bd1(0x128),'success');}catch(_0x2aa9a1){console['error'](_0x451bd1(0x1ad),_0x2aa9a1),showToast(_0x451bd1(0xa7),'error');}finally{toggleSpinner(elements[_0x451bd1(0x25b)],![]);}});elements[_0x4cce9e(0x236)]&&elements[_0x4cce9e(0x236)][_0x4cce9e(0x16a)]('click',_0x5b9366=>{const _0x521f19=_0x4cce9e,_0x42ebbc=_0x5b9366[_0x521f19(0x9b)][_0x521f19(0x2b4)]('.notification-tab-btn');if(!_0x42ebbc)return;elements[_0x521f19(0x301)][_0x521f19(0x144)](_0x3cc254=>_0x3cc254[_0x521f19(0x1b2)]['remove'](_0x521f19(0x24a))),_0x42ebbc[_0x521f19(0x1b2)][_0x521f19(0x239)](_0x521f19(0x24a));const _0x3095f5=_0x42ebbc[_0x521f19(0x1f3)][_0x521f19(0x80)];if(elements['personalNotificationsListContainer'])elements[_0x521f19(0x1f6)][_0x521f19(0x1b2)]['toggle']('active',_0x3095f5===_0x521f19(0x23f));if(elements[_0x521f19(0x24c)])elements[_0x521f19(0x24c)]['classList'][_0x521f19(0x12a)](_0x521f19(0x24a),_0x3095f5===_0x521f19(0x101));if(_0x3095f5==='personal'){if(elements[_0x521f19(0x25b)])elements['markAllNotificationsReadBtn'][_0x521f19(0x2ac)]=unreadNotificationsCount===0x0;}else{if(elements[_0x521f19(0x25b)])elements[_0x521f19(0x25b)][_0x521f19(0x2ac)]=!![];}AOS[_0x521f19(0x233)]();});window[_0x4cce9e(0x16a)](_0x4cce9e(0x17c),()=>{const _0x46f3c8=_0x4cce9e;if(window[_0x46f3c8(0x23c)]>0x32&&elements[_0x46f3c8(0x327)])elements[_0x46f3c8(0x327)][_0x46f3c8(0x1b2)][_0x46f3c8(0x239)](_0x46f3c8(0x11f));else{if(elements[_0x46f3c8(0x327)])elements[_0x46f3c8(0x327)][_0x46f3c8(0x1b2)]['remove'](_0x46f3c8(0x11f));}elements[_0x46f3c8(0x20c)]&&elements[_0x46f3c8(0x20c)][_0x46f3c8(0x1b2)][_0x46f3c8(0xac)]('active')&&window[_0x46f3c8(0x235)]+window[_0x46f3c8(0x23c)]>=document[_0x46f3c8(0x323)]['offsetHeight']-0x12c&&!isLoadingBooksMain&&hasMoreBooksMain&&currentUser&&fetchBooksMain(!![]);});elements[_0x4cce9e(0x229)]&&elements[_0x4cce9e(0x229)][_0x4cce9e(0x16a)](_0x4cce9e(0x328),_0x45978f=>{const _0xbfbf95=_0x4cce9e;_0x45978f['stopPropagation']();if(elements['searchContainer'])elements['searchContainer']['classList'][_0xbfbf95(0x12a)](_0xbfbf95(0x24a));if(elements[_0xbfbf95(0x146)]&&elements['searchContainer'][_0xbfbf95(0x1b2)][_0xbfbf95(0xac)](_0xbfbf95(0x24a))&&elements[_0xbfbf95(0xed)])elements[_0xbfbf95(0xed)]['focus']();});function handleSearchInput(){const _0x14ec79=_0x4cce9e;if(!elements['searchInput']||!elements['searchResults'])return;const _0x4a3726=elements['searchInput']['value']['toLowerCase']()[_0x14ec79(0x113)]();if(_0x4a3726['length']<0x2){elements[_0x14ec79(0x22d)][_0x14ec79(0x285)][_0x14ec79(0x103)]=_0x14ec79(0x2f4);return;}const _0x28d9e0=allBooksCache[_0x14ec79(0x1eb)](_0x49d919=>_0x49d919['bookName'][_0x14ec79(0xb5)]()[_0x14ec79(0x339)](_0x4a3726)||_0x49d919['authorName'][_0x14ec79(0xb5)]()[_0x14ec79(0x339)](_0x4a3726)||_0x49d919[_0x14ec79(0x329)]&&_0x49d919[_0x14ec79(0x329)][_0x14ec79(0xb5)]()[_0x14ec79(0x339)](_0x4a3726))[_0x14ec79(0x340)](0x0,0xa);renderSearchResults(_0x28d9e0,elements['searchResults']);}let searchTimeoutGlobal;elements[_0x4cce9e(0xed)]&&(elements['searchInput'][_0x4cce9e(0x16a)]('input',()=>{clearTimeout(searchTimeoutGlobal),searchTimeoutGlobal=setTimeout(handleSearchInput,0x12c);}),elements[_0x4cce9e(0xed)][_0x4cce9e(0x16a)](_0x4cce9e(0x1bc),handleSearchInput));function renderSearchResults(_0x4643be,_0x2f0baa){const _0x12e0c8=_0x4cce9e;if(!_0x2f0baa)return;if(_0x4643be[_0x12e0c8(0x151)]===0x0){_0x2f0baa[_0x12e0c8(0x17e)]=_0x12e0c8(0xbf),_0x2f0baa[_0x12e0c8(0x285)]['display']=_0x12e0c8(0x8b);return;}_0x2f0baa[_0x12e0c8(0x17e)]=_0x4643be[_0x12e0c8(0x84)](_0x5856cf=>_0x12e0c8(0x240)+_0x5856cf['id']+_0x12e0c8(0x102)+escapeHTML(_0x5856cf[_0x12e0c8(0x86)])+_0x12e0c8(0x1b6)+escapeHTML(_0x5856cf['authorName'])+_0x12e0c8(0x302)+escapeHTML(_0x5856cf['category']||_0x12e0c8(0xb3))+_0x12e0c8(0x219))[_0x12e0c8(0x23e)](''),_0x2f0baa[_0x12e0c8(0x285)][_0x12e0c8(0x103)]=_0x12e0c8(0x8b);}elements[_0x4cce9e(0x22d)]&&elements[_0x4cce9e(0x22d)]['addEventListener']('click',_0x4e7253=>{const _0x56ea71=_0x4cce9e,_0x54d87c=_0x4e7253[_0x56ea71(0x9b)]['closest'](_0x56ea71(0xb8));if(_0x54d87c&&_0x54d87c[_0x56ea71(0x1f3)][_0x56ea71(0x191)]){if(!currentUser){openModal(elements[_0x56ea71(0x70)]);return;}openBookDetailModal(_0x54d87c['dataset'][_0x56ea71(0x191)]),elements[_0x56ea71(0x22d)][_0x56ea71(0x285)][_0x56ea71(0x103)]='none';if(elements[_0x56ea71(0xed)])elements[_0x56ea71(0xed)]['value']='';elements[_0x56ea71(0x146)]&&elements[_0x56ea71(0x146)][_0x56ea71(0x1b2)][_0x56ea71(0xac)]('active')&&window[_0x56ea71(0x75)]<=0x300&&elements['searchContainer']['classList'][_0x56ea71(0x318)](_0x56ea71(0x24a));}});document[_0x4cce9e(0x16a)](_0x4cce9e(0x328),_0x339c37=>{const _0x39756a=_0x4cce9e;elements['searchContainer']&&elements['searchContainer'][_0x39756a(0x1b2)][_0x39756a(0xac)](_0x39756a(0x24a))&&window[_0x39756a(0x75)]<=0x300&&!elements[_0x39756a(0x146)][_0x39756a(0xac)](_0x339c37[_0x39756a(0x9b)])&&_0x339c37[_0x39756a(0x9b)]!==elements[_0x39756a(0x229)]&&elements[_0x39756a(0x146)][_0x39756a(0x1b2)]['remove'](_0x39756a(0x24a)),elements[_0x39756a(0x146)]&&!elements[_0x39756a(0x146)]['contains'](_0x339c37[_0x39756a(0x9b)])&&elements[_0x39756a(0x22d)]&&(elements[_0x39756a(0x22d)]['style'][_0x39756a(0x103)]=_0x39756a(0x2f4));});function openPage(_0xfcc084){const _0x4ad72a=_0x4cce9e;if(!_0xfcc084)return;_0xfcc084[_0x4ad72a(0x1b2)][_0x4ad72a(0x239)]('active'),elements[_0x4ad72a(0x323)][_0x4ad72a(0x285)][_0x4ad72a(0x184)]=_0x4ad72a(0x107),AOS[_0x4ad72a(0x233)]();if(_0xfcc084===elements[_0x4ad72a(0x1bf)]){if(currentUser){fetchUserBooks(![],!![]),fetchWithdrawalHistory();if(elements[_0x4ad72a(0x172)]){const _0x29cd21=elements[_0x4ad72a(0x172)]['querySelector'](_0x4ad72a(0xca));if(_0x29cd21){const _0x291375=_0x4ad72a(0x1cf)+_0x29cd21[_0x4ad72a(0x1f3)][_0x4ad72a(0x80)];elements['profileTabBtns'][_0x4ad72a(0x144)](_0x2aa534=>_0x2aa534[_0x4ad72a(0x1b2)]['remove']('active')),elements['profileTabContents'][_0x4ad72a(0x144)](_0xbc857b=>_0xbc857b[_0x4ad72a(0x1b2)][_0x4ad72a(0x318)](_0x4ad72a(0x24a))),_0x29cd21[_0x4ad72a(0x1b2)]['add']('active');const _0x29a9cf=$('#'+_0x291375);if(_0x29a9cf)_0x29a9cf[_0x4ad72a(0x1b2)][_0x4ad72a(0x239)](_0x4ad72a(0x24a));}}}else closePage(elements[_0x4ad72a(0x1bf)]),openModal(elements[_0x4ad72a(0x70)]);}else{if(_0xfcc084===elements[_0x4ad72a(0x19e)]){if(currentUser){if(elements[_0x4ad72a(0x236)]&&elements[_0x4ad72a(0x1f6)]&&elements[_0x4ad72a(0x24c)]){elements[_0x4ad72a(0x301)]['forEach'](_0x225075=>_0x225075[_0x4ad72a(0x1b2)][_0x4ad72a(0x318)](_0x4ad72a(0x24a))),elements[_0x4ad72a(0x1f6)][_0x4ad72a(0x1b2)][_0x4ad72a(0x318)]('active'),elements[_0x4ad72a(0x24c)][_0x4ad72a(0x1b2)][_0x4ad72a(0x318)](_0x4ad72a(0x24a));const _0x3cebb3=elements[_0x4ad72a(0x236)][_0x4ad72a(0x2d5)](_0x4ad72a(0x2a2));if(_0x3cebb3)_0x3cebb3['classList'][_0x4ad72a(0x239)](_0x4ad72a(0x24a));elements[_0x4ad72a(0x1f6)]['classList']['add'](_0x4ad72a(0x24a));if(elements['markAllNotificationsReadBtn'])elements[_0x4ad72a(0x25b)]['disabled']=unreadNotificationsCount===0x0;}}else closePage(elements['notificationsPage']),openModal(elements[_0x4ad72a(0x70)]);}}}function closePage(_0x3c23c5){const _0x7cea6a=_0x4cce9e;if(!_0x3c23c5)return;_0x3c23c5[_0x7cea6a(0x1b2)][_0x7cea6a(0x318)]('active');const _0x136462=$$('.modal.active')[_0x7cea6a(0x151)]>0x0,_0x33586f=$$(_0x7cea6a(0x28d))['length']>0x0;!_0x136462&&!_0x33586f&&(elements[_0x7cea6a(0x323)][_0x7cea6a(0x285)]['overflow']=_0x7cea6a(0x27e));}function openProfilePage(){const _0xbacc19=_0x4cce9e;currentUser?(activateNavItem(elements[_0xbacc19(0xde)]),openPage(elements[_0xbacc19(0x1bf)])):openModal(elements[_0xbacc19(0x70)]);}function closeProfilePage(){const _0x3c7dfb=_0x4cce9e;if(elements[_0x3c7dfb(0x1bf)])closePage(elements['profilePage']);if(elements[_0x3c7dfb(0x20c)])activateNavItem(elements['homeBtn']);}function openNotificationsPage(){const _0xf767bb=_0x4cce9e;currentUser?(activateNavItem(elements[_0xf767bb(0x2cb)]),openPage(elements[_0xf767bb(0x19e)])):openModal(elements[_0xf767bb(0x70)]);}function closeNotificationsPage(){const _0x316279=_0x4cce9e;if(elements[_0x316279(0x19e)])closePage(elements[_0x316279(0x19e)]);if(elements[_0x316279(0x20c)])activateNavItem(elements[_0x316279(0x20c)]);}function activateNavItem(_0x41c31c){const _0x9e02bf=_0x4cce9e;if(!_0x41c31c)return;elements[_0x9e02bf(0x23a)]['forEach'](_0x2e1253=>_0x2e1253[_0x9e02bf(0x1b2)]['remove'](_0x9e02bf(0x24a))),_0x41c31c[_0x9e02bf(0x1b2)][_0x9e02bf(0x239)](_0x9e02bf(0x24a));}function resetNavigation(){const _0xb57209=_0x4cce9e;if(elements[_0xb57209(0x20c)])activateNavItem(elements[_0xb57209(0x20c)]);}function closeAllPagesAndModals(){const _0x54cb2c=_0x4cce9e;if(elements[_0x54cb2c(0x1bf)])closePage(elements['profilePage']);if(elements['notificationsPage'])closePage(elements['notificationsPage']);$$(_0x54cb2c(0xd3))[_0x54cb2c(0x144)](_0x22e496=>closeModal(_0x22e496));const _0x475675=$$(_0x54cb2c(0xd3))[_0x54cb2c(0x151)]>0x0,_0x20921a=$$('.profile-page.active,\x20.notifications-page.active')[_0x54cb2c(0x151)]>0x0;!_0x475675&&!_0x20921a&&(elements['body'][_0x54cb2c(0x285)][_0x54cb2c(0x184)]=_0x54cb2c(0x27e)),currentBookDetailId=null;}if(elements['homeBtn'])elements[_0x4cce9e(0x20c)][_0x4cce9e(0x1a2)]=()=>{const _0x4083c3=_0x4cce9e;closeAllPagesAndModals(),activateNavItem(elements[_0x4083c3(0x20c)]),window[_0x4083c3(0x32f)]({'top':0x0,'behavior':'smooth'});};if(elements[_0x4cce9e(0x32e)])elements[_0x4cce9e(0x32e)]['onclick']=_0x4198d4=>{const _0x466bbb=_0x4cce9e;_0x4198d4[_0x466bbb(0x27d)]();if(elements['homeBtn'])elements[_0x466bbb(0x20c)][_0x466bbb(0x328)]();};if(elements[_0x4cce9e(0x2cb)])elements['notificationsBtn']['onclick']=openNotificationsPage;if(elements['notificationsBackBtn'])elements[_0x4cce9e(0x83)][_0x4cce9e(0x1a2)]=closeNotificationsPage;if(elements[_0x4cce9e(0xde)])elements[_0x4cce9e(0xde)][_0x4cce9e(0x1a2)]=openProfilePage;if(elements[_0x4cce9e(0x82)])elements[_0x4cce9e(0x82)][_0x4cce9e(0x1a2)]=openProfilePage;if(elements[_0x4cce9e(0xf4)])elements[_0x4cce9e(0xf4)][_0x4cce9e(0x1a2)]=closeProfilePage;if(elements[_0x4cce9e(0x2ff)])elements[_0x4cce9e(0x2ff)]['onclick']=()=>{const _0x52e779=_0x4cce9e;if(currentUser)openModal(elements[_0x52e779(0x91)]);else openModal(elements[_0x52e779(0x70)]);};if(elements[_0x4cce9e(0x27f)])elements[_0x4cce9e(0x27f)][_0x4cce9e(0x1a2)]=()=>closeModal(elements[_0x4cce9e(0x91)]);if(elements['discoverBtn'])elements['discoverBtn'][_0x4cce9e(0x1a2)]=()=>{const _0xc28c19=_0x4cce9e;if(currentUser)openModal(elements['discoverModal']);else openModal(elements[_0xc28c19(0x70)]);};if(elements['closeDiscoverModal'])elements[_0x4cce9e(0x1b8)][_0x4cce9e(0x1a2)]=()=>closeModal(elements['discoverModal']);if(elements[_0x4cce9e(0x1f7)])elements['switchToSignup']['onclick']=()=>{const _0x5c18df=_0x4cce9e;closeModal(elements[_0x5c18df(0x70)]),openModal(elements['signupModal']);};if(elements[_0x4cce9e(0x277)])elements['switchToLogin'][_0x4cce9e(0x1a2)]=()=>{const _0x1bbba2=_0x4cce9e;closeModal(elements[_0x1bbba2(0x132)]),openModal(elements[_0x1bbba2(0x70)]);};if(elements['closeLoginModal'])elements[_0x4cce9e(0x121)]['onclick']=()=>closeModal(elements[_0x4cce9e(0x70)]);if(elements[_0x4cce9e(0x1b5)])elements[_0x4cce9e(0x1b5)]['onclick']=()=>closeModal(elements[_0x4cce9e(0x132)]);if(elements[_0x4cce9e(0x267)])elements[_0x4cce9e(0x267)]['onclick']=()=>{const _0x5c4794=_0x4cce9e;closeModal(elements[_0x5c4794(0x110)]),currentBookDetailId=null;};$$(_0x4cce9e(0x2d9))[_0x4cce9e(0x144)](_0x344208=>{const _0x4a8698=_0x4cce9e;_0x344208['addEventListener'](_0x4a8698(0x328),_0x279494=>{if(_0x279494['target']===_0x344208)closeModal(_0x344208);});}),document[_0x4cce9e(0x16a)](_0x4cce9e(0x28b),()=>{const _0x3aac2d=_0x4cce9e;if(elements[_0x3aac2d(0x1e6)])elements[_0x3aac2d(0x1e6)][_0x3aac2d(0x1b2)][_0x3aac2d(0x318)](_0x3aac2d(0x107));showRandomLoadingMessage(),renderSkeletonLoaders(elements[_0x3aac2d(0x1ff)],BOOKS_PER_PAGE_MAIN,_0x3aac2d(0x2c3)),renderSkeletonLoaders(elements[_0x3aac2d(0x2e9)],0x5,_0x3aac2d(0x213)),renderCategoryFilters(),resetNavigation(),setupWithdrawalListeners();const _0x31edc9=_0x3aac2d(0x141);if(elements[_0x3aac2d(0xfa)])elements['withdrawalOptionsContainer']['innerHTML']=_0x31edc9;const _0x596639=_0x3aac2d(0xb4);if(elements[_0x3aac2d(0xb2)])elements[_0x3aac2d(0xb2)]['innerHTML']=_0x596639;});
    </script>
</body>
</html>
