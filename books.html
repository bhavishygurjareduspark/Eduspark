<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduSparK - Share Knowledge</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
   
    <style>
        :root {
            --primary-color: #ff4757;
            --primary-light: #ff6b81;
            --primary-dark: #e84118;
            --secondary-color: #2f3542;
            --secondary-light: #57606f;
            --secondary-dark: #1e272e;
            --text-light: #f1f2f6;
            --text-dark: #2f3542;
            --text-muted: #747d8c;
            --bg-light: #ffffff;
            --bg-dark: #1e272e;
            --card-bg: #ffffff;
            --card-bg-dark: #2f3542;
            --gradient: linear-gradient(135deg, #ff4757, #2f3542);
            --gradient-light: linear-gradient(135deg, #ff6b81, #57606f);
            --gradient-dark: linear-gradient(135deg, #e84118, #1e272e);
            --message-sent-bg: linear-gradient(135deg, #ff4757, #ff6b81);
            --message-received-bg: #f1f2f6;
            --message-received-text: #2f3542;
            --typing-indicator-bg: #f1f2f6;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.1);
            --border-radius: 12px;
            --border-radius-sm: 8px;
            --border-radius-xs: 6px;
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            --transition-fast: all 0.15s ease;
            --header-height: 70px;
            --nav-height: 70px;
            --max-width: 1200px;
        }

        [data-theme="dark"] {
            --primary-color: #ff6b81;
            --primary-light: #ff8fa3;
            --primary-dark: #ff4757;
            --secondary-color: #1e272e;
            --secondary-light: #2f3542;
            --secondary-dark: #12181f;
            --text-light: #f1f2f6;
            --text-dark: #dfe4ea;
            --text-muted: #a4b0be;
            --bg-light: #2f3542;
            --bg-dark: #1e272e;
            --card-bg: #2f3542;
            --card-bg-dark: #1e272e;
            --gradient: linear-gradient(135deg, #ff6b81, #1e272e);
            --gradient-light: linear-gradient(135deg, #ff8fa3, #2f3542);
            --gradient-dark: linear-gradient(135deg, #ff4757, #12181f);
            --message-sent-bg: linear-gradient(135deg, #ff6b81, #ff4757);
            --message-received-bg: #1e272e;
            --message-received-text: #dfe4ea;
            --typing-indicator-bg: #1e272e;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.3);
            --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s, border-color 0.3s;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-light);
            color: var(--text-dark);
            min-height: 100vh;
            padding-top: var(--header-height);
            padding-bottom: var(--nav-height);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Enhanced Header with Glass Morphism */
        .header {
            background-color: rgba(47, 53, 66, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: var(--text-light);
            height: var(--header-height);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow-md);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            padding: 0 20px;
            transition: all 0.3s ease;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        [data-theme="dark"] .header {
            background-color: rgba(30, 39, 46, 0.95);
        }

        .header.scrolled {
            height: 60px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }

        .logo-container {
            display: flex;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            background: var(--gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            display: flex;
            align-items: center;
            text-decoration: none;
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
            padding: 5px 0;
        }

        .logo::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--gradient);
            transform-origin: right;
            transition: transform 0.3s ease;
        }

        .logo:hover {
            transform: scale(1.05);
        }

        .logo:hover::after {
            transform: scaleX(1);
            transform-origin: left;
        }

        .logo i {
            margin-right: 10px;
            font-size: 1.5rem;
            color: var(--primary-color);
        }

        .logo-text {
            display: inline-block;
            position: relative;
        }

        .logo-text::after {
            content: '‚ù§Ô∏è‚Äçüî•';
            position: absolute;
            right: -25px;
            top: -5px;
            font-size: 1.2rem;
            animation: pulse 1.5s infinite;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .search-container {
            position: relative;
            width: 250px;
            transition: all 0.3s ease;
        }

        .search-container.active {
            width: 300px;
        }

        .search-input {
            width: 100%;
            padding: 10px 15px 10px 40px;
            border: none;
            border-radius: 30px;
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--text-light);
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .search-input:focus {
            outline: none;
            background-color: rgba(255, 255, 255, 0.2);
            box-shadow: 0 0 0 2px var(--primary-color);
        }

        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
            opacity: 0.7;
            font-size: 1rem;
        }

        .search-results {
            position: absolute;
            top: calc(100% + 5px);
            left: 0;
            right: 0;
            background-color: var(--card-bg);
            border-radius: var(--border-radius-sm);
            box-shadow: var(--shadow-xl);
            max-height: 400px;
            overflow-y: auto;
            z-index: 1001;
            display: none;
            animation: fadeIn 0.3s ease;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] .search-results {
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .search-result-item {
            padding: 12px 15px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        [data-theme="dark"] .search-result-item {
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .search-result-item:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        [data-theme="dark"] .search-result-item:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .search-result-item h4 {
            font-size: 0.95rem;
            color: var(--text-dark);
            margin-bottom: 5px;
            font-weight: 500;
        }

        .search-result-item p {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .no-results {
            padding: 20px;
            text-align: center;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .theme-toggle {
            background: none;
            border: none;
            color: var(--text-light);
            font-size: 1.3rem;
            cursor: pointer;
            position: relative;
            width: 38px;
            height: 38px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: transform 0.5s ease, background-color 0.3s ease;
        }

        .theme-toggle:hover {
            transform: rotate(180deg) scale(1.1);
            background-color: rgba(255, 255, 255, 0.1);
        }

        .theme-toggle .sun {
            display: none;
            position: absolute;
        }

        .theme-toggle .moon {
            display: block;
            position: absolute;
        }

        [data-theme="dark"] .theme-toggle .sun {
            display: block;
        }

        [data-theme="dark"] .theme-toggle .moon {
            display: none;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary-color);
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--gradient);
            color: white;
            font-weight: 600;
            font-size: 1rem;
            position: relative;
            overflow: hidden;
        }

        .user-avatar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .user-avatar:hover {
            transform: scale(1.1);
            box-shadow: 0 0 0 3px var(--primary-light);
        }

        .user-avatar:hover::after {
            opacity: 1;
        }

        /* Bottom Navigation with Glass Morphism */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: rgba(47, 53, 66, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            display: flex;
            justify-content: space-around;
            align-items: center;
            height: var(--nav-height);
            z-index: 1000;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        [data-theme="dark"] .bottom-nav {
            background-color: rgba(30, 39, 46, 0.95);
        }

        .nav-item {
            color: var(--text-light);
            font-size: 1.3rem;
            padding: 10px;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 50%;
            background: var(--gradient);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: -1;
        }

        .nav-item:hover {
            transform: translateY(-5px);
            color: white;
        }

        .nav-item:hover::before {
            opacity: 1;
        }

        .nav-item.active {
            color: white;
            transform: translateY(-5px);
        }

        .nav-item.active::before {
            opacity: 1;
        }

        .nav-item.active::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 6px;
            height: 6px;
            background-color: var(--primary-color);
            border-radius: 50%;
            box-shadow: 0 0 10px var(--primary-color);
        }

        .notification-badge {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            animation: pulse 2s infinite;
            z-index: 1;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .add-btn {
            background: var(--gradient);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.7rem;
            transform: translateY(-20px);
            box-shadow: 0 6px 20px rgba(255, 71, 87, 0.4);
            transition: var(--transition);
            cursor: pointer;
            border: none;
            outline: none;
            z-index: 1001;
            position: relative;
            overflow: hidden;
        }

        .add-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .add-btn:hover {
            transform: translateY(-20px) scale(1.1);
            box-shadow: 0 8px 25px rgba(255, 71, 87, 0.6);
            background: var(--gradient-light);
            animation: none;
        }

        .add-btn:hover::after {
            opacity: 1;
        }

        @keyframes float {
            0%, 100% { transform: translateY(-20px); }
            50% { transform: translateY(-25px); }
        }

        /* Main Content */
        .container {
            padding: 20px;
            max-width: var(--max-width);
            margin: 0 auto;
        }

        .page-title {
            font-size: 2rem;
            margin-bottom: 20px;
            color: var(--primary-color);
            position: relative;
            display: inline-block;
            font-weight: 600;
            padding-bottom: 8px;
        }

        .page-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 4px;
            background: var(--gradient);
            border-radius: 4px;
            transform-origin: left;
            animation: scaleIn 0.5s ease-out forwards;
        }

        @keyframes scaleIn {
            from { transform: scaleX(0); }
            to { transform: scaleX(1); }
        }

        .books-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .book-card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow-md);
            transition: var(--transition);
            position: relative;
            border: 1px solid rgba(0, 0, 0, 0.1);
            transform: translateY(30px);
            opacity: 0;
            animation: cardAppear 0.6s ease forwards;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        [data-theme="dark"] .book-card {
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        @keyframes cardAppear {
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .book-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .book-img-container {
            height: 220px;
            overflow: hidden;
            position: relative;
            background-color: rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        [data-theme="dark"] .book-img-container {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .book-img {
            width: auto;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .book-card:hover .book-img {
            transform: scale(1.05);
        }

        .book-info {
            padding: 15px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .book-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-dark);
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .book-author {
            font-size: 0.85rem;
            color: var(--primary-color);
            margin-bottom: 12px;
            font-weight: 500;
        }

        .book-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .book-meta i {
            margin-right: 5px;
            color: var(--primary-color);
            font-size: 0.8rem;
        }

        .book-admin-info {
            font-size: 0.7rem;
            color: var(--text-muted);
            margin-top: auto;
            padding-top: 10px;
            border-top: 1px dashed rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        [data-theme="dark"] .book-admin-info {
            border-top: 1px dashed rgba(255, 255, 255, 0.1);
        }

        .book-admin-info i {
            color: var(--primary-color);
            font-size: 0.8rem;
        }

        .download-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: var(--border-radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            font-size: 0.85rem;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            margin-top: 10px;
        }

        .download-btn::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -60%;
            width: 40px;
            height: 200%;
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(30deg);
            transition: all 0.5s ease;
        }

        .download-btn:hover::after {
            left: 120%;
        }

        .download-btn i {
            margin-right: 8px;
            font-size: 0.8rem;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(255, 71, 87, 0.4);
            background: var(--gradient-light);
        }

        /* Enhanced Profile Page */
        .profile-page {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--bg-light);
            z-index: 2000;
            transform: translateX(100%);
            transition: transform 0.4s cubic-bezier(0.22, 1, 0.36, 1);
            overflow-y: auto;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
        }

        .profile-page.active {
            transform: translateX(0);
            opacity: 1;
            visibility: visible;
        }

        .profile-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
            padding-top: 20px;
            text-align: center;
            position: relative;
        }

        .profile-back-btn {
            background: none;
            border: none;
            color: var(--primary-color);
            font-size: 1.3rem;
            position: absolute;
            left: 0;
            top: 0;
            cursor: pointer;
            transition: transform 0.3s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .profile-back-btn:hover {
            transform: translateX(-5px);
            background-color: rgba(255, 71, 87, 0.1);
        }

        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--primary-color);
            margin-bottom: 15px;
            background: var(--gradient);
            color: white;
            font-size: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            position: relative;
            overflow: hidden;
        }

        .profile-avatar::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                to bottom right,
                rgba(255, 255, 255, 0.3),
                rgba(255, 255, 255, 0)
            );
            transform: rotate(30deg);
            transition: all 0.5s ease;
        }

        .profile-avatar:hover::before {
            transform: rotate(30deg) translateX(50%);
        }

        .profile-info {
            width: 100%;
            margin-top: 10px;
        }

        .profile-info h2 {
            font-size: 1.8rem;
            margin-bottom: 8px;
            color: var(--text-dark);
            position: relative;
            display: inline-block;
            font-weight: 600;
        }

        .profile-info h2::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 3px;
            background: var(--gradient);
            border-radius: 3px;
        }

        .profile-username {
            color: var(--primary-color);
            margin-bottom: 8px;
            font-size: 1.1rem;
            font-weight: 500;
        }

        .profile-email {
            color: var(--text-muted);
            margin-bottom: 15px;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .profile-email i {
            margin-right: 8px;
            font-size: 0.95rem;
        }

        .profile-bio {
            margin: 20px 0;
            color: var(--text-dark);
            line-height: 1.7;
            padding: 20px;
            background-color: rgba(0, 0, 0, 0.05);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--primary-color);
            font-size: 0.95rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        [data-theme="dark"] .profile-bio {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .profile-bio::before {
            content: '"';
            position: absolute;
            top: 10px;
            left: 15px;
            font-size: 3.5rem;
            color: var(--primary-color);
            opacity: 0.1;
            font-family: serif;
            line-height: 1;
        }

        .profile-bio::after {
            content: '"';
            position: absolute;
            bottom: -20px;
            right: 15px;
            font-size: 3.5rem;
            color: var(--primary-color);
            opacity: 0.1;
            font-family: serif;
            line-height: 1;
        }

        .profile-stats {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
            background: rgba(0, 0, 0, 0.05);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: hidden;
        }

        [data-theme="dark"] .profile-stats {
            background: rgba(255, 255, 255, 0.05);
        }

        .profile-stats::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--gradient);
        }

        .stat-item {
            text-align: center;
            padding: 10px;
            flex: 1;
            transition: transform 0.3s ease;
            position: relative;
        }

        .stat-item:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 50%;
            right: 0;
            transform: translateY(-50%);
            width: 1px;
            height: 40px;
            background-color: rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] .stat-item:not(:last-child)::after {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .stat-item:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 5px;
            position: relative;
            display: inline-block;
        }

        .stat-number::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 3px;
            background: var(--gradient);
            border-radius: 3px;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 500;
        }

        .profile-books-title {
            font-size: 1.6rem;
            margin: 30px 0 20px;
            color: var(--primary-color);
            position: relative;
            display: inline-block;
            text-align: center;
            width: 100%;
            font-weight: 600;
        }

        .profile-books-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: var(--gradient);
            border-radius: 3px;
        }

        .profile-actions {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            justify-content: center;
        }

        .edit-profile {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: var(--border-radius-sm);
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: var(--shadow-md);
            position: relative;
            overflow: hidden;
            flex: 1;
            max-width: 200px;
        }

        .edit-profile::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .edit-profile:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 71, 87, 0.5);
            background: var(--gradient-light);
        }

        .edit-profile:hover::after {
            opacity: 1;
        }

        .logout-btn {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: var(--border-radius-sm);
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: var(--shadow-md);
            position: relative;
            overflow: hidden;
            flex: 1;
            max-width: 200px;
        }

        .logout-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .logout-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(47, 53, 66, 0.3);
            background: var(--secondary-light);
        }

        .logout-btn:hover::after {
            opacity: 1;
        }

        /* Full Page Chat */
        .chat-page {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--bg-light);
            z-index: 2000;
            transform: translateX(100%);
            transition: transform 0.4s cubic-bezier(0.22, 1, 0.36, 1);
            display: flex;
            flex-direction: column;
            opacity: 0;
            visibility: hidden;
        }

        .chat-page.active {
            transform: translateX(0);
            opacity: 1;
            visibility: visible;
        }

        .chat-header {
            padding: 15px;
            background: var(--gradient);
            color: white;
            text-align: center;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            height: var(--header-height);
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
        }

        .chat-back-btn {
            position: absolute;
            left: 15px;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: transform 0.3s ease;
            background: none;
            border: none;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .chat-back-btn:hover {
            transform: translateX(-5px);
            background-color: rgba(255, 255, 255, 0.1);
        }

        .chat-title {
            font-size: 1.3rem;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background-color: var(--bg-light);
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            display: flex;
            flex-direction: column;
            max-width: 85%;
            opacity: 0;
            transform: translateY(10px);
            animation: messageAppear 0.4s forwards;
            animation-delay: 0.1s;
        }

        @keyframes messageAppear {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.sent {
            align-self: flex-end;
            align-items: flex-end;
        }

        .message.received {
            align-self: flex-start;
            align-items: flex-start;
        }

        .message-content {
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 1rem;
            line-height: 1.5;
            word-break: break-word;
            position: relative;
            transition: all 0.2s ease;
            box-shadow: var(--shadow-sm);
        }

        .message.sent .message-content {
            background: var(--message-sent-bg);
            color: white;
            border-top-right-radius: 5px;
        }

        .message.received .message-content {
            background-color: var(--message-received-bg);
            color: var(--message-received-text);
            border-top-left-radius: 5px;
        }

        .message-time {
            font-size: 0.75rem;
            color: var(--text-dark);
            opacity: 0.7;
            margin-top: 6px;
            align-self: flex-end;
        }

        .message.sent .message-time {
            color: rgba(255, 255, 255, 0.7);
        }

        .message-sender {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 6px;
        }

        .chat-input-container {
            display: flex;
            padding: 15px;
            background-color: var(--bg-light);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            align-items: center;
            box-shadow: 0 -2px 15px rgba(0, 0, 0, 0.05);
        }

        [data-theme="dark"] .chat-input-container {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            border: none;
            border-radius: 25px;
            font-family: 'Poppins', sans-serif;
            background-color: var(--typing-indicator-bg);
            color: var(--text-dark);
            outline: none;
            resize: none;
            max-height: 120px;
            overflow-y: auto;
            margin-right: 12px;
            font-size: 1rem;
            box-shadow: inset 0 1px 4px rgba(0, 0, 0, 0.1);
            transition: var(--transition);
        }

        [data-theme="dark"] .chat-input {
            box-shadow: inset 0 1px 4px rgba(0, 0, 0, 0.3);
        }

        .chat-input:focus {
            box-shadow: 0 0 0 2px rgba(255, 71, 87, 0.3), inset 0 1px 4px rgba(0, 0, 0, 0.1);
        }

        .send-btn {
            background: var(--gradient);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            flex-shrink: 0;
            font-size: 1.2rem;
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: hidden;
        }

        .send-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .send-btn:hover {
            transform: scale(1.1);
            background: var(--gradient-light);
            box-shadow: 0 4px 15px rgba(255, 71, 87, 0.5);
        }

        .send-btn:hover::after {
            opacity: 1;
        }

        .send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            background: var(--secondary-light);
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            background-color: var(--typing-indicator-bg);
            border-radius: 18px;
            margin-left: 20px;
            margin-bottom: 8px;
            align-self: flex-start;
            opacity: 0;
            transition: opacity 0.3s ease;
            font-size: 0.85rem;
            color: var(--text-muted);
            box-shadow: var(--shadow-sm);
        }

        .typing-indicator.active {
            opacity: 1;
        }

        .typing-indicator span {
            height: 7px;
            width: 7px;
            background-color: var(--primary-color);
            border-radius: 50%;
            display: inline-block;
            margin: 0 3px;
            animation: typingAnimation 1.4s infinite ease-in-out;
        }

        .typing-indicator span:nth-child(1) {
            animation-delay: 0s;
        }

        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typingAnimation {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-4px);
            }
        }

        /* Message status indicators */
        .message-status {
            display: inline-block;
            margin-left: 6px;
            font-size: 0.8rem;
        }

        .message-status.sent {
            color: rgba(255, 255, 255, 0.7);
        }

        .message-status.delivered {
            color: rgba(255, 255, 255, 0.9);
        }

        /* Message bubble tail effect */
        .message.sent .message-content::after {
            content: '';
            position: absolute;
            right: -6px;
            top: 0;
            width: 12px;
            height: 20px;
            background: var(--message-sent-bg);
            clip-path: polygon(0 0, 100% 0, 100% 100%);
        }

        .message.received .message-content::after {
            content: '';
            position: absolute;
            left: -6px;
            top: 0;
            width: 12px;
            height: 20px;
            background: var(--message-received-bg);
            clip-path: polygon(0 0, 100% 0, 0 100%);
        }

        /* Loading Spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-muted);
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--primary-color);
            opacity: 0.7;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-15px); }
            60% { transform: translateY(-8px); }
        }

        .empty-state h3 {
            margin-bottom: 12px;
            color: var(--text-dark);
            font-size: 1.4rem;
            font-weight: 600;
        }

        .empty-state p {
            font-size: 0.95rem;
            max-width: 350px;
            margin: 0 auto;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }

        .modal.active {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 450px;
            padding: 25px;
            box-shadow: var(--shadow-xl);
            transform: translateY(-30px);
            transition: transform 0.3s ease, opacity 0.3s ease;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] .modal-content {
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal.active .modal-content {
            transform: translateY(0);
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.7rem;
            color: var(--text-dark);
            cursor: pointer;
            background: none;
            border: none;
            transition: var(--transition);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close-modal:hover {
            color: var(--primary-color);
            transform: rotate(90deg);
            background-color: rgba(255, 71, 87, 0.1);
        }

        .modal-title {
            font-size: 1.7rem;
            margin-bottom: 20px;
            color: var(--primary-color);
            text-align: center;
            position: relative;
            padding-bottom: 12px;
            font-weight: 600;
        }

        .modal-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 4px;
            background: var(--gradient);
            border-radius: 4px;
        }

        .form-group {
            margin-bottom: 20px;
            position: relative;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-dark);
            font-size: 0.9rem;
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius-sm);
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-light);
            color: var(--text-dark);
            transition: var(--transition);
            font-size: 0.95rem;
        }

        [data-theme="dark"] .form-input {
            border-color: rgba(255, 255, 255, 0.2);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(255, 71, 87, 0.2);
        }

        .file-input-container {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }

        .file-input-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 12px 18px;
            border-radius: var(--border-radius-sm);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            width: 100%;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: hidden;
        }

        .file-input-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .file-input-btn:hover {
            background: var(--gradient-light);
        }

        .file-input-btn:hover::after {
            opacity: 1;
        }

        .file-input {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-name {
            margin-top: 8px;
            font-size: 0.85rem;
            color: var(--text-muted);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .submit-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 12px 18px;
            border-radius: var(--border-radius-sm);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            width: 100%;
            transition: var(--transition);
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: hidden;
        }

        .submit-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 71, 87, 0.5);
            background: var(--gradient-light);
        }

        .submit-btn:hover::after {
            opacity: 1;
        }

        .auth-switch {
            text-align: center;
            margin-top: 15px;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .auth-switch a {
            color: var(--primary-color);
            font-weight: 500;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .auth-switch a:hover {
            color: var(--primary-light);
            text-decoration: underline;
        }

        /* Discover Modal */
        .discover-list {
            max-height: 60vh;
            overflow-y: auto;
            padding-right: 10px;
        }

        .discover-item {
            display: flex;
            padding: 15px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            align-items: center;
            cursor: pointer;
            border-radius: var(--border-radius-sm);
            margin-bottom: 8px;
            background-color: rgba(0, 0, 0, 0.03);
        }

        [data-theme="dark"] .discover-item {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background-color: rgba(255, 255, 255, 0.03);
        }

        .discover-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .discover-item:hover {
            background-color: rgba(0, 0, 0, 0.05);
            transform: translateX(5px);
        }

        [data-theme="dark"] .discover-item:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .discover-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            flex-shrink: 0;
            font-size: 1.1rem;
            box-shadow: var(--shadow-sm);
        }

        .discover-content {
            flex: 1;
        }

        .discover-title {
            font-size: 1rem;
            color: var(--text-dark);
            margin-bottom: 5px;
            font-weight: 600;
        }

        .discover-description {
            font-size: 0.85rem;
            color: var(--text-muted);
            line-height: 1.5;
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            top: 25px;
            right: 25px;
            padding: 15px 20px;
            border-radius: var(--border-radius-sm);
            background-color: var(--secondary-color);
            color: white;
            box-shadow: var(--shadow-xl);
            transform: translateX(150%);
            transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 3000;
            display: flex;
            align-items: center;
            max-width: 350px;
            border-left: 5px solid var(--primary-color);
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            background-color: #27ae60;
            border-left-color: #2ecc71;
        }

        .toast.error {
            background-color: #e74c3c;
            border-left-color: #ff4757;
        }

        .toast.warning {
            background-color: #f39c12;
            border-left-color: #f1c40f;
        }

        .toast.info {
            background-color: #3498db;
            border-left-color: #2980b9;
        }

        .toast i {
            margin-right: 10px;
            font-size: 1.2rem;
        }

        .toast-close {
            margin-left: 15px;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.2s ease;
            font-size: 1rem;
        }

        .toast-close:hover {
            opacity: 1;
        }

        /* Book Status Badges */
        .status-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 4px 8px;
            border-radius: var(--border-radius-xs);
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            z-index: 1;
            box-shadow: var(--shadow-sm);
        }

        .status-approved {
            background-color: #27ae60;
            color: white;
        }

        .status-pending {
            background-color: #f39c12;
            color: white;
        }

        .status-rejected {
            background-color: #e74c3c;
            color: white;
        }

        /* Book Card Hover Overlay */
        .book-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease;
            padding: 15px;
            text-align: center;
            color: white;
        }

        .book-card:hover .book-overlay {
            opacity: 1;
        }

        .book-overlay-title {
            font-size: 1.1rem;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .book-overlay-author {
            font-size: 0.9rem;
            margin-bottom: 12px;
            color: rgba(255, 255, 255, 0.9);
        }

        .book-overlay-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: var(--border-radius-xs);
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 8px;
        }

        .book-overlay-btn:hover {
            background: var(--gradient-light);
            transform: translateY(-2px);
        }

        /* Responsive Styles */
        @media (max-width: 992px) {
            .container {
                padding: 20px;
            }
            
            .books-grid {
                grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
                gap: 15px;
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 0 15px;
            }

            .logo {
                font-size: 1.6rem;
            }

            .logo i {
                font-size: 1.3rem;
            }

            .search-container {
                width: 200px;
            }

            .search-container.active {
                width: 250px;
            }

            .books-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 15px;
            }
            
            .nav-item {
                font-size: 1.2rem;
                width: 45px;
                height: 45px;
            }
            
            .add-btn {
                width: 55px;
                height: 55px;
                font-size: 1.5rem;
            }

            .profile-info h2 {
                font-size: 1.6rem;
            }

            .profile-stats {
                flex-direction: column;
                gap: 12px;
            }

            .stat-item:not(:last-child)::after {
                display: none;
            }

            .stat-item {
                padding: 12px 0;
            }

            .chat-input {
                padding: 12px 15px;
            }

            .send-btn {
                width: 42px;
                height: 42px;
            }

            .book-img-container {
                height: 180px;
            }
        }

        @media (max-width: 576px) {
            .header {
                padding: 0 10px;
                height: var(--header-height);
                flex-direction: row;
                justify-content: space-between;
            }

            .logo {
                font-size: 1.5rem;
            }

            .logo i {
                font-size: 1.2rem;
            }

            .header-actions {
                gap: 10px;
            }

            .search-container {
                position: absolute;
                top: var(--header-height);
                left: 0;
                right: 0;
                width: 100%;
                margin: 0;
                padding: 10px;
                background-color: var(--secondary-color);
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
                z-index: 999;
                display: none;
            }

            [data-theme="dark"] .search-container {
                background-color: var(--secondary-dark);
            }

            .search-container.active {
                display: block;
                width: 100%;
            }

            .search-input {
                display: block;
                width: 100%;
                padding: 10px 15px 10px 40px;
                border-radius: var(--border-radius);
                background-color: var(--secondary-light);
            }

            .search-results {
                top: calc(100% + 10px);
                left: 10px;
                right: 10px;
                width: auto;
            }

            .books-grid {
                grid-template-columns: 1fr 1fr;
                gap: 12px;
            }

            .book-img-container {
                height: 150px;
            }

            .profile-info h2 {
                font-size: 1.5rem;
            }

            .profile-bio {
                padding: 15px;
                font-size: 0.9rem;
            }

            .stat-number {
                font-size: 1.6rem;
            }

            .chat-input-container {
                padding: 12px;
            }

            .chat-input {
                padding: 12px 15px;
                margin-right: 10px;
                font-size: 0.95rem;
            }

            .send-btn {
                width: 40px;
                height: 40px;
                font-size: 1.1rem;
            }

            .message-content {
                padding: 10px 14px;
                font-size: 0.95rem;
            }
            
            .modal-content {
                padding: 20px;
                width: 95%;
            }
            
            .modal-title {
                font-size: 1.5rem;
            }

            .profile-actions {
                flex-direction: column;
                gap: 10px;
            }

            .edit-profile, .logout-btn {
                max-width: 100%;
                width: 100%;
            }

            .profile-avatar {
                width: 100px;
                height: 100px;
                font-size: 2.2rem;
            }
        }

        @media (max-width: 400px) {
            .container {
                padding: 15px 10px;
            }
            
            .page-title {
                font-size: 1.7rem;
            }
            
            .books-grid {
                grid-template-columns: 1fr;
            }

            .profile-info h2 {
                font-size: 1.4rem;
            }
            
            .profile-bio {
                padding: 12px;
            }
            
            .chat-input {
                padding: 10px 14px;
                font-size: 0.9rem;
            }
            
            .modal-content {
                padding: 15px;
            }

            .profile-avatar {
                width: 90px;
                height: 90px;
                font-size: 2rem;
            }
            
            .profile-points {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
            background: var(--gradient);
            color: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
            align-items: center;
        }

        .points-info {
            text-align: center;
        }

        .points-amount {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .points-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .withdraw-btn {
            background: white;
            color: var(--primary-color);
            border: none;
            padding: 12px 25px;
            border-radius: var(--border-radius-sm);
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: var(--shadow-md);
        }

        .withdraw-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 255, 255, 0.3);
        }

        .withdraw-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .withdraw-btn i {
            font-size: 1.1rem;
        }

        /* Withdrawal Modal */
        .withdrawal-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }

        .withdrawal-option {
            display: flex;
            align-items: center;
            padding: 15px;
            border-radius: var(--border-radius-sm);
            background-color: rgba(0, 0, 0, 0.05);
            cursor: pointer;
            transition: var(--transition);
        }

        [data-theme="dark"] .withdrawal-option {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .withdrawal-option:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] .withdrawal-option:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .withdrawal-option.active {
            border: 2px solid var(--primary-color);
            background-color: rgba(255, 71, 87, 0.1);
        }

        .withdrawal-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            flex-shrink: 0;
            font-size: 1.1rem;
        }

        .withdrawal-details {
            flex: 1;
        }

        .withdrawal-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--text-dark);
        }

        .withdrawal-description {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .amount-selection {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .amount-option {
            padding: 12px;
            text-align: center;
            border-radius: var(--border-radius-sm);
            background-color: rgba(0, 0, 0, 0.05);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }

        [data-theme="dark"] .amount-option {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .amount-option:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] .amount-option:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .amount-option.active {
            background: var(--gradient);
            color: white;
        }

        .payment-details {
            margin-top: 20px;
            display: none;
        }

        .payment-details.active {
            display: block;
        }

        .withdrawal-history {
            margin-top: 30px;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            padding-top: 20px;
        }

        [data-theme="dark"] .withdrawal-history {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .withdrawal-history-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--primary-color);
            font-weight: 600;
        }

        .withdrawal-item {
            padding: 15px;
            margin-bottom: 10px;
            border-radius: var(--border-radius-sm);
            background-color: rgba(0, 0, 0, 0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        [data-theme="dark"] .withdrawal-item {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .withdrawal-info {
            flex: 1;
        }

        .withdrawal-amount {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .withdrawal-method {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-bottom: 5px;
        }

        .withdrawal-date {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .withdrawal-status {
            padding: 5px 10px;
            border-radius: var(--border-radius-xs);
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-pending {
            background-color: #f39c12;
            color: white;
        }

        .status-completed {
            background-color: #27ae60;
            color: white;
        }

        .status-rejected {
            background-color: #e74c3c;
            color: white;
        }

        /* Point System Info */
        .point-system-info {
            background-color: rgba(0, 0, 0, 0.05);
            border-radius: var(--border-radius);
            padding: 20px;
            margin: 20px 0;
        }

        [data-theme="dark"] .point-system-info {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .point-system-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--primary-color);
            font-weight: 600;
        }

        .point-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px dashed rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] .point-item {
            border-bottom: 1px dashed rgba(255, 255, 255, 0.1);
        }

        .point-item:last-child {
            border-bottom: none;
        }

        .point-action {
            font-weight: 500;
        }

        .point-value {
            color: var(--primary-color);
            font-weight: 600;
        }
        
        .load-more-btn {
    background: var(--gradient);
    color: white;
    border: none;
    padding: 12px 25px;
    border-radius: var(--border-radius-sm);
    font-size: 1rem;
    cursor: pointer;
    transition: var(--transition);
    font-weight: 500;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    box-shadow: var(--shadow-md);
    margin: 0 auto;
}

.load-more-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 20px rgba(255, 71, 87, 0.5);
    background: var(--gradient-light);
}

.load-more-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none !important;
}

/* Lazy loading styles */
.lazy-load {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.6s ease, transform 0.6s ease;
}

.lazy-load.visible {
    opacity: 1;
    transform: translateY(0);
}

/* Tutorial button styles */
.tutorial-btn {
    background: var(--secondary-color);
    color: white;
    border: none;
    padding: 12px 18px;
    border-radius: var(--border-radius-sm);
    font-size: 0.9rem;
    cursor: pointer;
    transition: var(--transition);
    width: 100%;
    margin-top: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    box-shadow: var(--shadow-sm);
}

.tutorial-btn:hover {
    background: var(--secondary-light);
    transform: translateY(-2px);
}
        }
    </style>
</head>
<body data-theme="light">
    <!-- Header -->
    <header class="header">
        <div class="logo-container">
            <a href="#" class="logo" id="logoLink">
                <i class="fas fa-book-open"></i>
                <span>EduSparK</span>
            </a>
        </div>
        
        <div class="header-actions">
            <button class="theme-toggle">
                <i class="fas fa-sun sun"></i>
                <i class="fas fa-moon moon"></i>
            </button>
            
            <div class="user-avatar" id="userAvatar">
                <span id="avatarInitials">[^]</span>
            </div>
        </div>

        <div class="search-container" id="searchContainer">
            <i class="fas fa-search search-icon"></i>
            <input type="text" class="search-input" id="searchInput" placeholder="Search books...">
            <div class="search-results" id="searchResults"></div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <h1 class="page-title" data-aos="fade-right">Discover Books</h1>
        <div class="books-grid" id="booksContainer">
            <!-- Books will be dynamically added here -->
            <div class="empty-state" id="emptyState">
                <i class="fas fa-book-open"></i>
                <h3>No Books Available</h3>
                <p>Be the first to share a book with the community!</p>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <div class="nav-item" id="chatBtn">
            <i class="fas fa-comment-dots"></i>
        </div>
        <div class="nav-item active" id="homeBtn">
            <i class="fas fa-home"></i>
        </div>
        <button class="add-btn" id="addBookBtn">
            <i class="fas fa-plus"></i>
        </button>
        <div class="nav-item" id="discoverBtn">
            <i class="fas fa-compass"></i>
        </div>
        <div class="nav-item" id="profileBtn">
            <i class="fas fa-user"></i>
        </div>
    </nav>

    <!-- Full Page Profile -->
     <div class="profile-page" id="profilePage">
        <div class="profile-header">
            <button class="profile-back-btn" id="profileBackBtn">
                <i class="fas fa-arrow-left"></i>
            </button>
            <div class="profile-avatar" id="profileAvatar">
                <span id="profileAvatarInitials">U</span>
            </div>
            <div class="profile-info">
                <h2 id="profileName">User</h2>
                <br>
                <p class="profile-username" id="profileUsername">@username</p>
                <p class="profile-email" id="profileEmail"><i class="fas fa-envelope"></i> user@example.com</p>
            </div>
        </div>
        
        <div class="profile-bio" id="profileBio">
            No bio available. Edit your profile to add one.
        </div>
        
        <!-- Points Section -->
        <div class="profile-points">
            <div class="points-info">
                <div class="points-amount" id="userPoints">0</div>
                <div class="points-label">Points Earned</div>
            </div>
            <button class="withdraw-btn" id="withdrawBtn" disabled>
                <i class="fas fa-rupee-sign"></i> Withdraw
            </button>
        </div>

        <!-- Point System Info -->
        <div class="point-system-info">
            <h3 class="point-system-title">Point System</h3>
            <div class="point-item">
                <span class="point-action">Share a New book (2025-2026)</span>
                <span class="point-value">+10 points</span>
            </div>
            <div class="point-item">
                <span class="point-action">Share a Old book (2019-2024)</span>
                <span class="point-value">+5 points</span>
            </div>
            <div class="point-item">
                <span class="point-action">500 points</span>
                <span class="point-value">= ‚Çπ50</span>
            </div>
            <div class="point-item">
                <span class="point-action">1000 points</span>
                <span class="point-value">= ‚Çπ100</span>
            </div>
            <div class="point-item">
                <span class="point-action">2000 points</span>
                <span class="point-value">= ‚Çπ200</span>
            </div>
            <div class="point-item">
                <span class="point-action">5000 points</span>
                <span class="point-value">= ‚Çπ500</span>
            </div>
        </div>
        
        <div class="profile-stats">
            <div class="stat-item">
                <div class="stat-number" id="booksShared">0</div>
                <div class="stat-label">Books Shared</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="booksDownloaded">0</div>
                <div class="stat-label">Books Downloaded</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="memberSince">-</div>
                <div class="stat-label">Member Since</div>
            </div>
        </div>
        
        <div class="load-more-container" id="loadMoreContainer" style="text-align: center; margin-top: 20px;">
    <button class="load-more-btn" id="loadMoreBooksBtn" style="display: none;">
        <i class="fas fa-book-open"></i> Load More Books
    </button>
</div>
        <div class="books-grid" id="profileBooksContainer">
            <div class="empty-state">
                <i class="fas fa-book"></i>
                <h3>No Books Shared Yet</h3>
                <p>Start sharing books with the community!</p>
                
              
            </div>
              
        </div>

        <!-- Withdrawal History -->
        <div class="withdrawal-history" id="withdrawalHistory">
            <h3 class="withdrawal-history-title">Withdrawal History</h3>
            <div class="empty-state" id="emptyWithdrawalHistory">
                <i class="fas fa-wallet"></i>
                <h3>No Withdrawals Yet</h3>
                <p>Withdraw your points to see history here</p>
            </div>
        </div>
        
        <div class="profile-actions">
            <button class="edit-profile" id="editProfileBtn">
                <i class="fas fa-user-edit"></i> Edit Profile
            </button>
            <button class="logout-btn" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
        </div>
    </div>

    <!-- Full Page Chat -->
    <div class="chat-page" id="chatPage">
        <div class="chat-header">
            <button class="chat-back-btn" id="chatBackBtn">
                <i class="fas fa-arrow-left"></i>
            </button>
            <div class="chat-title">Live Chat</div>
        </div>
        
        <div class="chat-messages" id="chatMessages">
            <div class="empty-state">
                <i class="fas fa-comments"></i>
                <h3>No Messages Yet</h3>
                <p>Start the conversation with the community!</p>
            </div>
        </div>
        
        <div class="typing-indicator" id="typingIndicator">
            <span></span>
            <span></span>
            <span></span>
        </div>
        
        <div class="chat-input-container">
            <textarea id="chatInput" class="chat-input" placeholder="Type your message..." rows="1"></textarea>
            <button class="send-btn" id="sendMessageBtn" disabled>
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>
    
       <div class="modal" id="withdrawalModal">
        <div class="modal-content">
            <button class="close-modal" id="closeWithdrawalModal">&times;</button>
            <h2 class="modal-title">Withdraw Points</h2>
            
            <div class="withdrawal-options">
                <div class="withdrawal-option" data-method="upi">
                    <div class="withdrawal-icon">
                        <i class="fas fa-mobile-alt"></i>
                    </div>
                    <div class="withdrawal-details">
                        <div class="withdrawal-title">UPI</div>
                        <div class="withdrawal-description">Instant transfer to your UPI ID</div>
                    </div>
                </div>
                <div class="withdrawal-option" data-method="redeem">
    <div class="withdrawal-icon">
        <i class="fab fa-google-play"></i>
    </div>
    <div class="withdrawal-details">
        <div class="withdrawal-title">Redeem Code</div>
        <div class="withdrawal-description">Get Google Play gift card code</div>
    </div>
</div>
                <div class="withdrawal-option" data-method="bank">
                    <div class="withdrawal-icon">
                        <i class="fas fa-university"></i>
                    </div>
                    <div class="withdrawal-details">
                        <div class="withdrawal-title">Bank Account</div>
                        <div class="withdrawal-description">Transfer to your bank account</div>
                    </div>
                </div>
                <div class="withdrawal-option" data-method="paytm">
                    <div class="withdrawal-icon">
                        <i class="fab fa-paypal"></i>
                    </div>
                    <div class="withdrawal-details">
                        <div class="withdrawal-title">Paytm</div>
                        <div class="withdrawal-description">Transfer to your Paytm wallet</div>
                    </div>
                </div>
                <div class="withdrawal-option" data-method="phonepay">
                    <div class="withdrawal-icon">
                        <i class="fas fa-money-bill-wave"></i>
                    </div>
                    <div class="withdrawal-details">
                        <div class="withdrawal-title">PhonePe</div>
                        <div class="withdrawal-description">Transfer to your PhonePe account</div>
                    </div>
                </div>
            </div>
            
            <div class="amount-selection">
                <div class="amount-option" data-amount="500" data-rs="50">500 points = ‚Çπ50</div>
                <div class="amount-option" data-amount="1000" data-rs="100">1000 points = ‚Çπ100</div>
                <div class="amount-option" data-amount="2000" data-rs="200">2000 points = ‚Çπ200</div>
                <div class="amount-option" data-amount="5000" data-rs="500">5000 points = ‚Çπ500</div>
            </div>
            
            <div class="payment-details" id="paymentDetails">
                <div class="form-group">
                    <label id="paymentMethodLabel">UPI ID</label>
                    <input type="text" id="paymentId" class="form-input" placeholder="Enter your UPI ID" required>
                </div>
                <div class="form-group">
                    <label for="accountName">Account Holder Name</label>
                    <input type="text" id="accountName" class="form-input" placeholder="Enter account holder name" required>
                </div>
                <button type="button" class="submit-btn" id="submitWithdrawalBtn">
                    <span class="spinner" id="withdrawalSpinner" style="display: none;"></span>
                    Request Withdrawal
                </button>
                
            </div>
        </div>
    </div>

    <!-- Add Book Modal -->
    <div class="modal" id="addBookModal">
        <div class="modal-content">
            <button class="close-modal" id="closeAddBookModal">&times;</button>
            <h2 class="modal-title">Add New Book</h2>
            <form id="addBookForm">
                <div class="form-group">
                    <label for="bookName" class="form-label">Book Name</label>
                    <input type="text" id="bookName" class="form-input" placeholder="Enter book name" required>
                </div>
              
                <div class="form-group">
                    <label for="authorName" class="form-label">Author Name</label>
                    <input type="text" id="authorName" class="form-input" placeholder="Enter author name" required>
                </div>
                <div class="form-group">
                    <label for="bookCategory" class="form-label">Category</label>
                    <input type="text" id="bookCategory" class="form-input" placeholder="Enter book category (e.g., Fiction, Science)" required>
                </div>
                <div class="form-group">
                    <label for="bookImageUrl" class="form-label">Cover Image URL (Optional)</label>
                    <input type="url" id="bookImageUrl" class="form-input" placeholder="Enter image URL for book cover">
                </div>
                <div class="form-group">
                    <label for="driveLink" class="form-label">Google Drive Link</label>
                    <input type="url" id="driveLink" class="form-input" placeholder="Enter Google Drive link" required>
                </div>
                <div class="form-group">
                    <label for="bookDescription" class="form-label">Description (Optional)</label>
                    <textarea id="bookDescription" class="form-input" placeholder="Enter a brief description about the book" rows="3"></textarea>
                </div>
                <button type="submit" class="submit-btn" id="submitBookBtn">
                    <span class="spinner" id="submitSpinner" style="display: none;"></span>
                    Submit for Approval
                </button>
                <!-- Add this below the submit button in the addBookModal -->
<button class="tutorial-btn" onclick="location.href='https://t.me/official_learnhub/140'" id="tutorialBtn">
    <i class="fas fa-question-circle"></i> How to Share Books
</button>
            </form>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <button class="close-modal" id="closeLoginModal">&times;</button>
            <h2 class="modal-title">Login to EduSparK</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label for="loginEmail" class="form-label">Email</label>
                    <input type="email" id="loginEmail" class="form-input" placeholder="Enter your email" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword" class="form-label">Password</label>
                    <input type="password" id="loginPassword" class="form-input" placeholder="Enter your password" required>
                </div>
                <button type="submit" class="submit-btn" id="loginBtn">
                    <span class="spinner" id="loginSpinner" style="display: none;"></span>
                    Login
                </button>
            </form>
            <div class="auth-switch">
                Don't have an account? <a id="switchToSignup">Sign up</a>
            </div>
        </div>
    </div>

    <!-- Signup Modal -->
    <div class="modal" id="signupModal">
        <div class="modal-content">
            <button class="close-modal" id="closeSignupModal">&times;</button>
            <h2 class="modal-title">Create Account</h2>
            <form id="signupForm">
                <div class="form-group">
                    <label for="signupName" class="form-label">Full Name</label>
                    <input type="text" id="signupName" class="form-input" placeholder="Enter your full name" required>
                </div>
                <div class="form-group">
                    <label for="signupUsername" class="form-label">Username</label>
                    <input type="text" id="signupUsername" class="form-input" placeholder="Choose a username" required>
                </div>
                <div class="form-group">
                    <label for="signupEmail" class="form-label">Email</label>
                    <input type="email" id="signupEmail" class="form-input" placeholder="Enter your email" required>
                </div>
                <div class="form-group">
                    <label for="signupPassword" class="form-label">Password</label>
                    <input type="password" id="signupPassword" class="form-input" placeholder="Create a password" required>
                </div>
                <div class="form-group">
                    <label for="signupBio" class="form-label">Bio (Optional)</label>
                    <textarea id="signupBio" class="form-input" placeholder="Tell us about yourself" rows="3"></textarea>
                </div>
                <button type="submit" class="submit-btn" id="signupBtn">
                    <span class="spinner" id="signupSpinner" style="display: none;"></span>
                    Sign Up
                </button>
            </form>
            <div class="auth-switch">
                Already have an account? <a id="switchToLogin">Login</a>
            </div>
        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div class="modal" id="editProfileModal">
        <div class="modal-content">
            <button class="close-modal" id="closeEditProfileModal">&times;</button>
            <h2 class="modal-title">Edit Profile</h2>
            <form id="editProfileForm">
                <div class="form-group">
                    <label for="editProfileName" class="form-label">Full Name</label>
                    <input type="text" id="editProfileName" class="form-input" placeholder="Enter your full name" required>
                </div>
                <div class="form-group">
                    <label for="editProfileUsername" class="form-label">Username</label>
                    <input type="text" id="editProfileUsername" class="form-input" placeholder="Choose a username" required>
                </div>
                <div class="form-group">
                    <label for="editProfileBio" class="form-label">Bio</label>
                    <textarea id="editProfileBio" class="form-input" placeholder="Tell us about yourself" rows="3"></textarea>
                </div>
                <button type="submit" class="submit-btn" id="saveProfileBtn">
                    <span class="spinner" id="saveProfileSpinner" style="display: none;"></span>
                    Save Changes
                </button>
            </form>
        </div>
    </div>

    <!-- Discover Modal -->
    <div class="modal" id="discoverModal">
        <div class="modal-content">
            <button class="close-modal" id="closeDiscoverModal">&times;</button>
            <h2 class="modal-title">Discover</h2>
            <div class="discover-list" id="discoverList">
                <div class="discover-item">
                    <div class="discover-icon">
                        <i class="fas fa-book-open"></i>
                    </div>
                    <div class="discover-content">
                        <div class="discover-title">Featured Books</div>
                        <div class="discover-description">Explore our curated collection of featured books</div>
                    </div>
                </div>
                <div class="discover-item">
                    <div class="discover-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="discover-content">
                        <div class="discover-title">Top Contributors</div>
                        <div class="discover-description">See who's sharing the most books</div>
                    </div>
                </div>
                <div class="discover-item">
                    <div class="discover-icon">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <div class="discover-content">
                        <div class="discover-title">Popular This Week</div>
                        <div class="discover-description">Most downloaded books this week</div>
                    </div>
                </div>
                <div class="discover-item">
                    <div class="discover-icon">
                        <i class="fas fa-lightbulb"></i>
                    </div>
                    <div class="discover-content">
                        <div class="discover-title">New Releases</div>
                        <div class="discover-description">Recently added books to the platform</div>
                    </div>
                </div>
                <div class="discover-item">
                    <div class="discover-icon">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div class="discover-content">
                        <div class="discover-title">Educational Resources</div>
                        <div class="discover-description">Textbooks and academic materials</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        const _0x16d062=_0x526e;(function(_0x54ecde,_0x45c1f6){const _0x433a21=_0x526e,_0x589eb9=_0x54ecde();while(!![]){try{const _0x59bfb8=parseInt(_0x433a21(0x2a6))/0x1+parseInt(_0x433a21(0x332))/0x2+-parseInt(_0x433a21(0x24b))/0x3*(parseInt(_0x433a21(0x25b))/0x4)+-parseInt(_0x433a21(0x26f))/0x5*(-parseInt(_0x433a21(0x2db))/0x6)+parseInt(_0x433a21(0x2c6))/0x7+parseInt(_0x433a21(0x246))/0x8*(parseInt(_0x433a21(0x240))/0x9)+-parseInt(_0x433a21(0x208))/0xa;if(_0x59bfb8===_0x45c1f6)break;else _0x589eb9['push'](_0x589eb9['shift']());}catch(_0x3abb5c){_0x589eb9['push'](_0x589eb9['shift']());}}}(_0x5ad3,0x444d6));function hi(){const _0x214532=_0x526e;console[_0x214532(0x254)](_0x214532(0x226));}hi(),AOS[_0x16d062(0x253)]({'duration':0x320,'easing':_0x16d062(0x1f8),'once':!![],'offset':0x64});const firebaseConfig={'apiKey':_0x16d062(0x1eb),'authDomain':_0x16d062(0x2a4),'databaseURL':_0x16d062(0x2e5),'projectId':'eduspark-books','storageBucket':_0x16d062(0x210),'messagingSenderId':'977405961718','appId':_0x16d062(0x28a),'measurementId':_0x16d062(0x23a)};firebase[_0x16d062(0x200)](firebaseConfig);const auth=firebase['auth'](),db=firebase[_0x16d062(0x256)](),storage=firebase[_0x16d062(0x23e)](),themeToggle=document[_0x16d062(0x34d)](_0x16d062(0x2f3)),body=document[_0x16d062(0x2b7)],header=document['querySelector'](_0x16d062(0x2d1)),logoLink=document['getElementById'](_0x16d062(0x314)),userAvatar=document[_0x16d062(0x23c)](_0x16d062(0x2ce)),avatarInitials=document[_0x16d062(0x23c)](_0x16d062(0x2f9)),searchContainer=document['getElementById'](_0x16d062(0x2c3)),searchInput=document[_0x16d062(0x23c)](_0x16d062(0x1e5)),searchResults=document[_0x16d062(0x23c)](_0x16d062(0x2cb)),addBookBtn=document[_0x16d062(0x23c)](_0x16d062(0x32a)),addBookModal=document[_0x16d062(0x23c)](_0x16d062(0x2de)),closeAddBookModal=document[_0x16d062(0x23c)](_0x16d062(0x30d)),addBookForm=document[_0x16d062(0x23c)](_0x16d062(0x307)),booksContainer=document['getElementById'](_0x16d062(0x2a9)),emptyState=document[_0x16d062(0x23c)](_0x16d062(0x347)),profileBtn=document[_0x16d062(0x23c)](_0x16d062(0x20d)),profilePage=document['getElementById'](_0x16d062(0x231)),profileBackBtn=document['getElementById']('profileBackBtn'),chatBtn=document[_0x16d062(0x23c)](_0x16d062(0x27f)),chatPage=document[_0x16d062(0x23c)](_0x16d062(0x2bc)),chatBackBtn=document['getElementById']('chatBackBtn'),chatMessages=document['getElementById']('chatMessages'),chatInput=document[_0x16d062(0x23c)](_0x16d062(0x2d3)),sendMessageBtn=document['getElementById'](_0x16d062(0x205)),typingIndicator=document['getElementById'](_0x16d062(0x33d)),loginModal=document[_0x16d062(0x23c)](_0x16d062(0x312)),signupModal=document['getElementById'](_0x16d062(0x31c)),closeLoginModal=document['getElementById'](_0x16d062(0x2da)),closeSignupModal=document[_0x16d062(0x23c)](_0x16d062(0x1fd)),loginForm=document['getElementById'](_0x16d062(0x32e)),signupForm=document['getElementById']('signupForm'),switchToSignup=document[_0x16d062(0x23c)]('switchToSignup'),switchToLogin=document[_0x16d062(0x23c)](_0x16d062(0x23d)),editProfileBtn=document[_0x16d062(0x23c)](_0x16d062(0x235)),editProfileModal=document['getElementById'](_0x16d062(0x283)),closeEditProfileModal=document[_0x16d062(0x23c)](_0x16d062(0x2fe)),editProfileForm=document[_0x16d062(0x23c)](_0x16d062(0x2f1)),profileName=document[_0x16d062(0x23c)](_0x16d062(0x1f1)),profileUsername=document['getElementById']('profileUsername'),profileEmail=document['getElementById'](_0x16d062(0x2d0)),profileBio=document['getElementById']('profileBio'),booksShared=document[_0x16d062(0x23c)](_0x16d062(0x34b)),booksDownloaded=document['getElementById']('booksDownloaded'),memberSince=document['getElementById']('memberSince'),profileBooksContainer=document[_0x16d062(0x23c)](_0x16d062(0x21b)),discoverBtn=document['getElementById'](_0x16d062(0x33b)),discoverModal=document[_0x16d062(0x23c)](_0x16d062(0x2f4)),closeDiscoverModal=document['getElementById'](_0x16d062(0x278)),discoverList=document[_0x16d062(0x23c)](_0x16d062(0x30e)),logoutBtn=document[_0x16d062(0x23c)](_0x16d062(0x207)),profileAvatar=document[_0x16d062(0x23c)](_0x16d062(0x22f)),profileAvatarInitials=document[_0x16d062(0x23c)](_0x16d062(0x30f)),userPoints=document[_0x16d062(0x23c)]('userPoints'),withdrawBtn=document[_0x16d062(0x23c)](_0x16d062(0x247)),withdrawalModal=document[_0x16d062(0x23c)](_0x16d062(0x34a)),closeWithdrawalModal=document[_0x16d062(0x23c)]('closeWithdrawalModal'),withdrawalOptions=document[_0x16d062(0x24a)](_0x16d062(0x305)),amountOptions=document['querySelectorAll']('.amount-option'),paymentDetails=document[_0x16d062(0x23c)]('paymentDetails'),paymentMethodLabel=document['getElementById']('paymentMethodLabel'),paymentId=document[_0x16d062(0x23c)](_0x16d062(0x320)),accountName=document[_0x16d062(0x23c)](_0x16d062(0x319)),submitWithdrawalBtn=document[_0x16d062(0x23c)]('submitWithdrawalBtn'),withdrawalHistory=document[_0x16d062(0x23c)]('withdrawalHistory'),emptyWithdrawalHistory=document[_0x16d062(0x23c)](_0x16d062(0x1fb));let isLoadingBooks=![],allBooksLoaded=![],lastVisibleBook=null;const booksPerLoad=0xa;let booksLimit=0x3,lastBook=null;const batchSize=0xa;let lastBookSnapshot=null,hasMoreBooks=![],currentUser=null,userData=null,isTyping=![],typingTimeout=null,lastTypingTime=0x0,allBooks=[],selectedWithdrawalMethod=null,selectedWithdrawalAmount=null,selectedWithdrawalRs=null;function _0x5ad3(){const _0x24f6d1=['desc','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Bank\x20Account\x20Number','editProfileModal','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-status\x20','set','dark','status-rejected','innerWidth','48done=','1:977405961718:web:4f9d16cf0a44e1f54e93d7','bank','slice','.header-actions','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-calendar-alt\x22></i>\x20','reviewedBy','<span\x20class=\x22status-badge\x20status-pending\x22>Pending</span>','doc','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-date\x22>','description','createdAt','Account\x20created\x20successfully!','update','reset','toUpperCase','Error\x20submitting\x20withdrawal\x20request','Please\x20login\x20to\x20add\x20books','pending','classList','forEach','message\x20','status','processedApprovals','<span\x20class=\x22status-badge\x20status-approved\x22>Approved</span>','Error\x20adding\x20book:','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22book-overlay-author\x22>By\x20','eduspark-books.firebaseapp.com','Enter\x20your\x20PhonePe\x20registered\x20number','501436CAzEXT','You\x20don\x27t\x20have\x20enough\x20points','loginPassword','booksContainer','senderName','saveProfileBtn','style','\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>','authorName','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22book-author\x22>By\x20','scrollHeight','exists','click','signupUsername','where','Enter','1.2rem','body','createElement','href','driveLink','<div\x20class=\x22message-sender\x22>','chatPage','toString','cookie','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-download\x22></i>\x20','appendChild','currentTarget','Your\x20book\x20was\x20approved!','searchContainer','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22message-time\x22>','imageUrl','3620918miBtMC','onSnapshot','pointer','show','add','searchResults','textContent','signupPassword','userAvatar','catch','profileEmail','.header','toLocaleTimeString','chatInput','temp-','user@example.com','FieldValue','drive.google.com','amountRs','Error:\x20','closeLoginModal','291882cElPAn','loginBtn','submittedAt','addBookModal','open','map','sending','block','then','orderBy','https://eduspark-books-default-rtdb.asia-southeast1.firebasedatabase.app','toLowerCase','messages','You\x20need\x20at\x20least\x20500\x20points\x20to\x20withdraw','User','center','getMonth','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22download-btn\x22\x20data-link=\x22','display','.download-btn,\x20.book-overlay-btn','data-link','getAttribute','editProfileForm','keydown','.theme-toggle','discoverModal','height','<i\x20class=\x22fas\x20fa-envelope\x22></i>\x20','animationDelay','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','avatarInitials','submittedBy','completed','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20','info','closeEditProfileModal','/login','Error\x20loading\x20more\x20books:','light','status-completed','No\x20Name','setItem','.withdrawal-option','submit','addBookForm','theme','Profile\x20updated\x20successfully!','inline-block','limit','empty','closeAddBookModal','discoverList','profileAvatarInitials','get','\x20is\x20typing...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','loginModal','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','logoLink','.message-status','Error\x20logging\x20out','books','delivered','accountName','var(--text-light)','preventDefault','signupModal','signupSpinner','senderId','scrolled','paymentId','approved','includes','scrollIntoView','setAttribute','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22toast-close\x22>&times;</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','location','<span\x20class=\x22status-badge\x20status-rejected\x22>Rejected</span>','Signup\x20error:','error','addBookBtn','split','highlight','submitSpinner','loginForm','user','editProfileBio','auto','976046jofpen','https://via.placeholder.com/300x200?text=No+Cover','requestedAt','reviewedAt','book-card','</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>By\x20','fontSize','<div\x20class=\x22book-admin-info\x22><i\x20class=\x22fas\x20fa-user-shield\x22></i>\x20Reviewed\x20by\x20','method','discoverBtn','.book-card[data-id=\x22','typingIndicator','signupBtn','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-user\x22></i>\x20','getFullYear','scroll','data-theme','withdrawals','clientHeight','padStart','Paytm\x20Number','emptyState','fa-search','docs','withdrawalModal','booksShared','bookName','querySelector','10px','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4>','hidden','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','name','2-digit','contains','.modal','withdrawal-item','className','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22book-title\x22>','increment','submitBookBtn','docChanges','disabled','smooth','message','searchInput','\x20on\x20','<div\x20class=\x22no-results\x22>No\x20books\x20found\x20matching\x20your\x20search</div>','collection','children','scrollTop','AIzaSyASKb2xr27kjYokZICpIbBYULWsRdmBzI0','key','Enter\x20your\x20UPI\x20ID\x20(e.g.,\x20name@upi)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22download-btn\x22\x20data-link=\x22','cursor','_blank','profileName','warning','Pending','72done=','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-calendar-alt\x22></i>\x20','flex','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22book-author\x22>By\x20','ease-in-out','shiftKey','loadMoreBooksBtn','emptyWithdrawalHistory','added','closeSignupModal','none','saveProfileSpinner','initializeApp','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','filter','fa-exclamation-circle','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-download\x22></i>\x20','sendMessageBtn','Enter\x20your\x20bank\x20account\x20number','logoutBtn','17746300mkoGWS','PhonePe\x20Number','fa-check-circle','success','loginSpinner','profileBtn','placeholder','</span>','eduspark-books.firebasestorage.app','.book-card','marginLeft','now','userId','Login\x20failed:\x20','username','onAuthStateChanged','join','fa-info-circle','Error\x20fetching\x20books:','profileBooksContainer','data','scrollTo','booksDownloaded','upi','push','div','bookImageUrl','.toast-close','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22withdrawal-history-title\x22>Withdrawal\x20History</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','target','Hello\x20World!','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22book-overlay-author\x22>By\x20','data-rs','withdrawalSpinner','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-external-link-alt\x22></i>\x20View\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Error\x20sending\x20message:','scrollY','serverTimestamp','profileAvatar','Please\x20provide\x20a\x20valid\x20Google\x20Drive\x20link','profilePage','24done=','typing','addEventListener','editProfileBtn','value','bio','uid','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','G-G6JHCMYZ0X','</p>','getElementById','switchToLogin','storage','signupName','198EZHXIx','modified','No\x20bio\x20available.\x20Edit\x20your\x20profile\x20to\x20add\x20one.','downloads','editProfileName','closest','179528qjNVtZ','withdrawBtn','rejected','type','querySelectorAll','129999dmUrEv','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22book-title\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</div>','fa-exclamation-triangle','active','email','init','log','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','firestore','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22book-overlay-btn\x22\x20data-link=\x22','length','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-calendar-alt\x22></i>\x20','signOut','4AEmNZG','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-img-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','editProfileUsername','createUserWithEmailAndPassword','Book\x20submitted\x20for\x20approval!','remove','bookCategory','points','<span\x20class=\x22message-status\x20','submittedByName','\x20‚Ä¢\x20','\x22\x20alt=\x22','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Rejected\x20by\x20','amountPoints','search-result-item','sent','getItem','overflow','10xGXbCh','<p\x20class=\x22book-overlay-desc\x22>','data-id','received','category','\x20points)</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-method\x22>','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-external-link-alt\x22></i>\x20View\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','innerHTML','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22book-overlay-btn\x22\x20data-link=\x22','closeDiscoverModal','users','Anonymous','trim','toDate','Error\x20submitting\x20withdrawal:','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-download\x22></i>\x20Download\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','chatBtn'];_0x5ad3=function(){return _0x24f6d1;};return _0x5ad3();}window[_0x16d062(0x234)](_0x16d062(0x341),()=>{const _0x4712a9=_0x16d062;window[_0x4712a9(0x22d)]>0x32?header[_0x4712a9(0x29c)][_0x4712a9(0x2ca)](_0x4712a9(0x31f)):header['classList'][_0x4712a9(0x261)](_0x4712a9(0x31f));}),themeToggle['addEventListener'](_0x16d062(0x2b2),()=>{const _0x1d3da6=_0x16d062,_0x1a9abd=body['getAttribute']('data-theme'),_0x447bb6=_0x1a9abd===_0x1d3da6(0x301)?_0x1d3da6(0x286):_0x1d3da6(0x301);body[_0x1d3da6(0x324)](_0x1d3da6(0x342),_0x447bb6),localStorage[_0x1d3da6(0x304)](_0x1d3da6(0x308),_0x447bb6);});const savedTheme=localStorage[_0x16d062(0x26d)](_0x16d062(0x308));savedTheme&&body[_0x16d062(0x324)](_0x16d062(0x342),savedTheme);searchInput[_0x16d062(0x234)]('input',function(){const _0xa03421=_0x16d062,_0x21ad84=this[_0xa03421(0x236)][_0xa03421(0x27b)]()[_0xa03421(0x2e6)]();if(_0x21ad84[_0xa03421(0x258)]===0x0){searchResults[_0xa03421(0x2ac)][_0xa03421(0x2ed)]='none';return;}const _0x419783=allBooks[_0xa03421(0x202)](_0x5dd32b=>_0x5dd32b[_0xa03421(0x34c)]['toLowerCase']()[_0xa03421(0x322)](_0x21ad84)||_0x5dd32b[_0xa03421(0x2ae)][_0xa03421(0x2e6)]()[_0xa03421(0x322)](_0x21ad84)||_0x5dd32b['category']&&_0x5dd32b['category'][_0xa03421(0x2e6)]()[_0xa03421(0x322)](_0x21ad84));renderSearchResults(_0x419783);});if(window[_0x16d062(0x288)]<=0x240){const searchIcon=document[_0x16d062(0x2b8)]('i');searchIcon[_0x16d062(0x1dd)]='fas\x20fa-search',searchIcon['style'][_0x16d062(0x338)]=_0x16d062(0x2b6),searchIcon[_0x16d062(0x2ac)]['color']=_0x16d062(0x31a),searchIcon[_0x16d062(0x2ac)][_0x16d062(0x1ef)]=_0x16d062(0x2c8),searchIcon[_0x16d062(0x2ac)][_0x16d062(0x212)]=_0x16d062(0x34e),searchIcon[_0x16d062(0x234)]('click',()=>{const _0x168d5e=_0x16d062;searchContainer[_0x168d5e(0x2ac)][_0x168d5e(0x2ed)]=_0x168d5e(0x2e2),searchInput['focus']();}),document[_0x16d062(0x34d)](_0x16d062(0x28d))['insertBefore'](searchIcon,themeToggle),searchContainer['style'][_0x16d062(0x2ed)]='none';}function renderSearchResults(_0x6b54ec){const _0x4e6074=_0x16d062;searchResults['innerHTML']='';if(_0x6b54ec[_0x4e6074(0x258)]===0x0){searchResults[_0x4e6074(0x276)]=_0x4e6074(0x1e7),searchResults[_0x4e6074(0x2ac)]['display']=_0x4e6074(0x2e2);return;}_0x6b54ec[_0x4e6074(0x28c)](0x0,0x5)[_0x4e6074(0x29d)](_0xb2f477=>{const _0x39f080=_0x4e6074,_0x108b26=document['createElement'](_0x39f080(0x221));_0x108b26[_0x39f080(0x1dd)]=_0x39f080(0x26b),_0x108b26['innerHTML']=_0x39f080(0x34f)+_0xb2f477[_0x39f080(0x34c)]+_0x39f080(0x337)+_0xb2f477['authorName']+(_0xb2f477['category']?_0x39f080(0x266)+_0xb2f477[_0x39f080(0x273)]:'')+_0x39f080(0x24c),_0x108b26[_0x39f080(0x234)](_0x39f080(0x2b2),()=>{const _0x184164=_0x39f080,_0x2a34da=document['querySelector'](_0x184164(0x33c)+_0xb2f477['id']+'\x22]');_0x2a34da&&(_0x2a34da[_0x184164(0x323)]({'behavior':'smooth','block':_0x184164(0x2ea)}),_0x2a34da[_0x184164(0x29c)]['add'](_0x184164(0x32c)),setTimeout(()=>{const _0x5015e7=_0x184164;_0x2a34da[_0x5015e7(0x29c)][_0x5015e7(0x261)](_0x5015e7(0x32c));},0x7d0)),searchInput[_0x184164(0x236)]='',searchResults['style']['display']=_0x184164(0x1fe),window['innerWidth']<=0x240&&(searchContainer[_0x184164(0x2ac)][_0x184164(0x2ed)]='none');}),searchResults[_0x39f080(0x2c0)](_0x108b26);}),searchResults[_0x4e6074(0x2ac)][_0x4e6074(0x2ed)]='block';}document[_0x16d062(0x234)]('click',_0x45f2b2=>{const _0x223547=_0x16d062;!searchContainer[_0x223547(0x354)](_0x45f2b2[_0x223547(0x225)])&&_0x45f2b2[_0x223547(0x225)][_0x223547(0x1dd)]!==_0x223547(0x348)&&(searchResults[_0x223547(0x2ac)][_0x223547(0x2ed)]='none');});function openProfilePage(){const _0x5550f7=_0x16d062;profilePage['classList']['add'](_0x5550f7(0x251)),document[_0x5550f7(0x2b7)][_0x5550f7(0x2ac)][_0x5550f7(0x26e)]=_0x5550f7(0x350),fetchUserBooks();}function closeProfilePage(){const _0x36c7c6=_0x16d062;profilePage[_0x36c7c6(0x29c)][_0x36c7c6(0x261)](_0x36c7c6(0x251)),document[_0x36c7c6(0x2b7)]['style'][_0x36c7c6(0x26e)]=_0x36c7c6(0x331);}function openChatPage(){const _0x49c80c=_0x16d062;chatPage[_0x49c80c(0x29c)][_0x49c80c(0x2ca)](_0x49c80c(0x251)),document[_0x49c80c(0x2b7)][_0x49c80c(0x2ac)][_0x49c80c(0x26e)]=_0x49c80c(0x350),chatInput['focus']();}function closeChatPage(){const _0x120c7c=_0x16d062;chatPage[_0x120c7c(0x29c)]['remove'](_0x120c7c(0x251)),document[_0x120c7c(0x2b7)]['style'][_0x120c7c(0x26e)]='auto';}profileBtn[_0x16d062(0x234)](_0x16d062(0x2b2),()=>{if(!currentUser){openModal(loginModal);return;}openProfilePage();}),profileBackBtn[_0x16d062(0x234)]('click',closeProfilePage),chatBtn[_0x16d062(0x234)]('click',()=>{if(!currentUser){openModal(loginModal);return;}openChatPage();}),chatBackBtn[_0x16d062(0x234)]('click',closeChatPage),userAvatar[_0x16d062(0x234)](_0x16d062(0x2b2),()=>{if(!currentUser){openModal(loginModal);return;}openProfilePage();}),logoLink[_0x16d062(0x234)](_0x16d062(0x2b2),_0x349bb7=>{const _0x255042=_0x16d062;_0x349bb7[_0x255042(0x31b)](),window[_0x255042(0x21d)]({'top':0x0,'behavior':_0x255042(0x1e3)});});function openModal(_0x4182ad){const _0x41ecb6=_0x16d062;_0x4182ad[_0x41ecb6(0x29c)][_0x41ecb6(0x2ca)]('active'),document[_0x41ecb6(0x2b7)]['style'][_0x41ecb6(0x26e)]=_0x41ecb6(0x350);}function closeModal(_0x1607dc){const _0x414b0d=_0x16d062;_0x1607dc[_0x414b0d(0x29c)]['remove']('active'),document[_0x414b0d(0x2b7)][_0x414b0d(0x2ac)][_0x414b0d(0x26e)]='auto';}addBookBtn[_0x16d062(0x234)]('click',()=>{if(!currentUser){openModal(loginModal);return;}addBookForm['reset'](),openModal(addBookModal);}),closeAddBookModal[_0x16d062(0x234)]('click',()=>closeModal(addBookModal)),closeLoginModal[_0x16d062(0x234)]('click',()=>closeModal(loginModal)),closeSignupModal[_0x16d062(0x234)]('click',()=>closeModal(signupModal)),switchToSignup[_0x16d062(0x234)](_0x16d062(0x2b2),()=>{closeModal(loginModal),openModal(signupModal);}),switchToLogin[_0x16d062(0x234)](_0x16d062(0x2b2),()=>{closeModal(signupModal),openModal(loginModal);}),editProfileBtn[_0x16d062(0x234)]('click',()=>{const _0x33223a=_0x16d062;closeProfilePage(),openModal(editProfileModal),document[_0x33223a(0x23c)](_0x33223a(0x244))[_0x33223a(0x236)]=userData?.[_0x33223a(0x352)]||'',document[_0x33223a(0x23c)](_0x33223a(0x25e))[_0x33223a(0x236)]=userData?.[_0x33223a(0x216)]||'',document[_0x33223a(0x23c)]('editProfileBio')[_0x33223a(0x236)]=userData?.[_0x33223a(0x237)]||'';}),closeEditProfileModal[_0x16d062(0x234)](_0x16d062(0x2b2),()=>{closeModal(editProfileModal),openProfilePage();}),discoverBtn[_0x16d062(0x234)](_0x16d062(0x2b2),()=>{if(!currentUser){openModal(loginModal);return;}openModal(discoverModal);}),closeDiscoverModal[_0x16d062(0x234)](_0x16d062(0x2b2),()=>closeModal(discoverModal)),document[_0x16d062(0x24a)](_0x16d062(0x355))['forEach'](_0x13acda=>{_0x13acda['addEventListener']('click',_0x4d0b35=>{const _0x2af5a9=_0x526e;_0x4d0b35[_0x2af5a9(0x225)]===_0x13acda&&closeModal(_0x13acda);});}),chatInput[_0x16d062(0x234)]('input',function(){const _0x312b84=_0x16d062;this[_0x312b84(0x2ac)][_0x312b84(0x2f5)]=_0x312b84(0x331),this[_0x312b84(0x2ac)][_0x312b84(0x2f5)]=this[_0x312b84(0x2b0)]+'px',sendMessageBtn[_0x312b84(0x1e2)]=this[_0x312b84(0x236)][_0x312b84(0x27b)]()==='';}),addBookForm['addEventListener'](_0x16d062(0x306),async _0x9fcbf8=>{const _0x13074d=_0x16d062;_0x9fcbf8[_0x13074d(0x31b)]();if(!currentUser){showToast(_0x13074d(0x29a),_0x13074d(0x329));return;}const _0x418a8b=document[_0x13074d(0x23c)](_0x13074d(0x1e0)),_0x3721ca=document[_0x13074d(0x23c)](_0x13074d(0x32d));_0x418a8b[_0x13074d(0x1e2)]=!![],_0x3721ca[_0x13074d(0x2ac)][_0x13074d(0x2ed)]=_0x13074d(0x30a);const _0x2e69b1=document[_0x13074d(0x23c)]('bookName')['value'],_0x1b4624=document['getElementById']('authorName')[_0x13074d(0x236)],_0x13d896=document['getElementById'](_0x13074d(0x262))[_0x13074d(0x236)],_0xe671d6=document['getElementById']('bookImageUrl')['value'],_0x24fe96=document[_0x13074d(0x23c)](_0x13074d(0x2ba))['value'],_0x3b34c0=document[_0x13074d(0x23c)]('bookDescription')[_0x13074d(0x236)];try{if(!_0x24fe96['includes'](_0x13074d(0x2d7)))throw new Error(_0x13074d(0x230));await db[_0x13074d(0x1e8)](_0x13074d(0x317))[_0x13074d(0x2ca)]({'bookName':_0x2e69b1,'authorName':_0x1b4624,'category':_0x13d896,'imageUrl':_0xe671d6||null,'description':_0x3b34c0,'driveLink':_0x24fe96,'submittedBy':currentUser['uid'],'submittedByName':userData?.['name']||_0x13074d(0x27a),'submittedAt':firebase[_0x13074d(0x256)][_0x13074d(0x2d6)][_0x13074d(0x22e)](),'status':_0x13074d(0x29b),'adminNotes':'','reviewedBy':'','reviewedAt':null,'rejectionReason':'','downloads':0x0}),await db[_0x13074d(0x1e8)](_0x13074d(0x279))[_0x13074d(0x291)](currentUser[_0x13074d(0x238)])['update']({'booksShared':firebase['firestore'][_0x13074d(0x2d6)]['increment'](0x1)}),userData[_0x13074d(0x34b)]=(userData[_0x13074d(0x34b)]||0x0)+0x1,booksShared[_0x13074d(0x2cc)]=userData[_0x13074d(0x34b)],showToast(_0x13074d(0x260),_0x13074d(0x20b)),addBookForm[_0x13074d(0x297)](),closeModal(addBookModal);}catch(_0x548469){console[_0x13074d(0x329)]('Error\x20adding\x20book:',_0x548469),showToast(_0x13074d(0x2d9)+_0x548469[_0x13074d(0x1e4)],_0x13074d(0x329));}finally{_0x418a8b[_0x13074d(0x1e2)]=![],_0x3721ca[_0x13074d(0x2ac)][_0x13074d(0x2ed)]='none',isSubmittingBook=![];}});function setupDownloadButtons(){const _0x21ff89=_0x16d062;document[_0x21ff89(0x24a)]('.download-btn,\x20.book-overlay-btn')[_0x21ff89(0x29d)](_0x19b379=>{const _0x1dc2bd=_0x21ff89;_0x19b379[_0x1dc2bd(0x234)](_0x1dc2bd(0x2b2),async _0xa4b166=>{const _0x43367e=_0x1dc2bd;if(!currentUser){openModal(loginModal);return;}const _0x333dc0=_0xa4b166['currentTarget'][_0x43367e(0x2f0)]('data-link');window[_0x43367e(0x2df)](_0x333dc0,'_blank');const _0x161548=_0xa4b166[_0x43367e(0x2c1)][_0x43367e(0x245)]('.book-card')?.[_0x43367e(0x2f0)](_0x43367e(0x271));if(_0x161548)try{await db[_0x43367e(0x1e8)](_0x43367e(0x317))[_0x43367e(0x291)](_0x161548)[_0x43367e(0x296)]({'downloads':firebase['firestore']['FieldValue'][_0x43367e(0x1df)](0x1)}),await db[_0x43367e(0x1e8)](_0x43367e(0x279))[_0x43367e(0x291)](currentUser[_0x43367e(0x238)])[_0x43367e(0x296)]({'booksDownloaded':firebase['firestore'][_0x43367e(0x2d6)]['increment'](0x1)});}catch(_0x11a7f4){console['error']('Error\x20updating\x20download\x20count:',_0x11a7f4);}});});}function setupBookApprovalListener(){const _0x412097=_0x16d062;if(!currentUser)return;db[_0x412097(0x1e8)](_0x412097(0x317))['where'](_0x412097(0x2fa),'==',currentUser[_0x412097(0x238)])[_0x412097(0x2b4)](_0x412097(0x29f),'in',[_0x412097(0x321),_0x412097(0x248)])['onSnapshot'](_0x422b27=>{const _0x180808=_0x412097;_0x422b27[_0x180808(0x1e1)]()['forEach'](_0x5ea34d=>{const _0x3fa1c1=_0x180808,_0x511080=_0x5ea34d[_0x3fa1c1(0x291)][_0x3fa1c1(0x21c)](),_0x2274e9=_0x5ea34d[_0x3fa1c1(0x291)]['id'];if(_0x5ea34d[_0x3fa1c1(0x249)]===_0x3fa1c1(0x241)&&_0x511080[_0x3fa1c1(0x29f)]==='approved'){const _0x35be9d=JSON['parse'](localStorage[_0x3fa1c1(0x26d)]('processedApprovals')||'{}');!_0x35be9d[_0x2274e9]&&db['collection'](_0x3fa1c1(0x32f))[_0x3fa1c1(0x291)](currentUser[_0x3fa1c1(0x238)])[_0x3fa1c1(0x296)]({'points':firebase['firestore']['FieldValue']['increment'](0x0)})[_0x3fa1c1(0x2e3)](()=>{const _0xdd5229=_0x3fa1c1;userData[_0xdd5229(0x263)]=userData[_0xdd5229(0x263)],userPoints[_0xdd5229(0x2cc)]=userData[_0xdd5229(0x263)],withdrawBtn[_0xdd5229(0x1e2)]=userData['points']<0x1f4,_0x35be9d[_0x2274e9]=!![],localStorage['setItem'](_0xdd5229(0x2a0),JSON['stringify'](_0x35be9d)),showToast(_0xdd5229(0x2c2),_0xdd5229(0x20b));});}});});}function showToast(_0x3993c4,_0x1e642c=_0x16d062(0x2fd)){const _0x59da10=_0x16d062,_0x4cb895=document[_0x59da10(0x2b8)]('div');_0x4cb895[_0x59da10(0x1dd)]='toast\x20'+_0x1e642c;let _0x578071='';switch(_0x1e642c){case _0x59da10(0x20b):_0x578071=_0x59da10(0x20a);break;case'error':_0x578071=_0x59da10(0x203);break;case _0x59da10(0x1f2):_0x578071=_0x59da10(0x250);break;default:_0x578071=_0x59da10(0x219);}_0x4cb895[_0x59da10(0x276)]=_0x59da10(0x2fc)+_0x578071+_0x59da10(0x2ad)+_0x3993c4+_0x59da10(0x325);const _0xaa8f97=_0x4cb895[_0x59da10(0x34d)](_0x59da10(0x223));_0xaa8f97[_0x59da10(0x234)]('click',()=>{_0x4cb895['remove']();}),document['body'][_0x59da10(0x2c0)](_0x4cb895),setTimeout(()=>{const _0xa592fd=_0x59da10;_0x4cb895[_0xa592fd(0x29c)]['add']('show');},0xa),setTimeout(()=>{const _0x6b72f6=_0x59da10;_0x4cb895[_0x6b72f6(0x29c)][_0x6b72f6(0x261)](_0x6b72f6(0x2c9)),setTimeout(()=>{_0x4cb895['remove']();},0x12c);},0x1388);}function _0x526e(_0x5d3309,_0x5536d0){const _0x5ad38b=_0x5ad3();return _0x526e=function(_0x526e38,_0x87c909){_0x526e38=_0x526e38-0x1dc;let _0x4d1db3=_0x5ad38b[_0x526e38];return _0x4d1db3;},_0x526e(_0x5d3309,_0x5536d0);}loginForm[_0x16d062(0x234)]('submit',async _0x1335f4=>{const _0x367873=_0x16d062;_0x1335f4[_0x367873(0x31b)]();const _0x3dc860=document[_0x367873(0x23c)](_0x367873(0x2dc)),_0x4f7187=document['getElementById'](_0x367873(0x20c));_0x3dc860['disabled']=!![],_0x4f7187[_0x367873(0x2ac)]['display']=_0x367873(0x30a);const _0x4a1b5d=document[_0x367873(0x23c)]('loginEmail')['value'],_0x55184f=document['getElementById'](_0x367873(0x2a8))['value'];try{await auth['signInWithEmailAndPassword'](_0x4a1b5d,_0x55184f),closeModal(loginModal),showToast('Logged\x20in\x20successfully!',_0x367873(0x20b));}catch(_0x203706){console[_0x367873(0x329)]('Login\x20error:',_0x203706),showToast(_0x367873(0x215)+_0x203706[_0x367873(0x1e4)],_0x367873(0x329));}finally{_0x3dc860[_0x367873(0x1e2)]=![],_0x4f7187[_0x367873(0x2ac)][_0x367873(0x2ed)]=_0x367873(0x1fe);}}),signupForm['addEventListener'](_0x16d062(0x306),async _0x48bf65=>{const _0x5f4348=_0x16d062;_0x48bf65[_0x5f4348(0x31b)]();const _0x26d0a=document['getElementById'](_0x5f4348(0x33e)),_0x29ff5a=document[_0x5f4348(0x23c)](_0x5f4348(0x31d));_0x26d0a[_0x5f4348(0x1e2)]=!![],_0x29ff5a[_0x5f4348(0x2ac)][_0x5f4348(0x2ed)]='inline-block';const _0x97bb04=document[_0x5f4348(0x23c)](_0x5f4348(0x23f))[_0x5f4348(0x236)],_0x3e0f4e=document['getElementById'](_0x5f4348(0x2b3))[_0x5f4348(0x236)],_0x147832=document['getElementById']('signupEmail')[_0x5f4348(0x236)],_0x5d8287=document['getElementById'](_0x5f4348(0x2cd))[_0x5f4348(0x236)],_0x10e54b=document[_0x5f4348(0x23c)]('signupBio')[_0x5f4348(0x236)];try{const _0x3abf0a=await auth[_0x5f4348(0x25f)](_0x147832,_0x5d8287);await db[_0x5f4348(0x1e8)](_0x5f4348(0x279))['doc'](_0x3abf0a[_0x5f4348(0x32f)][_0x5f4348(0x238)])['set']({'name':_0x97bb04,'username':_0x3e0f4e,'email':_0x147832,'bio':_0x10e54b,'createdAt':firebase[_0x5f4348(0x256)]['FieldValue'][_0x5f4348(0x22e)](),'booksShared':0x0,'booksDownloaded':0x0,'role':_0x5f4348(0x32f),'lastActive':firebase['firestore']['FieldValue']['serverTimestamp'](),'status':_0x5f4348(0x251)}),closeModal(signupModal),showToast(_0x5f4348(0x295),_0x5f4348(0x20b));}catch(_0xbcaa4e){console[_0x5f4348(0x329)](_0x5f4348(0x328),_0xbcaa4e),showToast('Signup\x20failed:\x20'+_0xbcaa4e[_0x5f4348(0x1e4)],_0x5f4348(0x329));}finally{_0x26d0a[_0x5f4348(0x1e2)]=![],_0x29ff5a['style'][_0x5f4348(0x2ed)]=_0x5f4348(0x1fe);}}),editProfileForm[_0x16d062(0x234)]('submit',async _0x23f7a2=>{const _0x4f96b3=_0x16d062;_0x23f7a2['preventDefault']();if(!currentUser)return;const _0x4252d3=document['getElementById'](_0x4f96b3(0x2ab)),_0x3c2306=document['getElementById'](_0x4f96b3(0x1ff));_0x4252d3[_0x4f96b3(0x1e2)]=!![],_0x3c2306['style']['display']=_0x4f96b3(0x30a);const _0x1a8e28=document[_0x4f96b3(0x23c)]('editProfileName')[_0x4f96b3(0x236)],_0x53df23=document[_0x4f96b3(0x23c)](_0x4f96b3(0x25e))[_0x4f96b3(0x236)],_0x346ba4=document[_0x4f96b3(0x23c)](_0x4f96b3(0x330))['value'];try{const _0x550243={'name':_0x1a8e28,'username':_0x53df23,'bio':_0x346ba4,'updatedAt':firebase[_0x4f96b3(0x256)][_0x4f96b3(0x2d6)]['serverTimestamp']()};await db['collection'](_0x4f96b3(0x279))[_0x4f96b3(0x291)](currentUser['uid'])[_0x4f96b3(0x296)](_0x550243),userData={...userData,..._0x550243},updateProfileUI(),closeModal(editProfileModal),openProfilePage(),showToast(_0x4f96b3(0x309),_0x4f96b3(0x20b));}catch(_0xd2b53c){console[_0x4f96b3(0x329)]('Error\x20updating\x20profile:',_0xd2b53c),showToast('Error\x20updating\x20profile:\x20'+_0xd2b53c[_0x4f96b3(0x1e4)],_0x4f96b3(0x329));}finally{_0x4252d3[_0x4f96b3(0x1e2)]=![],_0x3c2306[_0x4f96b3(0x2ac)][_0x4f96b3(0x2ed)]=_0x4f96b3(0x1fe);}}),logoutBtn[_0x16d062(0x234)]('click',async()=>{const _0x3c4b3b=_0x16d062;try{await auth[_0x3c4b3b(0x25a)](),closeProfilePage(),showToast('Logged\x20out\x20successfully',_0x3c4b3b(0x20b));}catch(_0x3b0ee5){console['error']('Logout\x20error:',_0x3b0ee5),showToast(_0x3c4b3b(0x316),'error');}});function updateTyping(){const _0x496561=_0x16d062;if(!currentUser)return;!isTyping&&(isTyping=!![],db[_0x496561(0x1e8)](_0x496561(0x233))[_0x496561(0x291)](currentUser[_0x496561(0x238)])['set']({'userId':currentUser[_0x496561(0x238)],'userName':userData?.['name']||_0x496561(0x27a),'typing':!![],'timestamp':firebase[_0x496561(0x256)]['FieldValue']['serverTimestamp']()})),lastTypingTime=Date[_0x496561(0x213)](),typingTimeout&&clearTimeout(typingTimeout),typingTimeout=setTimeout(()=>{const _0x44d52e=_0x496561,_0x5a32e3=Date[_0x44d52e(0x213)](),_0xdd2c53=_0x5a32e3-lastTypingTime;_0xdd2c53>=0x7d0&&isTyping&&(db[_0x44d52e(0x1e8)]('typing')['doc'](currentUser[_0x44d52e(0x238)])[_0x44d52e(0x285)]({'userId':currentUser[_0x44d52e(0x238)],'userName':userData?.['name']||'Anonymous','typing':![],'timestamp':firebase['firestore'][_0x44d52e(0x2d6)][_0x44d52e(0x22e)]()},{'merge':!![]}),isTyping=![]);},0x7d0);}function setupTypingListener(){const _0xb93409=_0x16d062;db[_0xb93409(0x1e8)](_0xb93409(0x233))[_0xb93409(0x2b4)](_0xb93409(0x233),'==',!![])[_0xb93409(0x2c7)](_0x2c77c7=>{const _0x303c17=_0xb93409,_0x57ec34=[];_0x2c77c7[_0x303c17(0x29d)](_0x9e93e1=>{const _0x93b37=_0x303c17;_0x9e93e1[_0x93b37(0x21c)]()[_0x93b37(0x214)]!==currentUser[_0x93b37(0x238)]&&_0x57ec34['push'](_0x9e93e1[_0x93b37(0x21c)]());}),_0x57ec34['length']>0x0?(typingIndicator[_0x303c17(0x29c)][_0x303c17(0x2ca)](_0x303c17(0x251)),typingIndicator[_0x303c17(0x276)]=_0x303c17(0x227)+_0x57ec34[0x0]['userName']+_0x303c17(0x311)):typingIndicator[_0x303c17(0x29c)][_0x303c17(0x261)]('active');});}sendMessageBtn[_0x16d062(0x234)](_0x16d062(0x2b2),async()=>{const _0x2a3779=_0x16d062,_0x197aee=chatInput[_0x2a3779(0x236)][_0x2a3779(0x27b)]();if(!_0x197aee||!currentUser)return;const _0x4c7193=_0x2a3779(0x2d4)+Date[_0x2a3779(0x213)](),_0x16693a=createMessageElement({'id':_0x4c7193,'text':_0x197aee,'senderId':currentUser[_0x2a3779(0x238)],'senderName':userData?.['name']||_0x2a3779(0x27a),'status':_0x2a3779(0x2e1),'createdAt':new Date()});chatMessages[_0x2a3779(0x2c0)](_0x16693a),chatInput[_0x2a3779(0x236)]='',chatInput['style'][_0x2a3779(0x2f5)]='auto',sendMessageBtn[_0x2a3779(0x1e2)]=!![],chatMessages['scrollTop']=chatMessages[_0x2a3779(0x2b0)];try{const _0x17c790=await db[_0x2a3779(0x1e8)]('messages')[_0x2a3779(0x2ca)]({'text':_0x197aee,'senderId':currentUser[_0x2a3779(0x238)],'senderName':userData?.[_0x2a3779(0x352)]||_0x2a3779(0x27a),'createdAt':firebase['firestore'][_0x2a3779(0x2d6)][_0x2a3779(0x22e)](),'status':_0x2a3779(0x26c)}),_0x50241d=document[_0x2a3779(0x23c)](_0x4c7193);if(_0x50241d){_0x50241d['id']=_0x17c790['id'];const _0x5d1b10=_0x50241d[_0x2a3779(0x34d)](_0x2a3779(0x315));_0x5d1b10&&(_0x5d1b10[_0x2a3779(0x2cc)]='‚úì',_0x5d1b10[_0x2a3779(0x29c)][_0x2a3779(0x2ca)]('sent'));}}catch(_0x55fe05){console['error'](_0x2a3779(0x22c),_0x55fe05);const _0xfde1e7=document[_0x2a3779(0x23c)](_0x4c7193);_0xfde1e7&&(_0xfde1e7[_0x2a3779(0x34d)](_0x2a3779(0x315))[_0x2a3779(0x2cc)]='‚úï');}});function createMessageElement(_0x59f756){const _0x927205=_0x16d062,_0x28b464=_0x59f756[_0x927205(0x31e)]===currentUser?.['uid'],_0x4b8d93=_0x59f756[_0x927205(0x294)][_0x927205(0x27c)]?formatTime(_0x59f756[_0x927205(0x294)]['toDate']()):formatTime(new Date(_0x59f756['createdAt'])),_0x574916=document[_0x927205(0x2b8)]('div');return _0x574916[_0x927205(0x1dd)]=_0x927205(0x29e)+(_0x28b464?'sent':_0x927205(0x272)),_0x574916['id']=_0x59f756['id'],_0x574916['innerHTML']=_0x927205(0x239)+(!_0x28b464?_0x927205(0x2bb)+_0x59f756[_0x927205(0x2aa)]+_0x927205(0x24f):'')+_0x927205(0x25d)+_0x59f756['text']+_0x927205(0x2c4)+_0x4b8d93+_0x927205(0x255)+(_0x28b464?_0x927205(0x264)+(_0x59f756[_0x927205(0x29f)]||_0x927205(0x26c))+'\x22>'+(_0x59f756[_0x927205(0x29f)]===_0x927205(0x2e1)?'...':'‚úì')+_0x927205(0x20f):'')+_0x927205(0x24e),_0x574916;}function formatTime(_0x3431eb){const _0x29fe9a=_0x16d062;return _0x3431eb[_0x29fe9a(0x2d2)]([],{'hour':'2-digit','minute':_0x29fe9a(0x353)});}chatInput['addEventListener'](_0x16d062(0x2f2),_0xc622ec=>{const _0x273e1e=_0x16d062;_0xc622ec[_0x273e1e(0x1ec)]===_0x273e1e(0x2b5)&&!_0xc622ec[_0x273e1e(0x1f9)]&&(_0xc622ec[_0x273e1e(0x31b)](),sendMessageBtn[_0x273e1e(0x2b2)]()),updateTyping();});function updateProfileUI(){const _0x440599=_0x16d062;if(!currentUser||!userData){profileName[_0x440599(0x2cc)]=_0x440599(0x2e9),profileUsername[_0x440599(0x2cc)]='@username',profileEmail[_0x440599(0x2cc)]=_0x440599(0x2d5),profileBio[_0x440599(0x2cc)]=_0x440599(0x242),booksShared[_0x440599(0x2cc)]='0',booksDownloaded[_0x440599(0x2cc)]='0',memberSince[_0x440599(0x2cc)]='-',avatarInitials[_0x440599(0x2cc)]='U',profileAvatarInitials['textContent']='U',userPoints[_0x440599(0x2cc)]='0',withdrawBtn[_0x440599(0x1e2)]=!![];return;}profileName[_0x440599(0x2cc)]=userData[_0x440599(0x352)]||_0x440599(0x303),profileUsername[_0x440599(0x2cc)]='@'+(userData[_0x440599(0x216)]||_0x440599(0x32f)),profileEmail[_0x440599(0x276)]=_0x440599(0x2f6)+currentUser[_0x440599(0x252)],profileBio[_0x440599(0x2cc)]=userData[_0x440599(0x237)]||'No\x20bio\x20available.\x20Edit\x20your\x20profile\x20to\x20add\x20one.',booksShared[_0x440599(0x2cc)]=userData[_0x440599(0x34b)]||'0',booksDownloaded[_0x440599(0x2cc)]=userData[_0x440599(0x21e)]||'0',userPoints[_0x440599(0x2cc)]=userData[_0x440599(0x263)],withdrawBtn['disabled']=!userData[_0x440599(0x263)]||userData[_0x440599(0x263)]<0x1f4;const _0x5ac342=userData[_0x440599(0x352)]?userData[_0x440599(0x352)][_0x440599(0x32b)]('\x20')[_0x440599(0x2e0)](_0x2359d9=>_0x2359d9[0x0])['join']('')[_0x440599(0x298)]():'U';avatarInitials[_0x440599(0x2cc)]=_0x5ac342,profileAvatarInitials[_0x440599(0x2cc)]=_0x5ac342;if(userData['createdAt']){const _0xddd5be=userData['createdAt'][_0x440599(0x27c)]?userData[_0x440599(0x294)]['toDate']():new Date(userData[_0x440599(0x294)]);memberSince[_0x440599(0x2cc)]=_0xddd5be['getFullYear']();}else memberSince['textContent']='-';fetchWithdrawalHistory();}function fetchWithdrawalHistory(){const _0x107d4f=_0x16d062;if(!currentUser)return;db[_0x107d4f(0x1e8)](_0x107d4f(0x343))['where'](_0x107d4f(0x214),'==',currentUser[_0x107d4f(0x238)])[_0x107d4f(0x2e4)]('requestedAt','desc')[_0x107d4f(0x2c7)](_0x413d64=>{const _0x4dfefe=_0x107d4f;if(_0x413d64[_0x4dfefe(0x30c)]){emptyWithdrawalHistory[_0x4dfefe(0x2ac)]['display']=_0x4dfefe(0x2e2);return;}emptyWithdrawalHistory[_0x4dfefe(0x2ac)]['display']=_0x4dfefe(0x1fe),withdrawalHistory[_0x4dfefe(0x276)]=_0x4dfefe(0x224),_0x413d64['forEach'](_0x5aeb44=>{const _0x1a595e=_0x4dfefe,_0x46a4cc=_0x5aeb44[_0x1a595e(0x21c)](),_0x4c4a37=document[_0x1a595e(0x2b8)](_0x1a595e(0x221));_0x4c4a37[_0x1a595e(0x1dd)]=_0x1a595e(0x1dc);const _0x1b7b71=_0x46a4cc['status']===_0x1a595e(0x2fb)?_0x1a595e(0x302):_0x46a4cc[_0x1a595e(0x29f)]===_0x1a595e(0x248)?_0x1a595e(0x287):'status-pending';_0x4c4a37[_0x1a595e(0x276)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-amount\x22>‚Çπ'+_0x46a4cc[_0x1a595e(0x2d8)]+'\x20('+_0x46a4cc[_0x1a595e(0x26a)]+_0x1a595e(0x274)+_0x46a4cc[_0x1a595e(0x33a)]+'\x20‚Ä¢\x20'+_0x46a4cc[_0x1a595e(0x320)]+_0x1a595e(0x292)+formatDate(_0x46a4cc[_0x1a595e(0x334)][_0x1a595e(0x27c)]())+_0x1a595e(0x284)+_0x1b7b71+'\x22>'+_0x46a4cc[_0x1a595e(0x29f)]+_0x1a595e(0x351),withdrawalHistory['appendChild'](_0x4c4a37);});});}withdrawalOptions['forEach'](_0x1bcb7f=>{const _0x55f31a=_0x16d062;_0x1bcb7f[_0x55f31a(0x234)](_0x55f31a(0x2b2),()=>{const _0x56ad49=_0x55f31a;withdrawalOptions[_0x56ad49(0x29d)](_0x5a4d56=>_0x5a4d56['classList']['remove'](_0x56ad49(0x251))),_0x1bcb7f[_0x56ad49(0x29c)][_0x56ad49(0x2ca)](_0x56ad49(0x251)),selectedWithdrawalMethod=_0x1bcb7f['getAttribute']('data-method');switch(selectedWithdrawalMethod){case _0x56ad49(0x21f):paymentMethodLabel[_0x56ad49(0x2cc)]='UPI\x20ID',paymentId['placeholder']=_0x56ad49(0x1ed);break;case _0x56ad49(0x28b):paymentMethodLabel[_0x56ad49(0x2cc)]=_0x56ad49(0x282),paymentId[_0x56ad49(0x20e)]=_0x56ad49(0x206);break;case'paytm':paymentMethodLabel[_0x56ad49(0x2cc)]=_0x56ad49(0x346),paymentId[_0x56ad49(0x20e)]='Enter\x20your\x20Paytm\x20registered\x20number';break;case'phonepay':paymentMethodLabel['textContent']=_0x56ad49(0x209),paymentId[_0x56ad49(0x20e)]=_0x56ad49(0x2a5);break;}selectedWithdrawalAmount&&paymentDetails[_0x56ad49(0x29c)]['add'](_0x56ad49(0x251));});}),amountOptions[_0x16d062(0x29d)](_0x4ff1b7=>{const _0x5b8d81=_0x16d062;_0x4ff1b7[_0x5b8d81(0x234)]('click',()=>{const _0x240fd5=_0x5b8d81;amountOptions[_0x240fd5(0x29d)](_0x556fa9=>_0x556fa9[_0x240fd5(0x29c)][_0x240fd5(0x261)](_0x240fd5(0x251))),_0x4ff1b7[_0x240fd5(0x29c)][_0x240fd5(0x2ca)](_0x240fd5(0x251)),selectedWithdrawalAmount=_0x4ff1b7['getAttribute']('data-amount'),selectedWithdrawalRs=_0x4ff1b7[_0x240fd5(0x2f0)](_0x240fd5(0x229)),selectedWithdrawalMethod&&paymentDetails[_0x240fd5(0x29c)]['add'](_0x240fd5(0x251));});}),submitWithdrawalBtn['addEventListener'](_0x16d062(0x2b2),async()=>{const _0x33d104=_0x16d062;if(!currentUser||!userData||!selectedWithdrawalMethod||!selectedWithdrawalAmount||!paymentId[_0x33d104(0x236)]||!accountName[_0x33d104(0x236)]){showToast('Please\x20fill\x20all\x20the\x20details',_0x33d104(0x329));return;}if(userData[_0x33d104(0x263)]<parseInt(selectedWithdrawalAmount)){showToast(_0x33d104(0x2a7),_0x33d104(0x329));return;}const _0x1e8dfb=document[_0x33d104(0x23c)](_0x33d104(0x22a));submitWithdrawalBtn['disabled']=!![],_0x1e8dfb['style']['display']='inline-block';try{await db['collection'](_0x33d104(0x343))[_0x33d104(0x2ca)]({'userId':currentUser[_0x33d104(0x238)],'userName':userData['name'],'userEmail':currentUser[_0x33d104(0x252)],'method':selectedWithdrawalMethod,'paymentId':paymentId[_0x33d104(0x236)],'accountName':accountName[_0x33d104(0x236)],'amountPoints':parseInt(selectedWithdrawalAmount),'amountRs':parseInt(selectedWithdrawalRs),'status':_0x33d104(0x29b),'requestedAt':firebase[_0x33d104(0x256)][_0x33d104(0x2d6)]['serverTimestamp'](),'processedAt':null,'processedBy':null}),await db[_0x33d104(0x1e8)](_0x33d104(0x279))[_0x33d104(0x291)](currentUser['uid'])[_0x33d104(0x296)]({'points':firebase[_0x33d104(0x256)]['FieldValue'][_0x33d104(0x1df)](-parseInt(selectedWithdrawalAmount))}),userData[_0x33d104(0x263)]-=parseInt(selectedWithdrawalAmount),userPoints[_0x33d104(0x2cc)]=userData[_0x33d104(0x263)],withdrawBtn[_0x33d104(0x1e2)]=userData['points']<0x1f4,closeModal(withdrawalModal),showToast('Withdrawal\x20request\x20submitted\x20successfully!',_0x33d104(0x20b)),withdrawalOptions[_0x33d104(0x29d)](_0x69f3dc=>_0x69f3dc['classList'][_0x33d104(0x261)]('active')),amountOptions[_0x33d104(0x29d)](_0xe02586=>_0xe02586[_0x33d104(0x29c)][_0x33d104(0x261)](_0x33d104(0x251))),paymentDetails['classList']['remove'](_0x33d104(0x251)),paymentId[_0x33d104(0x236)]='',accountName[_0x33d104(0x236)]='',selectedWithdrawalMethod=null,selectedWithdrawalAmount=null,selectedWithdrawalRs=null;}catch(_0x53b503){console[_0x33d104(0x329)](_0x33d104(0x27d),_0x53b503),showToast(_0x33d104(0x299),'error');}finally{submitWithdrawalBtn['disabled']=![],_0x1e8dfb['style']['display']=_0x33d104(0x1fe);}}),withdrawBtn[_0x16d062(0x234)](_0x16d062(0x2b2),()=>{const _0x1ee903=_0x16d062;if(!currentUser){openModal(loginModal);return;}if(userData['points']<0x1f4){showToast(_0x1ee903(0x2e8),_0x1ee903(0x329));return;}openModal(withdrawalModal);}),closeWithdrawalModal[_0x16d062(0x234)](_0x16d062(0x2b2),()=>closeModal(withdrawalModal));function renderBooks(_0x2e5527){const _0x3e608c=_0x16d062;allBooks=_0x2e5527;if(_0x2e5527[_0x3e608c(0x258)]===0x0){emptyState[_0x3e608c(0x2ac)][_0x3e608c(0x2ed)]=_0x3e608c(0x2e2),booksContainer[_0x3e608c(0x276)]='',booksContainer[_0x3e608c(0x2c0)](emptyState);return;}emptyState['style'][_0x3e608c(0x2ed)]=_0x3e608c(0x1fe),booksContainer[_0x3e608c(0x276)]='',_0x2e5527[_0x3e608c(0x29d)]((_0x596aea,_0x4868b9)=>{const _0x11b901=_0x3e608c,_0x4ce02a=document[_0x11b901(0x2b8)](_0x11b901(0x221));_0x4ce02a[_0x11b901(0x1dd)]=_0x11b901(0x336),_0x4ce02a[_0x11b901(0x324)](_0x11b901(0x271),_0x596aea['id']),_0x4ce02a[_0x11b901(0x2ac)][_0x11b901(0x2f7)]=_0x4868b9*0.1+'s';let _0x581d9c='';if(_0x596aea[_0x11b901(0x29f)]==='approved'&&_0x596aea[_0x11b901(0x28f)]&&_0x596aea[_0x11b901(0x335)]){const _0x42dd0f=_0x596aea['reviewedAt'][_0x11b901(0x27c)]();_0x581d9c='Approved\x20by\x20'+_0x596aea[_0x11b901(0x28f)]+_0x11b901(0x1e6)+formatDate(_0x42dd0f);}else{if(_0x596aea[_0x11b901(0x29f)]===_0x11b901(0x248)&&_0x596aea[_0x11b901(0x28f)]&&_0x596aea[_0x11b901(0x335)]){const _0x2a8a6c=_0x596aea[_0x11b901(0x335)][_0x11b901(0x27c)]();_0x581d9c=_0x11b901(0x269)+_0x596aea['reviewedBy']+'\x20on\x20'+formatDate(_0x2a8a6c);}}_0x4ce02a['innerHTML']=_0x11b901(0x25c)+(_0x596aea[_0x11b901(0x2c5)]||'https://via.placeholder.com/300x200?text=No+Cover')+_0x11b901(0x267)+_0x596aea[_0x11b901(0x34c)]+'\x22\x20class=\x22book-img\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22book-overlay-title\x22>'+_0x596aea[_0x11b901(0x34c)]+_0x11b901(0x228)+_0x596aea[_0x11b901(0x2ae)]+_0x11b901(0x313)+(_0x596aea['description']?_0x11b901(0x270)+_0x596aea['description']+_0x11b901(0x23b):'')+_0x11b901(0x257)+_0x596aea['driveLink']+_0x11b901(0x27e)+(_0x596aea[_0x11b901(0x29f)]===_0x11b901(0x29b)?_0x11b901(0x290):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x596aea[_0x11b901(0x29f)]===_0x11b901(0x248)?_0x11b901(0x327):'')+_0x11b901(0x201)+(_0x596aea[_0x11b901(0x29f)]===_0x11b901(0x321)?_0x11b901(0x2a1):'')+_0x11b901(0x24d)+_0x596aea[_0x11b901(0x34c)]+_0x11b901(0x1f7)+_0x596aea[_0x11b901(0x2ae)]+_0x11b901(0x33f)+(_0x596aea[_0x11b901(0x265)]||'Anonymous')+_0x11b901(0x259)+(_0x596aea['submittedAt']?formatDate(_0x596aea[_0x11b901(0x2dd)][_0x11b901(0x27c)]()):'N/A')+_0x11b901(0x2f8)+(_0x581d9c?'<div\x20class=\x22book-admin-info\x22><i\x20class=\x22fas\x20fa-user-shield\x22></i>\x20'+_0x581d9c+_0x11b901(0x24f):'')+_0x11b901(0x1ee)+_0x596aea[_0x11b901(0x2ba)]+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-download\x22></i>\x20Download\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',booksContainer[_0x11b901(0x2c0)](_0x4ce02a);}),document['querySelectorAll'](_0x3e608c(0x2ee))[_0x3e608c(0x29d)](_0x217a5e=>{const _0x569573=_0x3e608c;_0x217a5e['addEventListener'](_0x569573(0x2b2),_0x2f38d3=>{const _0x2506ad=_0x569573;if(!currentUser){openModal(loginModal);return;}const _0x55dab7=_0x2f38d3['currentTarget'][_0x2506ad(0x2f0)](_0x2506ad(0x2ef));window[_0x2506ad(0x2df)](_0x55dab7,_0x2506ad(0x1f0));if(currentUser){db[_0x2506ad(0x1e8)](_0x2506ad(0x279))[_0x2506ad(0x291)](currentUser[_0x2506ad(0x238)])['update']({'booksDownloaded':firebase[_0x2506ad(0x256)][_0x2506ad(0x2d6)][_0x2506ad(0x1df)](0x1)});const _0x5d3c0d=_0x2f38d3[_0x2506ad(0x2c1)]['closest'](_0x2506ad(0x211))?.[_0x2506ad(0x2f0)](_0x2506ad(0x271));_0x5d3c0d&&db[_0x2506ad(0x1e8)]('books')['doc'](_0x5d3c0d)[_0x2506ad(0x296)]({'downloads':firebase['firestore'][_0x2506ad(0x2d6)][_0x2506ad(0x1df)](0x1)});}});});}function renderUserBooks(_0x4e0957){const _0x54999b=_0x16d062;if(_0x4e0957[_0x54999b(0x258)]===0x0){profileBooksContainer[_0x54999b(0x276)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22empty-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-book\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>No\x20Books\x20Shared\x20Yet</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Start\x20sharing\x20books\x20with\x20the\x20community!</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';return;}profileBooksContainer['innerHTML']='',_0x4e0957['forEach'](_0x4bf47a=>{const _0x364a92=_0x54999b,_0x51d11f=document[_0x364a92(0x2b8)](_0x364a92(0x221));_0x51d11f[_0x364a92(0x1dd)]='book-card',_0x51d11f['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-img-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x4bf47a['imageUrl']||_0x364a92(0x333))+_0x364a92(0x267)+_0x4bf47a[_0x364a92(0x34c)]+'\x22\x20class=\x22book-img\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22book-overlay-title\x22>'+_0x4bf47a[_0x364a92(0x34c)]+_0x364a92(0x228)+_0x4bf47a[_0x364a92(0x2ae)]+_0x364a92(0x313)+(_0x4bf47a[_0x364a92(0x293)]?_0x364a92(0x270)+_0x4bf47a[_0x364a92(0x293)]+_0x364a92(0x23b):'')+_0x364a92(0x257)+_0x4bf47a[_0x364a92(0x2ba)]+_0x364a92(0x275)+(_0x4bf47a['status']===_0x364a92(0x29b)?_0x364a92(0x290):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x4bf47a[_0x364a92(0x29f)]===_0x364a92(0x248)?_0x364a92(0x327):'')+_0x364a92(0x201)+(_0x4bf47a['status']==='approved'?_0x364a92(0x2a1):'')+_0x364a92(0x24d)+_0x4bf47a[_0x364a92(0x34c)]+_0x364a92(0x1f7)+_0x4bf47a[_0x364a92(0x2ae)]+_0x364a92(0x28e)+(_0x4bf47a[_0x364a92(0x2dd)]?formatDate(_0x4bf47a[_0x364a92(0x2dd)]['toDate']()):_0x364a92(0x1f3))+_0x364a92(0x204)+(_0x4bf47a[_0x364a92(0x243)]||0x0)+_0x364a92(0x2f8)+(_0x4bf47a['reviewedBy']?_0x364a92(0x339)+_0x4bf47a[_0x364a92(0x28f)]+'</div>':'')+_0x364a92(0x1ee)+_0x4bf47a[_0x364a92(0x2ba)]+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-external-link-alt\x22></i>\x20View\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',profileBooksContainer[_0x364a92(0x2c0)](_0x51d11f);}),document[_0x54999b(0x24a)](_0x54999b(0x2ee))[_0x54999b(0x29d)](_0xda4f2a=>{const _0x3f3c70=_0x54999b;_0xda4f2a[_0x3f3c70(0x234)](_0x3f3c70(0x2b2),_0x46c1bb=>{const _0x4dc8b1=_0x3f3c70,_0x579af1=_0x46c1bb['currentTarget']['getAttribute']('data-link');window['open'](_0x579af1,_0x4dc8b1(0x1f0));});});}function fetchUserBooks(){const _0xb54399=_0x16d062;if(!currentUser)return;const _0x4c8cc6=document['getElementById']('profileBooksContainer'),_0x95412e=document['getElementById'](_0xb54399(0x1fa));_0x4c8cc6[_0xb54399(0x276)]='',_0x95412e[_0xb54399(0x2ac)]['display']=_0xb54399(0x1fe);let _0x33b925=db[_0xb54399(0x1e8)]('books')[_0xb54399(0x2b4)](_0xb54399(0x2fa),'==',currentUser['uid'])[_0xb54399(0x2e4)](_0xb54399(0x2dd),_0xb54399(0x280))[_0xb54399(0x30b)](booksLimit);_0x33b925['get']()[_0xb54399(0x2e3)](_0x4f76c8=>{const _0x2f2edb=_0xb54399;if(_0x4f76c8['empty']){_0x4c8cc6['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22empty-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-book\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>No\x20Books\x20Shared\x20Yet</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Start\x20sharing\x20books\x20with\x20the\x20community!</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';return;}const _0x544797=[];_0x4f76c8[_0x2f2edb(0x29d)](_0x55ab49=>{const _0x594b0f=_0x2f2edb;_0x544797[_0x594b0f(0x220)]({'id':_0x55ab49['id'],..._0x55ab49[_0x594b0f(0x21c)]()});}),renderUserBooks(_0x544797),_0x4f76c8[_0x2f2edb(0x349)][_0x2f2edb(0x258)]===booksLimit?(lastBookSnapshot=_0x4f76c8[_0x2f2edb(0x349)][_0x4f76c8[_0x2f2edb(0x349)][_0x2f2edb(0x258)]-0x1],hasMoreBooks=!![],_0x95412e[_0x2f2edb(0x2ac)][_0x2f2edb(0x2ed)]=_0x2f2edb(0x1f6)):(hasMoreBooks=![],_0x95412e[_0x2f2edb(0x2ac)]['display']=_0x2f2edb(0x1fe));})[_0xb54399(0x2cf)](_0x462a59=>{const _0x14493a=_0xb54399;console[_0x14493a(0x329)]('Error\x20fetching\x20user\x20books:',_0x462a59);});}document['getElementById'](_0x16d062(0x1fa))[_0x16d062(0x234)](_0x16d062(0x2b2),()=>{const _0x370291=_0x16d062;if(!currentUser||!hasMoreBooks)return;const _0xa75e57=document[_0x370291(0x23c)]('profileBooksContainer'),_0x50c9fa=document['getElementById']('loadMoreBooksBtn');_0x50c9fa['disabled']=!![];let _0x4e5ace=db[_0x370291(0x1e8)](_0x370291(0x317))[_0x370291(0x2b4)](_0x370291(0x2fa),'==',currentUser[_0x370291(0x238)])[_0x370291(0x2e4)](_0x370291(0x2dd),_0x370291(0x280))['startAfter'](lastBookSnapshot)[_0x370291(0x30b)](booksLimit);_0x4e5ace[_0x370291(0x310)]()[_0x370291(0x2e3)](_0x9a6fad=>{const _0x2aadfa=_0x370291,_0x1c6677=[];_0x9a6fad['forEach'](_0x399141=>{const _0x336d27=_0x526e;_0x1c6677['push']({'id':_0x399141['id'],..._0x399141[_0x336d27(0x21c)]()});}),renderUserBooks(_0x1c6677,!![]),_0x9a6fad['docs'][_0x2aadfa(0x258)]===booksLimit?(lastBookSnapshot=_0x9a6fad['docs'][_0x9a6fad['docs'][_0x2aadfa(0x258)]-0x1],hasMoreBooks=!![]):(hasMoreBooks=![],_0x50c9fa[_0x2aadfa(0x2ac)][_0x2aadfa(0x2ed)]=_0x2aadfa(0x1fe)),_0x50c9fa[_0x2aadfa(0x1e2)]=![];})[_0x370291(0x2cf)](_0x287e39=>{const _0x27c5f5=_0x370291;console[_0x27c5f5(0x329)](_0x27c5f5(0x300),_0x287e39),_0x50c9fa['disabled']=![];});});function renderUserBooks(_0x2e4573,_0x35bc77=![]){const _0x4ab240=_0x16d062,_0x3b86ce=document[_0x4ab240(0x23c)](_0x4ab240(0x21b));!_0x35bc77&&(_0x3b86ce[_0x4ab240(0x276)]='');if(_0x2e4573[_0x4ab240(0x258)]===0x0&&!_0x35bc77){_0x3b86ce['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22empty-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-book\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>No\x20Books\x20Shared\x20Yet</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Start\x20sharing\x20books\x20with\x20the\x20community!</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';return;}_0x2e4573[_0x4ab240(0x29d)](_0x5d2bf0=>{const _0x12fbd7=_0x4ab240,_0x2c58bc=document[_0x12fbd7(0x2b8)]('div');_0x2c58bc[_0x12fbd7(0x1dd)]=_0x12fbd7(0x336),_0x2c58bc[_0x12fbd7(0x276)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-img-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x5d2bf0[_0x12fbd7(0x2c5)]||_0x12fbd7(0x333))+_0x12fbd7(0x267)+_0x5d2bf0[_0x12fbd7(0x34c)]+'\x22\x20class=\x22book-img\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22book-overlay-title\x22>'+_0x5d2bf0[_0x12fbd7(0x34c)]+_0x12fbd7(0x2a3)+_0x5d2bf0[_0x12fbd7(0x2ae)]+_0x12fbd7(0x268)+(_0x5d2bf0[_0x12fbd7(0x293)]?'<p\x20class=\x22book-overlay-desc\x22>'+_0x5d2bf0[_0x12fbd7(0x293)]+_0x12fbd7(0x23b):'')+_0x12fbd7(0x277)+_0x5d2bf0[_0x12fbd7(0x2ba)]+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-external-link-alt\x22></i>\x20View\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x5d2bf0[_0x12fbd7(0x29f)]===_0x12fbd7(0x29b)?'<span\x20class=\x22status-badge\x20status-pending\x22>Pending</span>':'')+_0x12fbd7(0x239)+(_0x5d2bf0[_0x12fbd7(0x29f)]==='rejected'?_0x12fbd7(0x327):'')+_0x12fbd7(0x239)+(_0x5d2bf0['status']==='approved'?_0x12fbd7(0x2a1):'')+_0x12fbd7(0x1de)+_0x5d2bf0[_0x12fbd7(0x34c)]+_0x12fbd7(0x2af)+_0x5d2bf0[_0x12fbd7(0x2ae)]+_0x12fbd7(0x1f5)+(_0x5d2bf0['submittedAt']?formatDate(_0x5d2bf0[_0x12fbd7(0x2dd)]['toDate']()):_0x12fbd7(0x1f3))+_0x12fbd7(0x2bf)+(_0x5d2bf0['downloads']||0x0)+_0x12fbd7(0x281)+(_0x5d2bf0[_0x12fbd7(0x28f)]?'<div\x20class=\x22book-admin-info\x22><i\x20class=\x22fas\x20fa-user-shield\x22></i>\x20Reviewed\x20by\x20'+_0x5d2bf0['reviewedBy']+_0x12fbd7(0x24f):'')+_0x12fbd7(0x2ec)+_0x5d2bf0['driveLink']+_0x12fbd7(0x22b),_0x3b86ce[_0x12fbd7(0x2c0)](_0x2c58bc);}),document[_0x4ab240(0x24a)]('.download-btn,\x20.book-overlay-btn')[_0x4ab240(0x29d)](_0x14d318=>{const _0x28eb26=_0x4ab240;_0x14d318['addEventListener'](_0x28eb26(0x2b2),_0x3424c9=>{const _0x4fee2e=_0x28eb26,_0x59a496=_0x3424c9['currentTarget'][_0x4fee2e(0x2f0)](_0x4fee2e(0x2ef));window[_0x4fee2e(0x2df)](_0x59a496,_0x4fee2e(0x1f0));});});}function formatDate(_0x28149d){const _0x22274f=_0x16d062,_0x512cda=_0x28149d['getDate']()[_0x22274f(0x2bd)]()[_0x22274f(0x345)](0x2,'0'),_0x3f80a1=(_0x28149d[_0x22274f(0x2eb)]()+0x1)[_0x22274f(0x2bd)]()[_0x22274f(0x345)](0x2,'0'),_0x472d1b=_0x28149d[_0x22274f(0x340)]();return _0x512cda+'/'+_0x3f80a1+'/'+_0x472d1b;}function fetchBooks(){const _0x256b62=_0x16d062;db[_0x256b62(0x1e8)]('books')[_0x256b62(0x2b4)](_0x256b62(0x29f),'==',_0x256b62(0x321))[_0x256b62(0x2e4)]('approvedAt',_0x256b62(0x280))[_0x256b62(0x2c7)](_0x2b3be3=>{const _0x17daac=[];_0x2b3be3['forEach'](_0x504d08=>{const _0x5732f0=_0x526e;_0x17daac[_0x5732f0(0x220)]({'id':_0x504d08['id'],..._0x504d08[_0x5732f0(0x21c)]()});}),renderBooks(_0x17daac);},_0x36f12e=>{const _0x1360f7=_0x256b62;console['error'](_0x1360f7(0x21a),_0x36f12e);});}auth[_0x16d062(0x217)](async _0x59481d=>{const _0xe70409=_0x16d062;currentUser=_0x59481d;if(_0x59481d){const _0x3c7a28=await db['collection']('users')['doc'](_0x59481d['uid'])[_0xe70409(0x310)]();userData=_0x3c7a28[_0xe70409(0x2b1)]?_0x3c7a28['data']():null,setupDownloadButtons(),setupBookApprovalListener();if(!_0x3c7a28[_0xe70409(0x2b1)]){const _0x13927e=_0x59481d['displayName']||'User',_0x24b3ed=_0x13927e[_0xe70409(0x32b)]('\x20')[_0xe70409(0x2e0)](_0x2fb2d3=>_0x2fb2d3[0x0])[_0xe70409(0x218)]('')['toUpperCase']();await db['collection'](_0xe70409(0x279))[_0xe70409(0x291)](_0x59481d[_0xe70409(0x238)])[_0xe70409(0x285)]({'name':_0x13927e,'email':_0x59481d[_0xe70409(0x252)],'username':_0x59481d[_0xe70409(0x252)]['split']('@')[0x0],'createdAt':firebase[_0xe70409(0x256)][_0xe70409(0x2d6)][_0xe70409(0x22e)](),'booksShared':0x0,'booksDownloaded':0x0,'points':0x0,'role':_0xe70409(0x32f),'lastActive':firebase[_0xe70409(0x256)][_0xe70409(0x2d6)]['serverTimestamp'](),'status':'active'}),userData={'name':_0x13927e,'email':_0x59481d[_0xe70409(0x252)],'username':_0x59481d[_0xe70409(0x252)][_0xe70409(0x32b)]('@')[0x0],'booksShared':0x0,'booksDownloaded':0x0,'points':0x0};}updateProfileUI(),fetchBooks(),setupTypingListener(),db[_0xe70409(0x1e8)](_0xe70409(0x2e7))[_0xe70409(0x2e4)](_0xe70409(0x294))[_0xe70409(0x30b)](0x32)['onSnapshot'](_0x591af2=>{const _0x53faeb=_0xe70409;chatMessages[_0x53faeb(0x1e9)][_0x53faeb(0x258)]===0x0&&(chatMessages['innerHTML']=''),_0x591af2['docChanges']()[_0x53faeb(0x29d)](_0x386617=>{const _0x2d7a81=_0x53faeb;if(_0x386617[_0x2d7a81(0x249)]===_0x2d7a81(0x1fc)){const _0x1db7fa=_0x386617['doc'][_0x2d7a81(0x21c)](),_0x5a3657=_0x1db7fa[_0x2d7a81(0x31e)]===_0x59481d['uid'];if(!document['getElementById'](_0x386617[_0x2d7a81(0x291)]['id'])){const _0x196fdd=createMessageElement({'id':_0x386617[_0x2d7a81(0x291)]['id'],..._0x1db7fa});chatMessages['appendChild'](_0x196fdd);const _0x2b108d=chatMessages['scrollHeight']-chatMessages[_0x2d7a81(0x344)]<=chatMessages[_0x2d7a81(0x1ea)]+0x32;(_0x2b108d||_0x5a3657)&&setTimeout(()=>{const _0x3626c7=_0x2d7a81;chatMessages['scrollTop']=chatMessages[_0x3626c7(0x2b0)];},0x32);}}else{if(_0x386617[_0x2d7a81(0x249)]===_0x2d7a81(0x241)){const _0x2f69de=document[_0x2d7a81(0x23c)](_0x386617[_0x2d7a81(0x291)]['id']);if(_0x2f69de){const _0x433ec2=_0x2f69de[_0x2d7a81(0x34d)](_0x2d7a81(0x315));_0x433ec2&&(_0x433ec2[_0x2d7a81(0x2cc)]='‚úì‚úì',_0x433ec2[_0x2d7a81(0x29c)][_0x2d7a81(0x2ca)](_0x2d7a81(0x318)));}}}});}),db['collection'](_0xe70409(0x279))['doc'](_0x59481d['uid'])[_0xe70409(0x296)]({'lastActive':firebase['firestore'][_0xe70409(0x2d6)][_0xe70409(0x22e)]()});}else userData=null,updateProfileUI();}),addBookForm[_0x16d062(0x234)](_0x16d062(0x306),async _0x28cad8=>{const _0x1a7309=_0x16d062;_0x28cad8[_0x1a7309(0x31b)]();if(!currentUser){showToast(_0x1a7309(0x29a),_0x1a7309(0x329));return;}const _0x2d354b=document[_0x1a7309(0x23c)](_0x1a7309(0x1e0)),_0x1e84c3=document[_0x1a7309(0x23c)]('submitSpinner');_0x2d354b[_0x1a7309(0x1e2)]=!![],_0x1e84c3[_0x1a7309(0x2ac)][_0x1a7309(0x2ed)]=_0x1a7309(0x30a);const _0x2dfe3c=document[_0x1a7309(0x23c)]('bookName')['value'],_0x2ca3c9=document['getElementById']('authorName')[_0x1a7309(0x236)],_0x2dc47f=document[_0x1a7309(0x23c)](_0x1a7309(0x262))[_0x1a7309(0x236)],_0x4de709=document[_0x1a7309(0x23c)](_0x1a7309(0x222))[_0x1a7309(0x236)],_0x1c7f27=document[_0x1a7309(0x23c)]('driveLink')[_0x1a7309(0x236)],_0x5acea0=document[_0x1a7309(0x23c)]('bookDescription')['value'];try{if(!_0x1c7f27[_0x1a7309(0x322)](_0x1a7309(0x2d7)))throw new Error(_0x1a7309(0x230));await db[_0x1a7309(0x1e8)](_0x1a7309(0x279))[_0x1a7309(0x291)](currentUser[_0x1a7309(0x238)])[_0x1a7309(0x296)]({'booksShared':firebase[_0x1a7309(0x256)][_0x1a7309(0x2d6)][_0x1a7309(0x1df)](0x0)}),userData['points']=userData[_0x1a7309(0x263)],booksShared[_0x1a7309(0x2cc)]=userData[_0x1a7309(0x34b)],userPoints[_0x1a7309(0x2cc)]=userData['points'],withdrawBtn[_0x1a7309(0x1e2)]=userData[_0x1a7309(0x263)]<0x1f4,addBookForm[_0x1a7309(0x297)](),closeModal(addBookModal);}catch(_0x6912b7){console[_0x1a7309(0x329)](_0x1a7309(0x2a2),_0x6912b7),showToast('Error:\x20'+_0x6912b7[_0x1a7309(0x1e4)],_0x1a7309(0x329));}finally{_0x2d354b['disabled']=![],_0x1e84c3[_0x1a7309(0x2ac)][_0x1a7309(0x2ed)]='none';}}),document[_0x16d062(0x24a)](_0x16d062(0x2ee))[_0x16d062(0x29d)](_0x2e95aa=>{const _0x43c6a2=_0x16d062;_0x2e95aa[_0x43c6a2(0x234)]('click',_0x111e72=>{const _0x5a13c0=_0x43c6a2;if(!currentUser){openModal(loginModal);return;}const _0x46d7b5=_0x111e72[_0x5a13c0(0x2c1)][_0x5a13c0(0x2f0)]('data-link');window['open'](_0x46d7b5,_0x5a13c0(0x1f0));if(currentUser){db[_0x5a13c0(0x1e8)](_0x5a13c0(0x279))[_0x5a13c0(0x291)](currentUser[_0x5a13c0(0x238)])[_0x5a13c0(0x296)]({'booksDownloaded':firebase[_0x5a13c0(0x256)][_0x5a13c0(0x2d6)][_0x5a13c0(0x1df)](0x0)});const _0x8a2b3d=_0x111e72[_0x5a13c0(0x2c1)][_0x5a13c0(0x245)](_0x5a13c0(0x211))?.['getAttribute'](_0x5a13c0(0x271));_0x8a2b3d&&(db[_0x5a13c0(0x1e8)]('books')[_0x5a13c0(0x291)](_0x8a2b3d)[_0x5a13c0(0x296)]({'downloads':firebase[_0x5a13c0(0x256)][_0x5a13c0(0x2d6)][_0x5a13c0(0x1df)](0x1)}),db['collection']('books')[_0x5a13c0(0x291)](_0x8a2b3d)['get']()[_0x5a13c0(0x2e3)](_0x33fb53=>{const _0x437ebf=_0x5a13c0;if(_0x33fb53['exists']){const _0x2905e6=_0x33fb53[_0x437ebf(0x21c)]()[_0x437ebf(0x2fa)];_0x2905e6&&_0x2905e6!==currentUser[_0x437ebf(0x238)]&&db[_0x437ebf(0x1e8)](_0x437ebf(0x279))[_0x437ebf(0x291)](_0x2905e6)['update']({'points':firebase[_0x437ebf(0x256)][_0x437ebf(0x2d6)][_0x437ebf(0x1df)](0x0)});}}));}});});!document[_0x16d062(0x2be)]['includes'](_0x16d062(0x232))&&!document[_0x16d062(0x2be)]['includes'](_0x16d062(0x289))&&!document[_0x16d062(0x2be)][_0x16d062(0x322)](_0x16d062(0x1f4))&&(window[_0x16d062(0x326)][_0x16d062(0x2b9)]=_0x16d062(0x2ff));
    </script>
</body>
</html>
