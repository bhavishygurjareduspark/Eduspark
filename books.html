<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduSparK - Share Knowledge</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
   
    <style>
        :root {
            --primary-color: #ff4757;
            --primary-light: #ff6b81;
            --primary-dark: #e84118;
            --secondary-color: #2f3542;
            --secondary-light: #57606f;
            --secondary-dark: #1e272e;
            --text-light: #f1f2f6;
            --text-dark: #2f3542;
            --text-muted: #747d8c;
            --bg-light: #ffffff;
            --bg-dark: #1e272e;
            --card-bg: #ffffff;
            --card-bg-dark: #2f3542;
            --gradient: linear-gradient(135deg, #ff4757, #2f3542);
            --gradient-light: linear-gradient(135deg, #ff6b81, #57606f);
            --gradient-dark: linear-gradient(135deg, #e84118, #1e272e);
            --message-sent-bg: linear-gradient(135deg, #ff4757, #ff6b81);
            --message-received-bg: #f1f2f6;
            --message-received-text: #2f3542;
            --typing-indicator-bg: #f1f2f6;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.1);
            --border-radius: 12px;
            --border-radius-sm: 8px;
            --border-radius-xs: 6px;
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            --transition-fast: all 0.15s ease;
            --header-height: 70px;
            --nav-height: 70px;
            --max-width: 1200px;
        }

        [data-theme="dark"] {
            --primary-color: #ff6b81;
            --primary-light: #ff8fa3;
            --primary-dark: #ff4757;
            --secondary-color: #1e272e;
            --secondary-light: #2f3542;
            --secondary-dark: #12181f;
            --text-light: #f1f2f6;
            --text-dark: #dfe4ea;
            --text-muted: #a4b0be;
            --bg-light: #2f3542;
            --bg-dark: #1e272e;
            --card-bg: #2f3542;
            --card-bg-dark: #1e272e;
            --gradient: linear-gradient(135deg, #ff6b81, #1e272e);
            --gradient-light: linear-gradient(135deg, #ff8fa3, #2f3542);
            --gradient-dark: linear-gradient(135deg, #ff4757, #12181f);
            --message-sent-bg: linear-gradient(135deg, #ff6b81, #ff4757);
            --message-received-bg: #1e272e;
            --message-received-text: #dfe4ea;
            --typing-indicator-bg: #1e272e;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.3);
            --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s, border-color 0.3s;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-light);
            color: var(--text-dark);
            min-height: 100vh;
            padding-top: var(--header-height);
            padding-bottom: var(--nav-height);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Enhanced Header with Glass Morphism */
        .header {
            background-color: rgba(47, 53, 66, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: var(--text-light);
            height: var(--header-height);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow-md);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            padding: 0 20px;
            transition: all 0.3s ease;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        [data-theme="dark"] .header {
            background-color: rgba(30, 39, 46, 0.95);
        }

        .header.scrolled {
            height: 60px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }

        .logo-container {
            display: flex;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            background: var(--gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            display: flex;
            align-items: center;
            text-decoration: none;
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
            padding: 5px 0;
        }

        .logo::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--gradient);
            transform-origin: right;
            transition: transform 0.3s ease;
        }

        .logo:hover {
            transform: scale(1.05);
        }

        .logo:hover::after {
            transform: scaleX(1);
            transform-origin: left;
        }

        .logo i {
            margin-right: 10px;
            font-size: 1.5rem;
            color: var(--primary-color);
        }

        .logo-text {
            display: inline-block;
            position: relative;
        }

        .logo-text::after {
            content: '‚ù§Ô∏è‚Äçüî•';
            position: absolute;
            right: -25px;
            top: -5px;
            font-size: 1.2rem;
            animation: pulse 1.5s infinite;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .search-container {
            position: relative;
            width: 250px;
            transition: all 0.3s ease;
        }

        .search-container.active {
            width: 300px;
        }

        .search-input {
            width: 100%;
            padding: 10px 15px 10px 40px;
            border: none;
            border-radius: 30px;
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--text-light);
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .search-input:focus {
            outline: none;
            background-color: rgba(255, 255, 255, 0.2);
            box-shadow: 0 0 0 2px var(--primary-color);
        }

        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
            opacity: 0.7;
            font-size: 1rem;
        }

        .search-results {
            position: absolute;
            top: calc(100% + 5px);
            left: 0;
            right: 0;
            background-color: var(--card-bg);
            border-radius: var(--border-radius-sm);
            box-shadow: var(--shadow-xl);
            max-height: 400px;
            overflow-y: auto;
            z-index: 1001;
            display: none;
            animation: fadeIn 0.3s ease;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] .search-results {
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .search-result-item {
            padding: 12px 15px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        [data-theme="dark"] .search-result-item {
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .search-result-item:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        [data-theme="dark"] .search-result-item:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .search-result-item h4 {
            font-size: 0.95rem;
            color: var(--text-dark);
            margin-bottom: 5px;
            font-weight: 500;
        }

        .search-result-item p {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .no-results {
            padding: 20px;
            text-align: center;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .theme-toggle {
            background: none;
            border: none;
            color: var(--text-light);
            font-size: 1.3rem;
            cursor: pointer;
            position: relative;
            width: 38px;
            height: 38px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: transform 0.5s ease, background-color 0.3s ease;
        }

        .theme-toggle:hover {
            transform: rotate(180deg) scale(1.1);
            background-color: rgba(255, 255, 255, 0.1);
        }

        .theme-toggle .sun {
            display: none;
            position: absolute;
        }

        .theme-toggle .moon {
            display: block;
            position: absolute;
        }

        [data-theme="dark"] .theme-toggle .sun {
            display: block;
        }

        [data-theme="dark"] .theme-toggle .moon {
            display: none;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary-color);
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--gradient);
            color: white;
            font-weight: 600;
            font-size: 1rem;
            position: relative;
            overflow: hidden;
        }

        .user-avatar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .user-avatar:hover {
            transform: scale(1.1);
            box-shadow: 0 0 0 3px var(--primary-light);
        }

        .user-avatar:hover::after {
            opacity: 1;
        }

        /* Bottom Navigation with Glass Morphism */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: rgba(47, 53, 66, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            display: flex;
            justify-content: space-around;
            align-items: center;
            height: var(--nav-height);
            z-index: 1000;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        [data-theme="dark"] .bottom-nav {
            background-color: rgba(30, 39, 46, 0.95);
        }

        .nav-item {
            color: var(--text-light);
            font-size: 1.3rem;
            padding: 10px;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 50%;
            background: var(--gradient);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: -1;
        }

        .nav-item:hover {
            transform: translateY(-5px);
            color: white;
        }

        .nav-item:hover::before {
            opacity: 1;
        }

        .nav-item.active {
            color: white;
            transform: translateY(-5px);
        }

        .nav-item.active::before {
            opacity: 1;
        }

        .nav-item.active::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 6px;
            height: 6px;
            background-color: var(--primary-color);
            border-radius: 50%;
            box-shadow: 0 0 10px var(--primary-color);
        }

        .notification-badge {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            animation: pulse 2s infinite;
            z-index: 1;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .add-btn {
            background: var(--gradient);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.7rem;
            transform: translateY(-20px);
            box-shadow: 0 6px 20px rgba(255, 71, 87, 0.4);
            transition: var(--transition);
            cursor: pointer;
            border: none;
            outline: none;
            z-index: 1001;
            position: relative;
            overflow: hidden;
        }

        .add-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .add-btn:hover {
            transform: translateY(-20px) scale(1.1);
            box-shadow: 0 8px 25px rgba(255, 71, 87, 0.6);
            background: var(--gradient-light);
            animation: none;
        }

        .add-btn:hover::after {
            opacity: 1;
        }

        @keyframes float {
            0%, 100% { transform: translateY(-20px); }
            50% { transform: translateY(-25px); }
        }

        /* Main Content */
        .container {
            padding: 20px;
            max-width: var(--max-width);
            margin: 0 auto;
        }

        .page-title {
            font-size: 2rem;
            margin-bottom: 20px;
            color: var(--primary-color);
            position: relative;
            display: inline-block;
            font-weight: 600;
            padding-bottom: 8px;
        }

        .page-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 4px;
            background: var(--gradient);
            border-radius: 4px;
            transform-origin: left;
            animation: scaleIn 0.5s ease-out forwards;
        }

        @keyframes scaleIn {
            from { transform: scaleX(0); }
            to { transform: scaleX(1); }
        }

        .books-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .book-card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow-md);
            transition: var(--transition);
            position: relative;
            border: 1px solid rgba(0, 0, 0, 0.1);
            transform: translateY(30px);
            opacity: 0;
            animation: cardAppear 0.6s ease forwards;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        [data-theme="dark"] .book-card {
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        @keyframes cardAppear {
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .book-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .book-img-container {
            height: 220px;
            overflow: hidden;
            position: relative;
            background-color: rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        [data-theme="dark"] .book-img-container {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .book-img {
            width: auto;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .book-card:hover .book-img {
            transform: scale(1.05);
        }

        .book-info {
            padding: 15px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .book-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-dark);
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .book-author {
            font-size: 0.85rem;
            color: var(--primary-color);
            margin-bottom: 12px;
            font-weight: 500;
        }

        .book-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .book-meta i {
            margin-right: 5px;
            color: var(--primary-color);
            font-size: 0.8rem;
        }

        .book-admin-info {
            font-size: 0.7rem;
            color: var(--text-muted);
            margin-top: auto;
            padding-top: 10px;
            border-top: 1px dashed rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        [data-theme="dark"] .book-admin-info {
            border-top: 1px dashed rgba(255, 255, 255, 0.1);
        }

        .book-admin-info i {
            color: var(--primary-color);
            font-size: 0.8rem;
        }

        .download-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: var(--border-radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            font-size: 0.85rem;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            margin-top: 10px;
        }

        .download-btn::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -60%;
            width: 40px;
            height: 200%;
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(30deg);
            transition: all 0.5s ease;
        }

        .download-btn:hover::after {
            left: 120%;
        }

        .download-btn i {
            margin-right: 8px;
            font-size: 0.8rem;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(255, 71, 87, 0.4);
            background: var(--gradient-light);
        }

        /* Enhanced Profile Page */
        .profile-page {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--bg-light);
            z-index: 2000;
            transform: translateX(100%);
            transition: transform 0.4s cubic-bezier(0.22, 1, 0.36, 1);
            overflow-y: auto;
            padding: 20px;
            opacity: 0;
            visibility: hidden;
        }

        .profile-page.active {
            transform: translateX(0);
            opacity: 1;
            visibility: visible;
        }

        .profile-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
            padding-top: 20px;
            text-align: center;
            position: relative;
        }

        .profile-back-btn {
            background: none;
            border: none;
            color: var(--primary-color);
            font-size: 1.3rem;
            position: absolute;
            left: 0;
            top: 0;
            cursor: pointer;
            transition: transform 0.3s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .profile-back-btn:hover {
            transform: translateX(-5px);
            background-color: rgba(255, 71, 87, 0.1);
        }

        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--primary-color);
            margin-bottom: 15px;
            background: var(--gradient);
            color: white;
            font-size: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            box-shadow: var(--shadow-md);
            position: relative;
            overflow: hidden;
        }

        .profile-avatar::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                to bottom right,
                rgba(255, 255, 255, 0.3),
                rgba(255, 255, 255, 0)
            );
            transform: rotate(30deg);
            transition: all 0.5s ease;
        }

        .profile-avatar:hover::before {
            transform: rotate(30deg) translateX(50%);
        }

        .profile-info {
            width: 100%;
            margin-top: 10px;
        }

        .profile-info h2 {
            font-size: 1.8rem;
            margin-bottom: 8px;
            color: var(--text-dark);
            position: relative;
            display: inline-block;
            font-weight: 600;
        }

        .profile-info h2::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 3px;
            background: var(--gradient);
            border-radius: 3px;
        }

        .profile-username {
            color: var(--primary-color);
            margin-bottom: 8px;
            font-size: 1.1rem;
            font-weight: 500;
        }

        .profile-email {
            color: var(--text-muted);
            margin-bottom: 15px;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .profile-email i {
            margin-right: 8px;
            font-size: 0.95rem;
        }

        .profile-bio {
            margin: 20px 0;
            color: var(--text-dark);
            line-height: 1.7;
            padding: 20px;
            background-color: rgba(0, 0, 0, 0.05);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--primary-color);
            font-size: 0.95rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        [data-theme="dark"] .profile-bio {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .profile-bio::before {
            content: '"';
            position: absolute;
            top: 10px;
            left: 15px;
            font-size: 3.5rem;
            color: var(--primary-color);
            opacity: 0.1;
            font-family: serif;
            line-height: 1;
        }

        .profile-bio::after {
            content: '"';
            position: absolute;
            bottom: -20px;
            right: 15px;
            font-size: 3.5rem;
            color: var(--primary-color);
            opacity: 0.1;
            font-family: serif;
            line-height: 1;
        }

        .profile-stats {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
            background: rgba(0, 0, 0, 0.05);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: hidden;
        }

        [data-theme="dark"] .profile-stats {
            background: rgba(255, 255, 255, 0.05);
        }

        .profile-stats::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--gradient);
        }

        .stat-item {
            text-align: center;
            padding: 10px;
            flex: 1;
            transition: transform 0.3s ease;
            position: relative;
        }

        .stat-item:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 50%;
            right: 0;
            transform: translateY(-50%);
            width: 1px;
            height: 40px;
            background-color: rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] .stat-item:not(:last-child)::after {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .stat-item:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 5px;
            position: relative;
            display: inline-block;
        }

        .stat-number::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 3px;
            background: var(--gradient);
            border-radius: 3px;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 500;
        }

        .profile-books-title {
            font-size: 1.6rem;
            margin: 30px 0 20px;
            color: var(--primary-color);
            position: relative;
            display: inline-block;
            text-align: center;
            width: 100%;
            font-weight: 600;
        }

        .profile-books-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: var(--gradient);
            border-radius: 3px;
        }

        .profile-actions {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            justify-content: center;
        }

        .edit-profile {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: var(--border-radius-sm);
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: var(--shadow-md);
            position: relative;
            overflow: hidden;
            flex: 1;
            max-width: 200px;
        }

        .edit-profile::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .edit-profile:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 71, 87, 0.5);
            background: var(--gradient-light);
        }

        .edit-profile:hover::after {
            opacity: 1;
        }

        .logout-btn {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: var(--border-radius-sm);
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: var(--shadow-md);
            position: relative;
            overflow: hidden;
            flex: 1;
            max-width: 200px;
        }

        .logout-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .logout-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(47, 53, 66, 0.3);
            background: var(--secondary-light);
        }

        .logout-btn:hover::after {
            opacity: 1;
        }

        /* Full Page Chat */
        .chat-page {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--bg-light);
            z-index: 2000;
            transform: translateX(100%);
            transition: transform 0.4s cubic-bezier(0.22, 1, 0.36, 1);
            display: flex;
            flex-direction: column;
            opacity: 0;
            visibility: hidden;
        }

        .chat-page.active {
            transform: translateX(0);
            opacity: 1;
            visibility: visible;
        }

        .chat-header {
            padding: 15px;
            background: var(--gradient);
            color: white;
            text-align: center;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            height: var(--header-height);
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
        }

        .chat-back-btn {
            position: absolute;
            left: 15px;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: transform 0.3s ease;
            background: none;
            border: none;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .chat-back-btn:hover {
            transform: translateX(-5px);
            background-color: rgba(255, 255, 255, 0.1);
        }

        .chat-title {
            font-size: 1.3rem;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background-color: var(--bg-light);
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            display: flex;
            flex-direction: column;
            max-width: 85%;
            opacity: 0;
            transform: translateY(10px);
            animation: messageAppear 0.4s forwards;
            animation-delay: 0.1s;
        }

        @keyframes messageAppear {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.sent {
            align-self: flex-end;
            align-items: flex-end;
        }

        .message.received {
            align-self: flex-start;
            align-items: flex-start;
        }

        .message-content {
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 1rem;
            line-height: 1.5;
            word-break: break-word;
            position: relative;
            transition: all 0.2s ease;
            box-shadow: var(--shadow-sm);
        }

        .message.sent .message-content {
            background: var(--message-sent-bg);
            color: white;
            border-top-right-radius: 5px;
        }

        .message.received .message-content {
            background-color: var(--message-received-bg);
            color: var(--message-received-text);
            border-top-left-radius: 5px;
        }

        .message-time {
            font-size: 0.75rem;
            color: var(--text-dark);
            opacity: 0.7;
            margin-top: 6px;
            align-self: flex-end;
        }

        .message.sent .message-time {
            color: rgba(255, 255, 255, 0.7);
        }

        .message-sender {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 6px;
        }

        .chat-input-container {
            display: flex;
            padding: 15px;
            background-color: var(--bg-light);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            align-items: center;
            box-shadow: 0 -2px 15px rgba(0, 0, 0, 0.05);
        }

        [data-theme="dark"] .chat-input-container {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            border: none;
            border-radius: 25px;
            font-family: 'Poppins', sans-serif;
            background-color: var(--typing-indicator-bg);
            color: var(--text-dark);
            outline: none;
            resize: none;
            max-height: 120px;
            overflow-y: auto;
            margin-right: 12px;
            font-size: 1rem;
            box-shadow: inset 0 1px 4px rgba(0, 0, 0, 0.1);
            transition: var(--transition);
        }

        [data-theme="dark"] .chat-input {
            box-shadow: inset 0 1px 4px rgba(0, 0, 0, 0.3);
        }

        .chat-input:focus {
            box-shadow: 0 0 0 2px rgba(255, 71, 87, 0.3), inset 0 1px 4px rgba(0, 0, 0, 0.1);
        }

        .send-btn {
            background: var(--gradient);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            flex-shrink: 0;
            font-size: 1.2rem;
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: hidden;
        }

        .send-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .send-btn:hover {
            transform: scale(1.1);
            background: var(--gradient-light);
            box-shadow: 0 4px 15px rgba(255, 71, 87, 0.5);
        }

        .send-btn:hover::after {
            opacity: 1;
        }

        .send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            background: var(--secondary-light);
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            background-color: var(--typing-indicator-bg);
            border-radius: 18px;
            margin-left: 20px;
            margin-bottom: 8px;
            align-self: flex-start;
            opacity: 0;
            transition: opacity 0.3s ease;
            font-size: 0.85rem;
            color: var(--text-muted);
            box-shadow: var(--shadow-sm);
        }

        .typing-indicator.active {
            opacity: 1;
        }

        .typing-indicator span {
            height: 7px;
            width: 7px;
            background-color: var(--primary-color);
            border-radius: 50%;
            display: inline-block;
            margin: 0 3px;
            animation: typingAnimation 1.4s infinite ease-in-out;
        }

        .typing-indicator span:nth-child(1) {
            animation-delay: 0s;
        }

        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typingAnimation {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-4px);
            }
        }

        /* Message status indicators */
        .message-status {
            display: inline-block;
            margin-left: 6px;
            font-size: 0.8rem;
        }

        .message-status.sent {
            color: rgba(255, 255, 255, 0.7);
        }

        .message-status.delivered {
            color: rgba(255, 255, 255, 0.9);
        }

        /* Message bubble tail effect */
        .message.sent .message-content::after {
            content: '';
            position: absolute;
            right: -6px;
            top: 0;
            width: 12px;
            height: 20px;
            background: var(--message-sent-bg);
            clip-path: polygon(0 0, 100% 0, 100% 100%);
        }

        .message.received .message-content::after {
            content: '';
            position: absolute;
            left: -6px;
            top: 0;
            width: 12px;
            height: 20px;
            background: var(--message-received-bg);
            clip-path: polygon(0 0, 100% 0, 0 100%);
        }

        /* Loading Spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-muted);
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--primary-color);
            opacity: 0.7;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-15px); }
            60% { transform: translateY(-8px); }
        }

        .empty-state h3 {
            margin-bottom: 12px;
            color: var(--text-dark);
            font-size: 1.4rem;
            font-weight: 600;
        }

        .empty-state p {
            font-size: 0.95rem;
            max-width: 350px;
            margin: 0 auto;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }

        .modal.active {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 450px;
            padding: 25px;
            box-shadow: var(--shadow-xl);
            transform: translateY(-30px);
            transition: transform 0.3s ease, opacity 0.3s ease;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] .modal-content {
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal.active .modal-content {
            transform: translateY(0);
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.7rem;
            color: var(--text-dark);
            cursor: pointer;
            background: none;
            border: none;
            transition: var(--transition);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close-modal:hover {
            color: var(--primary-color);
            transform: rotate(90deg);
            background-color: rgba(255, 71, 87, 0.1);
        }

        .modal-title {
            font-size: 1.7rem;
            margin-bottom: 20px;
            color: var(--primary-color);
            text-align: center;
            position: relative;
            padding-bottom: 12px;
            font-weight: 600;
        }

        .modal-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 4px;
            background: var(--gradient);
            border-radius: 4px;
        }

        .form-group {
            margin-bottom: 20px;
            position: relative;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-dark);
            font-size: 0.9rem;
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius-sm);
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-light);
            color: var(--text-dark);
            transition: var(--transition);
            font-size: 0.95rem;
        }

        [data-theme="dark"] .form-input {
            border-color: rgba(255, 255, 255, 0.2);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(255, 71, 87, 0.2);
        }

        .file-input-container {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }

        .file-input-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 12px 18px;
            border-radius: var(--border-radius-sm);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            width: 100%;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: hidden;
        }

        .file-input-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .file-input-btn:hover {
            background: var(--gradient-light);
        }

        .file-input-btn:hover::after {
            opacity: 1;
        }

        .file-input {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-name {
            margin-top: 8px;
            font-size: 0.85rem;
            color: var(--text-muted);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .submit-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 12px 18px;
            border-radius: var(--border-radius-sm);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            width: 100%;
            transition: var(--transition);
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: hidden;
        }

        .submit-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 71, 87, 0.5);
            background: var(--gradient-light);
        }

        .submit-btn:hover::after {
            opacity: 1;
        }

        .auth-switch {
            text-align: center;
            margin-top: 15px;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .auth-switch a {
            color: var(--primary-color);
            font-weight: 500;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .auth-switch a:hover {
            color: var(--primary-light);
            text-decoration: underline;
        }

        /* Discover Modal */
        .discover-list {
            max-height: 60vh;
            overflow-y: auto;
            padding-right: 10px;
        }

        .discover-item {
            display: flex;
            padding: 15px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            align-items: center;
            cursor: pointer;
            border-radius: var(--border-radius-sm);
            margin-bottom: 8px;
            background-color: rgba(0, 0, 0, 0.03);
        }

        [data-theme="dark"] .discover-item {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background-color: rgba(255, 255, 255, 0.03);
        }

        .discover-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .discover-item:hover {
            background-color: rgba(0, 0, 0, 0.05);
            transform: translateX(5px);
        }

        [data-theme="dark"] .discover-item:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .discover-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            flex-shrink: 0;
            font-size: 1.1rem;
            box-shadow: var(--shadow-sm);
        }

        .discover-content {
            flex: 1;
        }

        .discover-title {
            font-size: 1rem;
            color: var(--text-dark);
            margin-bottom: 5px;
            font-weight: 600;
        }

        .discover-description {
            font-size: 0.85rem;
            color: var(--text-muted);
            line-height: 1.5;
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            top: 25px;
            right: 25px;
            padding: 15px 20px;
            border-radius: var(--border-radius-sm);
            background-color: var(--secondary-color);
            color: white;
            box-shadow: var(--shadow-xl);
            transform: translateX(150%);
            transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 3000;
            display: flex;
            align-items: center;
            max-width: 350px;
            border-left: 5px solid var(--primary-color);
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            background-color: #27ae60;
            border-left-color: #2ecc71;
        }

        .toast.error {
            background-color: #e74c3c;
            border-left-color: #ff4757;
        }

        .toast.warning {
            background-color: #f39c12;
            border-left-color: #f1c40f;
        }

        .toast.info {
            background-color: #3498db;
            border-left-color: #2980b9;
        }

        .toast i {
            margin-right: 10px;
            font-size: 1.2rem;
        }

        .toast-close {
            margin-left: 15px;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.2s ease;
            font-size: 1rem;
        }

        .toast-close:hover {
            opacity: 1;
        }

        /* Book Status Badges */
        .status-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 4px 8px;
            border-radius: var(--border-radius-xs);
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            z-index: 1;
            box-shadow: var(--shadow-sm);
        }

        .status-approved {
            background-color: #27ae60;
            color: white;
        }

        .status-pending {
            background-color: #f39c12;
            color: white;
        }

        .status-rejected {
            background-color: #e74c3c;
            color: white;
        }

        /* Book Card Hover Overlay */
        .book-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease;
            padding: 15px;
            text-align: center;
            color: white;
        }

        .book-card:hover .book-overlay {
            opacity: 1;
        }

        .book-overlay-title {
            font-size: 1.1rem;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .book-overlay-author {
            font-size: 0.9rem;
            margin-bottom: 12px;
            color: rgba(255, 255, 255, 0.9);
        }

        .book-overlay-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: var(--border-radius-xs);
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 8px;
        }

        .book-overlay-btn:hover {
            background: var(--gradient-light);
            transform: translateY(-2px);
        }

        /* Responsive Styles */
        @media (max-width: 992px) {
            .container {
                padding: 20px;
            }
            
            .books-grid {
                grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
                gap: 15px;
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 0 15px;
            }

            .logo {
                font-size: 1.6rem;
            }

            .logo i {
                font-size: 1.3rem;
            }

            .search-container {
                width: 200px;
            }

            .search-container.active {
                width: 250px;
            }

            .books-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 15px;
            }
            
            .nav-item {
                font-size: 1.2rem;
                width: 45px;
                height: 45px;
            }
            
            .add-btn {
                width: 55px;
                height: 55px;
                font-size: 1.5rem;
            }

            .profile-info h2 {
                font-size: 1.6rem;
            }

            .profile-stats {
                flex-direction: column;
                gap: 12px;
            }

            .stat-item:not(:last-child)::after {
                display: none;
            }

            .stat-item {
                padding: 12px 0;
            }

            .chat-input {
                padding: 12px 15px;
            }

            .send-btn {
                width: 42px;
                height: 42px;
            }

            .book-img-container {
                height: 180px;
            }
        }

        @media (max-width: 576px) {
            .header {
                padding: 0 10px;
                height: var(--header-height);
                flex-direction: row;
                justify-content: space-between;
            }

            .logo {
                font-size: 1.5rem;
            }

            .logo i {
                font-size: 1.2rem;
            }

            .header-actions {
                gap: 10px;
            }

            .search-container {
                position: absolute;
                top: var(--header-height);
                left: 0;
                right: 0;
                width: 100%;
                margin: 0;
                padding: 10px;
                background-color: var(--secondary-color);
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
                z-index: 999;
                display: none;
            }

            [data-theme="dark"] .search-container {
                background-color: var(--secondary-dark);
            }

            .search-container.active {
                display: block;
                width: 100%;
            }

            .search-input {
                display: block;
                width: 100%;
                padding: 10px 15px 10px 40px;
                border-radius: var(--border-radius);
                background-color: var(--secondary-light);
            }

            .search-results {
                top: calc(100% + 10px);
                left: 10px;
                right: 10px;
                width: auto;
            }

            .books-grid {
                grid-template-columns: 1fr 1fr;
                gap: 12px;
            }

            .book-img-container {
                height: 150px;
            }

            .profile-info h2 {
                font-size: 1.5rem;
            }

            .profile-bio {
                padding: 15px;
                font-size: 0.9rem;
            }

            .stat-number {
                font-size: 1.6rem;
            }

            .chat-input-container {
                padding: 12px;
            }

            .chat-input {
                padding: 12px 15px;
                margin-right: 10px;
                font-size: 0.95rem;
            }

            .send-btn {
                width: 40px;
                height: 40px;
                font-size: 1.1rem;
            }

            .message-content {
                padding: 10px 14px;
                font-size: 0.95rem;
            }
            
            .modal-content {
                padding: 20px;
                width: 95%;
            }
            
            .modal-title {
                font-size: 1.5rem;
            }

            .profile-actions {
                flex-direction: column;
                gap: 10px;
            }

            .edit-profile, .logout-btn {
                max-width: 100%;
                width: 100%;
            }

            .profile-avatar {
                width: 100px;
                height: 100px;
                font-size: 2.2rem;
            }
        }

        @media (max-width: 400px) {
            .container {
                padding: 15px 10px;
            }
            
            .page-title {
                font-size: 1.7rem;
            }
            
            .books-grid {
                grid-template-columns: 1fr;
            }

            .profile-info h2 {
                font-size: 1.4rem;
            }
            
            .profile-bio {
                padding: 12px;
            }
            
            .chat-input {
                padding: 10px 14px;
                font-size: 0.9rem;
            }
            
            .modal-content {
                padding: 15px;
            }

            .profile-avatar {
                width: 90px;
                height: 90px;
                font-size: 2rem;
            }
            
            .profile-points {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
            background: var(--gradient);
            color: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
            align-items: center;
        }

        .points-info {
            text-align: center;
        }

        .points-amount {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .points-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .withdraw-btn {
            background: white;
            color: var(--primary-color);
            border: none;
            padding: 12px 25px;
            border-radius: var(--border-radius-sm);
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: var(--shadow-md);
        }

        .withdraw-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 255, 255, 0.3);
        }

        .withdraw-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .withdraw-btn i {
            font-size: 1.1rem;
        }

        /* Withdrawal Modal */
        .withdrawal-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }

        .withdrawal-option {
            display: flex;
            align-items: center;
            padding: 15px;
            border-radius: var(--border-radius-sm);
            background-color: rgba(0, 0, 0, 0.05);
            cursor: pointer;
            transition: var(--transition);
        }

        [data-theme="dark"] .withdrawal-option {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .withdrawal-option:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] .withdrawal-option:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .withdrawal-option.active {
            border: 2px solid var(--primary-color);
            background-color: rgba(255, 71, 87, 0.1);
        }

        .withdrawal-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            flex-shrink: 0;
            font-size: 1.1rem;
        }

        .withdrawal-details {
            flex: 1;
        }

        .withdrawal-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--text-dark);
        }

        .withdrawal-description {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .amount-selection {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .amount-option {
            padding: 12px;
            text-align: center;
            border-radius: var(--border-radius-sm);
            background-color: rgba(0, 0, 0, 0.05);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }

        [data-theme="dark"] .amount-option {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .amount-option:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] .amount-option:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .amount-option.active {
            background: var(--gradient);
            color: white;
        }

        .payment-details {
            margin-top: 20px;
            display: none;
        }

        .payment-details.active {
            display: block;
        }

        .withdrawal-history {
            margin-top: 30px;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            padding-top: 20px;
        }

        [data-theme="dark"] .withdrawal-history {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .withdrawal-history-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--primary-color);
            font-weight: 600;
        }

        .withdrawal-item {
            padding: 15px;
            margin-bottom: 10px;
            border-radius: var(--border-radius-sm);
            background-color: rgba(0, 0, 0, 0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        [data-theme="dark"] .withdrawal-item {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .withdrawal-info {
            flex: 1;
        }

        .withdrawal-amount {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .withdrawal-method {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-bottom: 5px;
        }

        .withdrawal-date {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .withdrawal-status {
            padding: 5px 10px;
            border-radius: var(--border-radius-xs);
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-pending {
            background-color: #f39c12;
            color: white;
        }

        .status-completed {
            background-color: #27ae60;
            color: white;
        }

        .status-rejected {
            background-color: #e74c3c;
            color: white;
        }

        /* Point System Info */
        .point-system-info {
            background-color: rgba(0, 0, 0, 0.05);
            border-radius: var(--border-radius);
            padding: 20px;
            margin: 20px 0;
        }

        [data-theme="dark"] .point-system-info {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .point-system-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--primary-color);
            font-weight: 600;
        }

        .point-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px dashed rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] .point-item {
            border-bottom: 1px dashed rgba(255, 255, 255, 0.1);
        }

        .point-item:last-child {
            border-bottom: none;
        }

        .point-action {
            font-weight: 500;
        }

        .point-value {
            color: var(--primary-color);
            font-weight: 600;
        }
        
        .load-more-btn {
    background: var(--gradient);
    color: white;
    border: none;
    padding: 12px 25px;
    border-radius: var(--border-radius-sm);
    font-size: 1rem;
    cursor: pointer;
    transition: var(--transition);
    font-weight: 500;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    box-shadow: var(--shadow-md);
    margin: 0 auto;
}

.load-more-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 20px rgba(255, 71, 87, 0.5);
    background: var(--gradient-light);
}

.load-more-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none !important;
}
        }
    </style>
</head>
<body data-theme="light">
    <!-- Header -->
    <header class="header">
        <div class="logo-container">
            <a href="#" class="logo" id="logoLink">
                <i class="fas fa-book-open"></i>
                <span>EduSparK</span>
            </a>
        </div>
        
        <div class="header-actions">
            <button class="theme-toggle">
                <i class="fas fa-sun sun"></i>
                <i class="fas fa-moon moon"></i>
            </button>
            
            <div class="user-avatar" id="userAvatar">
                <span id="avatarInitials">[^]</span>
            </div>
        </div>

        <div class="search-container" id="searchContainer">
            <i class="fas fa-search search-icon"></i>
            <input type="text" class="search-input" id="searchInput" placeholder="Search books...">
            <div class="search-results" id="searchResults"></div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <h1 class="page-title" data-aos="fade-right">Discover Books</h1>
        <div class="books-grid" id="booksContainer">
            <!-- Books will be dynamically added here -->
            <div class="empty-state" id="emptyState">
                <i class="fas fa-book-open"></i>
                <h3>No Books Available</h3>
                <p>Be the first to share a book with the community!</p>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <div class="nav-item" id="chatBtn">
            <i class="fas fa-comment-dots"></i>
        </div>
        <div class="nav-item active" id="homeBtn">
            <i class="fas fa-home"></i>
        </div>
        <button class="add-btn" id="addBookBtn">
            <i class="fas fa-plus"></i>
        </button>
        <div class="nav-item" id="discoverBtn">
            <i class="fas fa-compass"></i>
        </div>
        <div class="nav-item" id="profileBtn">
            <i class="fas fa-user"></i>
        </div>
    </nav>

    <!-- Full Page Profile -->
     <div class="profile-page" id="profilePage">
        <div class="profile-header">
            <button class="profile-back-btn" id="profileBackBtn">
                <i class="fas fa-arrow-left"></i>
            </button>
            <div class="profile-avatar" id="profileAvatar">
                <span id="profileAvatarInitials">U</span>
            </div>
            <div class="profile-info">
                <h2 id="profileName">User</h2>
                <br>
                <p class="profile-username" id="profileUsername">@username</p>
                <p class="profile-email" id="profileEmail"><i class="fas fa-envelope"></i> user@example.com</p>
            </div>
        </div>
        
        <div class="profile-bio" id="profileBio">
            No bio available. Edit your profile to add one.
        </div>
        
        <!-- Points Section -->
        <div class="profile-points">
            <div class="points-info">
                <div class="points-amount" id="userPoints">0</div>
                <div class="points-label">Points Earned</div>
            </div>
            <button class="withdraw-btn" id="withdrawBtn" disabled>
                <i class="fas fa-rupee-sign"></i> Withdraw
            </button>
        </div>

        <!-- Point System Info -->
        <div class="point-system-info">
            <h3 class="point-system-title">Point System</h3>
            <div class="point-item">
                <span class="point-action">Share a New book (2025-2026)</span>
                <span class="point-value">+10 points</span>
            </div>
            <div class="point-item">
                <span class="point-action">Share a Old book (2019-2024)</span>
                <span class="point-value">+5 points</span>
            </div>
            <div class="point-item">
                <span class="point-action">500 points</span>
                <span class="point-value">= ‚Çπ50</span>
            </div>
            <div class="point-item">
                <span class="point-action">1000 points</span>
                <span class="point-value">= ‚Çπ100</span>
            </div>
            <div class="point-item">
                <span class="point-action">2000 points</span>
                <span class="point-value">= ‚Çπ200</span>
            </div>
            <div class="point-item">
                <span class="point-action">5000 points</span>
                <span class="point-value">= ‚Çπ500</span>
            </div>
        </div>
        
        <div class="profile-stats">
            <div class="stat-item">
                <div class="stat-number" id="booksShared">0</div>
                <div class="stat-label">Books Shared</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="booksDownloaded">0</div>
                <div class="stat-label">Books Downloaded</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="memberSince">-</div>
                <div class="stat-label">Member Since</div>
            </div>
        </div>
        
        <div class="load-more-container" id="loadMoreContainer" style="text-align: center; margin-top: 20px;">
    <button class="load-more-btn" id="loadMoreBooksBtn" style="display: none;">
        <i class="fas fa-book-open"></i> Load More Books
    </button>
</div>
        <div class="books-grid" id="profileBooksContainer">
            <div class="empty-state">
                <i class="fas fa-book"></i>
                <h3>No Books Shared Yet</h3>
                <p>Start sharing books with the community!</p>
                
              
            </div>
              
        </div>

        <!-- Withdrawal History -->
        <div class="withdrawal-history" id="withdrawalHistory">
            <h3 class="withdrawal-history-title">Withdrawal History</h3>
            <div class="empty-state" id="emptyWithdrawalHistory">
                <i class="fas fa-wallet"></i>
                <h3>No Withdrawals Yet</h3>
                <p>Withdraw your points to see history here</p>
            </div>
        </div>
        
        <div class="profile-actions">
            <button class="edit-profile" id="editProfileBtn">
                <i class="fas fa-user-edit"></i> Edit Profile
            </button>
            <button class="logout-btn" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
        </div>
    </div>

    <!-- Full Page Chat -->
    <div class="chat-page" id="chatPage">
        <div class="chat-header">
            <button class="chat-back-btn" id="chatBackBtn">
                <i class="fas fa-arrow-left"></i>
            </button>
            <div class="chat-title">Live Chat</div>
        </div>
        
        <div class="chat-messages" id="chatMessages">
            <div class="empty-state">
                <i class="fas fa-comments"></i>
                <h3>No Messages Yet</h3>
                <p>Start the conversation with the community!</p>
            </div>
        </div>
        
        <div class="typing-indicator" id="typingIndicator">
            <span></span>
            <span></span>
            <span></span>
        </div>
        
        <div class="chat-input-container">
            <textarea id="chatInput" class="chat-input" placeholder="Type your message..." rows="1"></textarea>
            <button class="send-btn" id="sendMessageBtn" disabled>
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>
    
       <div class="modal" id="withdrawalModal">
        <div class="modal-content">
            <button class="close-modal" id="closeWithdrawalModal">&times;</button>
            <h2 class="modal-title">Withdraw Points</h2>
            
            <div class="withdrawal-options">
                <div class="withdrawal-option" data-method="upi">
                    <div class="withdrawal-icon">
                        <i class="fas fa-mobile-alt"></i>
                    </div>
                    <div class="withdrawal-details">
                        <div class="withdrawal-title">UPI</div>
                        <div class="withdrawal-description">Instant transfer to your UPI ID</div>
                    </div>
                </div>
                <div class="withdrawal-option" data-method="redeem">
    <div class="withdrawal-icon">
        <i class="fab fa-google-play"></i>
    </div>
    <div class="withdrawal-details">
        <div class="withdrawal-title">Redeem Code</div>
        <div class="withdrawal-description">Get Google Play gift card code</div>
    </div>
</div>
                <div class="withdrawal-option" data-method="bank">
                    <div class="withdrawal-icon">
                        <i class="fas fa-university"></i>
                    </div>
                    <div class="withdrawal-details">
                        <div class="withdrawal-title">Bank Account</div>
                        <div class="withdrawal-description">Transfer to your bank account</div>
                    </div>
                </div>
                <div class="withdrawal-option" data-method="paytm">
                    <div class="withdrawal-icon">
                        <i class="fab fa-paypal"></i>
                    </div>
                    <div class="withdrawal-details">
                        <div class="withdrawal-title">Paytm</div>
                        <div class="withdrawal-description">Transfer to your Paytm wallet</div>
                    </div>
                </div>
                <div class="withdrawal-option" data-method="phonepay">
                    <div class="withdrawal-icon">
                        <i class="fas fa-money-bill-wave"></i>
                    </div>
                    <div class="withdrawal-details">
                        <div class="withdrawal-title">PhonePe</div>
                        <div class="withdrawal-description">Transfer to your PhonePe account</div>
                    </div>
                </div>
            </div>
            
            <div class="amount-selection">
                <div class="amount-option" data-amount="500" data-rs="50">500 points = ‚Çπ50</div>
                <div class="amount-option" data-amount="1000" data-rs="100">1000 points = ‚Çπ100</div>
                <div class="amount-option" data-amount="2000" data-rs="200">2000 points = ‚Çπ200</div>
                <div class="amount-option" data-amount="5000" data-rs="500">5000 points = ‚Çπ500</div>
            </div>
            
            <div class="payment-details" id="paymentDetails">
                <div class="form-group">
                    <label id="paymentMethodLabel">UPI ID</label>
                    <input type="text" id="paymentId" class="form-input" placeholder="Enter your UPI ID" required>
                </div>
                <div class="form-group">
                    <label for="accountName">Account Holder Name</label>
                    <input type="text" id="accountName" class="form-input" placeholder="Enter account holder name" required>
                </div>
                <button type="button" class="submit-btn" id="submitWithdrawalBtn">
                    <span class="spinner" id="withdrawalSpinner" style="display: none;"></span>
                    Request Withdrawal
                </button>
            </div>
        </div>
    </div>

    <!-- Add Book Modal -->
    <div class="modal" id="addBookModal">
        <div class="modal-content">
            <button class="close-modal" id="closeAddBookModal">&times;</button>
            <h2 class="modal-title">Add New Book</h2>
            <form id="addBookForm">
                <div class="form-group">
                    <label for="bookName" class="form-label">Book Name</label>
                    <input type="text" id="bookName" class="form-input" placeholder="Enter book name" required>
                </div>
              
                <div class="form-group">
                    <label for="authorName" class="form-label">Author Name</label>
                    <input type="text" id="authorName" class="form-input" placeholder="Enter author name" required>
                </div>
                <div class="form-group">
                    <label for="bookCategory" class="form-label">Category</label>
                    <input type="text" id="bookCategory" class="form-input" placeholder="Enter book category (e.g., Fiction, Science)" required>
                </div>
                <div class="form-group">
                    <label for="bookImageUrl" class="form-label">Cover Image URL (Optional)</label>
                    <input type="url" id="bookImageUrl" class="form-input" placeholder="Enter image URL for book cover">
                </div>
                <div class="form-group">
                    <label for="driveLink" class="form-label">Google Drive Link</label>
                    <input type="url" id="driveLink" class="form-input" placeholder="Enter Google Drive link" required>
                </div>
                <div class="form-group">
                    <label for="bookDescription" class="form-label">Description (Optional)</label>
                    <textarea id="bookDescription" class="form-input" placeholder="Enter a brief description about the book" rows="3"></textarea>
                </div>
                <button type="submit" class="submit-btn" id="submitBookBtn">
                    <span class="spinner" id="submitSpinner" style="display: none;"></span>
                    Submit for Approval
                </button>
            </form>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <button class="close-modal" id="closeLoginModal">&times;</button>
            <h2 class="modal-title">Login to EduSparK</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label for="loginEmail" class="form-label">Email</label>
                    <input type="email" id="loginEmail" class="form-input" placeholder="Enter your email" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword" class="form-label">Password</label>
                    <input type="password" id="loginPassword" class="form-input" placeholder="Enter your password" required>
                </div>
                <button type="submit" class="submit-btn" id="loginBtn">
                    <span class="spinner" id="loginSpinner" style="display: none;"></span>
                    Login
                </button>
            </form>
            <div class="auth-switch">
                Don't have an account? <a id="switchToSignup">Sign up</a>
            </div>
        </div>
    </div>

    <!-- Signup Modal -->
    <div class="modal" id="signupModal">
        <div class="modal-content">
            <button class="close-modal" id="closeSignupModal">&times;</button>
            <h2 class="modal-title">Create Account</h2>
            <form id="signupForm">
                <div class="form-group">
                    <label for="signupName" class="form-label">Full Name</label>
                    <input type="text" id="signupName" class="form-input" placeholder="Enter your full name" required>
                </div>
                <div class="form-group">
                    <label for="signupUsername" class="form-label">Username</label>
                    <input type="text" id="signupUsername" class="form-input" placeholder="Choose a username" required>
                </div>
                <div class="form-group">
                    <label for="signupEmail" class="form-label">Email</label>
                    <input type="email" id="signupEmail" class="form-input" placeholder="Enter your email" required>
                </div>
                <div class="form-group">
                    <label for="signupPassword" class="form-label">Password</label>
                    <input type="password" id="signupPassword" class="form-input" placeholder="Create a password" required>
                </div>
                <div class="form-group">
                    <label for="signupBio" class="form-label">Bio (Optional)</label>
                    <textarea id="signupBio" class="form-input" placeholder="Tell us about yourself" rows="3"></textarea>
                </div>
                <button type="submit" class="submit-btn" id="signupBtn">
                    <span class="spinner" id="signupSpinner" style="display: none;"></span>
                    Sign Up
                </button>
            </form>
            <div class="auth-switch">
                Already have an account? <a id="switchToLogin">Login</a>
            </div>
        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div class="modal" id="editProfileModal">
        <div class="modal-content">
            <button class="close-modal" id="closeEditProfileModal">&times;</button>
            <h2 class="modal-title">Edit Profile</h2>
            <form id="editProfileForm">
                <div class="form-group">
                    <label for="editProfileName" class="form-label">Full Name</label>
                    <input type="text" id="editProfileName" class="form-input" placeholder="Enter your full name" required>
                </div>
                <div class="form-group">
                    <label for="editProfileUsername" class="form-label">Username</label>
                    <input type="text" id="editProfileUsername" class="form-input" placeholder="Choose a username" required>
                </div>
                <div class="form-group">
                    <label for="editProfileBio" class="form-label">Bio</label>
                    <textarea id="editProfileBio" class="form-input" placeholder="Tell us about yourself" rows="3"></textarea>
                </div>
                <button type="submit" class="submit-btn" id="saveProfileBtn">
                    <span class="spinner" id="saveProfileSpinner" style="display: none;"></span>
                    Save Changes
                </button>
            </form>
        </div>
    </div>

    <!-- Discover Modal -->
    <div class="modal" id="discoverModal">
        <div class="modal-content">
            <button class="close-modal" id="closeDiscoverModal">&times;</button>
            <h2 class="modal-title">Discover</h2>
            <div class="discover-list" id="discoverList">
                <div class="discover-item">
                    <div class="discover-icon">
                        <i class="fas fa-book-open"></i>
                    </div>
                    <div class="discover-content">
                        <div class="discover-title">Featured Books</div>
                        <div class="discover-description">Explore our curated collection of featured books</div>
                    </div>
                </div>
                <div class="discover-item">
                    <div class="discover-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="discover-content">
                        <div class="discover-title">Top Contributors</div>
                        <div class="discover-description">See who's sharing the most books</div>
                    </div>
                </div>
                <div class="discover-item">
                    <div class="discover-icon">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <div class="discover-content">
                        <div class="discover-title">Popular This Week</div>
                        <div class="discover-description">Most downloaded books this week</div>
                    </div>
                </div>
                <div class="discover-item">
                    <div class="discover-icon">
                        <i class="fas fa-lightbulb"></i>
                    </div>
                    <div class="discover-content">
                        <div class="discover-title">New Releases</div>
                        <div class="discover-description">Recently added books to the platform</div>
                    </div>
                </div>
                <div class="discover-item">
                    <div class="discover-icon">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div class="discover-content">
                        <div class="discover-title">Educational Resources</div>
                        <div class="discover-description">Textbooks and academic materials</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
       const _0x582850=_0x4b14;(function(_0x2b3381,_0x422fdb){const _0xd24e88=_0x4b14,_0x5325fe=_0x2b3381();while(!![]){try{const _0x2cf6d9=parseInt(_0xd24e88(0x1ce))/0x1*(parseInt(_0xd24e88(0x1cb))/0x2)+-parseInt(_0xd24e88(0x15d))/0x3*(parseInt(_0xd24e88(0x201))/0x4)+-parseInt(_0xd24e88(0x221))/0x5*(-parseInt(_0xd24e88(0x27b))/0x6)+parseInt(_0xd24e88(0x19d))/0x7*(parseInt(_0xd24e88(0x1fa))/0x8)+parseInt(_0xd24e88(0x1d1))/0x9*(-parseInt(_0xd24e88(0x117))/0xa)+parseInt(_0xd24e88(0x177))/0xb+-parseInt(_0xd24e88(0x176))/0xc;if(_0x2cf6d9===_0x422fdb)break;else _0x5325fe['push'](_0x5325fe['shift']());}catch(_0xbd838c){_0x5325fe['push'](_0x5325fe['shift']());}}}(_0x2ab7,0xaee90));function hi(){const _0x1c2759=_0x4b14;console[_0x1c2759(0x1a7)](_0x1c2759(0x196));}hi(),AOS[_0x582850(0x1d8)]({'duration':0x320,'easing':_0x582850(0x244),'once':!![],'offset':0x64});const firebaseConfig={'apiKey':_0x582850(0x1a8),'authDomain':'eduspark-books.firebaseapp.com','databaseURL':'https://eduspark-books-default-rtdb.asia-southeast1.firebasedatabase.app','projectId':_0x582850(0x19e),'storageBucket':'eduspark-books.firebasestorage.app','messagingSenderId':_0x582850(0x1c7),'appId':_0x582850(0x1bd),'measurementId':_0x582850(0x18b)};firebase[_0x582850(0x22f)](firebaseConfig);const auth=firebase['auth'](),db=firebase[_0x582850(0x166)](),storage=firebase[_0x582850(0x15b)](),themeToggle=document[_0x582850(0x143)](_0x582850(0x1cf)),body=document[_0x582850(0x216)],header=document[_0x582850(0x143)](_0x582850(0x1a9)),logoLink=document[_0x582850(0x17d)](_0x582850(0x168)),userAvatar=document['getElementById'](_0x582850(0x269)),avatarInitials=document[_0x582850(0x17d)](_0x582850(0x15c)),searchContainer=document[_0x582850(0x17d)]('searchContainer'),searchInput=document['getElementById'](_0x582850(0x231)),searchResults=document[_0x582850(0x17d)]('searchResults'),addBookBtn=document[_0x582850(0x17d)](_0x582850(0x1b9)),addBookModal=document[_0x582850(0x17d)](_0x582850(0x1f4)),closeAddBookModal=document[_0x582850(0x17d)](_0x582850(0x1ba)),addBookForm=document[_0x582850(0x17d)](_0x582850(0x1b5)),booksContainer=document[_0x582850(0x17d)]('booksContainer'),emptyState=document[_0x582850(0x17d)](_0x582850(0x171)),profileBtn=document[_0x582850(0x17d)](_0x582850(0x200)),profilePage=document[_0x582850(0x17d)](_0x582850(0x1e3)),profileBackBtn=document[_0x582850(0x17d)](_0x582850(0x195)),chatBtn=document['getElementById'](_0x582850(0x239)),chatPage=document[_0x582850(0x17d)]('chatPage'),chatBackBtn=document[_0x582850(0x17d)]('chatBackBtn'),chatMessages=document[_0x582850(0x17d)]('chatMessages'),chatInput=document['getElementById'](_0x582850(0x11d)),sendMessageBtn=document[_0x582850(0x17d)](_0x582850(0x1b0)),typingIndicator=document[_0x582850(0x17d)](_0x582850(0x1dc)),loginModal=document[_0x582850(0x17d)](_0x582850(0x17e)),signupModal=document[_0x582850(0x17d)](_0x582850(0x26b)),closeLoginModal=document[_0x582850(0x17d)]('closeLoginModal'),closeSignupModal=document['getElementById']('closeSignupModal'),loginForm=document[_0x582850(0x17d)](_0x582850(0x17f)),signupForm=document['getElementById']('signupForm'),switchToSignup=document[_0x582850(0x17d)]('switchToSignup'),switchToLogin=document['getElementById'](_0x582850(0x212)),editProfileBtn=document['getElementById'](_0x582850(0x115)),editProfileModal=document[_0x582850(0x17d)]('editProfileModal'),closeEditProfileModal=document[_0x582850(0x17d)](_0x582850(0x25d)),editProfileForm=document[_0x582850(0x17d)]('editProfileForm'),profileName=document[_0x582850(0x17d)]('profileName'),profileUsername=document['getElementById']('profileUsername'),profileEmail=document[_0x582850(0x17d)](_0x582850(0x15f)),profileBio=document[_0x582850(0x17d)]('profileBio'),booksShared=document['getElementById'](_0x582850(0x183)),booksDownloaded=document['getElementById'](_0x582850(0x153)),memberSince=document[_0x582850(0x17d)](_0x582850(0x11b)),profileBooksContainer=document[_0x582850(0x17d)](_0x582850(0x124)),discoverBtn=document['getElementById'](_0x582850(0x27a)),discoverModal=document[_0x582850(0x17d)]('discoverModal'),closeDiscoverModal=document[_0x582850(0x17d)]('closeDiscoverModal'),discoverList=document[_0x582850(0x17d)](_0x582850(0x125)),logoutBtn=document[_0x582850(0x17d)](_0x582850(0x16f)),profileAvatar=document[_0x582850(0x17d)](_0x582850(0x1c8)),profileAvatarInitials=document[_0x582850(0x17d)](_0x582850(0x13f)),userPoints=document[_0x582850(0x17d)](_0x582850(0x15a)),withdrawBtn=document[_0x582850(0x17d)]('withdrawBtn'),withdrawalModal=document[_0x582850(0x17d)](_0x582850(0x1ff)),closeWithdrawalModal=document['getElementById']('closeWithdrawalModal'),withdrawalOptions=document[_0x582850(0x230)](_0x582850(0x278)),amountOptions=document[_0x582850(0x230)](_0x582850(0x19a)),paymentDetails=document['getElementById']('paymentDetails'),paymentMethodLabel=document[_0x582850(0x17d)](_0x582850(0x23b)),paymentId=document[_0x582850(0x17d)](_0x582850(0x179)),accountName=document[_0x582850(0x17d)](_0x582850(0x10c)),submitWithdrawalBtn=document[_0x582850(0x17d)](_0x582850(0x1c0)),withdrawalHistory=document[_0x582850(0x17d)](_0x582850(0x10b)),emptyWithdrawalHistory=document[_0x582850(0x17d)]('emptyWithdrawalHistory');let booksLimit=0x3,lastBook=null;const batchSize=0xa;let lastBookSnapshot=null,hasMoreBooks=![],currentUser=null,userData=null,isTyping=![],typingTimeout=null,lastTypingTime=0x0,allBooks=[],selectedWithdrawalMethod=null,selectedWithdrawalAmount=null,selectedWithdrawalRs=null;window[_0x582850(0x127)](_0x582850(0x24d),()=>{const _0x2ff535=_0x582850;window[_0x2ff535(0x1c3)]>0x32?header[_0x2ff535(0x10e)][_0x2ff535(0x13c)](_0x2ff535(0x23e)):header[_0x2ff535(0x10e)][_0x2ff535(0x16e)](_0x2ff535(0x23e));}),themeToggle['addEventListener'](_0x582850(0x214),()=>{const _0x3bee3d=_0x582850,_0x5bb6a7=body[_0x3bee3d(0x233)](_0x3bee3d(0x152)),_0x445954=_0x5bb6a7===_0x3bee3d(0x14e)?'dark':'light';body[_0x3bee3d(0x13d)](_0x3bee3d(0x152),_0x445954),localStorage['setItem']('theme',_0x445954);});const savedTheme=localStorage[_0x582850(0x209)](_0x582850(0x27c));savedTheme&&body['setAttribute'](_0x582850(0x152),savedTheme);searchInput[_0x582850(0x127)]('input',function(){const _0x83442a=_0x582850,_0x36c00f=this['value'][_0x83442a(0x135)]()[_0x83442a(0x14a)]();if(_0x36c00f[_0x83442a(0x21f)]===0x0){searchResults[_0x83442a(0x1f7)][_0x83442a(0x1be)]=_0x83442a(0x1ea);return;}const _0x2cc6b6=allBooks[_0x83442a(0x1b7)](_0x50abf7=>_0x50abf7[_0x83442a(0x18c)][_0x83442a(0x14a)]()[_0x83442a(0x1e6)](_0x36c00f)||_0x50abf7[_0x83442a(0x19b)][_0x83442a(0x14a)]()[_0x83442a(0x1e6)](_0x36c00f)||_0x50abf7[_0x83442a(0x1b3)]&&_0x50abf7[_0x83442a(0x1b3)][_0x83442a(0x14a)]()[_0x83442a(0x1e6)](_0x36c00f));renderSearchResults(_0x2cc6b6);});if(window[_0x582850(0x14c)]<=0x240){const searchIcon=document[_0x582850(0x1b2)]('i');searchIcon[_0x582850(0x157)]=_0x582850(0x205),searchIcon[_0x582850(0x1f7)][_0x582850(0x10a)]=_0x582850(0x253),searchIcon[_0x582850(0x1f7)][_0x582850(0x165)]='var(--text-light)',searchIcon['style'][_0x582850(0x227)]=_0x582850(0x1f3),searchIcon[_0x582850(0x1f7)]['marginLeft']=_0x582850(0x208),searchIcon['addEventListener']('click',()=>{const _0x5ef866=_0x582850;searchContainer[_0x5ef866(0x1f7)][_0x5ef866(0x1be)]=_0x5ef866(0x158),searchInput['focus']();}),document['querySelector']('.header-actions')[_0x582850(0x199)](searchIcon,themeToggle),searchContainer['style']['display']=_0x582850(0x1ea);}function renderSearchResults(_0x456c44){const _0x535796=_0x582850;searchResults['innerHTML']='';if(_0x456c44[_0x535796(0x21f)]===0x0){searchResults[_0x535796(0x24c)]=_0x535796(0x240),searchResults['style'][_0x535796(0x1be)]=_0x535796(0x158);return;}_0x456c44[_0x535796(0x210)](0x0,0x5)['forEach'](_0x36e3aa=>{const _0x12b98a=_0x535796,_0x340983=document[_0x12b98a(0x1b2)](_0x12b98a(0x22a));_0x340983[_0x12b98a(0x157)]=_0x12b98a(0x1b4),_0x340983[_0x12b98a(0x24c)]=_0x12b98a(0x21a)+_0x36e3aa['bookName']+_0x12b98a(0x217)+_0x36e3aa[_0x12b98a(0x19b)]+(_0x36e3aa[_0x12b98a(0x1b3)]?_0x12b98a(0x1e7)+_0x36e3aa['category']:'')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x340983['addEventListener'](_0x12b98a(0x214),()=>{const _0x257666=_0x12b98a,_0x51c792=document[_0x257666(0x143)]('.book-card[data-id=\x22'+_0x36e3aa['id']+'\x22]');_0x51c792&&(_0x51c792[_0x257666(0x17c)]({'behavior':_0x257666(0x12b),'block':'center'}),_0x51c792['classList'][_0x257666(0x13c)]('highlight'),setTimeout(()=>{const _0x2ff67b=_0x257666;_0x51c792[_0x2ff67b(0x10e)][_0x2ff67b(0x16e)](_0x2ff67b(0x24a));},0x7d0)),searchInput['value']='',searchResults[_0x257666(0x1f7)][_0x257666(0x1be)]=_0x257666(0x1ea),window[_0x257666(0x14c)]<=0x240&&(searchContainer[_0x257666(0x1f7)]['display']=_0x257666(0x1ea));}),searchResults['appendChild'](_0x340983);}),searchResults[_0x535796(0x1f7)][_0x535796(0x1be)]='block';}document[_0x582850(0x127)](_0x582850(0x214),_0x52c7b=>{const _0x4e1a36=_0x582850;!searchContainer[_0x4e1a36(0x277)](_0x52c7b[_0x4e1a36(0x110)])&&_0x52c7b[_0x4e1a36(0x110)]['className']!==_0x4e1a36(0x10d)&&(searchResults['style'][_0x4e1a36(0x1be)]=_0x4e1a36(0x1ea));});function openProfilePage(){const _0x513437=_0x582850;profilePage[_0x513437(0x10e)][_0x513437(0x13c)](_0x513437(0x237)),document[_0x513437(0x216)][_0x513437(0x1f7)][_0x513437(0x222)]=_0x513437(0x111),fetchUserBooks();}function closeProfilePage(){const _0x5be74f=_0x582850;profilePage[_0x5be74f(0x10e)][_0x5be74f(0x16e)](_0x5be74f(0x237)),document[_0x5be74f(0x216)][_0x5be74f(0x1f7)]['overflow']=_0x5be74f(0x197);}function openChatPage(){const _0x4481e8=_0x582850;chatPage[_0x4481e8(0x10e)][_0x4481e8(0x13c)](_0x4481e8(0x237)),document['body']['style'][_0x4481e8(0x222)]=_0x4481e8(0x111),chatInput[_0x4481e8(0x232)]();}function closeChatPage(){const _0x20aef1=_0x582850;chatPage[_0x20aef1(0x10e)]['remove'](_0x20aef1(0x237)),document[_0x20aef1(0x216)][_0x20aef1(0x1f7)][_0x20aef1(0x222)]=_0x20aef1(0x197);}profileBtn[_0x582850(0x127)]('click',()=>{if(!currentUser){openModal(loginModal);return;}openProfilePage();}),profileBackBtn[_0x582850(0x127)](_0x582850(0x214),closeProfilePage),chatBtn[_0x582850(0x127)](_0x582850(0x214),()=>{if(!currentUser){openModal(loginModal);return;}openChatPage();}),chatBackBtn[_0x582850(0x127)](_0x582850(0x214),closeChatPage),userAvatar['addEventListener'](_0x582850(0x214),()=>{if(!currentUser){openModal(loginModal);return;}openProfilePage();}),logoLink[_0x582850(0x127)](_0x582850(0x214),_0x8dea1a=>{const _0x281a7f=_0x582850;_0x8dea1a[_0x281a7f(0x18d)](),window[_0x281a7f(0x1a5)]({'top':0x0,'behavior':_0x281a7f(0x12b)});});function openModal(_0x4c0925){const _0x19ee29=_0x582850;_0x4c0925[_0x19ee29(0x10e)][_0x19ee29(0x13c)]('active'),document['body'][_0x19ee29(0x1f7)][_0x19ee29(0x222)]='hidden';}function closeModal(_0x167169){const _0x244d3f=_0x582850;_0x167169[_0x244d3f(0x10e)][_0x244d3f(0x16e)](_0x244d3f(0x237)),document[_0x244d3f(0x216)][_0x244d3f(0x1f7)]['overflow']=_0x244d3f(0x197);}addBookBtn[_0x582850(0x127)](_0x582850(0x214),()=>{const _0x1489ef=_0x582850;if(!currentUser){openModal(loginModal);return;}addBookForm[_0x1489ef(0x1cc)](),openModal(addBookModal);}),closeAddBookModal[_0x582850(0x127)](_0x582850(0x214),()=>closeModal(addBookModal)),closeLoginModal['addEventListener'](_0x582850(0x214),()=>closeModal(loginModal)),closeSignupModal[_0x582850(0x127)]('click',()=>closeModal(signupModal)),switchToSignup[_0x582850(0x127)]('click',()=>{closeModal(loginModal),openModal(signupModal);}),switchToLogin[_0x582850(0x127)]('click',()=>{closeModal(signupModal),openModal(loginModal);}),editProfileBtn['addEventListener'](_0x582850(0x214),()=>{const _0x5f52ae=_0x582850;closeProfilePage(),openModal(editProfileModal),document[_0x5f52ae(0x17d)](_0x5f52ae(0x21e))[_0x5f52ae(0x148)]=userData?.[_0x5f52ae(0x218)]||'',document[_0x5f52ae(0x17d)]('editProfileUsername')[_0x5f52ae(0x148)]=userData?.[_0x5f52ae(0x173)]||'',document[_0x5f52ae(0x17d)]('editProfileBio')[_0x5f52ae(0x148)]=userData?.['bio']||'';}),closeEditProfileModal['addEventListener'](_0x582850(0x214),()=>{closeModal(editProfileModal),openProfilePage();}),discoverBtn[_0x582850(0x127)]('click',()=>{if(!currentUser){openModal(loginModal);return;}openModal(discoverModal);}),closeDiscoverModal[_0x582850(0x127)](_0x582850(0x214),()=>closeModal(discoverModal)),document[_0x582850(0x230)]('.modal')[_0x582850(0x1d6)](_0x4ecdbf=>{const _0x45177e=_0x582850;_0x4ecdbf['addEventListener'](_0x45177e(0x214),_0x3265e7=>{_0x3265e7['target']===_0x4ecdbf&&closeModal(_0x4ecdbf);});}),chatInput[_0x582850(0x127)](_0x582850(0x18f),function(){const _0x5a7a20=_0x582850;this[_0x5a7a20(0x1f7)][_0x5a7a20(0x276)]='auto',this['style'][_0x5a7a20(0x276)]=this[_0x5a7a20(0x215)]+'px',sendMessageBtn['disabled']=this[_0x5a7a20(0x148)][_0x5a7a20(0x135)]()==='';}),addBookForm[_0x582850(0x127)]('submit',async _0x50c96c=>{const _0x5a5ef7=_0x582850;_0x50c96c['preventDefault']();if(!currentUser){showToast('Please\x20login\x20to\x20add\x20books',_0x5a5ef7(0x181));return;}const _0x48b855=document[_0x5a5ef7(0x17d)](_0x5a5ef7(0x250)),_0x5a8d9e=document[_0x5a5ef7(0x17d)](_0x5a5ef7(0x1d7));_0x48b855[_0x5a5ef7(0x213)]=!![],_0x5a8d9e[_0x5a5ef7(0x1f7)][_0x5a5ef7(0x1be)]=_0x5a5ef7(0x220);const _0x5b05b0=document[_0x5a5ef7(0x17d)](_0x5a5ef7(0x18c))[_0x5a5ef7(0x148)],_0x58e2f6=document[_0x5a5ef7(0x17d)](_0x5a5ef7(0x19b))['value'],_0x11e426=document[_0x5a5ef7(0x17d)](_0x5a5ef7(0x160))[_0x5a5ef7(0x148)],_0x1bfed4=document[_0x5a5ef7(0x17d)](_0x5a5ef7(0x132))[_0x5a5ef7(0x148)],_0x26f37b=document[_0x5a5ef7(0x17d)](_0x5a5ef7(0x12e))[_0x5a5ef7(0x148)],_0x30cb4c=document[_0x5a5ef7(0x17d)]('bookDescription')['value'];try{if(!_0x26f37b['includes'](_0x5a5ef7(0x1ad)))throw new Error(_0x5a5ef7(0x12c));await db[_0x5a5ef7(0x1da)](_0x5a5ef7(0x26f))[_0x5a5ef7(0x13c)]({'bookName':_0x5b05b0,'authorName':_0x58e2f6,'category':_0x11e426,'imageUrl':_0x1bfed4||null,'description':_0x30cb4c,'driveLink':_0x26f37b,'submittedBy':currentUser[_0x5a5ef7(0x22b)],'submittedByName':userData?.[_0x5a5ef7(0x218)]||_0x5a5ef7(0x11e),'submittedAt':firebase[_0x5a5ef7(0x166)]['FieldValue']['serverTimestamp'](),'status':'pending','adminNotes':'','reviewedBy':'','reviewedAt':null,'rejectionReason':'','downloads':0x0}),await db[_0x5a5ef7(0x1da)]('users')[_0x5a5ef7(0x120)](currentUser[_0x5a5ef7(0x22b)])[_0x5a5ef7(0x256)]({'booksShared':firebase[_0x5a5ef7(0x166)][_0x5a5ef7(0x1cd)]['increment'](0x0)}),userData[_0x5a5ef7(0x183)]=userData['booksShared']+0x1,booksShared[_0x5a5ef7(0x16a)]=userData[_0x5a5ef7(0x183)],showToast(_0x5a5ef7(0x147),'success'),addBookForm[_0x5a5ef7(0x1cc)](),closeModal(addBookModal);}catch(_0x586d34){console[_0x5a5ef7(0x181)]('Error\x20adding\x20book:',_0x586d34),showToast('Error:\x20'+_0x586d34[_0x5a5ef7(0x137)],_0x5a5ef7(0x181));}finally{_0x48b855[_0x5a5ef7(0x213)]=![],_0x5a8d9e[_0x5a5ef7(0x1f7)]['display']=_0x5a5ef7(0x1ea);}});function _0x2ab7(){const _0xe0528a=['saveProfileSpinner','memberSince','pending','chatInput','Anonymous','createUserWithEmailAndPassword','doc','docChanges','stringify','Your\x20book\x20was\x20approved!','profileBooksContainer','discoverList','downloads','addEventListener','Please\x20login\x20to\x20add\x20books','Enter\x20your\x20bank\x20account\x20number','user@example.com','smooth','Please\x20provide\x20a\x20valid\x20Google\x20Drive\x20link','modified','driveLink','increment','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22download-btn\x22\x20data-link=\x22','empty','bookImageUrl','limit','desc','trim','join','message','displayName','requestedAt','status-completed','getFullYear','add','setAttribute','fa-exclamation-circle','profileAvatarInitials','added','currentTarget','Paytm\x20Number','querySelector','status','<span\x20class=\x22status-badge\x20status-approved\x22>Approved</span>','Rejected\x20by\x20','Book\x20submitted\x20for\x20approval!','value','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','toLowerCase','toLocaleTimeString','innerWidth','keydown','light','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22book-overlay-author\x22>By\x20','reviewedBy','https://via.placeholder.com/300x200?text=No+Cover','data-theme','booksDownloaded','data-id','orderBy','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','className','block','<div\x20class=\x22book-admin-info\x22><i\x20class=\x22fas\x20fa-user-shield\x22></i>\x20Reviewed\x20by\x20','userPoints','storage','avatarInitials','2571BQyavb','Error\x20logging\x20out','profileEmail','bookCategory','data-link','<i\x20class=\x22fas\x20fa-envelope\x22></i>\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22book-overlay-btn\x22\x20data-link=\x22','placeholder','color','firestore','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22book-overlay-btn\x22\x20data-link=\x22','logoLink','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','textContent','amountPoints','submittedByName','fa-check-circle','remove','logoutBtn','received','emptyState','typing','username','toDate','loginPassword','5430156ZMtnFQ','9462552zDOTaD','<span\x20class=\x22status-badge\x20status-pending\x22>Pending</span>','paymentId','Logged\x20in\x20successfully!','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22withdrawal-history-title\x22>Withdrawal\x20History</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','scrollIntoView','getElementById','loginModal','loginForm','loginSpinner','error','signupEmail','booksShared','Enter\x20your\x20Paytm\x20registered\x20number','loadMoreBooksBtn','amountRs','Account\x20created\x20successfully!','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-external-link-alt\x22></i>\x20View\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','approved','G-G6JHCMYZ0X','bookName','preventDefault','createdAt','input','open','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20','success','reviewedAt','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','profileBackBtn','Hello\x20World!','auto','completed','insertBefore','.amount-option','authorName','\x20points)</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-method\x22>','7SoUnuC','eduspark-books','map','catch','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-img-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-user\x22></i>\x20','description','@username','scrollTo','signupUsername','log','AIzaSyASKb2xr27kjYokZICpIbBYULWsRdmBzI0','.header','</p>','Error:\x20','data-amount','drive.google.com','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-calendar-alt\x22></i>\x20','submittedBy','sendMessageBtn','split','createElement','category','search-result-item','addBookForm','Please\x20fill\x20all\x20the\x20details','filter','signupSpinner','addBookBtn','closeAddBookModal','points','submit','1:977405961718:web:4f9d16cf0a44e1f54e93d7','display','Error\x20loading\x20more\x20books:','submitWithdrawalBtn','rejected','signInWithEmailAndPassword','scrollY','Error\x20fetching\x20books:','PhonePe\x20Number','submittedAt','977405961718','profileAvatar','withdrawal-item','No\x20Name','122LKJKOD','reset','FieldValue','12681FtPMIy','.theme-toggle','Approved\x20by\x20','13518dmHAaO','Enter','signOut','saveProfileBtn','loginEmail','forEach','submitSpinner','init','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22empty-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-book\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>No\x20Books\x20Shared\x20Yet</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Start\x20sharing\x20books\x20with\x20the\x20community!</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','collection','Withdrawal\x20request\x20submitted\x20successfully!','typingIndicator','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','You\x20need\x20at\x20least\x20500\x20points\x20to\x20withdraw','serverTimestamp','Signup\x20error:','editProfileBio','where','profilePage','fa-exclamation-triangle','onSnapshot','includes','\x20‚Ä¢\x20','text','method','none','Error\x20updating\x20download\x20count:','Enter\x20your\x20UPI\x20ID\x20(e.g.,\x20name@upi)','signupName','signupBio','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22download-btn\x22\x20data-link=\x22','withdrawals','data-rs','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22empty-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-book\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>No\x20Books\x20Shared\x20Yet</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Start\x20sharing\x20books\x20with\x20the\x20community!</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','pointer','addBookModal','Pending','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-status\x20','style','messages','docs','5605144kjyeQF','Profile\x20updated\x20successfully!','loginBtn','message\x20','bio','withdrawalModal','profileBtn','1996JybFMN','sending','then','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22toast-close\x22>&times;</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','fas\x20fa-search','padStart','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','10px','getItem','push','status-rejected','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-img-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','bank','appendChild','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-external-link-alt\x22></i>\x20View\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','slice','signupBtn','switchToLogin','disabled','click','scrollHeight','body','</h4>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>By\x20','name','<span\x20class=\x22status-badge\x20status-rejected\x22>Rejected</span>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h4>','<div\x20class=\x22message-sender\x22>','set','upi','editProfileName','length','inline-block','490qZzjtY','overflow','exists','get','User','Error\x20updating\x20profile:','cursor','closest','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22message-time\x22>','div','uid','senderName','paytm','Error\x20adding\x20book:','initializeApp','querySelectorAll','searchInput','focus','getAttribute','temp-','Login\x20error:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22book-title\x22>','active','Logged\x20out\x20successfully','chatBtn','info','paymentMethodLabel','.message-status','Error\x20submitting\x20withdrawal\x20request','scrolled','phonepay','<div\x20class=\x22no-results\x22>No\x20books\x20found\x20matching\x20your\x20search</div>','show','Error\x20submitting\x20withdrawal:','approvedAt','ease-in-out','delivered','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','now','user','highlight','sent','innerHTML','scroll','flex','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-amount\x22>‚Çπ','submitBookBtn','<span\x20class=\x22message-status\x20','scrollTop','1.2rem','data-method','.book-card','update','\x20on\x20','data','toUpperCase','onAuthStateChanged','.toast-close','\x22\x20class=\x22book-img\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22book-overlay-title\x22>','closeEditProfileModal','Signup\x20failed:\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-download\x22></i>\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<p\x20class=\x22book-overlay-desc\x22>','parse','\x22\x20alt=\x22','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22withdrawal-date\x22>','status-pending','setItem','_blank','...','userAvatar','\x20is\x20typing...\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','signupModal','type','warning','book-card','books','</div>','email','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22book-author\x22>By\x20','users','Error\x20sending\x20message:','Error\x20fetching\x20user\x20books:','height','contains','.withdrawal-option','N/A','discoverBtn','37866sqQkSN','theme','imageUrl','.download-btn,\x20.book-overlay-btn','fontSize','withdrawalHistory','accountName','fa-search','classList','userId','target','hidden','processedApprovals','You\x20don\x27t\x20have\x20enough\x20points','senderId','editProfileBtn','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-external-link-alt\x22></i>\x20View\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','9030XiljNj','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-download\x22></i>\x20Download\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','shiftKey'];_0x2ab7=function(){return _0xe0528a;};return _0x2ab7();}function setupDownloadButtons(){const _0x202453=_0x582850;document[_0x202453(0x230)](_0x202453(0x109))[_0x202453(0x1d6)](_0x4f0212=>{const _0x229b88=_0x202453;_0x4f0212[_0x229b88(0x127)](_0x229b88(0x214),async _0x348481=>{const _0x2cf010=_0x229b88;if(!currentUser){openModal(loginModal);return;}const _0x17791c=_0x348481[_0x2cf010(0x141)][_0x2cf010(0x233)](_0x2cf010(0x161));window[_0x2cf010(0x190)](_0x17791c,'_blank');const _0x22d7b2=_0x348481[_0x2cf010(0x141)][_0x2cf010(0x228)]('.book-card')?.['getAttribute'](_0x2cf010(0x154));if(_0x22d7b2)try{await db[_0x2cf010(0x1da)](_0x2cf010(0x26f))['doc'](_0x22d7b2)[_0x2cf010(0x256)]({'downloads':firebase[_0x2cf010(0x166)][_0x2cf010(0x1cd)][_0x2cf010(0x12f)](0x1)}),await db[_0x2cf010(0x1da)]('users')[_0x2cf010(0x120)](currentUser[_0x2cf010(0x22b)])[_0x2cf010(0x256)]({'booksDownloaded':firebase['firestore'][_0x2cf010(0x1cd)][_0x2cf010(0x12f)](0x1)});}catch(_0x4b028d){console[_0x2cf010(0x181)](_0x2cf010(0x1eb),_0x4b028d);}});});}function setupBookApprovalListener(){const _0x33e434=_0x582850;if(!currentUser)return;db[_0x33e434(0x1da)](_0x33e434(0x26f))['where'](_0x33e434(0x1af),'==',currentUser[_0x33e434(0x22b)])[_0x33e434(0x1e2)]('status','in',[_0x33e434(0x18a),_0x33e434(0x1c1)])[_0x33e434(0x1e5)](_0x389809=>{const _0x168665=_0x33e434;_0x389809[_0x168665(0x121)]()['forEach'](_0x38aedd=>{const _0x30f4ce=_0x168665,_0x182560=_0x38aedd[_0x30f4ce(0x120)][_0x30f4ce(0x258)](),_0x5522d3=_0x38aedd[_0x30f4ce(0x120)]['id'];if(_0x38aedd[_0x30f4ce(0x26c)]===_0x30f4ce(0x12d)&&_0x182560[_0x30f4ce(0x144)]===_0x30f4ce(0x18a)){const _0x1f2ae5=JSON[_0x30f4ce(0x262)](localStorage[_0x30f4ce(0x209)](_0x30f4ce(0x112))||'{}');!_0x1f2ae5[_0x5522d3]&&db[_0x30f4ce(0x1da)](_0x30f4ce(0x249))[_0x30f4ce(0x120)](currentUser[_0x30f4ce(0x22b)])[_0x30f4ce(0x256)]({'points':firebase[_0x30f4ce(0x166)][_0x30f4ce(0x1cd)][_0x30f4ce(0x12f)](0x0)})[_0x30f4ce(0x203)](()=>{const _0x41d057=_0x30f4ce;userData[_0x41d057(0x1bb)]=userData[_0x41d057(0x1bb)],userPoints[_0x41d057(0x16a)]=userData[_0x41d057(0x1bb)],withdrawBtn['disabled']=userData[_0x41d057(0x1bb)]<0x1f4,_0x1f2ae5[_0x5522d3]=!![],localStorage[_0x41d057(0x266)](_0x41d057(0x112),JSON[_0x41d057(0x122)](_0x1f2ae5)),showToast(_0x41d057(0x123),_0x41d057(0x192));});}});});}function showToast(_0x4274b0,_0x200054=_0x582850(0x23a)){const _0x86f6c9=_0x582850,_0x1ae6dd=document[_0x86f6c9(0x1b2)](_0x86f6c9(0x22a));_0x1ae6dd[_0x86f6c9(0x157)]='toast\x20'+_0x200054;let _0x5abb79='';switch(_0x200054){case _0x86f6c9(0x192):_0x5abb79=_0x86f6c9(0x16d);break;case _0x86f6c9(0x181):_0x5abb79=_0x86f6c9(0x13e);break;case _0x86f6c9(0x26d):_0x5abb79=_0x86f6c9(0x1e4);break;default:_0x5abb79='fa-info-circle';}_0x1ae6dd[_0x86f6c9(0x24c)]=_0x86f6c9(0x191)+_0x5abb79+'\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>'+_0x4274b0+_0x86f6c9(0x204);const _0x561889=_0x1ae6dd['querySelector'](_0x86f6c9(0x25b));_0x561889[_0x86f6c9(0x127)]('click',()=>{const _0x1f0fd6=_0x86f6c9;_0x1ae6dd[_0x1f0fd6(0x16e)]();}),document['body'][_0x86f6c9(0x20e)](_0x1ae6dd),setTimeout(()=>{const _0x53b5a9=_0x86f6c9;_0x1ae6dd[_0x53b5a9(0x10e)][_0x53b5a9(0x13c)](_0x53b5a9(0x241));},0xa),setTimeout(()=>{const _0x10ed99=_0x86f6c9;_0x1ae6dd[_0x10ed99(0x10e)][_0x10ed99(0x16e)](_0x10ed99(0x241)),setTimeout(()=>{const _0xd91ddb=_0x10ed99;_0x1ae6dd[_0xd91ddb(0x16e)]();},0x12c);},0x1388);}loginForm[_0x582850(0x127)](_0x582850(0x1bc),async _0x587b3=>{const _0x5cffa3=_0x582850;_0x587b3[_0x5cffa3(0x18d)]();const _0x299022=document[_0x5cffa3(0x17d)](_0x5cffa3(0x1fc)),_0xfcde8a=document[_0x5cffa3(0x17d)](_0x5cffa3(0x180));_0x299022['disabled']=!![],_0xfcde8a[_0x5cffa3(0x1f7)][_0x5cffa3(0x1be)]='inline-block';const _0x3ddbbc=document['getElementById'](_0x5cffa3(0x1d5))[_0x5cffa3(0x148)],_0x413f54=document[_0x5cffa3(0x17d)](_0x5cffa3(0x175))[_0x5cffa3(0x148)];try{await auth[_0x5cffa3(0x1c2)](_0x3ddbbc,_0x413f54),closeModal(loginModal),showToast(_0x5cffa3(0x17a),'success');}catch(_0x211c0c){console[_0x5cffa3(0x181)](_0x5cffa3(0x235),_0x211c0c),showToast('Login\x20failed:\x20'+_0x211c0c['message'],'error');}finally{_0x299022[_0x5cffa3(0x213)]=![],_0xfcde8a[_0x5cffa3(0x1f7)][_0x5cffa3(0x1be)]=_0x5cffa3(0x1ea);}}),signupForm[_0x582850(0x127)](_0x582850(0x1bc),async _0x432661=>{const _0x54d64=_0x582850;_0x432661['preventDefault']();const _0x46f566=document['getElementById'](_0x54d64(0x211)),_0x423536=document[_0x54d64(0x17d)](_0x54d64(0x1b8));_0x46f566[_0x54d64(0x213)]=!![],_0x423536['style'][_0x54d64(0x1be)]='inline-block';const _0x4bb394=document[_0x54d64(0x17d)](_0x54d64(0x1ed))[_0x54d64(0x148)],_0x443326=document[_0x54d64(0x17d)](_0x54d64(0x1a6))[_0x54d64(0x148)],_0x594b02=document[_0x54d64(0x17d)](_0x54d64(0x182))[_0x54d64(0x148)],_0x260da7=document[_0x54d64(0x17d)]('signupPassword')['value'],_0x32599d=document[_0x54d64(0x17d)](_0x54d64(0x1ee))[_0x54d64(0x148)];try{const _0x2fd03d=await auth[_0x54d64(0x11f)](_0x594b02,_0x260da7);await db[_0x54d64(0x1da)](_0x54d64(0x273))[_0x54d64(0x120)](_0x2fd03d['user'][_0x54d64(0x22b)])[_0x54d64(0x21c)]({'name':_0x4bb394,'username':_0x443326,'email':_0x594b02,'bio':_0x32599d,'createdAt':firebase[_0x54d64(0x166)][_0x54d64(0x1cd)]['serverTimestamp'](),'booksShared':0x0,'booksDownloaded':0x0,'role':_0x54d64(0x249),'lastActive':firebase['firestore'][_0x54d64(0x1cd)]['serverTimestamp'](),'status':_0x54d64(0x237)}),closeModal(signupModal),showToast(_0x54d64(0x187),_0x54d64(0x192));}catch(_0x33b74d){console[_0x54d64(0x181)](_0x54d64(0x1e0),_0x33b74d),showToast(_0x54d64(0x25e)+_0x33b74d[_0x54d64(0x137)],_0x54d64(0x181));}finally{_0x46f566['disabled']=![],_0x423536[_0x54d64(0x1f7)][_0x54d64(0x1be)]=_0x54d64(0x1ea);}}),editProfileForm[_0x582850(0x127)](_0x582850(0x1bc),async _0x2ffa5b=>{const _0x18392b=_0x582850;_0x2ffa5b[_0x18392b(0x18d)]();if(!currentUser)return;const _0xa3b130=document[_0x18392b(0x17d)](_0x18392b(0x1d4)),_0xd6f048=document[_0x18392b(0x17d)](_0x18392b(0x11a));_0xa3b130[_0x18392b(0x213)]=!![],_0xd6f048[_0x18392b(0x1f7)][_0x18392b(0x1be)]=_0x18392b(0x220);const _0x19bf1c=document[_0x18392b(0x17d)]('editProfileName')[_0x18392b(0x148)],_0x59b003=document[_0x18392b(0x17d)]('editProfileUsername')[_0x18392b(0x148)],_0x1f1399=document[_0x18392b(0x17d)](_0x18392b(0x1e1))[_0x18392b(0x148)];try{const _0x4af2a1={'name':_0x19bf1c,'username':_0x59b003,'bio':_0x1f1399,'updatedAt':firebase['firestore']['FieldValue'][_0x18392b(0x1df)]()};await db[_0x18392b(0x1da)](_0x18392b(0x273))[_0x18392b(0x120)](currentUser[_0x18392b(0x22b)])[_0x18392b(0x256)](_0x4af2a1),userData={...userData,..._0x4af2a1},updateProfileUI(),closeModal(editProfileModal),openProfilePage(),showToast(_0x18392b(0x1fb),_0x18392b(0x192));}catch(_0x5df2bc){console[_0x18392b(0x181)](_0x18392b(0x226),_0x5df2bc),showToast('Error\x20updating\x20profile:\x20'+_0x5df2bc[_0x18392b(0x137)],'error');}finally{_0xa3b130[_0x18392b(0x213)]=![],_0xd6f048[_0x18392b(0x1f7)][_0x18392b(0x1be)]='none';}}),logoutBtn[_0x582850(0x127)](_0x582850(0x214),async()=>{const _0x1c2bac=_0x582850;try{await auth[_0x1c2bac(0x1d3)](),closeProfilePage(),showToast(_0x1c2bac(0x238),_0x1c2bac(0x192));}catch(_0x4ee973){console[_0x1c2bac(0x181)]('Logout\x20error:',_0x4ee973),showToast(_0x1c2bac(0x15e),_0x1c2bac(0x181));}});function updateTyping(){const _0x5b2497=_0x582850;if(!currentUser)return;!isTyping&&(isTyping=!![],db[_0x5b2497(0x1da)]('typing')[_0x5b2497(0x120)](currentUser[_0x5b2497(0x22b)])[_0x5b2497(0x21c)]({'userId':currentUser['uid'],'userName':userData?.[_0x5b2497(0x218)]||_0x5b2497(0x11e),'typing':!![],'timestamp':firebase[_0x5b2497(0x166)]['FieldValue'][_0x5b2497(0x1df)]()})),lastTypingTime=Date[_0x5b2497(0x248)](),typingTimeout&&clearTimeout(typingTimeout),typingTimeout=setTimeout(()=>{const _0xd213b6=_0x5b2497,_0x598c13=Date[_0xd213b6(0x248)](),_0x285d35=_0x598c13-lastTypingTime;_0x285d35>=0x7d0&&isTyping&&(db[_0xd213b6(0x1da)](_0xd213b6(0x172))[_0xd213b6(0x120)](currentUser[_0xd213b6(0x22b)])[_0xd213b6(0x21c)]({'userId':currentUser[_0xd213b6(0x22b)],'userName':userData?.[_0xd213b6(0x218)]||_0xd213b6(0x11e),'typing':![],'timestamp':firebase[_0xd213b6(0x166)][_0xd213b6(0x1cd)][_0xd213b6(0x1df)]()},{'merge':!![]}),isTyping=![]);},0x7d0);}function setupTypingListener(){const _0x4a9c76=_0x582850;db['collection'](_0x4a9c76(0x172))[_0x4a9c76(0x1e2)]('typing','==',!![])[_0x4a9c76(0x1e5)](_0x42cc59=>{const _0x5450f3=_0x4a9c76,_0x37bcfe=[];_0x42cc59[_0x5450f3(0x1d6)](_0xee75a1=>{const _0x32fe29=_0x5450f3;_0xee75a1[_0x32fe29(0x258)]()[_0x32fe29(0x10f)]!==currentUser[_0x32fe29(0x22b)]&&_0x37bcfe['push'](_0xee75a1[_0x32fe29(0x258)]());}),_0x37bcfe['length']>0x0?(typingIndicator[_0x5450f3(0x10e)]['add'](_0x5450f3(0x237)),typingIndicator[_0x5450f3(0x24c)]=_0x5450f3(0x149)+_0x37bcfe[0x0]['userName']+_0x5450f3(0x26a)):typingIndicator[_0x5450f3(0x10e)]['remove']('active');});}sendMessageBtn[_0x582850(0x127)](_0x582850(0x214),async()=>{const _0x1822c9=_0x582850,_0x1c31ad=chatInput[_0x1822c9(0x148)][_0x1822c9(0x135)]();if(!_0x1c31ad||!currentUser)return;const _0x50c31e=_0x1822c9(0x234)+Date[_0x1822c9(0x248)](),_0x4d015d=createMessageElement({'id':_0x50c31e,'text':_0x1c31ad,'senderId':currentUser[_0x1822c9(0x22b)],'senderName':userData?.[_0x1822c9(0x218)]||_0x1822c9(0x11e),'status':_0x1822c9(0x202),'createdAt':new Date()});chatMessages[_0x1822c9(0x20e)](_0x4d015d),chatInput[_0x1822c9(0x148)]='',chatInput[_0x1822c9(0x1f7)]['height']=_0x1822c9(0x197),sendMessageBtn[_0x1822c9(0x213)]=!![],chatMessages[_0x1822c9(0x252)]=chatMessages[_0x1822c9(0x215)];try{const _0x2d7515=await db[_0x1822c9(0x1da)](_0x1822c9(0x1f8))['add']({'text':_0x1c31ad,'senderId':currentUser[_0x1822c9(0x22b)],'senderName':userData?.[_0x1822c9(0x218)]||_0x1822c9(0x11e),'createdAt':firebase[_0x1822c9(0x166)][_0x1822c9(0x1cd)]['serverTimestamp'](),'status':_0x1822c9(0x24b)}),_0x558a40=document[_0x1822c9(0x17d)](_0x50c31e);if(_0x558a40){_0x558a40['id']=_0x2d7515['id'];const _0x436f6d=_0x558a40[_0x1822c9(0x143)](_0x1822c9(0x23c));_0x436f6d&&(_0x436f6d[_0x1822c9(0x16a)]='‚úì',_0x436f6d[_0x1822c9(0x10e)][_0x1822c9(0x13c)](_0x1822c9(0x24b)));}}catch(_0x367b9c){console[_0x1822c9(0x181)](_0x1822c9(0x274),_0x367b9c);const _0x211bac=document[_0x1822c9(0x17d)](_0x50c31e);_0x211bac&&(_0x211bac[_0x1822c9(0x143)](_0x1822c9(0x23c))[_0x1822c9(0x16a)]='‚úï');}});function createMessageElement(_0xbc3f7c){const _0x3fb39c=_0x582850,_0x42e084=_0xbc3f7c[_0x3fb39c(0x114)]===currentUser?.[_0x3fb39c(0x22b)],_0x3986c5=_0xbc3f7c['createdAt'][_0x3fb39c(0x174)]?formatTime(_0xbc3f7c[_0x3fb39c(0x18e)][_0x3fb39c(0x174)]()):formatTime(new Date(_0xbc3f7c[_0x3fb39c(0x18e)])),_0x2180a7=document[_0x3fb39c(0x1b2)](_0x3fb39c(0x22a));return _0x2180a7[_0x3fb39c(0x157)]=_0x3fb39c(0x1fd)+(_0x42e084?_0x3fb39c(0x24b):_0x3fb39c(0x170)),_0x2180a7['id']=_0xbc3f7c['id'],_0x2180a7[_0x3fb39c(0x24c)]=_0x3fb39c(0x207)+(!_0x42e084?_0x3fb39c(0x21b)+_0xbc3f7c[_0x3fb39c(0x22c)]+_0x3fb39c(0x270):'')+_0x3fb39c(0x246)+_0xbc3f7c[_0x3fb39c(0x1e8)]+_0x3fb39c(0x229)+_0x3986c5+_0x3fb39c(0x189)+(_0x42e084?_0x3fb39c(0x251)+(_0xbc3f7c['status']||'sent')+'\x22>'+(_0xbc3f7c['status']===_0x3fb39c(0x202)?_0x3fb39c(0x268):'‚úì')+'</span>':'')+_0x3fb39c(0x1dd),_0x2180a7;}function formatTime(_0x59457c){const _0x2a0cee=_0x582850;return _0x59457c[_0x2a0cee(0x14b)]([],{'hour':'2-digit','minute':'2-digit'});}chatInput[_0x582850(0x127)](_0x582850(0x14d),_0x4c50bc=>{const _0xc1d358=_0x582850;_0x4c50bc['key']===_0xc1d358(0x1d2)&&!_0x4c50bc[_0xc1d358(0x119)]&&(_0x4c50bc[_0xc1d358(0x18d)](),sendMessageBtn[_0xc1d358(0x214)]()),updateTyping();});function updateProfileUI(){const _0x1317f7=_0x582850;if(!currentUser||!userData){profileName[_0x1317f7(0x16a)]=_0x1317f7(0x225),profileUsername['textContent']=_0x1317f7(0x1a4),profileEmail[_0x1317f7(0x16a)]=_0x1317f7(0x12a),profileBio['textContent']='No\x20bio\x20available.\x20Edit\x20your\x20profile\x20to\x20add\x20one.',booksShared[_0x1317f7(0x16a)]='0',booksDownloaded[_0x1317f7(0x16a)]='0',memberSince[_0x1317f7(0x16a)]='-',avatarInitials['textContent']='U',profileAvatarInitials[_0x1317f7(0x16a)]='U',userPoints[_0x1317f7(0x16a)]='0',withdrawBtn[_0x1317f7(0x213)]=!![];return;}profileName['textContent']=userData[_0x1317f7(0x218)]||_0x1317f7(0x1ca),profileUsername[_0x1317f7(0x16a)]='@'+(userData[_0x1317f7(0x173)]||_0x1317f7(0x249)),profileEmail[_0x1317f7(0x24c)]=_0x1317f7(0x162)+currentUser[_0x1317f7(0x271)],profileBio[_0x1317f7(0x16a)]=userData[_0x1317f7(0x1fe)]||'No\x20bio\x20available.\x20Edit\x20your\x20profile\x20to\x20add\x20one.',booksShared[_0x1317f7(0x16a)]=userData[_0x1317f7(0x183)]||'0',booksDownloaded[_0x1317f7(0x16a)]=userData['booksDownloaded']||'0',userPoints[_0x1317f7(0x16a)]=userData[_0x1317f7(0x1bb)],withdrawBtn[_0x1317f7(0x213)]=!userData[_0x1317f7(0x1bb)]||userData['points']<0x1f4;const _0x201f40=userData[_0x1317f7(0x218)]?userData[_0x1317f7(0x218)][_0x1317f7(0x1b1)]('\x20')[_0x1317f7(0x19f)](_0x278f33=>_0x278f33[0x0])[_0x1317f7(0x136)]('')['toUpperCase']():'U';avatarInitials[_0x1317f7(0x16a)]=_0x201f40,profileAvatarInitials['textContent']=_0x201f40;if(userData[_0x1317f7(0x18e)]){const _0x466c5f=userData['createdAt'][_0x1317f7(0x174)]?userData['createdAt'][_0x1317f7(0x174)]():new Date(userData['createdAt']);memberSince['textContent']=_0x466c5f['getFullYear']();}else memberSince[_0x1317f7(0x16a)]='-';fetchWithdrawalHistory();}function fetchWithdrawalHistory(){const _0x58cb24=_0x582850;if(!currentUser)return;db[_0x58cb24(0x1da)](_0x58cb24(0x1f0))[_0x58cb24(0x1e2)](_0x58cb24(0x10f),'==',currentUser['uid'])['orderBy'](_0x58cb24(0x139),_0x58cb24(0x134))[_0x58cb24(0x1e5)](_0x452e36=>{const _0x5de1d8=_0x58cb24;if(_0x452e36[_0x5de1d8(0x131)]){emptyWithdrawalHistory[_0x5de1d8(0x1f7)][_0x5de1d8(0x1be)]=_0x5de1d8(0x158);return;}emptyWithdrawalHistory['style'][_0x5de1d8(0x1be)]='none',withdrawalHistory[_0x5de1d8(0x24c)]=_0x5de1d8(0x17b),_0x452e36['forEach'](_0x42295e=>{const _0x10e908=_0x5de1d8,_0x328e5f=_0x42295e[_0x10e908(0x258)](),_0x5d4e84=document[_0x10e908(0x1b2)](_0x10e908(0x22a));_0x5d4e84[_0x10e908(0x157)]=_0x10e908(0x1c9);const _0x149c6d=_0x328e5f['status']===_0x10e908(0x198)?_0x10e908(0x13a):_0x328e5f[_0x10e908(0x144)]==='rejected'?_0x10e908(0x20b):_0x10e908(0x265);_0x5d4e84[_0x10e908(0x24c)]=_0x10e908(0x24f)+_0x328e5f[_0x10e908(0x186)]+'\x20('+_0x328e5f[_0x10e908(0x16b)]+_0x10e908(0x19c)+_0x328e5f[_0x10e908(0x1e9)]+_0x10e908(0x1e7)+_0x328e5f['paymentId']+_0x10e908(0x264)+formatDate(_0x328e5f[_0x10e908(0x139)][_0x10e908(0x174)]())+_0x10e908(0x1f6)+_0x149c6d+'\x22>'+_0x328e5f[_0x10e908(0x144)]+_0x10e908(0x260),withdrawalHistory[_0x10e908(0x20e)](_0x5d4e84);});});}withdrawalOptions[_0x582850(0x1d6)](_0xd73cd7=>{const _0x3935=_0x582850;_0xd73cd7[_0x3935(0x127)](_0x3935(0x214),()=>{const _0x50e0fd=_0x3935;withdrawalOptions['forEach'](_0x1c2d96=>_0x1c2d96[_0x50e0fd(0x10e)][_0x50e0fd(0x16e)](_0x50e0fd(0x237))),_0xd73cd7[_0x50e0fd(0x10e)][_0x50e0fd(0x13c)](_0x50e0fd(0x237)),selectedWithdrawalMethod=_0xd73cd7[_0x50e0fd(0x233)](_0x50e0fd(0x254));switch(selectedWithdrawalMethod){case _0x50e0fd(0x21d):paymentMethodLabel[_0x50e0fd(0x16a)]='UPI\x20ID',paymentId[_0x50e0fd(0x164)]=_0x50e0fd(0x1ec);break;case _0x50e0fd(0x20d):paymentMethodLabel[_0x50e0fd(0x16a)]='Bank\x20Account\x20Number',paymentId[_0x50e0fd(0x164)]=_0x50e0fd(0x129);break;case _0x50e0fd(0x22d):paymentMethodLabel[_0x50e0fd(0x16a)]=_0x50e0fd(0x142),paymentId[_0x50e0fd(0x164)]=_0x50e0fd(0x184);break;case _0x50e0fd(0x23f):paymentMethodLabel[_0x50e0fd(0x16a)]=_0x50e0fd(0x1c5),paymentId['placeholder']='Enter\x20your\x20PhonePe\x20registered\x20number';break;}selectedWithdrawalAmount&&paymentDetails[_0x50e0fd(0x10e)][_0x50e0fd(0x13c)](_0x50e0fd(0x237));});}),amountOptions[_0x582850(0x1d6)](_0x23eea1=>{const _0x409f8e=_0x582850;_0x23eea1['addEventListener'](_0x409f8e(0x214),()=>{const _0x4b01d9=_0x409f8e;amountOptions['forEach'](_0x2aebd3=>_0x2aebd3[_0x4b01d9(0x10e)][_0x4b01d9(0x16e)](_0x4b01d9(0x237))),_0x23eea1['classList']['add']('active'),selectedWithdrawalAmount=_0x23eea1[_0x4b01d9(0x233)](_0x4b01d9(0x1ac)),selectedWithdrawalRs=_0x23eea1[_0x4b01d9(0x233)](_0x4b01d9(0x1f1)),selectedWithdrawalMethod&&paymentDetails[_0x4b01d9(0x10e)][_0x4b01d9(0x13c)](_0x4b01d9(0x237));});}),submitWithdrawalBtn[_0x582850(0x127)](_0x582850(0x214),async()=>{const _0x4d74c8=_0x582850;if(!currentUser||!userData||!selectedWithdrawalMethod||!selectedWithdrawalAmount||!paymentId[_0x4d74c8(0x148)]||!accountName['value']){showToast(_0x4d74c8(0x1b6),'error');return;}if(userData[_0x4d74c8(0x1bb)]<parseInt(selectedWithdrawalAmount)){showToast(_0x4d74c8(0x113),_0x4d74c8(0x181));return;}const _0x1175c4=document['getElementById']('withdrawalSpinner');submitWithdrawalBtn[_0x4d74c8(0x213)]=!![],_0x1175c4[_0x4d74c8(0x1f7)][_0x4d74c8(0x1be)]=_0x4d74c8(0x220);try{await db[_0x4d74c8(0x1da)](_0x4d74c8(0x1f0))['add']({'userId':currentUser[_0x4d74c8(0x22b)],'userName':userData[_0x4d74c8(0x218)],'userEmail':currentUser[_0x4d74c8(0x271)],'method':selectedWithdrawalMethod,'paymentId':paymentId[_0x4d74c8(0x148)],'accountName':accountName[_0x4d74c8(0x148)],'amountPoints':parseInt(selectedWithdrawalAmount),'amountRs':parseInt(selectedWithdrawalRs),'status':'pending','requestedAt':firebase[_0x4d74c8(0x166)][_0x4d74c8(0x1cd)]['serverTimestamp'](),'processedAt':null,'processedBy':null}),await db[_0x4d74c8(0x1da)](_0x4d74c8(0x273))[_0x4d74c8(0x120)](currentUser[_0x4d74c8(0x22b)])[_0x4d74c8(0x256)]({'points':firebase['firestore'][_0x4d74c8(0x1cd)]['increment'](-parseInt(selectedWithdrawalAmount))}),userData[_0x4d74c8(0x1bb)]-=parseInt(selectedWithdrawalAmount),userPoints['textContent']=userData[_0x4d74c8(0x1bb)],withdrawBtn[_0x4d74c8(0x213)]=userData['points']<0x1f4,closeModal(withdrawalModal),showToast(_0x4d74c8(0x1db),_0x4d74c8(0x192)),withdrawalOptions[_0x4d74c8(0x1d6)](_0x1420ac=>_0x1420ac[_0x4d74c8(0x10e)][_0x4d74c8(0x16e)](_0x4d74c8(0x237))),amountOptions[_0x4d74c8(0x1d6)](_0x12aeb0=>_0x12aeb0[_0x4d74c8(0x10e)][_0x4d74c8(0x16e)](_0x4d74c8(0x237))),paymentDetails[_0x4d74c8(0x10e)][_0x4d74c8(0x16e)](_0x4d74c8(0x237)),paymentId['value']='',accountName[_0x4d74c8(0x148)]='',selectedWithdrawalMethod=null,selectedWithdrawalAmount=null,selectedWithdrawalRs=null;}catch(_0x5f9ce5){console[_0x4d74c8(0x181)](_0x4d74c8(0x242),_0x5f9ce5),showToast(_0x4d74c8(0x23d),_0x4d74c8(0x181));}finally{submitWithdrawalBtn[_0x4d74c8(0x213)]=![],_0x1175c4[_0x4d74c8(0x1f7)][_0x4d74c8(0x1be)]=_0x4d74c8(0x1ea);}}),withdrawBtn[_0x582850(0x127)](_0x582850(0x214),()=>{const _0x4d941a=_0x582850;if(!currentUser){openModal(loginModal);return;}if(userData[_0x4d941a(0x1bb)]<0x1f4){showToast(_0x4d941a(0x1de),'error');return;}openModal(withdrawalModal);}),closeWithdrawalModal[_0x582850(0x127)](_0x582850(0x214),()=>closeModal(withdrawalModal));function renderBooks(_0x5dd11d){const _0x13076f=_0x582850;allBooks=_0x5dd11d;if(_0x5dd11d[_0x13076f(0x21f)]===0x0){emptyState['style'][_0x13076f(0x1be)]=_0x13076f(0x158),booksContainer['innerHTML']='',booksContainer['appendChild'](emptyState);return;}emptyState[_0x13076f(0x1f7)]['display']='none',booksContainer['innerHTML']='',_0x5dd11d['forEach']((_0x3f587c,_0x1d41c3)=>{const _0x347ea6=_0x13076f,_0x39211b=document[_0x347ea6(0x1b2)](_0x347ea6(0x22a));_0x39211b['className']=_0x347ea6(0x26e),_0x39211b[_0x347ea6(0x13d)](_0x347ea6(0x154),_0x3f587c['id']),_0x39211b[_0x347ea6(0x1f7)]['animationDelay']=_0x1d41c3*0.1+'s';let _0x5b4c29='';if(_0x3f587c[_0x347ea6(0x144)]===_0x347ea6(0x18a)&&_0x3f587c['reviewedBy']&&_0x3f587c[_0x347ea6(0x193)]){const _0xfb6770=_0x3f587c[_0x347ea6(0x193)]['toDate']();_0x5b4c29=_0x347ea6(0x1d0)+_0x3f587c[_0x347ea6(0x150)]+_0x347ea6(0x257)+formatDate(_0xfb6770);}else{if(_0x3f587c[_0x347ea6(0x144)]===_0x347ea6(0x1c1)&&_0x3f587c[_0x347ea6(0x150)]&&_0x3f587c[_0x347ea6(0x193)]){const _0x363b7c=_0x3f587c[_0x347ea6(0x193)]['toDate']();_0x5b4c29=_0x347ea6(0x146)+_0x3f587c[_0x347ea6(0x150)]+'\x20on\x20'+formatDate(_0x363b7c);}}_0x39211b[_0x347ea6(0x24c)]=_0x347ea6(0x20c)+(_0x3f587c[_0x347ea6(0x27d)]||_0x347ea6(0x151))+'\x22\x20alt=\x22'+_0x3f587c['bookName']+'\x22\x20class=\x22book-img\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22book-overlay-title\x22>'+_0x3f587c[_0x347ea6(0x18c)]+_0x347ea6(0x14f)+_0x3f587c['authorName']+_0x347ea6(0x169)+(_0x3f587c[_0x347ea6(0x1a3)]?_0x347ea6(0x261)+_0x3f587c[_0x347ea6(0x1a3)]+_0x347ea6(0x1aa):'')+_0x347ea6(0x163)+_0x3f587c[_0x347ea6(0x12e)]+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-download\x22></i>\x20Download\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x3f587c[_0x347ea6(0x144)]===_0x347ea6(0x11c)?_0x347ea6(0x178):'')+_0x347ea6(0x194)+(_0x3f587c[_0x347ea6(0x144)]===_0x347ea6(0x1c1)?'<span\x20class=\x22status-badge\x20status-rejected\x22>Rejected</span>':'')+_0x347ea6(0x194)+(_0x3f587c[_0x347ea6(0x144)]==='approved'?_0x347ea6(0x145):'')+_0x347ea6(0x236)+_0x3f587c['bookName']+_0x347ea6(0x272)+_0x3f587c[_0x347ea6(0x19b)]+_0x347ea6(0x1a2)+(_0x3f587c[_0x347ea6(0x16c)]||_0x347ea6(0x11e))+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-calendar-alt\x22></i>\x20'+(_0x3f587c[_0x347ea6(0x1c6)]?formatDate(_0x3f587c[_0x347ea6(0x1c6)][_0x347ea6(0x174)]()):_0x347ea6(0x279))+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x5b4c29?'<div\x20class=\x22book-admin-info\x22><i\x20class=\x22fas\x20fa-user-shield\x22></i>\x20'+_0x5b4c29+_0x347ea6(0x270):'')+_0x347ea6(0x130)+_0x3f587c[_0x347ea6(0x12e)]+_0x347ea6(0x118),booksContainer['appendChild'](_0x39211b);}),document[_0x13076f(0x230)](_0x13076f(0x109))[_0x13076f(0x1d6)](_0x4cba92=>{const _0x367b64=_0x13076f;_0x4cba92[_0x367b64(0x127)](_0x367b64(0x214),_0x1e56a2=>{const _0x116f11=_0x367b64;if(!currentUser){openModal(loginModal);return;}const _0x4a2d63=_0x1e56a2[_0x116f11(0x141)][_0x116f11(0x233)]('data-link');window['open'](_0x4a2d63,_0x116f11(0x267));if(currentUser){db[_0x116f11(0x1da)](_0x116f11(0x273))['doc'](currentUser[_0x116f11(0x22b)])[_0x116f11(0x256)]({'booksDownloaded':firebase[_0x116f11(0x166)][_0x116f11(0x1cd)][_0x116f11(0x12f)](0x1)});const _0x273464=_0x1e56a2['currentTarget'][_0x116f11(0x228)]('.book-card')?.[_0x116f11(0x233)](_0x116f11(0x154));_0x273464&&db[_0x116f11(0x1da)]('books')[_0x116f11(0x120)](_0x273464)[_0x116f11(0x256)]({'downloads':firebase[_0x116f11(0x166)][_0x116f11(0x1cd)]['increment'](0x1)});}});});}function renderUserBooks(_0x1e933a){const _0x33453a=_0x582850;if(_0x1e933a[_0x33453a(0x21f)]===0x0){profileBooksContainer[_0x33453a(0x24c)]=_0x33453a(0x1f2);return;}profileBooksContainer['innerHTML']='',_0x1e933a[_0x33453a(0x1d6)](_0x117cdb=>{const _0x145d34=_0x33453a,_0x15a5e6=document[_0x145d34(0x1b2)](_0x145d34(0x22a));_0x15a5e6[_0x145d34(0x157)]=_0x145d34(0x26e),_0x15a5e6['innerHTML']=_0x145d34(0x20c)+(_0x117cdb[_0x145d34(0x27d)]||'https://via.placeholder.com/300x200?text=No+Cover')+_0x145d34(0x263)+_0x117cdb[_0x145d34(0x18c)]+'\x22\x20class=\x22book-img\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22book-overlay-title\x22>'+_0x117cdb['bookName']+_0x145d34(0x14f)+_0x117cdb[_0x145d34(0x19b)]+_0x145d34(0x169)+(_0x117cdb[_0x145d34(0x1a3)]?_0x145d34(0x261)+_0x117cdb[_0x145d34(0x1a3)]+_0x145d34(0x1aa):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22book-overlay-btn\x22\x20data-link=\x22'+_0x117cdb[_0x145d34(0x12e)]+_0x145d34(0x20f)+(_0x117cdb[_0x145d34(0x144)]==='pending'?_0x145d34(0x178):'')+_0x145d34(0x194)+(_0x117cdb[_0x145d34(0x144)]===_0x145d34(0x1c1)?_0x145d34(0x219):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x117cdb[_0x145d34(0x144)]===_0x145d34(0x18a)?_0x145d34(0x145):'')+_0x145d34(0x236)+_0x117cdb[_0x145d34(0x18c)]+_0x145d34(0x272)+_0x117cdb['authorName']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-calendar-alt\x22></i>\x20'+(_0x117cdb[_0x145d34(0x1c6)]?formatDate(_0x117cdb[_0x145d34(0x1c6)][_0x145d34(0x174)]()):_0x145d34(0x1f5))+_0x145d34(0x25f)+(_0x117cdb[_0x145d34(0x126)]||0x0)+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x117cdb['reviewedBy']?'<div\x20class=\x22book-admin-info\x22><i\x20class=\x22fas\x20fa-user-shield\x22></i>\x20Reviewed\x20by\x20'+_0x117cdb[_0x145d34(0x150)]+'</div>':'')+_0x145d34(0x130)+_0x117cdb[_0x145d34(0x12e)]+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-external-link-alt\x22></i>\x20View\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',profileBooksContainer[_0x145d34(0x20e)](_0x15a5e6);}),document[_0x33453a(0x230)]('.download-btn,\x20.book-overlay-btn')[_0x33453a(0x1d6)](_0x249856=>{const _0xe96b60=_0x33453a;_0x249856[_0xe96b60(0x127)](_0xe96b60(0x214),_0x27e24d=>{const _0x48dcf6=_0xe96b60,_0x5bb4cd=_0x27e24d[_0x48dcf6(0x141)][_0x48dcf6(0x233)](_0x48dcf6(0x161));window[_0x48dcf6(0x190)](_0x5bb4cd,'_blank');});});}function fetchUserBooks(){const _0x2dfb6d=_0x582850;if(!currentUser)return;const _0x4e2ed9=document[_0x2dfb6d(0x17d)](_0x2dfb6d(0x124)),_0x16896d=document['getElementById'](_0x2dfb6d(0x185));_0x4e2ed9['innerHTML']='',_0x16896d[_0x2dfb6d(0x1f7)][_0x2dfb6d(0x1be)]=_0x2dfb6d(0x1ea);let _0x580dcf=db['collection'](_0x2dfb6d(0x26f))[_0x2dfb6d(0x1e2)](_0x2dfb6d(0x1af),'==',currentUser['uid'])[_0x2dfb6d(0x155)]('submittedAt',_0x2dfb6d(0x134))['limit'](booksLimit);_0x580dcf[_0x2dfb6d(0x224)]()[_0x2dfb6d(0x203)](_0x2b8bc0=>{const _0x1559a4=_0x2dfb6d;if(_0x2b8bc0[_0x1559a4(0x131)]){_0x4e2ed9[_0x1559a4(0x24c)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22empty-state\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22fas\x20fa-book\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3>No\x20Books\x20Shared\x20Yet</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Start\x20sharing\x20books\x20with\x20the\x20community!</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';return;}const _0x4049d2=[];_0x2b8bc0[_0x1559a4(0x1d6)](_0x55da96=>{const _0x101286=_0x1559a4;_0x4049d2[_0x101286(0x20a)]({'id':_0x55da96['id'],..._0x55da96[_0x101286(0x258)]()});}),renderUserBooks(_0x4049d2),_0x2b8bc0[_0x1559a4(0x1f9)][_0x1559a4(0x21f)]===booksLimit?(lastBookSnapshot=_0x2b8bc0['docs'][_0x2b8bc0['docs']['length']-0x1],hasMoreBooks=!![],_0x16896d['style'][_0x1559a4(0x1be)]=_0x1559a4(0x24e)):(hasMoreBooks=![],_0x16896d[_0x1559a4(0x1f7)][_0x1559a4(0x1be)]=_0x1559a4(0x1ea));})[_0x2dfb6d(0x1a0)](_0x47c471=>{const _0x4e3cc8=_0x2dfb6d;console[_0x4e3cc8(0x181)](_0x4e3cc8(0x275),_0x47c471);});}document[_0x582850(0x17d)]('loadMoreBooksBtn')[_0x582850(0x127)]('click',()=>{const _0x59a18a=_0x582850;if(!currentUser||!hasMoreBooks)return;const _0x2dce64=document[_0x59a18a(0x17d)](_0x59a18a(0x124)),_0x45f76a=document[_0x59a18a(0x17d)](_0x59a18a(0x185));_0x45f76a[_0x59a18a(0x213)]=!![];let _0x3ab85e=db['collection']('books')[_0x59a18a(0x1e2)](_0x59a18a(0x1af),'==',currentUser[_0x59a18a(0x22b)])[_0x59a18a(0x155)]('submittedAt','desc')['startAfter'](lastBookSnapshot)[_0x59a18a(0x133)](booksLimit);_0x3ab85e[_0x59a18a(0x224)]()[_0x59a18a(0x203)](_0x49b02e=>{const _0x3aa4f1=_0x59a18a,_0x2ac556=[];_0x49b02e['forEach'](_0x5492b5=>{const _0x200a4a=_0x4b14;_0x2ac556[_0x200a4a(0x20a)]({'id':_0x5492b5['id'],..._0x5492b5[_0x200a4a(0x258)]()});}),renderUserBooks(_0x2ac556,!![]),_0x49b02e['docs']['length']===booksLimit?(lastBookSnapshot=_0x49b02e[_0x3aa4f1(0x1f9)][_0x49b02e[_0x3aa4f1(0x1f9)]['length']-0x1],hasMoreBooks=!![]):(hasMoreBooks=![],_0x45f76a[_0x3aa4f1(0x1f7)][_0x3aa4f1(0x1be)]=_0x3aa4f1(0x1ea)),_0x45f76a['disabled']=![];})[_0x59a18a(0x1a0)](_0x2cfe7f=>{const _0x29c7f2=_0x59a18a;console['error'](_0x29c7f2(0x1bf),_0x2cfe7f),_0x45f76a['disabled']=![];});});function _0x4b14(_0x4129b6,_0x52aa4a){const _0x2ab7a9=_0x2ab7();return _0x4b14=function(_0x4b147b,_0x33ea56){_0x4b147b=_0x4b147b-0x109;let _0x424aa6=_0x2ab7a9[_0x4b147b];return _0x424aa6;},_0x4b14(_0x4129b6,_0x52aa4a);}function renderUserBooks(_0x598d70,_0x219762=![]){const _0xa585f0=_0x582850,_0x58f630=document[_0xa585f0(0x17d)](_0xa585f0(0x124));!_0x219762&&(_0x58f630[_0xa585f0(0x24c)]='');if(_0x598d70['length']===0x0&&!_0x219762){_0x58f630[_0xa585f0(0x24c)]=_0xa585f0(0x1d9);return;}_0x598d70[_0xa585f0(0x1d6)](_0x4abefb=>{const _0x18380d=_0xa585f0,_0x2a1da1=document[_0x18380d(0x1b2)](_0x18380d(0x22a));_0x2a1da1[_0x18380d(0x157)]=_0x18380d(0x26e),_0x2a1da1['innerHTML']=_0x18380d(0x1a1)+(_0x4abefb[_0x18380d(0x27d)]||_0x18380d(0x151))+_0x18380d(0x263)+_0x4abefb[_0x18380d(0x18c)]+_0x18380d(0x25c)+_0x4abefb[_0x18380d(0x18c)]+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22book-overlay-author\x22>By\x20'+_0x4abefb[_0x18380d(0x19b)]+_0x18380d(0x247)+(_0x4abefb[_0x18380d(0x1a3)]?_0x18380d(0x261)+_0x4abefb[_0x18380d(0x1a3)]+_0x18380d(0x1aa):'')+_0x18380d(0x167)+_0x4abefb['driveLink']+_0x18380d(0x188)+(_0x4abefb[_0x18380d(0x144)]===_0x18380d(0x11c)?_0x18380d(0x178):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x4abefb[_0x18380d(0x144)]===_0x18380d(0x1c1)?_0x18380d(0x219):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x4abefb[_0x18380d(0x144)]==='approved'?_0x18380d(0x145):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22book-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22book-title\x22>'+_0x4abefb[_0x18380d(0x18c)]+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22book-author\x22>By\x20'+_0x4abefb['authorName']+_0x18380d(0x1ae)+(_0x4abefb['submittedAt']?formatDate(_0x4abefb['submittedAt'][_0x18380d(0x174)]()):_0x18380d(0x1f5))+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><i\x20class=\x22fas\x20fa-download\x22></i>\x20'+(_0x4abefb['downloads']||0x0)+_0x18380d(0x156)+(_0x4abefb[_0x18380d(0x150)]?_0x18380d(0x159)+_0x4abefb['reviewedBy']+_0x18380d(0x270):'')+_0x18380d(0x1ef)+_0x4abefb[_0x18380d(0x12e)]+_0x18380d(0x116),_0x58f630[_0x18380d(0x20e)](_0x2a1da1);}),document[_0xa585f0(0x230)]('.download-btn,\x20.book-overlay-btn')['forEach'](_0x3566c0=>{const _0x6062d8=_0xa585f0;_0x3566c0[_0x6062d8(0x127)](_0x6062d8(0x214),_0x522f50=>{const _0x1fd5b5=_0x6062d8,_0x2ed7ea=_0x522f50[_0x1fd5b5(0x141)][_0x1fd5b5(0x233)](_0x1fd5b5(0x161));window[_0x1fd5b5(0x190)](_0x2ed7ea,_0x1fd5b5(0x267));});});}function formatDate(_0x119125){const _0x5602e7=_0x582850,_0x2e0c8c=_0x119125['getDate']()['toString']()[_0x5602e7(0x206)](0x2,'0'),_0x3d59b7=(_0x119125['getMonth']()+0x1)['toString']()[_0x5602e7(0x206)](0x2,'0'),_0x40cd00=_0x119125[_0x5602e7(0x13b)]();return _0x2e0c8c+'/'+_0x3d59b7+'/'+_0x40cd00;}function fetchBooks(){const _0x4c616d=_0x582850;db[_0x4c616d(0x1da)]('books')['where']('status','==',_0x4c616d(0x18a))[_0x4c616d(0x155)](_0x4c616d(0x243),_0x4c616d(0x134))[_0x4c616d(0x1e5)](_0x41d95c=>{const _0x4303c7=[];_0x41d95c['forEach'](_0x2e0e93=>{const _0x1d8ca6=_0x4b14;_0x4303c7[_0x1d8ca6(0x20a)]({'id':_0x2e0e93['id'],..._0x2e0e93['data']()});}),renderBooks(_0x4303c7);},_0x267161=>{const _0xe51f43=_0x4c616d;console['error'](_0xe51f43(0x1c4),_0x267161);});}auth[_0x582850(0x25a)](async _0x11b98=>{const _0x13d55d=_0x582850;currentUser=_0x11b98;if(_0x11b98){const _0x437ce1=await db[_0x13d55d(0x1da)]('users')['doc'](_0x11b98['uid'])[_0x13d55d(0x224)]();userData=_0x437ce1[_0x13d55d(0x223)]?_0x437ce1['data']():null,setupDownloadButtons(),setupBookApprovalListener();if(!_0x437ce1[_0x13d55d(0x223)]){const _0x908eca=_0x11b98[_0x13d55d(0x138)]||_0x13d55d(0x225),_0x301307=_0x908eca[_0x13d55d(0x1b1)]('\x20')[_0x13d55d(0x19f)](_0x365fc6=>_0x365fc6[0x0])['join']('')[_0x13d55d(0x259)]();await db[_0x13d55d(0x1da)](_0x13d55d(0x273))[_0x13d55d(0x120)](_0x11b98[_0x13d55d(0x22b)])[_0x13d55d(0x21c)]({'name':_0x908eca,'email':_0x11b98[_0x13d55d(0x271)],'username':_0x11b98['email'][_0x13d55d(0x1b1)]('@')[0x0],'createdAt':firebase[_0x13d55d(0x166)][_0x13d55d(0x1cd)][_0x13d55d(0x1df)](),'booksShared':0x0,'booksDownloaded':0x0,'points':0x0,'role':'user','lastActive':firebase['firestore'][_0x13d55d(0x1cd)][_0x13d55d(0x1df)](),'status':'active'}),userData={'name':_0x908eca,'email':_0x11b98['email'],'username':_0x11b98[_0x13d55d(0x271)][_0x13d55d(0x1b1)]('@')[0x0],'booksShared':0x0,'booksDownloaded':0x0,'points':0x0};}updateProfileUI(),fetchBooks(),setupTypingListener(),db['collection'](_0x13d55d(0x1f8))[_0x13d55d(0x155)]('createdAt')[_0x13d55d(0x133)](0x32)[_0x13d55d(0x1e5)](_0x4b3090=>{const _0x9496ed=_0x13d55d;chatMessages['children'][_0x9496ed(0x21f)]===0x0&&(chatMessages[_0x9496ed(0x24c)]=''),_0x4b3090[_0x9496ed(0x121)]()[_0x9496ed(0x1d6)](_0xc0aae2=>{const _0x558b9b=_0x9496ed;if(_0xc0aae2[_0x558b9b(0x26c)]===_0x558b9b(0x140)){const _0x20d8f5=_0xc0aae2['doc']['data'](),_0x34b2d1=_0x20d8f5['senderId']===_0x11b98[_0x558b9b(0x22b)];if(!document[_0x558b9b(0x17d)](_0xc0aae2[_0x558b9b(0x120)]['id'])){const _0x18e1bb=createMessageElement({'id':_0xc0aae2[_0x558b9b(0x120)]['id'],..._0x20d8f5});chatMessages['appendChild'](_0x18e1bb);const _0x19f742=chatMessages['scrollHeight']-chatMessages['clientHeight']<=chatMessages[_0x558b9b(0x252)]+0x32;(_0x19f742||_0x34b2d1)&&setTimeout(()=>{const _0x51d70f=_0x558b9b;chatMessages['scrollTop']=chatMessages[_0x51d70f(0x215)];},0x32);}}else{if(_0xc0aae2[_0x558b9b(0x26c)]===_0x558b9b(0x12d)){const _0x3bb5c=document[_0x558b9b(0x17d)](_0xc0aae2[_0x558b9b(0x120)]['id']);if(_0x3bb5c){const _0x264d92=_0x3bb5c['querySelector'](_0x558b9b(0x23c));_0x264d92&&(_0x264d92['textContent']='‚úì‚úì',_0x264d92[_0x558b9b(0x10e)][_0x558b9b(0x13c)](_0x558b9b(0x245)));}}}});}),db['collection'](_0x13d55d(0x273))[_0x13d55d(0x120)](_0x11b98[_0x13d55d(0x22b)])[_0x13d55d(0x256)]({'lastActive':firebase[_0x13d55d(0x166)][_0x13d55d(0x1cd)]['serverTimestamp']()});}else userData=null,updateProfileUI();}),addBookForm['addEventListener'](_0x582850(0x1bc),async _0x27053d=>{const _0x5ab723=_0x582850;_0x27053d[_0x5ab723(0x18d)]();if(!currentUser){showToast(_0x5ab723(0x128),_0x5ab723(0x181));return;}const _0x3ed78f=document[_0x5ab723(0x17d)]('submitBookBtn'),_0x2bd392=document[_0x5ab723(0x17d)]('submitSpinner');_0x3ed78f[_0x5ab723(0x213)]=!![],_0x2bd392[_0x5ab723(0x1f7)]['display']=_0x5ab723(0x220);const _0x1cb253=document[_0x5ab723(0x17d)](_0x5ab723(0x18c))[_0x5ab723(0x148)],_0x228de1=document[_0x5ab723(0x17d)](_0x5ab723(0x19b))[_0x5ab723(0x148)],_0x2b2664=document[_0x5ab723(0x17d)](_0x5ab723(0x160))['value'],_0x55099e=document[_0x5ab723(0x17d)](_0x5ab723(0x132))[_0x5ab723(0x148)],_0x12eca2=document['getElementById'](_0x5ab723(0x12e))[_0x5ab723(0x148)],_0x3780eb=document[_0x5ab723(0x17d)]('bookDescription')[_0x5ab723(0x148)];try{if(!_0x12eca2['includes'](_0x5ab723(0x1ad)))throw new Error(_0x5ab723(0x12c));await db[_0x5ab723(0x1da)](_0x5ab723(0x26f))[_0x5ab723(0x13c)]({'bookName':_0x1cb253,'authorName':_0x228de1,'category':_0x2b2664,'imageUrl':_0x55099e||null,'description':_0x3780eb,'driveLink':_0x12eca2,'submittedBy':currentUser[_0x5ab723(0x22b)],'submittedByName':userData?.[_0x5ab723(0x218)]||'Anonymous','submittedAt':firebase[_0x5ab723(0x166)][_0x5ab723(0x1cd)][_0x5ab723(0x1df)](),'status':'pending','adminNotes':'','reviewedBy':'','reviewedAt':null,'rejectionReason':'','downloads':0x0}),await db[_0x5ab723(0x1da)](_0x5ab723(0x273))[_0x5ab723(0x120)](currentUser[_0x5ab723(0x22b)])[_0x5ab723(0x256)]({'booksShared':firebase[_0x5ab723(0x166)][_0x5ab723(0x1cd)][_0x5ab723(0x12f)](0x1)}),userData[_0x5ab723(0x1bb)]=userData[_0x5ab723(0x1bb)],booksShared[_0x5ab723(0x16a)]=userData['booksShared'],userPoints['textContent']=userData[_0x5ab723(0x1bb)],withdrawBtn[_0x5ab723(0x213)]=userData['points']<0x1f4,addBookForm[_0x5ab723(0x1cc)](),closeModal(addBookModal);}catch(_0x468532){console[_0x5ab723(0x181)](_0x5ab723(0x22e),_0x468532),showToast(_0x5ab723(0x1ab)+_0x468532[_0x5ab723(0x137)],'error');}finally{_0x3ed78f[_0x5ab723(0x213)]=![],_0x2bd392['style'][_0x5ab723(0x1be)]=_0x5ab723(0x1ea);}}),document[_0x582850(0x230)](_0x582850(0x109))[_0x582850(0x1d6)](_0x20d214=>{_0x20d214['addEventListener']('click',_0x367aff=>{const _0xfa2813=_0x4b14;if(!currentUser){openModal(loginModal);return;}const _0x9d6c51=_0x367aff['currentTarget']['getAttribute'](_0xfa2813(0x161));window['open'](_0x9d6c51,_0xfa2813(0x267));if(currentUser){db['collection'](_0xfa2813(0x273))['doc'](currentUser['uid'])[_0xfa2813(0x256)]({'booksDownloaded':firebase[_0xfa2813(0x166)]['FieldValue'][_0xfa2813(0x12f)](0x0)});const _0xded119=_0x367aff[_0xfa2813(0x141)][_0xfa2813(0x228)](_0xfa2813(0x255))?.['getAttribute'](_0xfa2813(0x154));_0xded119&&(db[_0xfa2813(0x1da)](_0xfa2813(0x26f))[_0xfa2813(0x120)](_0xded119)[_0xfa2813(0x256)]({'downloads':firebase[_0xfa2813(0x166)][_0xfa2813(0x1cd)]['increment'](0x1)}),db[_0xfa2813(0x1da)](_0xfa2813(0x26f))[_0xfa2813(0x120)](_0xded119)['get']()[_0xfa2813(0x203)](_0x201ba6=>{const _0x574702=_0xfa2813;if(_0x201ba6[_0x574702(0x223)]){const _0x3a1f64=_0x201ba6[_0x574702(0x258)]()[_0x574702(0x1af)];_0x3a1f64&&_0x3a1f64!==currentUser[_0x574702(0x22b)]&&db[_0x574702(0x1da)]('users')[_0x574702(0x120)](_0x3a1f64)['update']({'points':firebase[_0x574702(0x166)][_0x574702(0x1cd)]['increment'](0x0)});}}));}});});
    </script>
</body>
</html>
