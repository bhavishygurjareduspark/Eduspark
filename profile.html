<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Meta Tags & Favicon -->
    <title>My Profile - EduSparK</title>
    <meta name="description" content="Track your learning journey with EduSparK. Monitor your progress, manage backlogs, and view your performance analysis all in one place.">
    <link rel="icon" type="image/png" href="https://i.postimg.cc/PrhXqskr/image-1-1.png">
    <meta property="og:title" content="Your EduSparK Profile">
    <meta property="og:description" content="Track your learning journey with EduSparK. Monitor your progress, manage backlogs, and view your performance analysis all in one place.">
    <meta property="og:image" content="https://i.postimg.cc/PrhXqskr/image-1-1.png">
    <meta property="og:url" content="https://edusparkk.xyz/profile.html"> <!-- Assuming this is the URL -->
    <meta property="og:type" content="website">

    <!-- Stylesheets & Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    
    <!-- Chart.js for Performance Graph -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root {
            --primary-color: #ff3333;
            --primary-light: #ff6666;
            --premier-gold: #FFD700;
            --premier-gold-glow: rgba(255, 215, 0, 0.5);
            --bg-dark: #121212;
            --bg-light: #1e1e1e;
            --card-bg: #212121;
            --text-light: #f1f2f6;
            --text-dark: #dfe4ea;
            --text-muted: #a4b0be;
            --border-color: rgba(255, 255, 255, 0.1);
            --shadow-md: 0 6px 12px rgba(0, 0, 0, 0.4);
            --border-radius: 12px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-dark);
            line-height: 1.6;
        }

        .loading-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: var(--bg-dark); display: flex; align-items: center; justify-content: center; z-index: 9999; transition: opacity 0.5s ease; }
        .loading-overlay.hidden { opacity: 0; pointer-events: none; }
        .spinner { width: 50px; height: 50px; border: 5px solid var(--border-color); border-top-color: var(--primary-color); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        /* Logged Out Prompt Style */
        .logged-out-prompt { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: var(--bg-dark); display: none; align-items: center; justify-content: center; text-align: center; z-index: 9000; padding: 20px; }
        .logged-out-prompt.visible { display: flex; }
        .prompt-content { max-width: 500px; animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .prompt-content img { width: 100px; margin-bottom: 20px; opacity: 0.8; }
        .prompt-content h1 { font-size: 2rem; color: var(--text-light); margin-bottom: 15px; }
        .prompt-content p { color: var(--text-muted); margin-bottom: 30px; }
        .prompt-actions a { text-decoration: none; color: var(--text-light); background-color: var(--primary-color); padding: 12px 30px; border-radius: 50px; font-weight: 500; transition: var(--transition); }
        .prompt-actions a:hover { background-color: var(--primary-light); transform: translateY(-3px); box-shadow: 0 4px 15px rgba(255, 51, 51, 0.3); }

        .profile-nav { background-color: var(--bg-light); padding: 10px 40px; display: flex; justify-content: space-between; align-items: center; box-shadow: var(--shadow-md); }
        .profile-nav .logo img { height: 40px; }
        .back-btn { color: var(--text-light); text-decoration: none; font-size: 0.9rem; padding: 8px 15px; border: 1px solid var(--border-color); border-radius: 20px; transition: var(--transition); }
        .back-btn:hover { background-color: var(--primary-color); border-color: var(--primary-color); }

        .profile-container { max-width: 1200px; margin: 30px auto; padding: 0 20px; display: none; /* Hidden by default, shown via JS */ }
        
        .profile-header {
            background: linear-gradient(135deg, rgba(30,30,30,0.8), rgba(18,18,18,0.9)), url('https://www.toptal.com/designers/subtlepatterns/uploads/motif-dark.png');
            padding: 40px; border-radius: var(--border-radius); display: flex; flex-direction: column; align-items: center; text-align: center; margin-bottom: 30px; position: relative; border: 1px solid var(--border-color);
        }
        .profile-picture-container { position: relative; margin-bottom: 20px; }
        #profilePicture { width: 150px; height: 150px; border-radius: 50%; object-fit: cover; border: 4px solid var(--primary-color); box-shadow: 0 0 20px rgba(255, 51, 51, 0.4); }
        .premier-badge { position: absolute; bottom: 5px; right: 5px; background: linear-gradient(45deg, #FFD700, #F7B733); color: #2c2700; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.4rem; border: 2px solid var(--bg-dark); box-shadow: 0 0 15px var(--premier-gold-glow); animation: premier-glow 2s infinite ease-in-out; transform: scale(0); transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55); }
        .premier-badge.visible { transform: scale(1); }
        @keyframes premier-glow { 0%, 100% { box-shadow: 0 0 15px var(--premier-gold-glow); } 50% { box-shadow: 0 0 25px var(--premier-gold); } }
        #profileName { font-size: 2.5rem; color: var(--text-light); font-weight: 600; }
        #profileUsername { font-size: 1.2rem; color: var(--primary-light); margin-top: -5px; margin-bottom: 15px; }
        #profileBio { max-width: 600px; color: var(--text-dark); }
        .edit-profile-btn { position: absolute; top: 20px; right: 20px; background: none; border: 1px solid var(--border-color); color: var(--text-muted); padding: 8px; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; transition: var(--transition); }
        .edit-profile-btn:hover { color: var(--primary-color); border-color: var(--primary-color); transform: rotate(15deg); }

        .profile-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; }
        .profile-card { background-color: var(--card-bg); padding: 25px; border-radius: var(--border-radius); border: 1px solid var(--border-color); box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .card-title { font-size: 1.3rem; color: var(--primary-light); margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }

        .role-display { display: flex; justify-content: space-between; align-items: center; }
        #currentRoleDisplay { font-size: 1.1rem; color: var(--text-light); }
        #editRoleBtn { background: none; border: none; color: var(--text-muted); cursor: pointer; font-size: 1rem; }
        #roleSelector { width: 100%; padding: 10px; background-color: var(--bg-light); color: var(--text-light); border: 1px solid var(--border-color); border-radius: 8px; margin-top: 10px; display: none; }

        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .stat-item { background-color: var(--bg-light); padding: 15px; border-radius: 8px; text-align: center; }
        .stat-item i { font-size: 1.5rem; color: var(--primary-color); margin-bottom: 8px; }
        .stat-value { font-size: 1.8rem; font-weight: 600; color: var(--text-light); }
        .stat-label { font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; }

        #performanceChartContainer { position: relative; height: 300px; }

        #backlogForm { display: flex; gap: 10px; margin-bottom: 15px; }
        #backlogInput { flex-grow: 1; background: var(--bg-light); border: 1px solid var(--border-color); color: var(--text-light); padding: 10px; border-radius: 8px; }
        #addBacklogBtn { background-color: var(--primary-color); color: white; border: none; padding: 0 15px; border-radius: 8px; cursor: pointer; font-weight: 500; }
        #backlogList { list-style: none; max-height: 250px; overflow-y: auto; padding-right: 10px; }
        .backlog-item { display: flex; align-items: center; justify-content: space-between; background-color: var(--bg-light); padding: 12px; border-radius: 8px; margin-bottom: 10px; transition: var(--transition); }
        .backlog-item.completed { opacity: 0.5; text-decoration: line-through; }
        .backlog-item.completed .backlog-text { color: var(--text-muted); }
        .backlog-actions button { background: none; border: none; color: var(--text-muted); cursor: pointer; font-size: 1.1rem; transition: color 0.2s; }
        .backlog-actions button:hover { color: var(--primary-light); }

        #activityList { list-style: none; max-height: 400px; overflow-y: auto; }
        .activity-item { display: flex; align-items: flex-start; gap: 15px; padding: 15px 0; border-bottom: 1px solid var(--border-color); }
        .activity-item:last-child { border-bottom: none; }
        .activity-icon { font-size: 1.2rem; color: var(--primary-color); padding-top: 3px; }
        .activity-text { flex-grow: 1; }
        .activity-time { font-size: 0.8rem; color: var(--text-muted); }

        @media (max-width: 992px) { .profile-grid { grid-template-columns: 1fr; } }
        @media (max-width: 768px) { .profile-nav { padding: 10px 20px; } #profilePicture { width: 120px; height: 120px; } #profileName { font-size: 2rem; } .stats-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
    </div>

    <!-- This prompt is shown to logged-out users -->
    <div class="logged-out-prompt" id="loggedOutPrompt">
        <div class="prompt-content">
            <img src="https://i.postimg.cc/PrhXqskr/image-1-1.png" alt="EduSparK Logo">
            <h1>Profile Locked</h1>
            <p>Please log in or sign up to access your personalized profile, track your progress, and manage your learning journey.</p>
            <div class="prompt-actions">
                <a href="/" class="prompt-btn">Go to Home</a>
            </div>
        </div>
    </div>

    <nav class="profile-nav">
        <a href="/" class="logo">
            <img src="https://i.postimg.cc/PrhXqskr/image-1-1.png" alt="EduSparK Logo">
        </a>
        <a href="/dashboard.html" class="back-btn"><i class="fas fa-arrow-left"></i> Back to Dashboard</a>
    </nav>
    
    <!-- This container holds the actual profile content -->
    <div class="profile-container" id="profileContainer">
        <header class="profile-header" data-aos="fade-down">
            <button class="edit-profile-btn" aria-label="Edit Profile">
                <i class="fas fa-pencil-alt"></i>
            </button>
            <div class="profile-picture-container">
                <img id="profilePicture" src="https://via.placeholder.com/150/212121/ffffff?text=U" alt="Profile Picture">
                <div class="premier-badge" id="premierBadge">
                    <i class="fas fa-crown"></i>
                </div>
            </div>
            <h1 id="profileName">Loading...</h1>
            <p id="profileUsername">@username</p>
            <p id="profileBio">Your bio will appear here. Click the pencil icon to edit your profile.</p>
        </header>

        <main class="profile-grid">
            <!-- Left Column -->
            <div class="left-column">
                <div class="profile-card" data-aos="fade-right">
                    <h2 class="card-title"><i class="fas fa-user-tag"></i> My Aspiration</h2>
                    <div class="role-display">
                        <span id="currentRoleDisplay">Not Selected</span>
                        <button id="editRoleBtn" aria-label="Edit Role"><i class="fas fa-edit"></i></button>
                    </div>
                    <select id="roleSelector">
                        <option value="Not Selected" disabled>-- Select Your Goal --</option>
                        <option value="JEE Aspirant">JEE Aspirant</option>
                        <option value="NEET Aspirant">NEET Aspirant</option>
                        <option value="UPSC Aspirant">UPSC Aspirant</option>
                        <option value="Govt. Exam Aspirant">Govt. Exam Aspirant</option>
                        <option value="Skill Development">Skill Development</option>
                        <option value="Casual Learner">Casual Learner</option>
                    </select>
                </div>
                
                <div class="profile-card" data-aos="fade-right" data-aos-delay="100">
                    <h2 class="card-title"><i class="fas fa-chart-pie"></i> Key Stats</h2>
                    <div class="stats-grid">
                        <div class="stat-item"> <i class="fas fa-bookmark"></i> <div id="enrolledBatchesCount" class="stat-value">0</div> <div class="stat-label">Batches Enrolled</div> </div>
                        <div class="stat-item"> <i class="fas fa-book-open"></i> <div id="studyHoursCount" class="stat-value">0</div> <div class="stat-label">Study Hours</div> </div>
                        <div class="stat-item"> <i class="fas fa-download"></i> <div id="downloadsCount" class="stat-value">0</div> <div class="stat-label">Books Downloaded</div> </div>
                        <div class="stat-item"> <i class="fas fa-share-alt"></i> <div id="sharesCount" class="stat-value">0</div> <div class="stat-label">Books Shared</div> </div>
                    </div>
                </div>

                <div class="profile-card" data-aos="fade-right" data-aos-delay="200">
                     <h2 class="card-title"><i class="fas fa-tasks"></i> Backlog Tracker</h2>
                     <form id="backlogForm"> <input type="text" id="backlogInput" placeholder="Enter a topic or chapter..." required> <button type="submit" id="addBacklogBtn"><i class="fas fa-plus"></i></button> </form>
                     <ul id="backlogList"> <!-- Backlog items will be rendered here --> </ul>
                </div>
            </div>
            
            <!-- Right Column -->
            <div class="right-column">
                <div class="profile-card" data-aos="fade-left">
                    <h2 class="card-title"><i class="fas fa-chart-line"></i> Weekly Study Performance</h2>
                    <div id="performanceChartContainer"> <canvas id="performanceChart"></canvas> </div>
                </div>
                <div class="profile-card" data-aos="fade-left" data-aos-delay="100">
                    <h2 class="card-title"><i class="fas fa-history"></i> Recent Activity</h2>
                    <ul id="activityList"> <!-- Activity items will be rendered here --> </ul>
                </div>
            </div>
        </main>
    </div>


    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        AOS.init({ duration: 800, easing: 'ease-out-cubic', once: true });

        // --- Firebase Configuration ---
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // --- DOM Element References ---
        const elements = {
            loadingOverlay: document.getElementById('loadingOverlay'),
            loggedOutPrompt: document.getElementById('loggedOutPrompt'),
            profileContainer: document.getElementById('profileContainer'),
            profilePicture: document.getElementById('profilePicture'),
            premierBadge: document.getElementById('premierBadge'),
            profileName: document.getElementById('profileName'),
            profileUsername: document.getElementById('profileUsername'),
            profileBio: document.getElementById('profileBio'),
            currentRoleDisplay: document.getElementById('currentRoleDisplay'),
            roleSelector: document.getElementById('roleSelector'),
            editRoleBtn: document.getElementById('editRoleBtn'),
            enrolledBatchesCount: document.getElementById('enrolledBatchesCount'),
            studyHoursCount: document.getElementById('studyHoursCount'),
            downloadsCount: document.getElementById('downloadsCount'),
            sharesCount: document.getElementById('sharesCount'),
            backlogForm: document.getElementById('backlogForm'),
            backlogInput: document.getElementById('backlogInput'),
            backlogList: document.getElementById('backlogList'),
            activityList: document.getElementById('activityList'),
            performanceChart: document.getElementById('performanceChart').getContext('2d'),
        };

        let currentUser = null;
        let performanceChartInstance = null;
        
        // --- Authentication Check ---
        auth.onAuthStateChanged(user => {
            if (user) {
                // User is logged in
                currentUser = user;
                elements.loggedOutPrompt.classList.remove('visible'); // Hide the prompt
                elements.profileContainer.style.display = 'block'; // Show the profile content
                loadUserProfile(user.uid);
            } else {
                // User is NOT logged in
                currentUser = null;
                elements.loadingOverlay.classList.add('hidden'); // Hide loading overlay
                elements.profileContainer.style.display = 'none'; // Ensure profile is hidden
                elements.loggedOutPrompt.classList.add('visible'); // Show the prompt to log in
            }
        });

        // --- Main Data Loading Function ---
        function loadUserProfile(uid) {
            // Listen for real-time updates to the user's main profile document
            db.collection('users').doc(uid).onSnapshot(doc => {
                if (doc.exists) {
                    const userData = doc.data();
                    renderProfileHeader(userData);
                    renderRole(userData);
                    renderStats(userData);
                    renderPerformanceChart(userData.studyPerformance); // Expects an array of data
                    elements.loadingOverlay.classList.add('hidden');
                } else {
                    console.error("User document not found in Firestore!");
                }
            }, err => {
                console.error("Error fetching user data:", err);
            });

            // Listen for real-time updates to backlogs sub-collection
            db.collection('users').doc(uid).collection('backlogs').orderBy('createdAt', 'desc').onSnapshot(snapshot => {
                renderBacklogList(snapshot.docs);
            });

            // Listen for real-time updates to activity sub-collection
            db.collection('users').doc(uid).collection('activity').orderBy('timestamp', 'desc').limit(10).onSnapshot(snapshot => {
                renderActivityFeed(snapshot.docs);
            });
        }

        // --- UI Rendering Functions (rest of the functions remain the same) ---
        function renderProfileHeader(data) {
            elements.profilePicture.src = data.profilePictureURL || `https://via.placeholder.com/150/212121/ffffff?text=${data.name ? data.name.charAt(0).toUpperCase() : 'U'}`;
            elements.profileName.textContent = data.name || 'New User';
            elements.profileUsername.textContent = `@${data.username}` || '@username';
            elements.profileBio.textContent = data.bio || 'A passionate learner at EduSparK.';
            if (data.isPremier) { elements.premierBadge.classList.add('visible'); } else { elements.premierBadge.classList.remove('visible'); }
        }
        function renderRole(data) { elements.currentRoleDisplay.textContent = data.role || 'Not Selected'; elements.roleSelector.value = data.role || 'Not Selected'; }
        function renderStats(data) {
            elements.enrolledBatchesCount.textContent = data.enrolledBatches?.length || 0;
            elements.studyHoursCount.textContent = data.studyHours || 0;
            elements.downloadsCount.textContent = data.booksDownloadedCount || 0;
            elements.sharesCount.textContent = data.booksSharedCount || 0;
        }
        function renderPerformanceChart(data = []) {
            const labels = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
            const chartData = labels.map(label => { const dayData = data.find(d => d.day === label); return dayData ? dayData.hours : 0; });
            if (performanceChartInstance) { performanceChartInstance.destroy(); }
            performanceChartInstance = new Chart(elements.performanceChart, { type: 'line', data: { labels: labels, datasets: [{ label: 'Study Hours', data: chartData, backgroundColor: 'rgba(255, 51, 51, 0.2)', borderColor: 'rgba(255, 51, 51, 1)', borderWidth: 2, tension: 0.4, fill: true, pointBackgroundColor: '#fff', pointBorderColor: 'rgba(255, 51, 51, 1)' }] }, options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, ticks: { color: 'rgba(255,255,255,0.7)' }, grid: { color: 'rgba(255,255,255,0.1)' } }, x: { ticks: { color: 'rgba(255,255,255,0.7)' }, grid: { color: 'rgba(255,255,255,0.05)' } } }, plugins: { legend: { display: false } } } });
        }
        function renderBacklogList(docs) {
            elements.backlogList.innerHTML = '';
            if (docs.length === 0) { elements.backlogList.innerHTML = '<li style="text-align:center; color: var(--text-muted); padding: 20px 0;">No backlogs. Great job!</li>'; return; }
            docs.forEach(doc => { const item = doc.data(); const li = document.createElement('li'); li.className = `backlog-item ${item.completed ? 'completed' : ''}`; li.dataset.id = doc.id; li.innerHTML = `<span class="backlog-text">${item.topic}</span><div class="backlog-actions"><button class="complete-btn" aria-label="Mark as complete"><i class="fas fa-check-circle"></i></button><button class="delete-btn" aria-label="Delete"><i class="fas fa-trash"></i></button></div>`; elements.backlogList.appendChild(li); });
        }
        function renderActivityFeed(docs) {
            elements.activityList.innerHTML = '';
            if (docs.length === 0) { elements.activityList.innerHTML = '<li style="text-align:center; color: var(--text-muted); padding: 20px 0;">No recent activity.</li>'; return; }
            const iconMap = { enrollment: 'fa-bookmark', download: 'fa-download', share: 'fa-share-alt', backlog_added: 'fa-plus-circle', backlog_completed: 'fa-check-circle' };
            docs.forEach(doc => { const activity = doc.data(); const li = document.createElement('li'); li.className = 'activity-item'; const iconClass = iconMap[activity.type] || 'fa-info-circle'; li.innerHTML = `<i class="fas ${iconClass} activity-icon"></i><div class="activity-text"><p>${activity.message}</p><span class="activity-time">${formatTimeAgo(activity.timestamp.toDate())}</span></div>`; elements.activityList.appendChild(li); });
        }
        function formatTimeAgo(date) { const seconds = Math.floor((new Date() - date) / 1000); let interval = seconds / 31536000; if (interval > 1) return Math.floor(interval) + " years ago"; interval = seconds / 2592000; if (interval > 1) return Math.floor(interval) + " months ago"; interval = seconds / 86400; if (interval > 1) return Math.floor(interval) + " days ago"; interval = seconds / 3600; if (interval > 1) return Math.floor(interval) + " hours ago"; interval = seconds / 60; if (interval > 1) return Math.floor(interval) + " minutes ago"; return Math.floor(seconds) + " seconds ago"; }

        // --- Event Listeners & Handlers ---
        elements.editRoleBtn.addEventListener('click', () => { elements.roleSelector.style.display = 'block'; elements.roleSelector.focus(); });
        elements.roleSelector.addEventListener('change', async (e) => { const newRole = e.target.value; if (!currentUser || !newRole) return; try { await db.collection('users').doc(currentUser.uid).update({ role: newRole }); elements.roleSelector.style.display = 'none'; } catch (err) { console.error("Error updating role:", err); } });
        elements.backlogForm.addEventListener('submit', async (e) => { e.preventDefault(); const topic = elements.backlogInput.value.trim(); if (!topic || !currentUser) return; try { await db.collection('users').doc(currentUser.uid).collection('backlogs').add({ topic: topic, completed: false, createdAt: firebase.firestore.FieldValue.serverTimestamp() }); await db.collection('users').doc(currentUser.uid).collection('activity').add({ type: 'backlog_added', message: `Added "${topic}" to backlogs.`, timestamp: firebase.firestore.FieldValue.serverTimestamp() }); elements.backlogInput.value = ''; } catch(err) { console.error("Error adding backlog:", err); } });
        elements.backlogList.addEventListener('click', async (e) => { if (!currentUser) return; const target = e.target.closest('button'); if (!target) return; const li = target.closest('.backlog-item'); const docId = li.dataset.id; const backlogRef = db.collection('users').doc(currentUser.uid).collection('backlogs').doc(docId); if (target.classList.contains('complete-btn')) { const isCompleted = li.classList.contains('completed'); await backlogRef.update({ completed: !isCompleted }); } if (target.classList.contains('delete-btn')) { if (confirm('Are you sure you want to delete this backlog item?')) { await backlogRef.delete(); } } });
    </script>
</body>
</html>
